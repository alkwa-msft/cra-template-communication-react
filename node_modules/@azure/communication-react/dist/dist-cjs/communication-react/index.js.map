{"version":3,"file":"index.js","sources":["../../../preprocess-dist/acs-ui-common/src/memoizeFnAll.ts","../../../preprocess-dist/acs-ui-common/src/identifier.ts","../../../preprocess-dist/acs-ui-common/src/telemetryVersion.js","../../../preprocess-dist/acs-ui-common/src/telemetry.ts","../../../preprocess-dist/acs-ui-common/src/localizationUtils.ts","../../../preprocess-dist/acs-ui-common/src/safeStringify.ts","../../../preprocess-dist/acs-ui-common/src/common.ts","../../../preprocess-dist/acs-ui-common/src/cssUtils.ts","../../../preprocess-dist/acs-ui-common/src/logEvent.ts","../../../preprocess-dist/calling-component-bindings/src/baseSelectors.ts","../../../preprocess-dist/calling-component-bindings/src/utils/callUtils.ts","../../../preprocess-dist/calling-component-bindings/src/callControlSelectors.ts","../../../preprocess-dist/calling-component-bindings/src/handlers/createHandlers.ts","../../../preprocess-dist/calling-component-bindings/src/providers/CallAgentProvider.tsx","../../../preprocess-dist/calling-component-bindings/src/providers/CallClientProvider.tsx","../../../preprocess-dist/calling-component-bindings/src/providers/CallProvider.tsx","../../../preprocess-dist/react-components/src/components/styles/TypingIndicator.styles.ts","../../../preprocess-dist/react-components/src/localization/locales/index.ts","../../../preprocess-dist/react-components/src/localization/LocalizationProvider.tsx","../../../preprocess-dist/react-components/src/identifiers/IdentifierProvider.tsx","../../../preprocess-dist/react-components/src/components/TypingIndicator.tsx","../../../preprocess-dist/react-components/src/components/utils.ts","../../../preprocess-dist/react-components/src/components/ErrorBar.tsx","../../../preprocess-dist/react-components/src/components/styles/GridLayout.styles.ts","../../../preprocess-dist/react-components/src/components/GridLayout.tsx","../../../preprocess-dist/react-components/src/components/styles/SendBox.styles.ts","../../../preprocess-dist/react-components/src/theming/themes.ts","../../../preprocess-dist/react-components/src/theming/FluentThemeProvider.tsx","../../../preprocess-dist/react-components/src/theming/icons.tsx","../../../preprocess-dist/react-components/src/components/styles/InputBoxComponent.style.ts","../../../preprocess-dist/react-components/src/theming/themeUtils.ts","../../../preprocess-dist/react-components/src/components/InputBoxComponent.tsx","../../../preprocess-dist/react-components/src/components/styles/VoiceOverButton.style.ts","../../../preprocess-dist/react-components/src/components/VoiceOverButton.tsx","../../../preprocess-dist/react-components/src/components/Announcer.tsx","../../../preprocess-dist/react-components/src/components/SendBoxErrorBar.tsx","../../../preprocess-dist/react-components/src/components/SendBoxErrors.tsx","../../../preprocess-dist/react-components/src/components/SendBox.tsx","../../../preprocess-dist/react-components/src/components/styles/MessageStatusIndicator.styles.ts","../../../preprocess-dist/react-components/src/components/MessageStatusIndicator.tsx","../../../preprocess-dist/react-components/src/components/styles/MessageThread.styles.ts","../../../preprocess-dist/react-components/src/components/utils/delay.ts","../../../preprocess-dist/react-components/src/components/styles/SystemMessage.styles.ts","../../../preprocess-dist/react-components/src/components/SystemMessage.tsx","../../../preprocess-dist/react-components/src/components/styles/EditBox.styles.ts","../../../preprocess-dist/react-components/src/components/utils/common.ts","../../../preprocess-dist/react-components/src/components/FileCard.tsx","../../../preprocess-dist/react-components/src/components/FileCardGroup.tsx","../../../preprocess-dist/react-components/src/components/styles/IconButton.styles.ts","../../../preprocess-dist/react-components/src/components/FileUploadCards.tsx","../../../preprocess-dist/react-components/src/components/ChatMessage/ChatMessageComponentAsEditBox.tsx","../../../preprocess-dist/react-components/src/components/styles/ChatMessageComponent.styles.ts","../../../preprocess-dist/react-components/src/components/utils/Datetime.ts","../../../preprocess-dist/react-components/src/components/ChatMessage/ChatMessageActionsFlyout.tsx","../../../preprocess-dist/react-components/src/components/ChatMessage/ChatMessageContent.tsx","../../../preprocess-dist/react-components/src/components/ChatMessage/ChatMessageActionMenu.tsx","../../../preprocess-dist/react-components/src/components/FileDownloadCards.tsx","../../../preprocess-dist/react-components/src/components/ChatMessage/ChatMessageComponentAsMessageBubble.tsx","../../../preprocess-dist/react-components/src/components/ChatMessage/ChatMessageComponent.tsx","../../../preprocess-dist/react-components/src/components/utils/responsive.ts","../../../preprocess-dist/react-components/src/components/utils/getParticipantsWhoHaveReadMessage.ts","../../../preprocess-dist/react-components/src/components/MessageThread.tsx","../../../preprocess-dist/react-components/src/components/styles/StreamMedia.styles.ts","../../../preprocess-dist/react-components/src/components/StreamMedia.tsx","../../../preprocess-dist/react-components/src/components/styles/ParticipantItem.styles.ts","../../../preprocess-dist/react-components/src/components/ParticipantItem.tsx","../../../preprocess-dist/react-components/src/components/styles/ParticipantList.styles.ts","../../../preprocess-dist/react-components/src/components/ParticipantList.tsx","../../../preprocess-dist/react-components/src/gallery/dominantSpeaker.ts","../../../preprocess-dist/react-components/src/components/VideoGallery/useVideoStreamLifecycleMaintainer.ts","../../../preprocess-dist/react-components/src/components/styles/VideoTile.styles.ts","../../../preprocess-dist/react-components/src/components/utils/videoTileStylesUtils.tsx","../../../preprocess-dist/react-components/src/components/VideoTile.tsx","../../../preprocess-dist/react-components/src/components/RemoteVideoTile.tsx","../../../preprocess-dist/react-components/src/components/styles/HorizontalGallery.styles.ts","../../../preprocess-dist/react-components/src/components/HorizontalGallery.tsx","../../../preprocess-dist/react-components/src/components/ResponsiveHorizontalGallery.tsx","../../../preprocess-dist/react-components/src/components/styles/VideoGallery.styles.ts","../../../preprocess-dist/react-components/src/components/VideoGallery/styles/LocalScreenShare.styles.ts","../../../preprocess-dist/react-components/src/components/VideoGallery/LocalScreenShare.tsx","../../../preprocess-dist/react-components/src/components/VideoGallery/styles/RemoteScreenShare.styles.ts","../../../preprocess-dist/react-components/src/components/VideoGallery/RemoteScreenShare.tsx","../../../preprocess-dist/react-components/src/components/ModalClone/ModalClone.tsx","../../../preprocess-dist/react-components/src/components/LocalVideoCameraButton.tsx","../../../preprocess-dist/react-components/src/components/LocalVideoTile.tsx","../../../preprocess-dist/react-components/src/components/VideoGallery.tsx","../../../preprocess-dist/react-components/src/components/styles/ControlBar.styles.ts","../../../preprocess-dist/react-components/src/components/ControlButtonTooltip.tsx","../../../preprocess-dist/react-components/src/components/ControlBarButton.tsx","../../../preprocess-dist/react-components/src/components/HighContrastAwareIcon.tsx","../../../preprocess-dist/react-components/src/components/DevicesButton.tsx","../../../preprocess-dist/react-components/src/components/CameraButton.tsx","../../../preprocess-dist/react-components/src/components/ControlBar.tsx","../../../preprocess-dist/react-components/src/components/EndCallButton.tsx","../../../preprocess-dist/react-components/src/components/MicrophoneButton.tsx","../../../preprocess-dist/react-components/src/components/ParticipantsButton.tsx","../../../preprocess-dist/react-components/src/components/ScreenShareButton.tsx","../../../preprocess-dist/react-components/src/components/utils/keyboardNavigation.ts","../../../preprocess-dist/react-components/src/components/PictureInPictureInPicture/PictureInPictureInPictureTile.tsx","../../../preprocess-dist/react-components/src/components/PictureInPictureInPicture/PictureInPictureInPicture.tsx","../../../preprocess-dist/react-components/src/components/Drawer/DrawerMenuItem.tsx","../../../preprocess-dist/react-components/src/components/Drawer/DrawerContentContainer.tsx","../../../preprocess-dist/react-components/src/components/Drawer/DrawerLightDismiss.tsx","../../../preprocess-dist/react-components/src/components/Drawer/DrawerSurface.tsx","../../../preprocess-dist/react-components/src/components/Drawer/DrawerMenu.tsx","../../../preprocess-dist/react-components/src/components/ComplianceBanner/Utils.tsx","../../../preprocess-dist/react-components/src/components/ComplianceBanner/BannerMessage.tsx","../../../preprocess-dist/react-components/src/components/ComplianceBanner/DelayedUpdateBanner.tsx","../../../preprocess-dist/react-components/src/components/ComplianceBanner/ComplianceBanner.tsx","../../../preprocess-dist/calling-component-bindings/src/utils/SelectorUtils.ts","../../../preprocess-dist/calling-component-bindings/src/utils/videoGalleryUtils.ts","../../../preprocess-dist/calling-component-bindings/src/videoGallerySelector.ts","../../../preprocess-dist/calling-component-bindings/src/utils/participantListSelectorUtils.ts","../../../preprocess-dist/calling-component-bindings/src/participantListSelector.ts","../../../preprocess-dist/calling-component-bindings/src/participantsButtonSelector.ts","../../../preprocess-dist/calling-component-bindings/src/hooks/useHandlers.ts","../../../preprocess-dist/calling-component-bindings/src/hooks/useSelector.ts","../../../preprocess-dist/calling-component-bindings/src/errorBarSelector.ts","../../../preprocess-dist/calling-component-bindings/src/hooks/usePropsFor.ts","../../../preprocess-dist/chat-component-bindings/src/handlers/createHandlers.ts","../../../preprocess-dist/chat-component-bindings/src/providers/ChatClientProvider.tsx","../../../preprocess-dist/chat-component-bindings/src/providers/ChatThreadClientProvider.tsx","../../../preprocess-dist/chat-component-bindings/src/hooks/useHandlers.ts","../../../preprocess-dist/chat-component-bindings/src/hooks/useSelector.ts","../../../preprocess-dist/chat-component-bindings/src/baseSelectors.ts","../../../preprocess-dist/chat-component-bindings/src/sendBoxSelector.ts","../../../preprocess-dist/chat-component-bindings/src/utils/constants.ts","../../../preprocess-dist/chat-component-bindings/src/utils/compareMessages.ts","../../../preprocess-dist/chat-component-bindings/src/utils/updateMessagesWithAttached.ts","../../../preprocess-dist/chat-component-bindings/src/messageThreadSelector.ts","../../../preprocess-dist/chat-component-bindings/src/typingIndicatorSelector.ts","../../../preprocess-dist/chat-component-bindings/src/chatParticipantListSelector.ts","../../../preprocess-dist/chat-component-bindings/src/errorBarSelector.ts","../../../preprocess-dist/chat-component-bindings/src/hooks/usePropsFor.ts","../../../preprocess-dist/calling-stateful-client/src/DeviceManagerDeclarative.ts","../../../preprocess-dist/calling-stateful-client/src/CallClientState.ts","../../../preprocess-dist/calling-stateful-client/src/Logger.ts","../../../preprocess-dist/calling-stateful-client/src/CallIdHistory.ts","../../../preprocess-dist/calling-stateful-client/src/CallContext.ts","../../../preprocess-dist/calling-stateful-client/src/CallDeclarative.ts","../../../preprocess-dist/calling-stateful-client/src/Converter.ts","../../../preprocess-dist/calling-stateful-client/src/RemoteVideoStreamSubscriber.ts","../../../preprocess-dist/calling-stateful-client/src/StreamUtils.ts","../../../preprocess-dist/calling-stateful-client/src/ParticipantSubscriber.ts","../../../preprocess-dist/calling-stateful-client/src/RecordingSubscriber.ts","../../../preprocess-dist/calling-stateful-client/src/TranscriptionSubscriber.ts","../../../preprocess-dist/calling-stateful-client/src/UserFacingDiagnosticsSubscriber.ts","../../../preprocess-dist/calling-stateful-client/src/CallSubscriber.ts","../../../preprocess-dist/calling-stateful-client/src/IncomingCallDeclarative.ts","../../../preprocess-dist/calling-stateful-client/src/IncomingCallSubscriber.ts","../../../preprocess-dist/calling-stateful-client/src/CallAgentDeclarative.ts","../../../preprocess-dist/calling-stateful-client/src/InternalCallContext.ts","../../../preprocess-dist/calling-stateful-client/src/StatefulCallClient.ts","../../../preprocess-dist/chat-stateful-client/src/ChatClientState.ts","../../../preprocess-dist/chat-stateful-client/src/Constants.ts","../../../preprocess-dist/chat-stateful-client/src/Logger.ts","../../../preprocess-dist/chat-stateful-client/src/ChatContext.ts","../../../preprocess-dist/chat-stateful-client/src/convertChatMessage.ts","../../../preprocess-dist/chat-stateful-client/src/EventSubscriber.ts","../../../preprocess-dist/chat-stateful-client/src/iterators/createDecoratedIterator.ts","../../../preprocess-dist/chat-stateful-client/src/iterators/createDecoratedListMessages.ts","../../../preprocess-dist/chat-stateful-client/src/iterators/createDecoratedListReadReceipts.ts","../../../preprocess-dist/chat-stateful-client/src/iterators/createDecoratedListParticipants.ts","../../../preprocess-dist/chat-stateful-client/src/StatefulChatThreadClient.ts","../../../preprocess-dist/chat-stateful-client/src/iterators/createDecoratedListThreads.ts","../../../preprocess-dist/chat-stateful-client/src/StatefulChatClient.ts","../../../preprocess-dist/react-composites/src/composites/ChatComposite/adapter/AzureCommunicationChatAdapter.ts","../../../preprocess-dist/react-composites/src/composites/localization/locales/index.ts","../../../preprocess-dist/react-composites/src/composites/localization/LocalizationProvider.tsx","../../../preprocess-dist/react-composites/src/composites/common/icons.tsx","../../../preprocess-dist/react-composites/src/composites/common/styles/GlobalHostLayer.styles.ts","../../../preprocess-dist/react-composites/src/composites/common/BaseComposite.tsx","../../../preprocess-dist/react-composites/src/composites/ChatComposite/adapter/ChatAdapterProvider.tsx","../../../preprocess-dist/react-composites/src/composites/ChatComposite/styles/Chat.styles.ts","../../../preprocess-dist/react-composites/src/composites/common/AvatarPersona.tsx","../../../preprocess-dist/react-composites/src/composites/ChatComposite/ChatHeader.tsx","../../../preprocess-dist/react-composites/src/composites/ChatComposite/file-sharing/FileUploadButton.tsx","../../../preprocess-dist/react-composites/src/composites/ChatComposite/hooks/useAdaptedSelector.ts","../../../preprocess-dist/react-composites/src/composites/ChatComposite/hooks/useHandlers.ts","../../../preprocess-dist/react-composites/src/composites/ChatComposite/hooks/usePropsFor.ts","../../../preprocess-dist/react-composites/src/composites/common/styles/ParticipantContainer.styles.ts","../../../preprocess-dist/react-composites/src/composites/ChatComposite/ChatScreen.tsx","../../../preprocess-dist/react-composites/src/composites/ChatComposite/ChatComposite.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/adapter/CallAdapterProvider.tsx","../../../preprocess-dist/react-composites/src/composites/common/ContainerRectProps.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/hooks/useAdaptedSelector.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/adapter/CallAdapter.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/utils/Utils.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/hooks/useHandlers.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/hooks/usePropsFor.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/styles/Buttons.styles.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/components/buttons/Camera.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/components/buttons/Devices.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/components/buttons/EndCall.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/hooks/useSelector.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/selectors/baseSelectors.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/components/buttons/Microphone.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/components/buttons/Participants.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/components/buttons/ScreenShare.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/components/CallControls.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/styles/CallControls.styles.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/styles/CallPage.styles.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/components/MutedNotification.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/components/CallArrangement.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/selectors/LocalVideoTileSelector.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/components/MediaGallery.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/styles/ExpandedLocalVideoTile.styles.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/components/ExpandedLocalVideoTile.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/styles/NetworkReconnectTile.styles.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/components/NetworkReconnectTile.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/selectors/callStatusSelector.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/selectors/complianceBannerSelector.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/selectors/mediaGallerySelector.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/selectors/mutedNotificationSelector.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/selectors/localVideoStreamSelector.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/selectors/lobbySelector.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/selectors/networkReconnectTileSelector.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/pages/CallPage.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/styles/LocalDeviceSettings.styles.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/components/ConfigurationpageCameraDropdown.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/components/ConfigurationpageMicDropdown.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/components/LocalDeviceSettings.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/styles/StartCallButton.styles.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/components/StartCallButton.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/selectors/devicePermissionSelector.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/selectors/localPreviewSelector.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/styles/LocalPreview.styles.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/components/LocalPreview.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/styles/CallConfiguration.styles.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/pages/ConfigurationPage.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/styles/NoticePage.styles.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/pages/NoticePage.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/styles/LobbyTile.styles.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/components/LobbyTile.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/pages/LobbyPage.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/styles/CallComposite.styles.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/CallComposite.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/adapter/ParticipantSubcriber.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/adapter/DiagnosticsForwarder.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/adapter/AzureCommunicationCallAdapter.ts","../../../preprocess-dist/react-composites/src/composites/CallWithChatComposite/PeopleButton.tsx","../../../preprocess-dist/react-composites/src/composites/CallWithChatComposite/hooks/useCallWithChatCompositeStrings.ts","../../../preprocess-dist/react-composites/src/composites/CallWithChatComposite/ChatButton.tsx","../../../preprocess-dist/react-composites/src/composites/CallWithChatComposite/NotificationIcon.tsx","../../../preprocess-dist/react-composites/src/composites/CallWithChatComposite/ChatButtonWithUnreadMessagesBadge.tsx","../../../preprocess-dist/react-composites/src/composites/common/MoreButton.tsx","../../../preprocess-dist/react-composites/src/composites/CallWithChatComposite/CallWithChatControlBar.tsx","../../../preprocess-dist/react-composites/src/composites/CallWithChatComposite/styles/CallWithChatCompositeStyles.ts","../../../preprocess-dist/react-composites/src/composites/CallWithChatComposite/adapter/CallWithChatBackedCallAdapter.ts","../../../preprocess-dist/react-composites/src/composites/CallWithChatComposite/adapter/CallWithChatBackedChatAdapter.ts","../../../preprocess-dist/react-composites/src/composites/CallWithChatComposite/components/MoreDrawer.tsx","../../../preprocess-dist/react-composites/src/composites/CallWithChatComposite/selectors/moreDrawerSelector.ts","../../../preprocess-dist/react-composites/src/composites/CallWithChatComposite/PreparedMoreDrawer.tsx","../../../preprocess-dist/react-composites/src/composites/common/SidePaneHeader.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/components/LocalAndRemotePIP.tsx","../../../preprocess-dist/react-composites/src/composites/CallComposite/selectors/dominantRemoteParticipantSelector.ts","../../../preprocess-dist/react-composites/src/composites/CallComposite/selectors/localAndRemotePIPSelector.ts","../../../preprocess-dist/react-composites/src/composites/common/styles/ModalLocalAndRemotePIP.styles.ts","../../../preprocess-dist/react-composites/src/composites/common/ModalLocalAndRemotePIP.tsx","../../../preprocess-dist/react-composites/src/composites/common/ParticipantContainer.tsx","../../../preprocess-dist/react-composites/src/composites/common/styles/PeoplePaneContent.styles.ts","../../../preprocess-dist/react-composites/src/composites/CallWithChatComposite/ConvertContextualMenuItemToDrawerMenuItem.tsx","../../../preprocess-dist/react-composites/src/composites/common/AddPeopleButton.tsx","../../../preprocess-dist/react-composites/src/composites/common/PeoplePaneContent.tsx","../../../preprocess-dist/react-composites/src/composites/common/styles/Pane.styles.ts","../../../preprocess-dist/react-composites/src/composites/common/TabHeader.tsx","../../../preprocess-dist/react-composites/src/composites/common/utils.tsx","../../../preprocess-dist/react-composites/src/composites/CallWithChatComposite/CallWithChatPane.tsx","../../../preprocess-dist/react-composites/src/composites/CallWithChatComposite/CallWithChatComposite.tsx","../../../preprocess-dist/react-composites/src/composites/CallWithChatComposite/state/CallWithChatAdapterState.ts","../../../preprocess-dist/react-composites/src/composites/CallWithChatComposite/adapter/parseTeamsUrl.ts","../../../preprocess-dist/react-composites/src/composites/CallWithChatComposite/adapter/AzureCommunicationCallWithChatAdapter.ts","../../../preprocess-dist/communication-react/src/mergedHooks.ts"],"sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/**\n * A function type where the first argument is a key used to memoize results.\n *\n * @public\n */\nexport type FunctionWithKey<KeyT, ArgsT extends unknown[], RetT> = (key: KeyT, ...args: ArgsT) => RetT;\n/**\n * A function type that is called with the result of a memoized functions return value.\n *\n * @public\n */\n\nexport type CallbackType<KeyT, ArgsT extends unknown[], FnRetT> = (memoizedFn: FunctionWithKey<KeyT, ArgsT, FnRetT>) => FnRetT[];\n\nconst argsCmp = (args1: unknown[], args2: unknown[], objCmp: (obj1: unknown, obj2: unknown) => boolean): boolean => {\n  return args1.length === args2.length && args1.every((arg1, index) => objCmp(args2[index], arg1));\n};\n/**\n * The function memoize a series of function calls in a single pass,\n * it memoizes all the args and return in a single run of the callback function, and read it in the next round of execution\n * note: this is a memory opimized function which will only memoize one round of bulk calls\n * @param  fnToMemoize - the function needs to be bulk memorized and a key key paramter needs to be provided as cache id\n * @param  shouldCacheUpdate - the validate function for comparing 2 argument, return true when 2 args are equal\n * @returns callback function includes a series calls of memoizedFn, and each call will get cache result if args are the same(according to shouldCacheUpdate fn)\n * @example\n * ```ts\n * const items = [{id:1, value:3}];\n * const heavyFn = (_key, value) => { // key is not used in the function, but it is a cache id\n *   // assume this is a heavy caculation\n *   return value+1;\n * }\n *\n * const memoizeHeavyFnAll = memoizeFnAll(heavyFn);\n * const generateValueArray = (memoizedHeavyFn) => (\n *   items.map(item => {\n *     memoizedHeavyFn(item.id, item.value);\n *   })\n * );\n *\n * const result = memoizeHeavyFnAll(generateValueArray); // Cache: {}, nextCache: {1: 4 *new}, heavyFn call times: 1\n *\n * // Argument changed\n * items[0].value = 2\n * const result0 = memoizeHeavyFnAll(generateValueArray); // Cache: {1: 4}, nextCache: {1: 3 *new}, heavyFn call times: 1\n *\n * // Cache added\n * items.push({id:3, value:4});\n * const result1 = memoizeHeavyFnAll(generateValueArray); // Cache: {1: 3 *hit}, nextCache: {1: 3, 3: 5 *new}, heavyFn call times: 1\n *\n * // Cache removed\n * delete items[0];\n * const result2 = memoizeHeavyFnAll(generateValueArray); // Cache: {1: 3, 3: 5 *hit}, nextCache: {3: 5}, heavyFn call times: 0\n * ```\n *\n * @public\n */\n\n\nexport const memoizeFnAll = <KeyT, ArgsT extends unknown[], FnRetT, CallBackT extends CallbackType<KeyT, ArgsT, FnRetT>>(fnToMemoize: FunctionWithKey<KeyT, ArgsT, FnRetT>, shouldCacheUpdate: (args1: unknown, args2: unknown) => boolean = Object.is): ((callback: CallBackT) => FnRetT[]) => {\n  let cache = new Map<KeyT, [ArgsT, FnRetT]>();\n  let nextCache = new Map<KeyT, [ArgsT, FnRetT]>();\n  return (callback: CallbackType<KeyT, ArgsT, FnRetT>): FnRetT[] => {\n    const memoizedFn: FunctionWithKey<KeyT, ArgsT, FnRetT> = (key: KeyT, ...args: ArgsT): FnRetT => {\n      const value = cache.get(key);\n\n      if (value) {\n        const [preArgs, ret] = value;\n\n        if (argsCmp(preArgs, args, shouldCacheUpdate)) {\n          nextCache.set(key, [args, ret]);\n          return ret;\n        }\n      }\n\n      const ret = fnToMemoize(key, ...args);\n      nextCache.set(key, [args, ret]);\n      return ret;\n    };\n\n    const retValue = callback(memoizedFn);\n    cache = nextCache;\n    nextCache = new Map<KeyT, [ArgsT, FnRetT]>();\n    return retValue;\n  };\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CommunicationIdentifier, isCommunicationUserIdentifier, isMicrosoftTeamsUserIdentifier, isPhoneNumberIdentifier } from '@azure/communication-common';\nconst COMMUNICATION_USER_PREFIX = '8:acs:';\nconst PHONE_NUMBER_PREFIX = '4:';\nconst TEAMS_DOD_PREFIX = '8:dod:';\nconst TEAMS_GCCH_PREFIX = '8:gcch:';\nconst TEAMS_USER_PREFIX = '8:origid:';\nconst TEAMS_VISITOR_PREFIX = '8:teamsvisitor:';\n/**\n * A string representation of a {@link @azure/communication-common#CommunicationIdentifier}.\n *\n * This string representation of CommunicationIdentifier is guaranteed to be stable for\n * a unique Communication user. Thus,\n * - it can be used to persist a user's identity in external databases.\n * - it can be used as keys into a Map to store data for the user.\n *\n * @public\n */\n\nexport const toFlatCommunicationIdentifier = (identifier: CommunicationIdentifier): string => {\n  if (isCommunicationUserIdentifier(identifier)) {\n    return identifier.communicationUserId;\n  }\n\n  if (isMicrosoftTeamsUserIdentifier(identifier)) {\n    if (identifier.isAnonymous) {\n      return TEAMS_VISITOR_PREFIX + identifier.microsoftTeamsUserId;\n    }\n\n    if (identifier.cloud === 'dod') {\n      return TEAMS_DOD_PREFIX + identifier.microsoftTeamsUserId;\n    }\n\n    if (identifier.cloud === 'gcch') {\n      return TEAMS_GCCH_PREFIX + identifier.microsoftTeamsUserId;\n    }\n\n    return TEAMS_USER_PREFIX + identifier.microsoftTeamsUserId;\n  }\n\n  if (isPhoneNumberIdentifier(identifier)) {\n    return PHONE_NUMBER_PREFIX + identifier.phoneNumber;\n  }\n\n  return identifier.id;\n};\n/**\n * Reverse operation of {@link toFlatCommunicationIdentifier}.\n *\n * @public\n */\n\nexport const fromFlatCommunicationIdentifier = (id: string): CommunicationIdentifier => {\n  if (id.startsWith(COMMUNICATION_USER_PREFIX)) {\n    // The prefix is preserved for this variant of the identifier.\n    return {\n      communicationUserId: id\n    };\n  }\n\n  if (id.startsWith(PHONE_NUMBER_PREFIX) || id.startsWith('+')) {\n    const isPhoneNumber = id.startsWith(PHONE_NUMBER_PREFIX) ? id.replace(PHONE_NUMBER_PREFIX, '') : id;\n    return {\n      phoneNumber: isPhoneNumber\n    };\n  }\n\n  if (id.startsWith(TEAMS_USER_PREFIX)) {\n    return {\n      microsoftTeamsUserId: id.replace(TEAMS_USER_PREFIX, '')\n    };\n  }\n\n  if (id.startsWith(TEAMS_DOD_PREFIX)) {\n    return {\n      microsoftTeamsUserId: id.replace(TEAMS_DOD_PREFIX, ''),\n      cloud: 'dod'\n    };\n  }\n\n  if (id.startsWith(TEAMS_GCCH_PREFIX)) {\n    return {\n      microsoftTeamsUserId: id.replace(TEAMS_GCCH_PREFIX, ''),\n      cloud: 'gcch'\n    };\n  }\n\n  if (id.startsWith(TEAMS_VISITOR_PREFIX)) {\n    return {\n      microsoftTeamsUserId: id.replace(TEAMS_VISITOR_PREFIX, ''),\n      isAnonymous: true\n    };\n  }\n\n  return {\n    id\n  };\n};\n/**\n * Returns a CommunicationIdentifier.\n * @internal\n */\n\nexport const _toCommunicationIdentifier = (id: string | CommunicationIdentifier): CommunicationIdentifier => {\n  if (typeof id === 'string') {\n    return fromFlatCommunicationIdentifier(id);\n  }\n\n  return id;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n// GENERATED FILE. DO NOT EDIT MANUALLY.\n\nmodule.exports = '1.4.1';\n","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport * as telemetryVersion from './telemetryVersion';\n/**\n * @private\n */\n// Removes long suffixes that don't fit the constraints for telemetry application ID.\n// e.g., the build suffix is dropped for alpha package versions.\n\nexport const sanitize = (version: string): string => {\n  const alphaIndex = version.search(/alpha/);\n\n  if (alphaIndex >= 0) {\n    return version.substring(0, alphaIndex + 5);\n  }\n\n  return version;\n};\n/**\n * Application ID to be included in telemetry data from the UI library.\n *\n * @internal\n */\n\nexport const _getApplicationId = (): string => {\n  const version = telemetryVersion['default'];\n  return sanitize(`acr/${version}`);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/**\n * @internal\n */\nexport interface _IObjectMap<T> {\n  [key: string]: T;\n}\n/**\n * @internal\n *\n * Replace the pattern \"\\{\\}\" in str with the values passed in as vars\n *\n * @example\n * ```ts\n *   _formatString(\"hello {name}. '{name}' is a rare name.\", {name: \"Foo\"});\n *   // returns \"hello Foo. 'Foo' is a rare name.\"\n * ```\n * @param str - The string to be formatted\n * @param variables - Variables to use to format the string\n * @returns a formatted string\n */\n\nexport const _formatString = (str: string, vars: _IObjectMap<string>): string => {\n  if (!str) {\n    return '';\n  }\n\n  if (!vars) {\n    return str;\n  } // regex to search for the pattern \"\\{\\}\"\n\n\n  const placeholdersRegex = /{(\\w+)}/g;\n  return str.replace(placeholdersRegex, (_: string, k: string) => vars[k] || `{${k}}`);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/**\n * Wrap JSON.stringify in a try-catch as JSON.stringify throws an exception if it fails.\n *\n * Use this only in areas where the JSON.stringify is non-critical and OK for the JSON.stringify to fail, such as logging.\n *\n * @internal\n */\nexport const _safeJSONStringify = (value: unknown, replacer: ((this: unknown, key: string, value: unknown) => unknown) | undefined = createSafeReplacer(), space?: string | number | undefined): string | undefined => {\n  try {\n    return JSON.stringify(value, replacer, space);\n  } catch (e) {\n    console.error(e);\n    return undefined;\n  }\n}; // Log all visited refs to avoid circular ref\n\nconst createSafeReplacer = (): (<T>(key: string, value: T) => T | string) => {\n  const visited = new Set();\n  return function replacer<T>(key: string, value: T): T | string {\n    if (typeof value !== 'object') {\n      return value;\n    }\n\n    if (visited.has(value)) {\n      return 'Visited-Ref';\n    } else {\n      visited.add(value);\n      return value;\n    }\n  };\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/**\n * @internal\n * Converts units of rem to units of pixels\n * @param rem - units of rem\n * @returns units of pixels\n */\nexport const _convertRemToPx = (rem: number): number => {\n  return rem * parseFloat(getComputedStyle(document.documentElement).fontSize);\n};\n/**\n * @internal\n * Disable dismiss on resize to work around a couple Fluent UI bugs\n * - The Callout is dismissed whenever *any child of window (inclusive)* is resized. In practice, this\n * happens when we change the VideoGallery layout, or even when the video stream element is internally resized\n * by the headless SDK.\n * - We also want to prevent dismiss when chat pane is scrolling especially a new message is added.\n * A side effect of this workaround is that the context menu stays open when window is resized, and may\n * get detached from original target visually. That bug is preferable to the bug when this value is not set -\n * The Callout (frequently) gets dismissed automatically.\n */\n\nexport const _preventDismissOnEvent = (ev: Event | React.FocusEvent | React.KeyboardEvent | React.MouseEvent): boolean => {\n  return ev.type === 'resize' || ev.type === 'scroll';\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/**\n * @internal\n * Converts px value to rem value.\n * For example, an input of `16` will return `1rem`.\n */\nexport const _pxToRem = (px: number): string => `${px / 16}rem`;","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { AzureLogger, AzureLogLevel } from '@azure/logger';\nimport { _safeJSONStringify } from './safeStringify';\n/**\n * @internal\n */\n\nexport type TelemetryEvent = {\n  name: string;\n  message: string;\n  level: AzureLogLevel;\n  data?: Record<string, unknown>;\n};\n/**\n * @internal\n * This is a log function to log structural data for easier parse in telemetry\n */\n\nexport const _logEvent = (logger: AzureLogger, event: TelemetryEvent): void => {\n  logger[event.level](_safeJSONStringify(event));\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { DominantSpeakersInfo } from '@azure/communication-calling';\nimport { toFlatCommunicationIdentifier } from '@internal/acs-ui-common';\nimport { CallClientState, DeviceManagerState, RemoteParticipantState, LocalVideoStreamState, CallErrors, DiagnosticsCallFeatureState } from '@internal/calling-stateful-client';\n/**\n * Common props used to reference calling declarative client state.\n *\n * @public\n */\n\nexport type CallingBaseSelectorProps = {\n  callId: string;\n};\n/**\n * @private\n */\n\nexport const getDeviceManager = (state: CallClientState): DeviceManagerState => state.deviceManager;\n/**\n * @private\n */\n\nexport const getCallExists = (state: CallClientState, props: CallingBaseSelectorProps): boolean => !!state.calls[props.callId];\n/**\n * @private\n */\n\nexport const getDominantSpeakers = (state: CallClientState, props: CallingBaseSelectorProps): undefined | DominantSpeakersInfo => state.calls[props.callId]?.dominantSpeakers;\n/**\n * @private\n */\n\nexport const getRemoteParticipants = (state: CallClientState, props: CallingBaseSelectorProps): {\n  [keys: string]: RemoteParticipantState;\n} | undefined => {\n  return state.calls[props.callId]?.remoteParticipants;\n};\n/**\n * @private\n */\n\nexport const getIsScreenSharingOn = (state: CallClientState, props: CallingBaseSelectorProps): boolean | undefined => state.calls[props.callId]?.isScreenSharingOn;\n/**\n * @private\n */\n\nexport const getIsMuted = (state: CallClientState, props: CallingBaseSelectorProps): boolean | undefined => state.calls[props.callId]?.isMuted;\n/**\n * @private\n */\n\nexport const getLocalVideoStreams = (state: CallClientState, props: CallingBaseSelectorProps): LocalVideoStreamState[] | undefined => state.calls[props.callId]?.localVideoStreams;\n/**\n * @private\n */\n\nexport const getScreenShareRemoteParticipant = (state: CallClientState, props: CallingBaseSelectorProps): string | undefined => state.calls[props.callId]?.screenShareRemoteParticipant;\n/**\n * @private\n */\n\nexport const getDisplayName = (state: CallClientState): string | undefined => state.callAgent?.displayName;\n/**\n * @private\n */\n\nexport const getIdentifier = (state: CallClientState): string => toFlatCommunicationIdentifier(state.userId);\n/**\n * @private\n */\n\nexport const getLatestErrors = (state: CallClientState): CallErrors => state.latestErrors;\n/**\n * @private\n */\n\nexport const getDiagnostics = (state: CallClientState, props: CallingBaseSelectorProps): DiagnosticsCallFeatureState | undefined => state.calls[props.callId]?.diagnostics;","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { DeviceManagerState, RemoteParticipantState, StatefulCallClient } from '@internal/calling-stateful-client';\nimport { CallState as CallStatus } from '@azure/communication-calling';\nimport { isPhoneNumberIdentifier } from '@azure/communication-common';\nimport { memoizeFnAll, toFlatCommunicationIdentifier } from '@internal/acs-ui-common';\n/**\n * Check if the call state represents being in the call\n *\n * @internal\n */\n\nexport const _isInCall = (callStatus?: CallStatus): boolean => !!callStatus && !['None', 'Disconnected', 'Connecting', 'Ringing', 'EarlyMedia'].includes(callStatus);\n/**\n * Check if the call state represents being in the lobby or waiting to be admitted.\n *\n * @internal\n */\n\nexport const _isInLobbyOrConnecting = (callStatus: CallStatus | undefined): boolean => !!callStatus && ['Connecting', 'Ringing', 'InLobby'].includes(callStatus);\n/**\n * Check if the device manager local video is on when not part of a call\n * i.e. do unparented views exist.\n *\n * @internal\n */\n\nexport const _isPreviewOn = (deviceManager: DeviceManagerState): boolean => {\n  // TODO: we should take in a LocalVideoStream that developer wants to use as their 'Preview' view. We should also\n  // handle cases where 'Preview' view is in progress and not necessary completed.\n  return deviceManager.unparentedViews.length > 0 && deviceManager.unparentedViews[0].view !== undefined;\n};\n/**\n * Dispose of all preview views\n * We assume all unparented views are local preview views.\n *\n * @private\n */\n\nexport const disposeAllLocalPreviewViews = async (callClient: StatefulCallClient): Promise<void> => {\n  const unparentedViews = callClient.getState().deviceManager.unparentedViews;\n\n  for (const view of unparentedViews) {\n    await callClient.disposeView(undefined, undefined, view);\n  }\n};\n/**\n * Update the users displayNames based on the type of user they are\n *\n * @internal\n */\n\nexport const _updateUserDisplayNames = (participants: RemoteParticipantState[]): RemoteParticipantState[] => {\n  if (participants) {\n    return memoizedUpdateDisplayName(memoizedFn => {\n      return Object.values(participants).map(p => {\n        const pid = toFlatCommunicationIdentifier(p.identifier);\n        return memoizedFn(pid, p);\n      });\n    });\n  } else {\n    return [];\n  }\n};\nconst memoizedUpdateDisplayName = memoizeFnAll((participantId: string, participant: RemoteParticipantState) => {\n  if (isPhoneNumberIdentifier(participant.identifier)) {\n    return { ...participant,\n      displayName: participant.identifier.phoneNumber\n    };\n  } else {\n    return participant;\n  }\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { AudioDeviceInfo, VideoDeviceInfo } from '@azure/communication-calling';\nimport { CallClientState } from '@internal/calling-stateful-client';\nimport * as reselect from 'reselect';\nimport { CallingBaseSelectorProps, getCallExists, getDeviceManager, getIsMuted, getIsScreenSharingOn, getLocalVideoStreams } from './baseSelectors';\nimport { _isPreviewOn } from './utils/callUtils';\n/**\n * Selector type for {@link MicrophoneButton} component.\n *\n * @public\n */\n\nexport type MicrophoneButtonSelector = (state: CallClientState, props: CallingBaseSelectorProps) => {\n  disabled: boolean;\n  checked: boolean;\n  microphones: AudioDeviceInfo[];\n  speakers: AudioDeviceInfo[];\n  selectedMicrophone?: AudioDeviceInfo;\n  selectedSpeaker?: AudioDeviceInfo;\n};\n/**\n * Selector for {@link MicrophoneButton} component.\n *\n * @public\n */\n\nexport const microphoneButtonSelector: MicrophoneButtonSelector = reselect.createSelector([getCallExists, getIsMuted, getDeviceManager], (callExists, isMuted, deviceManager) => {\n  const permission = deviceManager.deviceAccess ? deviceManager.deviceAccess.audio : true;\n  return {\n    disabled: !callExists || !permission,\n    checked: callExists ? !isMuted : false,\n    microphones: deviceManager.microphones,\n    speakers: deviceManager.speakers,\n    selectedMicrophone: deviceManager.selectedMicrophone,\n    selectedSpeaker: deviceManager.selectedSpeaker\n  };\n});\n/**\n * Selector type for {@link CameraButton} component.\n *\n * @public\n */\n\nexport type CameraButtonSelector = (state: CallClientState, props: CallingBaseSelectorProps) => {\n  disabled: boolean;\n  checked: boolean;\n  cameras: VideoDeviceInfo[];\n  selectedCamera?: VideoDeviceInfo;\n};\n/**\n * Selector for {@link CameraButton} component.\n *\n * @public\n */\n\nexport const cameraButtonSelector: CameraButtonSelector = reselect.createSelector([getLocalVideoStreams, getDeviceManager], (localVideoStreams, deviceManager) => {\n  const previewOn = _isPreviewOn(deviceManager);\n\n  const localVideoFromCall = localVideoStreams?.find(stream => stream.mediaStreamType === 'Video');\n  const permission = deviceManager.deviceAccess ? deviceManager.deviceAccess.video : true;\n  return {\n    disabled: !deviceManager.selectedCamera || !permission || !deviceManager.cameras.length,\n    checked: localVideoStreams !== undefined && localVideoStreams.length > 0 ? !!localVideoFromCall : previewOn,\n    cameras: deviceManager.cameras,\n    selectedCamera: deviceManager.selectedCamera\n  };\n});\n/**\n * Selector type for {@link ScreenShareButton} component.\n *\n * @public\n */\n\nexport type ScreenShareButtonSelector = (state: CallClientState, props: CallingBaseSelectorProps) => {\n  checked?: boolean;\n};\n/**\n * Selector for {@link ScreenShareButton} component.\n *\n * @public\n */\n\nexport const screenShareButtonSelector: ScreenShareButtonSelector = reselect.createSelector([getIsScreenSharingOn], (isScreenSharingOn,\n/* @conditional-compile-remove(PSTN-calls) */\ncallState) => {\n  return {\n    checked: isScreenSharingOn\n  };\n});\n/**\n * Selector type for {@link DevicesButton} component.\n *\n * @public\n */\n\nexport type DevicesButtonSelector = (state: CallClientState, props: CallingBaseSelectorProps) => {\n  microphones: AudioDeviceInfo[];\n  speakers: AudioDeviceInfo[];\n  cameras: VideoDeviceInfo[];\n  selectedMicrophone?: AudioDeviceInfo;\n  selectedSpeaker?: AudioDeviceInfo;\n  selectedCamera?: VideoDeviceInfo;\n};\n/**\n * Selector for {@link DevicesButton} component.\n *\n * @public\n */\n\nexport const devicesButtonSelector: DevicesButtonSelector = reselect.createSelector([getDeviceManager], deviceManager => {\n  return {\n    microphones: deviceManager.microphones,\n    speakers: deviceManager.speakers,\n    cameras: deviceManager.cameras,\n    selectedMicrophone: deviceManager.selectedMicrophone,\n    selectedSpeaker: deviceManager.selectedSpeaker,\n    selectedCamera: deviceManager.selectedCamera\n  };\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { AudioDeviceInfo, Call, CallAgent, LocalVideoStream, StartCallOptions, VideoDeviceInfo } from '@azure/communication-calling';\nimport { CommunicationUserIdentifier, PhoneNumberIdentifier, UnknownIdentifier } from '@azure/communication-common';\nimport { Common, toFlatCommunicationIdentifier, _toCommunicationIdentifier } from '@internal/acs-ui-common';\nimport { CreateViewResult, StatefulCallClient, StatefulDeviceManager } from '@internal/calling-stateful-client';\nimport memoizeOne from 'memoize-one';\nimport { ReactElement } from 'react';\nimport { CreateVideoStreamViewResult, VideoStreamOptions } from '@internal/react-components';\nimport { disposeAllLocalPreviewViews, _isInCall, _isInLobbyOrConnecting, _isPreviewOn } from '../utils/callUtils';\n/**\n * Object containing all the handlers required for calling components.\n *\n * Calling related components from this package are able to pick out relevant handlers from this object.\n * See {@link useHandlers} and {@link usePropsFor}.\n *\n * @public\n */\n\nexport type CallingHandlers = {\n  onStartLocalVideo: () => Promise<void>;\n  onToggleCamera: (options?: VideoStreamOptions) => Promise<void>;\n  onStartCall: (participants: (CommunicationUserIdentifier | PhoneNumberIdentifier | UnknownIdentifier)[], options?: StartCallOptions) => Call | undefined;\n  onSelectMicrophone: (device: AudioDeviceInfo) => Promise<void>;\n  onSelectSpeaker: (device: AudioDeviceInfo) => Promise<void>;\n  onSelectCamera: (device: VideoDeviceInfo, options?: VideoStreamOptions) => Promise<void>;\n  onToggleMicrophone: () => Promise<void>;\n  onStartScreenShare: () => Promise<void>;\n  onStopScreenShare: () => Promise<void>;\n  onToggleScreenShare: () => Promise<void>;\n  onHangUp: (forEveryone?: boolean) => Promise<void>;\n  onCreateLocalStreamView: (options?: VideoStreamOptions) => Promise<void | CreateVideoStreamViewResult>;\n  onCreateRemoteStreamView: (userId: string, options?: VideoStreamOptions) => Promise<void | CreateVideoStreamViewResult>;\n  onRemoveParticipant(userId: string): Promise<void>;\n  onDisposeRemoteStreamView: (userId: string) => Promise<void>;\n  onDisposeLocalStreamView: () => Promise<void>;\n};\n/**\n * @private\n */\n\nexport const areStreamsEqual = (prevStream: LocalVideoStream, newStream: LocalVideoStream): boolean => {\n  return !!prevStream && !!newStream && prevStream.source.id === newStream.source.id;\n};\n/**\n * Create the default implementation of {@link CallingHandlers}.\n *\n * Useful when implementing a custom component that utilizes the providers\n * exported from this library.\n *\n * @public\n */\n\nexport const createDefaultCallingHandlers = memoizeOne((callClient: StatefulCallClient, callAgent: CallAgent | undefined, deviceManager: StatefulDeviceManager | undefined, call: Call | undefined): CallingHandlers => {\n  const onStartLocalVideo = async (): Promise<void> => {\n    // Before the call object creates a stream, dispose of any local preview streams.\n    // @TODO: is there any way to parent the unparented view to the call object instead\n    // of disposing and creating a new stream?\n    await disposeAllLocalPreviewViews(callClient);\n    const callId = call?.id;\n    let videoDeviceInfo = callClient.getState().deviceManager.selectedCamera;\n\n    if (!videoDeviceInfo) {\n      const cameras = await deviceManager?.getCameras();\n      videoDeviceInfo = cameras && cameras.length > 0 ? cameras[0] : undefined;\n      videoDeviceInfo && deviceManager?.selectCamera(videoDeviceInfo);\n    }\n\n    if (!callId || !videoDeviceInfo) {\n      return;\n    }\n\n    const stream = new LocalVideoStream(videoDeviceInfo);\n\n    if (call && !call.localVideoStreams.find(s => areStreamsEqual(s, stream))) {\n      await call.startVideo(stream);\n    }\n  };\n\n  const onStopLocalVideo = async (stream: LocalVideoStream): Promise<void> => {\n    const callId = call?.id;\n\n    if (!callId) {\n      return;\n    }\n\n    if (call && call.localVideoStreams.find(s => areStreamsEqual(s, stream))) {\n      await call.stopVideo(stream);\n      await callClient.disposeView(callId, undefined, {\n        source: stream.source,\n        mediaStreamType: stream.mediaStreamType\n      });\n    }\n  };\n\n  const onToggleCamera = async (options?: VideoStreamOptions): Promise<void> => {\n    const previewOn = _isPreviewOn(callClient.getState().deviceManager);\n\n    if (previewOn && call && call.state === 'Connecting') {\n      // This is to workaround: https://skype.visualstudio.com/SPOOL/_workitems/edit/3030558.\n      // The root cause of the issue is caused by never transitioning the unparented view to the\n      // call object when going from configuration page (disconnected call state) to connecting.\n      //\n      // Currently the only time the local video stream is moved from unparented view to the call\n      // object is when we transition from connecting -> call state. If the camera was on,\n      // inside the MediaGallery we trigger toggleCamera. This triggers onStartLocalVideo which\n      // destroys the unparentedView and creates a new stream in the call - so all looks well.\n      //\n      // However, if someone turns off their camera during the lobbyOrConnecting screen, the\n      // call.localVideoStreams will be empty (as the stream is currently stored in the unparented\n      // views and was never transitioned to the call object) and thus we incorrectly try to create\n      // a new video stream for the call object, instead of only stopping the unparented view.\n      //\n      // The correct fix for this is to ensure that callAgent.onStartCall is called with the\n      // localvideostream as a videoOption. That will mean call.onLocalVideoStreamsUpdated will\n      // be triggered when the call is in connecting state, which we can then transition the\n      // local video stream to the stateful call client and get into a clean state.\n      await onDisposeLocalStreamView();\n      return;\n    }\n\n    if (call && (_isInCall(call.state) || _isInLobbyOrConnecting(call.state))) {\n      const stream = call.localVideoStreams.find(stream => stream.mediaStreamType === 'Video');\n\n      if (stream) {\n        await onStopLocalVideo(stream);\n      } else {\n        await onStartLocalVideo();\n      }\n    } else {\n      const selectedCamera = callClient.getState().deviceManager.selectedCamera;\n\n      if (selectedCamera) {\n        if (previewOn) {\n          await onDisposeLocalStreamView();\n        } else {\n          await callClient.createView(undefined, undefined, {\n            source: selectedCamera,\n            mediaStreamType: 'Video'\n          }, options);\n        }\n      }\n    }\n  };\n\n  const onStartCall = (participants: (CommunicationUserIdentifier | PhoneNumberIdentifier | UnknownIdentifier)[], options?: StartCallOptions): Call | undefined => {\n    return callAgent ? callAgent.startCall(participants, options) : undefined;\n  };\n\n  const onSelectMicrophone = async (device: AudioDeviceInfo): Promise<void> => {\n    if (!deviceManager) {\n      return;\n    }\n\n    return deviceManager.selectMicrophone(device);\n  };\n\n  const onSelectSpeaker = async (device: AudioDeviceInfo): Promise<void> => {\n    if (!deviceManager) {\n      return;\n    }\n\n    return deviceManager.selectSpeaker(device);\n  };\n\n  const onSelectCamera = async (device: VideoDeviceInfo, options?: VideoStreamOptions): Promise<void> => {\n    if (!deviceManager) {\n      return;\n    }\n\n    if (call && _isInCall(call.state)) {\n      deviceManager.selectCamera(device);\n      const stream = call.localVideoStreams.find(stream => stream.mediaStreamType === 'Video');\n      return stream?.switchSource(device);\n    } else {\n      const previewOn = _isPreviewOn(callClient.getState().deviceManager);\n\n      if (!previewOn) {\n        deviceManager.selectCamera(device);\n        return;\n      }\n\n      await onDisposeLocalStreamView();\n      deviceManager.selectCamera(device);\n      await callClient.createView(undefined, undefined, {\n        source: device,\n        mediaStreamType: 'Video'\n      }, options);\n    }\n  };\n\n  const onToggleMicrophone = async (): Promise<void> => {\n    if (!call || !_isInCall(call.state)) {\n      throw new Error(`Please invoke onToggleMicrophone after call is started`);\n    }\n\n    return call.isMuted ? await call.unmute() : await call.mute();\n  };\n\n  const onStartScreenShare = async (): Promise<void> => await call?.startScreenSharing();\n\n  const onStopScreenShare = async (): Promise<void> => await call?.stopScreenSharing();\n\n  const onToggleScreenShare = async (): Promise<void> => call?.isScreenSharingOn ? await onStopScreenShare() : await onStartScreenShare();\n\n  const onHangUp = async (forEveryone?: boolean): Promise<void> => await call?.hangUp({\n    forEveryone: forEveryone === true ? true : false\n  });\n\n  const onCreateLocalStreamView = async (options = ({\n    scalingMode: 'Crop',\n    isMirrored: true\n  } as VideoStreamOptions)): Promise<void | CreateVideoStreamViewResult> => {\n    if (!call || call.localVideoStreams.length === 0) {\n      return;\n    }\n\n    const callState = callClient.getState().calls[call.id];\n\n    if (!callState) {\n      return;\n    }\n\n    const localStream = callState.localVideoStreams.find(item => item.mediaStreamType === 'Video');\n\n    if (!localStream) {\n      return;\n    }\n\n    const {\n      view\n    } = (await callClient.createView(call.id, undefined, localStream, options)) ?? {};\n    return view ? {\n      view\n    } : undefined;\n  };\n\n  const onCreateRemoteStreamView = async (userId: string, options = ({\n    scalingMode: 'Crop'\n  } as VideoStreamOptions)): Promise<void | CreateVideoStreamViewResult> => {\n    if (!call) {\n      return;\n    }\n\n    const callState = callClient.getState().calls[call.id];\n\n    if (!callState) {\n      throw new Error(`Call Not Found: ${call.id}`);\n    }\n\n    const participant = Object.values(callState.remoteParticipants).find(participant => toFlatCommunicationIdentifier(participant.identifier) === userId);\n\n    if (!participant || !participant.videoStreams) {\n      return;\n    }\n\n    const remoteVideoStream = Object.values(participant.videoStreams).find(i => i.mediaStreamType === 'Video');\n    const screenShareStream = Object.values(participant.videoStreams).find(i => i.mediaStreamType === 'ScreenSharing');\n    let createViewResult: CreateViewResult | undefined = undefined;\n\n    if (remoteVideoStream && remoteVideoStream.isAvailable && !remoteVideoStream.view) {\n      createViewResult = await callClient.createView(call.id, participant.identifier, remoteVideoStream, options);\n    }\n\n    if (screenShareStream && screenShareStream.isAvailable && !screenShareStream.view) {\n      // Hardcoded `scalingMode` since it is highly unlikely that CONTOSO would ever want to use a different scaling mode for screenshare.\n      // Using `Crop` would crop the contents of screenshare and `Stretch` would warp it.\n      // `Fit` is the only mode that maintains the integrity of the screen being shared.\n      createViewResult = await callClient.createView(call.id, participant.identifier, screenShareStream, {\n        scalingMode: 'Fit'\n      });\n    }\n\n    return createViewResult?.view ? {\n      view: createViewResult?.view\n    } : undefined;\n  };\n\n  const onDisposeRemoteStreamView = async (userId: string): Promise<void> => {\n    if (!call) {\n      return;\n    }\n\n    const callState = callClient.getState().calls[call.id];\n\n    if (!callState) {\n      throw new Error(`Call Not Found: ${call.id}`);\n    }\n\n    const participant = Object.values(callState.remoteParticipants).find(participant => toFlatCommunicationIdentifier(participant.identifier) === userId);\n\n    if (!participant || !participant.videoStreams) {\n      return;\n    }\n\n    const remoteVideoStream = Object.values(participant.videoStreams).find(i => i.mediaStreamType === 'Video');\n    const screenShareStream = Object.values(participant.videoStreams).find(i => i.mediaStreamType === 'ScreenSharing');\n\n    if (remoteVideoStream && remoteVideoStream.view) {\n      callClient.disposeView(call.id, participant.identifier, remoteVideoStream);\n    }\n\n    if (screenShareStream && screenShareStream.view) {\n      callClient.disposeView(call.id, participant.identifier, screenShareStream);\n    }\n  };\n\n  const onDisposeLocalStreamView = async (): Promise<void> => {\n    // If the user is currently in a call, dispose of the local stream view attached to that call.\n    const callState = call && callClient.getState().calls[call.id];\n    const localStream = callState?.localVideoStreams.find(item => item.mediaStreamType === 'Video');\n\n    if (call && callState && localStream) {\n      callClient.disposeView(call.id, undefined, localStream);\n    } // If the user is not in a call we currently assume any unparented view is a LocalPreview and stop all\n    // since those are only used for LocalPreview currently.\n    // TODO: we need to remember which LocalVideoStream was used for LocalPreview and dispose that one.\n\n\n    await disposeAllLocalPreviewViews(callClient);\n  };\n\n  const onRemoveParticipant = async (userId: string): Promise<void> => {\n    const participant = _toCommunicationIdentifier(userId);\n\n    await call?.removeParticipant(participant);\n  };\n\n  return {\n    onHangUp,\n    onSelectCamera,\n    onSelectMicrophone,\n    onSelectSpeaker,\n    onStartCall,\n    onStartScreenShare,\n    onStopScreenShare,\n    onToggleCamera,\n    onToggleMicrophone,\n    onToggleScreenShare,\n    onCreateLocalStreamView,\n    onCreateRemoteStreamView,\n    onRemoveParticipant,\n    onStartLocalVideo,\n    onDisposeRemoteStreamView,\n    onDisposeLocalStreamView\n  };\n});\n/**\n * Create a set of default handlers for given component. Memoization is applied to the result. Multiple invocations with\n * the same arguments will return the same handler instances. DeclarativeCallAgent, DeclarativeDeviceManager, and\n * DeclarativeCall may be undefined. If undefined, their associated handlers will not be created and returned.\n *\n * @param callClient - StatefulCallClient returned from\n *   {@link @azure/communication-react#createStatefulCallClient}.\n * @param callAgent - Instance of {@link @azure/communication-calling#CallClient}.\n * @param deviceManager - Instance of {@link @azure/communication-calling#DeviceManager}.\n * @param call - Instance of {@link @azure/communication-calling#Call}.\n * @param _ - React component that you want to generate handlers for.\n *\n * @public\n */\n\nexport const createDefaultCallingHandlersForComponent = <Props,>(callClient: StatefulCallClient, callAgent: CallAgent | undefined, deviceManager: StatefulDeviceManager | undefined, call: Call | undefined, _Component: (props: Props) => ReactElement | null): Common<CallingHandlers, Props> => {\n  return createDefaultCallingHandlers(callClient, callAgent, deviceManager, call);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CallAgent } from '@azure/communication-calling';\nimport React, { createContext, useContext } from 'react';\n/**\n * @private\n */\n\nexport type CallAgentContextType = {\n  callAgent: CallAgent | undefined;\n};\n/**\n * @private\n */\n\nexport const CallAgentContext = createContext<CallAgentContextType | undefined>(undefined);\n/**\n * Arguments to initialize a {@link CallAgentProvider}.\n *\n * @public\n */\n\nexport interface CallAgentProviderProps {\n  children: React.ReactNode;\n  callAgent?: CallAgent;\n}\n\nconst CallAgentProviderBase = (props: CallAgentProviderProps): JSX.Element => {\n  const {\n    callAgent\n  } = props;\n  const initialState: CallAgentContextType = {\n    callAgent\n  };\n  return <CallAgentContext.Provider value={initialState}>{props.children}</CallAgentContext.Provider>;\n};\n/**\n * A {@link React.Context} that stores a {@link @azure/communication-calling#CallAgent}.\n *\n * Calling components from this package must be wrapped with a {@link CallAgentProvider}.\n *\n * @public\n */\n\n\nexport const CallAgentProvider = (props: CallAgentProviderProps): JSX.Element => <CallAgentProviderBase {...props} />;\n/**\n * Hook to obtain {@link @azure/communication-calling#CallAgent} from the provider.\n *\n * Useful when implementing a custom component that utilizes the providers\n * exported from this library.\n *\n * @public\n */\n\nexport const useCallAgent = (): CallAgent | undefined => useContext(CallAgentContext)?.callAgent;","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { StatefulCallClient, StatefulDeviceManager } from '@internal/calling-stateful-client';\nimport React, { createContext, useContext, useEffect, useState } from 'react';\n/**\n * @private\n */\n\nexport type CallClientContextType = {\n  callClient: StatefulCallClient;\n  deviceManager: StatefulDeviceManager | undefined;\n};\n/**\n * @private\n */\n\nexport const CallClientContext = createContext<CallClientContextType | undefined>(undefined);\n/**\n * Arguments to initialize a {@link CallClientProvider}.\n *\n * @public\n */\n\nexport interface CallClientProviderProps {\n  children: React.ReactNode;\n  callClient: StatefulCallClient;\n}\n/**\n * @private\n */\n\nconst CallClientProviderBase = (props: CallClientProviderProps): JSX.Element => {\n  const {\n    callClient\n  } = props;\n  const [deviceManager, setDeviceManager] = useState<StatefulDeviceManager | undefined>(undefined);\n  /**\n   * Initialize the DeviceManager inside CallClientState\n   */\n\n  useEffect(() => {\n    callClient.getDeviceManager().then(manager => {\n      manager.getCameras();\n      manager.getMicrophones();\n      manager.getSpeakers();\n      setDeviceManager((manager as StatefulDeviceManager));\n    }).catch(error => {\n      throw new Error(error);\n    });\n  }, [callClient]);\n  const initialState: CallClientContextType = {\n    callClient,\n    deviceManager\n  };\n  return <CallClientContext.Provider value={initialState}>{props.children}</CallClientContext.Provider>;\n};\n/**\n * A {@link React.Context} that stores a {@link StatefulCallClient}.\n *\n * Calling components from this package must be wrapped with a {@link CallClientProvider}.\n *\n * @public\n */\n\n\nexport const CallClientProvider = (props: CallClientProviderProps): JSX.Element => <CallClientProviderBase {...props} />;\n/**\n * Hook to obtain {@link StatefulCallClient} from the provider.\n *\n * Useful when implementing a custom component that utilizes the providers\n * exported from this library.\n *\n * @public\n */\n\nexport const useCallClient = (): StatefulCallClient => {\n  const context = useContext(CallClientContext);\n\n  if (context === undefined) {\n    throw new Error('CallClient Context is undefined');\n  }\n\n  return context.callClient;\n};\n/**\n * Hook to obtain {@link StatefulDeviceManager} from the provider.\n *\n * Useful when implementing a custom component that utilizes the providers\n * exported from this library.\n *\n * @public\n */\n\nexport const useDeviceManager = (): StatefulDeviceManager | undefined => {\n  return useContext(CallClientContext)?.deviceManager;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { useContext, createContext } from 'react';\nimport { Call } from '@azure/communication-calling';\n/**\n * @private\n */\n\nexport type CallContextType = {\n  call: Call | undefined;\n};\n/**\n * Arguments to initialize a {@link CallProvider}.\n *\n * @public\n */\n\nexport interface CallProviderProps {\n  children: React.ReactNode;\n  call?: Call;\n}\n/**\n * @private\n */\n\nexport const CallContext = createContext<CallContextType | undefined>(undefined);\n/**\n * @private\n */\n\nconst CallProviderBase = (props: CallProviderProps): JSX.Element => {\n  const {\n    children,\n    call\n  } = props;\n  const initialState: CallContextType = {\n    call\n  };\n  return <CallContext.Provider value={initialState}>{children}</CallContext.Provider>;\n};\n/**\n * A {@link React.Context} that stores a {@link @azure/communication-calling#Call}.\n *\n * Calling components from this package must be wrapped with a {@link CallProvider}.\n *\n * @public\n */\n\n\nexport const CallProvider = (props: CallProviderProps): JSX.Element => <CallProviderBase {...props} />;\n/**\n * Hook to obtain {@link @azure/communication-calling#Call} from the provider.\n *\n * Useful when implementing a custom component that utilizes the providers\n * exported from this library.\n *\n * @public\n */\n\nexport const useCall = (): Call | undefined => {\n  return useContext(CallContext)?.call;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const typingIndicatorContainerStyle = mergeStyles({\n  minHeight: '2.125rem',\n  // flexFlow set to column-reverse to align the text to the bottom of the container\n  flexFlow: 'column-reverse'\n});\n/**\n * @private\n */\n\nexport const typingIndicatorStringStyle = mergeStyles({\n  fontWeight: 400,\n  width: '100%',\n  alignSelf: 'center',\n  wordBreak: 'break-word'\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { PartialDeep } from 'type-fest';\nimport { ComponentLocale, ComponentStrings } from '..';\nimport en_US from './en-US/strings.json';\nimport en_GB from './en-GB/strings.json';\nimport de_DE from './de-DE/strings.json';\nimport es_ES from './es-ES/strings.json';\nimport fr_FR from './fr-FR/strings.json';\nimport it_IT from './it-IT/strings.json';\nimport ja_JP from './ja-JP/strings.json';\nimport ko_KR from './ko-KR/strings.json';\nimport nl_NL from './nl-NL/strings.json';\nimport pt_BR from './pt-BR/strings.json';\nimport ru_RU from './ru-RU/strings.json';\nimport tr_TR from './tr-TR/strings.json';\nimport zh_CN from './zh-CN/strings.json';\nimport zh_TW from './zh-TW/strings.json';\n\nconst createComponentStrings = (localizedStrings: PartialDeep<ComponentStrings>): ComponentStrings => {\n  const strings: ComponentStrings = { ...en_US\n  };\n  Object.keys(localizedStrings).forEach((key: string) => {\n    strings[key] = { ...strings[key],\n      ...localizedStrings[key]\n    };\n  });\n  return strings;\n};\n/**\r\n * Locale for English (US).\r\n *\r\n * @public\r\n */\n\n\nexport const COMPONENT_LOCALE_EN_US: ComponentLocale = {\n  strings: en_US\n};\n/**\r\n * Locale for English (GB).\r\n *\r\n * @public\r\n */\n\nexport const COMPONENT_LOCALE_EN_GB: ComponentLocale = {\n  strings: createComponentStrings(en_GB)\n};\n/**\r\n * Locale for  German (Germany).\r\n *\r\n * @public\r\n */\n\nexport const COMPONENT_LOCALE_DE_DE: ComponentLocale = {\n  strings: createComponentStrings(de_DE)\n};\n/**\r\n * Locale for Spanish (Spain).\r\n *\r\n * @public\r\n */\n\nexport const COMPONENT_LOCALE_ES_ES: ComponentLocale = {\n  strings: createComponentStrings(es_ES)\n};\n/**\r\n * Locale for French (France).\r\n *\r\n * @public\r\n */\n\nexport const COMPONENT_LOCALE_FR_FR: ComponentLocale = {\n  strings: createComponentStrings(fr_FR)\n};\n/**\r\n * Locale for Italian (Italy).\r\n *\r\n * @public\r\n */\n\nexport const COMPONENT_LOCALE_IT_IT: ComponentLocale = {\n  strings: createComponentStrings(it_IT)\n};\n/**\r\n * Locale for Japanese (Japan).\r\n *\r\n * @public\r\n */\n\nexport const COMPONENT_LOCALE_JA_JP: ComponentLocale = {\n  strings: createComponentStrings(ja_JP)\n};\n/**\r\n * Locale for Korean (South Korea).\r\n *\r\n * @public\r\n */\n\nexport const COMPONENT_LOCALE_KO_KR: ComponentLocale = {\n  strings: createComponentStrings(ko_KR)\n};\n/**\r\n * Locale for Dutch (Netherlands).\r\n *\r\n * @public\r\n */\n\nexport const COMPONENT_LOCALE_NL_NL: ComponentLocale = {\n  strings: createComponentStrings(nl_NL)\n};\n/**\r\n * Locale for Portuguese (Brazil).\r\n *\r\n * @public\r\n */\n\nexport const COMPONENT_LOCALE_PT_BR: ComponentLocale = {\n  strings: createComponentStrings(pt_BR)\n};\n/**\r\n * Locale for Russian (Russia).\r\n *\r\n * @public\r\n */\n\nexport const COMPONENT_LOCALE_RU_RU: ComponentLocale = {\n  strings: createComponentStrings(ru_RU)\n};\n/**\r\n * Locale for Turkish (Turkey).\r\n *\r\n * @public\r\n */\n\nexport const COMPONENT_LOCALE_TR_TR: ComponentLocale = {\n  strings: createComponentStrings(tr_TR)\n};\n/**\r\n * Locale for Chinese (Mainland China).\r\n *\r\n * @public\r\n */\n\nexport const COMPONENT_LOCALE_ZH_CN: ComponentLocale = {\n  strings: createComponentStrings(zh_CN)\n};\n/**\r\n * Locale for Chinese (Taiwan).\r\n *\r\n * @public\r\n */\n\nexport const COMPONENT_LOCALE_ZH_TW: ComponentLocale = {\n  strings: createComponentStrings(zh_TW)\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { createContext, useContext } from 'react';\nimport { CameraButtonStrings, EndCallButtonStrings, ErrorBarStrings, MessageStatusIndicatorStrings, MessageThreadStrings, MicrophoneButtonStrings, DevicesButtonStrings, ParticipantsButtonStrings, ParticipantItemStrings, ScreenShareButtonStrings, SendBoxStrings, TypingIndicatorStrings, VideoGalleryStrings } from '../components';\nimport { COMPONENT_LOCALE_EN_US } from './locales';\n/**\n * Locale information for all components exported from this library.\n *\n * @public\n */\n\nexport interface ComponentLocale {\n  /** Strings for components */\n  strings: ComponentStrings;\n}\n/**\n * Strings used by all components exported from this library.\n *\n * @public\n */\n\nexport interface ComponentStrings {\n  /** Strings for MessageThread */\n  messageThread: MessageThreadStrings;\n  /** Strings for ParticipantItem */\n\n  participantItem: ParticipantItemStrings;\n  /** Strings for CameraButton */\n\n  cameraButton: CameraButtonStrings;\n  /** Strings for MicrophoneButton */\n\n  microphoneButton: MicrophoneButtonStrings;\n  /** Strings for EndCallButton */\n\n  endCallButton: EndCallButtonStrings;\n  /** Strings for DevicesButton */\n\n  devicesButton: DevicesButtonStrings;\n  /** Strings for ParticipantsButton */\n\n  participantsButton: ParticipantsButtonStrings;\n  /** Strings for ScreenShareButton */\n\n  screenShareButton: ScreenShareButtonStrings;\n  /** Strings for TypingIndicator */\n\n  typingIndicator: TypingIndicatorStrings;\n  /** Strings for SendBox */\n\n  sendBox: SendBoxStrings;\n  /** Strings for MessageStatusIndicator */\n\n  messageStatusIndicator: MessageStatusIndicatorStrings;\n  /** Strings for ErroBar */\n\n  errorBar: ErrorBarStrings;\n  /** Strings for VideoGallery */\n\n  videoGallery: VideoGalleryStrings;\n}\n/**\n * Context for providing localized strings to components exported from this library.\n *\n * @public\n */\n\nexport const LocaleContext = createContext<ComponentLocale>(COMPONENT_LOCALE_EN_US);\n/**\n * Props for {@link LocalizationProvider}.\n *\n * @public\n */\n\nexport type LocalizationProviderProps = {\n  /** Locale context to provide components */\n  locale: ComponentLocale;\n  /** Children to provide locale context. */\n\n  children: React.ReactNode;\n};\n/**\n * Provider to provide localized strings for this library's react components.\n *\n * @remarks Components will be provided localized strings in English (US) by default if this\n * provider is not used.\n *\n * @public\n */\n\nexport const LocalizationProvider = (props: LocalizationProviderProps): JSX.Element => {\n  const {\n    locale,\n    children\n  } = props;\n  return <LocaleContext.Provider value={locale}>{children}</LocaleContext.Provider>;\n};\n/** React hook to access locale */\n\nexport const useLocale = (): ComponentLocale => useContext(LocaleContext);","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { createContext, useContext } from 'react';\n/**\n * Identifiers that can be used to target specific components in a composite.\n *\n * @experimental\n *\n * These identifiers are assigned as `data-ui-id` HTML attribute of the root element of the targeted component.\n *\n * This API is intended for end to end test automation. As such, they are not covered by the API\n * guarantee of the public API. This will remain perenially experimental and compatibility breaking changes\n * may be made at any point.\n *\n * @internal\n */\n\nexport interface _Identifiers {\n  /** `data-ui-id` value for `SendBox` Component */\n  sendboxTextField: string;\n  /** `data-ui-id` value for `ParticipantButton` Component's People menu item */\n\n  participantButtonPeopleMenuItem: string;\n  /** `data-ui-id` value for `ParticipantItem` Component's Menu button */\n\n  participantItemMenuButton: string;\n  /** `data-ui-id` value for `ParticipantList` Component */\n\n  participantList: string;\n  /** `data-ui-id` value for `ParticipantList` Component's People Button */\n\n  participantListPeopleButton: string;\n  /** `data-ui-id` value for `ParticipantList` Component's Remove Participant Button */\n\n  participantListRemoveParticipantButton: string;\n  /** `data-ui-id` value for `MessageThread` components message content */\n\n  messageContent: string;\n  /** `data-ui-id` value for `MessageThread` components message timestamp */\n\n  messageTimestamp: string;\n  /** `data-ui-id` value for `TypingIndicator` Component */\n\n  typingIndicator: string;\n  /** `data-ui-id` value for `VideoGallery` Component */\n\n  videoGallery: string;\n  /** `data-ui-id` value for `VideoTile` Component */\n\n  videoTile: string;\n  /** `data-ui-id` value for `HorizontalGallery` Component's left navigation button */\n\n  horizontalGalleryLeftNavButton: string;\n  /** `data-ui-id` value for `HorizontalGallery` Component's right navigation button */\n\n  horizontalGalleryRightNavButton: string;\n}\nconst defaultIdentifiers: _Identifiers = {\n  sendboxTextField: 'sendbox-textfield',\n  participantButtonPeopleMenuItem: 'participant-button-people-menu-item',\n  participantItemMenuButton: 'participant-item-menu-button',\n  participantList: 'participant-list',\n  participantListPeopleButton: 'participant-list-people-button',\n  participantListRemoveParticipantButton: 'participant-list-remove-participant-button',\n  messageContent: 'message-content',\n  messageTimestamp: 'message-timestamp',\n  typingIndicator: 'typing-indicator',\n  videoGallery: 'video-gallery',\n  videoTile: 'video-tile',\n  horizontalGalleryLeftNavButton: 'horizontal-gallery-left-nav-button',\n  horizontalGalleryRightNavButton: 'horizontal-gallery-right-nav-button'\n};\n/**\n * @private\n */\n\nexport const IdentifierContext = createContext<_Identifiers>(defaultIdentifiers);\n/**\n * Arguments to Context Provider for {@link _Identifiers}.\n *\n * @experimental\n *\n * See documentation for {@link _Identifiers}.\n *\n * @internal\n */\n\nexport interface _IdentifierProviderProps {\n  identifiers?: _Identifiers;\n  children: React.ReactNode;\n}\n/**\n * React Context provider for {@link _Identifiers}.\n *\n * @experimental\n *\n * See documentation for {@link _Identifiers}.\n *\n * @internal\n */\n\nexport const _IdentifierProvider = (props: _IdentifierProviderProps): JSX.Element => {\n  const {\n    identifiers,\n    children\n  } = props;\n  return <IdentifierContext.Provider value={identifiers ?? defaultIdentifiers}>{children}</IdentifierContext.Provider>;\n};\n/**\n * @private\n */\n\nexport const useIdentifiers = (): _Identifiers => useContext(IdentifierContext);","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { typingIndicatorContainerStyle, typingIndicatorStringStyle } from './styles/TypingIndicator.styles';\nimport React from 'react';\nimport { BaseCustomStyles, CommunicationParticipant } from '../types';\nimport { IStyle, mergeStyles, Stack, Text } from '@fluentui/react';\nimport { useLocale } from '../localization/LocalizationProvider';\nimport { useIdentifiers } from '../identifiers';\nimport { _IObjectMap } from '@internal/acs-ui-common';\n/**\n * Fluent styles for {@link TypingIndicator}.\n *\n * @public\n */\n\nexport interface TypingIndicatorStylesProps extends BaseCustomStyles {\n  /** Styles for each typing user's displayName. */\n  typingUserDisplayName?: IStyle;\n  /** Styles for the typing string. */\n\n  typingString?: IStyle;\n}\n/**\n * Strings of {@link TypingIndicator} that can be overridden.\n *\n * @public\n */\n\nexport interface TypingIndicatorStrings {\n  /**\n   * String template to use when one user is typing. Placeholders: [user].\n   * @example\n   * ```\n   * <TypingIndicator\n   *  strings={{ multipleUsersAbbreviateOne: '{users} is typing...' }}\n   *  typingUsers={[{ userId: 'user1', displayName: 'Claire' }]}\n   * />\n   * ```\n   * would be 'Claire is typing...'\n   **/\n  singleUser: string;\n  /**\n   * String template to use when multiple users are typing. Placeholders: [users].\n   * @example\n   * ```\n   * <TypingIndicator\n   *  strings={{ multipleUsers: '{users} are typing...' }}\n   *  typingUsers={[\n   *    { userId: 'user1', displayName: 'Claire' },\n   *    { userId: 'user2', displayName: 'Christopher' }\n   *  ]}\n   * />\n   * ```\n   * would be 'Claire, Chris are typing...'\n   **/\n\n  multipleUsers: string;\n  /**\n   * String template to use when multiple users are typing with one other user abbreviated. Placeholders: [users].\n   * @example\n   * ```typescript\n   * <TypingIndicator\n   * strings={{ multipleUsersAbbreviateOne: '{users} and 1 other are typing...' }}\n   * typingUsers={[\n   * { userId: 'user1', displayName: 'Claire Romanov' },\n   * { userId: 'user2', displayName: 'Christopher Rutherford' }\n   * ]}\n   * />\n   * ```\n   * would be 'Claire Romanov and 1 other are typing...'\n   **/\n\n  multipleUsersAbbreviateOne: string;\n  /**\n   * String template to use when multiple users are typing with one other user abbreviated. Placeholders: [users, numOthers].\n   * @example\n   * ```\n   * <TypingIndicator\n   *  strings={{ multipleUsersAbbreviateMany: '{users} and {numOthers} others are typing...' }}\n   *  typingUsers={[\n   *    { userId: 'user1', displayName: 'Claire Romanov' },\n   *    { userId: 'user2', displayName: 'Christopher Rutherford' },\n   *    { userId: 'user3', displayName: 'Jill Vernblom' }\n   *  ]}\n   * />\n   * ```\n   * would be 'Claire Romanov and 2 others are typing...'\n   **/\n\n  multipleUsersAbbreviateMany: string;\n  /**\n   * String to use as delimiter to separate multiple users.\n   * @example\n   * ```\n   * <TypingIndicator\n   *  strings={{ delimiter: ' + ' }}\n   *  typingUsers={[\n   *    { userId: 'user1', displayName: 'Claire' },\n   *    { userId: 'user2', displayName: 'Chris' },\n   *    { userId: 'user3', displayName: 'Jill' }\n   *  ]}\n   * />\n   * ```\n   * would be 'Claire + Chris + Jill are typing...'\n   **/\n\n  delimiter: string;\n}\n/**\n * Props for {@link TypingIndicator}.\n *\n * @public\n */\n\nexport interface TypingIndicatorProps {\n  /** List of the typing users. */\n  typingUsers: CommunicationParticipant[];\n  /** Callback to render typing users */\n\n  onRenderUser?: (users: CommunicationParticipant) => JSX.Element;\n  /**\n   * Allows users to pass in an object contains custom CSS styles.\n   * @Example\n   * ```\n   * <TypingIndicator styles={{ root: { background: 'blue' } }} />\n   * ```\n   */\n\n  styles?: TypingIndicatorStylesProps;\n  /**\n   * Optional strings to override in component\n   */\n\n  strings?: Partial<TypingIndicatorStrings>;\n}\nconst MAXIMUM_LENGTH_OF_TYPING_USERS = 35;\n/**\n * Helper function to create element wrapping all typing users\n * @param typingUsers typing users\n * @param delimiter string to separate typing users\n * @param onRenderUser optional callback to render each typing user\n * @param userDisplayNameStyles optional additional IStyle to apply to each element containing users name\n * @returns element wrapping all typing users\n */\n\nconst getUsersElement = (typingUsers: CommunicationParticipant[], delimiter: string, onRenderUser?: (users: CommunicationParticipant) => JSX.Element, userDisplayNameStyles?: IStyle): JSX.Element => {\n  const userElements: JSX.Element[] = [];\n  typingUsers.forEach((user, index) => {\n    userElements.push(onRenderUser ? onRenderUser(user) : <Text className={mergeStyles(userDisplayNameStyles)} key={`user-${index}`}>\n          {user.displayName}\n        </Text>);\n    userElements.push(<Text key={`comma-${index}`}>{`${delimiter}`}</Text>);\n  }); // pop last comma\n\n  userElements.pop();\n  return <>{userElements}</>;\n};\n/**\n * Helper function to get a string of all typing users\n * @param typingUsers typing users\n * @param delimiter string to separate typing users\n * @returns string of all typing users\n */\n\n\nconst getNamesString = (typingUsers: CommunicationParticipant[], delimiter: string): string => {\n  const userNames: string[] = [];\n  typingUsers.forEach(user => {\n    if (user.displayName) {\n      userNames.push(user.displayName);\n    }\n  });\n  return userNames.join(delimiter);\n};\n/**\n * Helper function to create span elements making up the typing indicator string\n * @param strings TypingIndicatorStrings containing strings to create span elements\n * @param usersElement JSX.Element containing all typing users\n * @param numTypingUsers number of total typing users\n * @param numUserNotMentioned number of typing users abbreviated\n * @returns array of span elements making up the typing indicator string\n */\n\n\nconst getSpanElements = (strings: TypingIndicatorStrings, usersElement: JSX.Element, numTypingUsers: number, numTypingUsersAbbreviated: number): JSX.Element[] => {\n  let variables: Record<string, JSX.Element> = {};\n  let typingString = '';\n\n  if (numTypingUsers === 1) {\n    typingString = strings.singleUser;\n    variables = {\n      user: usersElement\n    };\n  } else if (numTypingUsers > 1 && numTypingUsersAbbreviated === 0) {\n    typingString = strings.multipleUsers;\n    variables = {\n      users: usersElement\n    };\n  } else if (numTypingUsers > 1 && numTypingUsersAbbreviated === 1) {\n    typingString = strings.multipleUsersAbbreviateOne;\n    variables = {\n      users: usersElement\n    };\n  } else if (numTypingUsers > 1 && numTypingUsersAbbreviated > 1) {\n    typingString = strings.multipleUsersAbbreviateMany;\n    variables = {\n      users: usersElement,\n      numOthers: <>{numTypingUsersAbbreviated}</>\n    };\n  }\n\n  return formatInlineElements(typingString, variables);\n};\n/**\n * Helper function to get the string making up the typing indicator string\n * @param strings TypingIndicatorStrings containing strings to create span elements\n * @param namesString string of all typing users\n * @param numTypingUsers number of total typing users\n * @param numUserNotMentioned number of typing users abbreviated\n * @returns typing indicator string\n */\n\n\nconst getIndicatorString = (strings: TypingIndicatorStrings, namesString: string, numTypingUsers: number, numTypingUsersAbbreviated: number): string | undefined => {\n  if (numTypingUsers === 1) {\n    return strings.singleUser.replace('{user}', namesString);\n  }\n\n  if (numTypingUsers > 1 && numTypingUsersAbbreviated === 0) {\n    return strings.multipleUsers.replace('{users}', namesString);\n  }\n\n  if (numTypingUsers > 1 && numTypingUsersAbbreviated === 1) {\n    return strings.multipleUsersAbbreviateOne.replace('{users}', namesString);\n  }\n\n  if (numTypingUsers > 1 && numTypingUsersAbbreviated > 1) {\n    return strings.multipleUsersAbbreviateMany.replace('{users}', namesString).replace('{numOthers}', `${numTypingUsersAbbreviated}`);\n  }\n\n  return undefined;\n};\n\nconst IndicatorComponent = (typingUsers: CommunicationParticipant[], strings: TypingIndicatorStrings, onRenderUser?: (users: CommunicationParticipant) => JSX.Element, styles?: TypingIndicatorStylesProps): JSX.Element => {\n  const typingUsersMentioned: CommunicationParticipant[] = [];\n  let totalCharacterCount = 0;\n  const ids = useIdentifiers();\n\n  for (const typingUser of typingUsers) {\n    if (!typingUser.displayName) {\n      continue;\n    }\n\n    let additionalCharCount = typingUser.displayName.length; // The typing users will be separated by the delimiter. We account for that additional length when we generate the final string.\n\n    if (typingUsersMentioned.length > 0) {\n      additionalCharCount += strings.delimiter.length;\n    }\n\n    if (totalCharacterCount + additionalCharCount <= MAXIMUM_LENGTH_OF_TYPING_USERS || typingUsersMentioned.length === 0) {\n      typingUsersMentioned.push(typingUser);\n      totalCharacterCount += additionalCharCount;\n    } else {\n      break;\n    }\n  }\n\n  const usersElement: JSX.Element = getUsersElement(typingUsersMentioned, strings.delimiter, onRenderUser, styles?.typingUserDisplayName);\n  const numUserNotMentioned = typingUsers.length - typingUsersMentioned.length;\n  const spanElements: JSX.Element[] = getSpanElements(strings, usersElement, typingUsers.length, numUserNotMentioned);\n  const labelString = getIndicatorString(strings, getNamesString(typingUsersMentioned, strings.delimiter), typingUsers.length, numUserNotMentioned);\n  return <div data-ui-id={ids.typingIndicator} className={mergeStyles(typingIndicatorStringStyle, styles?.typingString)} key=\"typingStringKey\" role=\"status\" aria-label={labelString}>\n      {spanElements}\n    </div>;\n};\n/**\n * Component to notify local user when one or more participants in the chat thread are typing.\n *\n * @public\n */\n\n\nexport const TypingIndicator = (props: TypingIndicatorProps): JSX.Element => {\n  const {\n    typingUsers,\n    onRenderUser,\n    styles\n  } = props;\n  const {\n    strings\n  } = useLocale();\n  const typingUsersToRender = typingUsers.filter(typingUser => typingUser.displayName !== undefined);\n  const indicatorComponent = IndicatorComponent(typingUsersToRender, { ...strings.typingIndicator,\n    ...props.strings\n  }, onRenderUser, styles);\n  return <Stack className={mergeStyles(typingIndicatorContainerStyle, styles?.root)}>{indicatorComponent}</Stack>;\n};\n/**\n * Create an array of span elements by replacing the pattern \"\\{\\}\" in str with the elements\n * passed in as vars and creating inline elements from the rest\n *\n * @param str - The string to be formatted\n * @param vars - Variables to use to format the string\n * @returns formatted JSX elements\n */\n\nconst formatInlineElements = (str: string, vars: _IObjectMap<JSX.Element>): JSX.Element[] => {\n  if (!str) {\n    return [];\n  }\n\n  if (!vars) {\n    return [];\n  }\n\n  const elements: JSX.Element[] = []; // regex to search for the pattern \"{}\"\n\n  const placeholdersRegex = /{(\\w+)}/g;\n  const regex = RegExp(placeholdersRegex);\n  let array: RegExpExecArray | null = regex.exec(str);\n  let prev = 0;\n\n  while (array !== null) {\n    if (prev !== array.index) {\n      elements.push(<Text key={elements.length}>{str.substring(prev, array.index)}</Text>);\n    }\n\n    elements.push(<Text key={elements.length}>{vars[array[0].substring(1, array[0].length - 1)]}</Text>);\n    prev = regex.lastIndex;\n    array = regex.exec(str);\n  }\n\n  elements.push(<Text key={elements.length}>{str.substring(prev)}</Text>);\n  return elements;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IIconProps, MessageBarType } from '@fluentui/react';\nimport { ActiveErrorMessage, ErrorType } from './ErrorBar';\n/**\n * @private\n *\n * @param fileName\n * @param length\n * @returns string\n */\n\nexport const truncatedFileName = (fileName: string, length: number): string => {\n  return fileName.substring(0, length).trimEnd() + (fileName.length > length ? '... ' : '');\n};\n/**\n * @private\n *\n * @param fileName\n * @returns string\n */\n\nexport const extension = (fileName: string): string => fileName.split('.').pop() || '';\n/**\n * @private\n */\n\nexport interface DismissedError {\n  type: ErrorType;\n  dismissedAt: Date;\n  activeSince?: Date;\n}\n/**\n * @private\n * @param dismissedErrors\n * @param toDismiss\n * @returns DismissedError[]\n * Always returns a new Array so that the state variable is updated, trigerring a render.\n */\n\nexport const dismissError = (dismissedErrors: DismissedError[], toDismiss: ActiveErrorMessage): DismissedError[] => {\n  const now = new Date(Date.now());\n\n  for (const error of dismissedErrors) {\n    if (error.type === toDismiss.type) {\n      // Bump the timestamp for latest dismissal of this error to now.\n      error.dismissedAt = now;\n      error.activeSince = toDismiss.timestamp;\n      return Array.from(dismissedErrors);\n    }\n  } // Record that this error was dismissed for the first time right now.\n\n\n  return [...dismissedErrors, {\n    type: toDismiss.type,\n    dismissedAt: now,\n    activeSince: toDismiss.timestamp\n  }];\n};\n/**\n * @private\n * @param activeErrorMessages\n * @param dismissedErrors\n * @returns DismissedError[]\n *  Returns a new Array if and only if contents change, to avoid re-rendering when nothing was dropped.\n */\n\nexport const dropDismissalsForInactiveErrors = (activeErrorMessages: ActiveErrorMessage[], dismissedErrors: DismissedError[]): DismissedError[] => {\n  const active = new Map();\n\n  for (const message of activeErrorMessages) {\n    active.set(message.type, message);\n  } // For an error such that:\n  // * It was previously active, and dismissed.\n  // * It did not have a timestamp associated with it.\n  // * It is no longer active.\n  //\n  // We remove it from dismissals. When it becomes active again next time, it will be shown again on the UI.\n\n\n  const shouldDeleteDismissal = (dismissed: DismissedError): boolean => dismissed.activeSince === undefined && active.get(dismissed.type) === undefined;\n\n  if (dismissedErrors.some(dismissed => shouldDeleteDismissal(dismissed))) {\n    return dismissedErrors.filter(dismissed => !shouldDeleteDismissal(dismissed));\n  }\n\n  return dismissedErrors;\n};\n/**\n * @private\n * @param activeErrorMessages\n * @param dismissedErrors\n * @returns ActiveErrorMessage[]\n */\n\nexport const errorsToShow = (activeErrorMessages: ActiveErrorMessage[], dismissedErrors: DismissedError[]): ActiveErrorMessage[] => {\n  const dismissed: Map<ErrorType, DismissedError> = new Map();\n\n  for (const error of dismissedErrors) {\n    dismissed.set(error.type, error);\n  }\n\n  return activeErrorMessages.filter(error => {\n    const dismissal = dismissed.get(error.type);\n\n    if (!dismissal) {\n      // This error was never dismissed.\n      return true;\n    }\n\n    if (!error.timestamp) {\n      // No timestamp associated with the error. In this case, the existence of a dismissal is enough to suppress the error.\n      return false;\n    } // Error has an associated timestamp, so compare with last dismissal.\n\n\n    return error.timestamp > dismissal.dismissedAt;\n  });\n};\n/**\n * @private\n * @param errorType\n * @returns MessageBarType\n */\n\nexport const messageBarType = (errorType: ErrorType): MessageBarType => {\n  switch (errorType) {\n    case 'callNetworkQualityLow':\n    case 'callNoSpeakerFound':\n    case 'callNoMicrophoneFound':\n    case 'callMicrophoneAccessDenied':\n    case 'callMicrophoneMutedBySystem':\n    case 'callMicrophoneUnmutedBySystem':\n    case 'callMacOsMicrophoneAccessDenied':\n    case 'callLocalVideoFreeze':\n    case 'callCameraAccessDenied':\n    case 'callCameraAlreadyInUse':\n    case 'callVideoStoppedBySystem':\n    case 'callVideoRecoveredBySystem':\n    case 'callMacOsCameraAccessDenied':\n    case 'callMacOsScreenShareAccessDenied':\n      return MessageBarType.warning;\n\n    default:\n      return MessageBarType.error;\n  }\n};\n/**\n * @private\n * @param errorType\n * @returns IIconProps | undefined\n */\n\nexport const messageBarIconProps = (errorType: ErrorType): IIconProps | undefined => {\n  const iconName = customIconName[errorType];\n  return iconName ? {\n    iconName\n  } : undefined;\n};\n/**\n * @private\n */\n\nexport const customIconName: Partial<{ [key in ErrorType]: string }> = {\n  callNetworkQualityLow: 'ErrorBarCallNetworkQualityLow',\n  callNoSpeakerFound: 'ErrorBarCallNoSpeakerFound',\n  callNoMicrophoneFound: 'ErrorBarCallNoMicrophoneFound',\n  callMicrophoneAccessDenied: 'ErrorBarCallMicrophoneAccessDenied',\n  callMicrophoneMutedBySystem: 'ErrorBarCallMicrophoneMutedBySystem',\n  callMicrophoneUnmutedBySystem: 'ErrorBarCallMicrophoneUnmutedBySystem',\n  callMacOsMicrophoneAccessDenied: 'ErrorBarCallMacOsMicrophoneAccessDenied',\n  callLocalVideoFreeze: 'ErrorBarCallLocalVideoFreeze',\n  callCameraAccessDenied: 'ErrorBarCallCameraAccessDenied',\n  callCameraAlreadyInUse: 'ErrorBarCallCameraAlreadyInUse',\n  callVideoStoppedBySystem: 'ErrorBarCallVideoStoppedBySystem',\n  callVideoRecoveredBySystem: 'ErrorBarCallVideoRecoveredBySystem',\n  callMacOsCameraAccessDenied: 'ErrorBarCallMacOsCameraAccessDenied'\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { useEffect, useState } from 'react';\nimport { IMessageBarProps, MessageBar, Stack } from '@fluentui/react';\nimport { useLocale } from '../localization';\nimport { DismissedError, dismissError, dropDismissalsForInactiveErrors, errorsToShow, messageBarIconProps, messageBarType } from './utils';\n/**\n * Props for {@link ErrorBar}.\n *\n * In addition to the following, {@link ErrorBar} forwards all\n * {@link @fluentui/react#IMessageBarProps} to the underlying {@link @fluentui/react#MessageBar}.\n *\n * @public\n */\n\nexport interface ErrorBarProps extends IMessageBarProps {\n  /**\n   * Strings shown on the UI on errors.\n   */\n  strings?: ErrorBarStrings;\n  /**\n   * Currently active errors.\n   */\n\n  activeErrorMessages: ActiveErrorMessage[];\n}\n/**\n * All strings that may be shown on the UI in the {@link ErrorBar}.\n *\n * @public\n */\n\nexport interface ErrorBarStrings {\n  /**\n   * Unable to reach Chat service.\n   *\n   * This can mean:\n   *   - Incorrect Azure Communication Services endpoint was provided.\n   *   - User's network connection is down.\n   */\n  unableToReachChatService: string;\n  /**\n   * User does not have access to the Chat service.\n   * This usually means that either the Azure Communication Services endpiont or the token provided are incorrect.\n   */\n\n  accessDenied: string;\n  /**\n   * User is no longer on the thread.\n   *\n   * See also: {@link ErrorBarStrings.sendMessageNotInChatThread} for a more specific error.\n   */\n\n  userNotInChatThread: string;\n  /**\n   * Sending message failed because user is no longer on the thread.\n   */\n\n  sendMessageNotInChatThread: string;\n  /**\n   * A generic message when sending message fails.\n   * Prefer more specific error strings when possible.\n   */\n\n  sendMessageGeneric: string;\n  /**\n   * A generic message when starting video fails.\n   */\n\n  startVideoGeneric: string;\n  /**\n   * A generic message when starting video fails.\n   */\n\n  stopVideoGeneric: string;\n  /**\n   * A generic message when muting microphone fails.\n   */\n\n  muteGeneric: string;\n  /**\n   * A generic message when unmuting microphone fails.\n   */\n\n  unmuteGeneric: string;\n  /**\n   * A generic message when starting screenshare fails.\n   */\n\n  startScreenShareGeneric: string;\n  /**\n   * A generic message when stopping screenshare fails.\n   */\n\n  stopScreenShareGeneric: string;\n  /**\n   * Message shown when poor network quality is detected during a call.\n   */\n\n  callNetworkQualityLow: string;\n  /**\n   * Message shown on failure to detect audio output devices.\n   */\n\n  callNoSpeakerFound: string;\n  /**\n   * Message shown on failure to detect audio input devices.\n   */\n\n  callNoMicrophoneFound: string;\n  /**\n   * Message shown when microphone can be enumerated but access is blocked by the system.\n   */\n\n  callMicrophoneAccessDenied: string;\n  /**\n   * Message shown when microphone is muted by the system (not by local or remote participants)\n   */\n\n  callMicrophoneMutedBySystem: string;\n  /**\n   * Message shown when microphone is unmuted by the system (not by local or remote participants).\n   * This typically occurs if the system recovers from an unexpected mute.\n   */\n\n  callMicrophoneUnmutedBySystem: string;\n  /**\n   * Mac OS specific message shown when microphone can be enumerated but access is\n   * blocked by the system.\n   */\n\n  callMacOsMicrophoneAccessDenied: string;\n  /**\n   * Message shown when poor network causes local video stream to be frozen.\n   */\n\n  callLocalVideoFreeze: string;\n  /**\n   * Message shown when camera can be enumerated but access is blocked by the system.\n   */\n\n  callCameraAccessDenied: string;\n  /**\n   * Message shown when local video fails to start because camera is already in use by\n   * another applciation.\n   */\n\n  callCameraAlreadyInUse: string;\n  /**\n   * Message shown when local video is stopped by the system (not by local or remote participants)\n   */\n\n  callVideoStoppedBySystem: string;\n  /**\n   * Message shown when local video was recovered by the system (not by the local participant)\n   */\n\n  callVideoRecoveredBySystem: string;\n  /**\n   * Mac OS specific message shown when system denies access to camera.\n   */\n\n  callMacOsCameraAccessDenied: string;\n  /**\n   * Mac OS specific message shown when system denies sharing local screen on a call.\n   */\n\n  callMacOsScreenShareAccessDenied: string;\n  /**\n   * Dimiss errorbar button aria label read by screen reader accessibility tools\n   */\n\n  dismissButtonAriaLabel?: string;\n  /**\n   * An error message when joining a call fails.\n   */\n\n  failedToJoinCallGeneric?: string;\n  /**\n   * An error message when joining a call fails specifically due to an invalid meeting link.\n   */\n\n  failedToJoinCallInvalidMeetingLink?: string;\n}\n/**\n * All errors that can be shown in the {@link ErrorBar}.\n *\n * @public\n */\n\nexport type ErrorType = keyof ErrorBarStrings;\n/**\n * Active error messages to be shown via {@link ErrorBar}.\n *\n * @public\n */\n\nexport interface ActiveErrorMessage {\n  /**\n   * Type of error that is active.\n   */\n  type: ErrorType;\n  /**\n   * The latest timestamp when this error was observed.\n   *\n   * When available, this is used to track errors that have already been seen and dismissed\n   * by the user.\n   */\n\n  timestamp?: Date;\n}\n/**\n * A component to show error messages on the UI.\n * All strings that can be shown are accepted as the {@link ErrorBarProps.strings} so that they can be localized.\n * Active errors are selected by {@link ErrorBarProps.activeErrorMessages}.\n *\n * This component internally tracks dismissed by the user.\n *   * Errors that have an associated timestamp: The error is shown on the UI again if it occurs after being dismissed.\n *   * Errors that do not have a timestamp: The error is dismissed until it disappears from the props.\n *         If the error recurs, it is shown in the UI.\n *\n * Uses {@link @fluentui/react#MessageBar} UI element.\n *\n * @public\n */\n\nexport const ErrorBar = (props: ErrorBarProps): JSX.Element => {\n  const localeStrings = useLocale().strings.errorBar;\n  const strings = props.strings ?? localeStrings;\n  const [dismissedErrors, setDismissedErrors] = useState<DismissedError[]>([]); // dropDismissalsForInactiveErrors only returns a new object if `dismissedErrors` actually changes.\n  // Without this behaviour, this `useEffect` block would cause a render loop.\n\n  useEffect(() => setDismissedErrors(dropDismissalsForInactiveErrors(props.activeErrorMessages, dismissedErrors)), [props.activeErrorMessages, dismissedErrors]);\n  const toShow = errorsToShow(props.activeErrorMessages, dismissedErrors);\n  return <Stack data-ui-id=\"error-bar-stack\">\n      {toShow.map(error => <MessageBar {...props} styles={{\n      innerText: {\n        paddingTop: messageBarType(error.type) === 5 ? '0.15rem' : '0.1rem',\n        // to move the inner text of the message bar down to be centered\n        lineHeight: 'none'\n      },\n      icon: {\n        height: 0\n      },\n      content: {\n        lineHeight: 'inherit'\n      },\n      dismissal: {\n        height: 0,\n        paddingTop: '0.8rem'\n      }\n    }} key={error.type} messageBarType={messageBarType(error.type)} messageBarIconProps={messageBarIconProps(error.type)} onDismiss={() => setDismissedErrors(dismissError(dismissedErrors, error))} dismissButtonAriaLabel={strings.dismissButtonAriaLabel} dismissIconProps={{\n      iconName: 'ErrorBarClear'\n    }}>\n          {strings[error.type]}\n        </MessageBar>)}\n    </Stack>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const gridLayoutStyle = mergeStyles({\n  width: '100%',\n  height: '100%',\n  display: 'grid',\n  gridGap: '0.5rem'\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStyle, mergeStyles } from '@fluentui/react';\nimport React, { useRef, useEffect, useState, useMemo } from 'react';\nimport { BaseCustomStyles } from '../types';\nimport { gridLayoutStyle } from './styles/GridLayout.styles';\n/**\n * Props for {@link GridLayout}.\n *\n * @public\n */\n\nexport interface GridLayoutProps {\n  children: React.ReactNode;\n  /**\n   * Allows users to pass in an object contains custom CSS styles.\n   * @Example\n   * ```\n   * <GridLayout styles={{ root: { background: 'blue' } }} />\n   * ```\n   */\n\n  styles?: BaseCustomStyles;\n}\n/**\n * {@link GridLayout} Component Styles.\n * @public\n */\n\nexport interface GridLayoutStyles extends BaseCustomStyles {\n  /** Styles for each child of {@link GridLayout} */\n  children?: IStyle;\n}\n/**\n * A component to lay out audio / video participants tiles in a call.\n *\n * @public\n */\n\nexport const GridLayout = (props: GridLayoutProps): JSX.Element => {\n  const {\n    children,\n    styles\n  } = props;\n  const numberOfChildren = React.Children.count(children);\n  const [currentWidth, setCurrentWidth] = useState(0);\n  const [currentHeight, setCurrentHeight] = useState(0);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const observer = useRef(new ResizeObserver((entries): void => {\n    const {\n      width,\n      height\n    } = entries[0].contentRect;\n    setCurrentWidth(width);\n    setCurrentHeight(height);\n  }));\n  useEffect(() => {\n    if (containerRef.current) {\n      observer.current.observe(containerRef.current);\n    }\n\n    const currentObserver = observer.current;\n    return () => currentObserver.disconnect();\n  }, [observer, containerRef]);\n  const gridProps = useMemo(() => {\n    return calculateGridProps(numberOfChildren, currentWidth, currentHeight);\n  }, [numberOfChildren, currentWidth, currentHeight]);\n  const cssGridStyles = useMemo(() => createGridStyles(numberOfChildren, gridProps), [numberOfChildren, gridProps]);\n  return <div ref={containerRef} className={mergeStyles(gridLayoutStyle, cssGridStyles, styles?.root)}>\n      {children}\n    </div>;\n};\n/**\n * The cell aspect ratio we aim for in a grid\n */\n\nconst TARGET_CELL_ASPECT_RATIO = 16 / 9;\n/**\n * The minimum cell aspect ratio we allow\n */\n\nconst MINIMUM_CELL_ASPECT_RATIO_ALLOWED = 8 / 9;\n\nconst isCloserThan = (a: number, b: number, target: number): boolean => {\n  return Math.abs(target - a) < Math.abs(target - b);\n};\n/**\n * Properties to describe a grid. The number of rows, number of columns and whether it fills horizontally or vertically.\n *\n * @Example\n * ```\n *  ______________________\n * |_______|_______|______|\n * |___________|__________| This grid has 2 rows, 3 columns and fills horizontally.\n *  ______________\n * |    |    |    |\n * |____|____|    |\n * |    |    |    |\n * |____|____|____| This grid has 2 rows, 3 columns and fills vertically.\n *  _______________\n * |       |       |\n * |_______|_______|\n * |       |       | If all cells are equal, we default the fill direction as horizontal.\n * |_______|_______| This grid has 2 rows, 2 columns and fills horizontally.\n * ```\n */\n\n\ntype GridProps = {\n  fillDirection: FillDirection;\n  rows: number;\n  columns: number;\n};\ntype FillDirection = 'horizontal' | 'vertical';\n/**\n * Get the best GridProps to place a number of items in a grid as evenly as possible given the width and height of the grid\n * @param numberOfItems - number of items to place in grid\n * @param width - width of grid\n * @param height - height of grid\n * @returns GridProps\n */\n\nexport const calculateGridProps = (numberOfItems: number, width: number, height: number): GridProps => {\n  if (numberOfItems <= 0) {\n    return {\n      fillDirection: 'horizontal',\n      rows: 0,\n      columns: 0\n    };\n  } // If width or height are 0 then we return rows and column evenly\n\n\n  if (width <= 0 || height <= 0) {\n    return {\n      fillDirection: 'horizontal',\n      rows: Math.ceil(Math.sqrt(numberOfItems)),\n      columns: Math.ceil(Math.sqrt(numberOfItems))\n    };\n  }\n\n  const aspectRatio = width / height; // Approximate how many rows to divide the grid to achieve cells close to the TARGET_CELL_ASPECT_RATIO\n\n  let rows = Math.floor(Math.sqrt(TARGET_CELL_ASPECT_RATIO / aspectRatio * numberOfItems)) || 1; // Make sure rows do not exceed numberOfItems\n\n  rows = Math.min(rows, numberOfItems); // Given the rows, get the minimum columns needed to create enough cells for the number of items\n\n  let columns = Math.ceil(numberOfItems / rows); // Default fill direction to horizontal\n\n  let fillDirection: 'horizontal' | 'vertical' = 'horizontal';\n\n  while (rows < numberOfItems) {\n    // If cell aspect ratio is less than MINIMUM_CELL_ASPECT_RATIO_ALLOWED then try more rows\n    if (rows / columns * aspectRatio < MINIMUM_CELL_ASPECT_RATIO_ALLOWED) {\n      rows += 1;\n      columns = Math.ceil(numberOfItems / rows);\n      continue;\n    }\n\n    if (numberOfItems < rows * columns) {\n      // We need to check that stretching columns vertically will result in only one less cell in stretched columns.\n      // Likewise, we need to check that stretching rows horizonally will result in only one less cell in stretched rows.\n      // e.g. For 4 rows, 2 columns, but only 6 items, we cannot stretch vertically because that would result in a\n      // column of 2 cells which is less by more than 1 compared to the unstretched column.\n      //  _________\n      // |____|    |\n      // |____|____|\n      // |____|    |\n      // |____|____|\n      const canStretchVertically = numberOfItems >= rows + (columns - 1) * (rows - 1);\n      const canStretchHorizontally = numberOfItems >= columns + (rows - 1) * (columns - 1);\n\n      if (!canStretchVertically && !canStretchHorizontally) {\n        rows += 1;\n        columns = Math.ceil(numberOfItems / rows);\n        continue;\n      } else if (!canStretchVertically) {\n        break;\n      } else if (!canStretchHorizontally) {\n        fillDirection = 'vertical';\n        break;\n      } // We need to figure out whether the big cells should stretch horizontally or vertically\n      // to fill in the empty spaces\n      // e.g. For 2 rows, 3 columns, but only 5 items, we need to choose whether to stretch cells\n      //       horizontally            or           vertically\n      //  ______________________               _______________________\n      // |       |       |      |             |       |       |       |\n      // |_______|_______|______|             |_______|_______|       |\n      // |           |          |             |       |       |       |\n      // |___________|__________|             |_______|_______|_______|\n      // Calculate the aspect ratio of big cells stretched horizontally\n\n\n      const horizontallyStretchedCellRatio = rows / (columns - 1) * aspectRatio; // Calculate the aspect ratio of big cells stretched vertically\n\n      const verticallyStretchedCellRatio = (rows - 1) / columns * aspectRatio; // We know the horizontally stretched cells aspect ratio is higher than MINIMUM_CELL_ASPECT_RATIO_ALLOWED. If vertically stretched cells\n      // is also higher than the MINIMUM_CELL_ASPECT_RATIO_ALLOWED, then choose which aspect ratio is better.\n\n      if (verticallyStretchedCellRatio >= MINIMUM_CELL_ASPECT_RATIO_ALLOWED) {\n        // If vertically stetched cell has an aspect ratio closer to TARGET_CELL_ASPECT_RATIO then change the fill direction to vertical\n        if (isCloserThan(verticallyStretchedCellRatio, horizontallyStretchedCellRatio, TARGET_CELL_ASPECT_RATIO)) {\n          fillDirection = 'vertical';\n        }\n      }\n    }\n\n    break;\n  }\n\n  return {\n    fillDirection,\n    rows,\n    columns\n  };\n};\n/**\n * Creates a styles classname with CSS Grid related styles given GridProps and the number of items to distribute as evenly as possible.\n * @param numberOfItems - number of items to place in grid\n * @param gridProps - GridProps that define the number of rows, number of columns, and the fill direction\n * @returns - classname\n */\n\nexport const createGridStyles = (numberOfItems: number, gridProps: GridProps): string => {\n  const isHorizontal = gridProps.fillDirection === 'horizontal'; // Blocks are either rows or columns depending on whether we fill horizontally or vertically. Each block may differ in the number of cells.\n\n  const blocks = isHorizontal ? gridProps.rows : gridProps.columns;\n  const smallCellsPerBlock = Math.ceil(numberOfItems / blocks);\n  const bigCellsPerBlock = Math.floor(numberOfItems / blocks);\n  const numBigCells = (gridProps.rows * gridProps.columns - numberOfItems) * bigCellsPerBlock; // Get grid units\n  // e.g. If some blocks have 2 big cells while others have 3 small cells, we need to work with 6 units per block\n\n  const units = smallCellsPerBlock * bigCellsPerBlock;\n  const gridStyles = isHorizontal ? {\n    gridTemplateColumns: `repeat(${units}, minmax(0, 1fr))`,\n    gridTemplateRows: `repeat(${blocks}, minmax(0, 1fr))`,\n    gridAutoFlow: 'row'\n  } : {\n    gridTemplateColumns: `repeat(${blocks}, minmax(0, 1fr))`,\n    gridTemplateRows: `repeat(${units}, minmax(0, 1fr))`,\n    gridAutoFlow: 'column'\n  };\n  const smallCellStyle = isHorizontal ? {\n    '> *': {\n      gridColumn: `auto / span ${units / smallCellsPerBlock}`\n    }\n  } : {\n    '> *': {\n      gridRow: `auto / span ${units / smallCellsPerBlock}`\n    }\n  }; // If there are big cells, we are choosing to place the latest children into the big cells.\n  // That is why we use the '> *:nth-last-child(-n + ${numBigCells})' CSS selector below\n\n  const bigCellStyle = numBigCells ? {\n    [`> *:nth-last-child(-n + ${numBigCells})`]: isHorizontal ? {\n      gridColumn: `auto / span ${units / bigCellsPerBlock}`\n    } : {\n      gridRow: `auto / span ${units / bigCellsPerBlock}`\n    }\n  } : {};\n  return mergeStyles(gridStyles, smallCellStyle, bigCellStyle);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles, IStyle, Theme } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const suppressIconStyle = {\n  iconContainer: {\n    minHeight: '0',\n    minWidth: '0',\n    height: '0',\n    width: '0',\n    margin: '0'\n  },\n  icon: {\n    display: 'none'\n  }\n};\n/**\n * @private\n */\n\nexport const sendBoxWrapperStyles = mergeStyles({\n  margin: '0.25rem',\n  overflow: 'hidden',\n\n  /**\n   * margin-top set for all the child components of sendbox except first\n   */\n  ':not(:first-child)': {\n    marginTop: '0.25rem'\n  }\n});\n/**\n * @private\n */\n\nexport const sendBoxStyle = mergeStyles({\n  paddingRight: '2rem'\n});\n/**\n * @private\n */\n\nexport const sendButtonStyle = mergeStyles({\n  height: '1.25rem',\n  width: '1.25rem',\n  marginRight: '0.313rem' // 5px\n\n});\n/**\n * @private\n */\n\nexport const sendIconStyle = mergeStyles({\n  width: '1.25rem',\n  height: '1.25rem',\n  margin: 'auto'\n});\n/**\n * @private\n */\n\nexport const fileUploadCardsStyles = mergeStyles({\n  margin: '0.25rem',\n  maxHeight: '12.5rem',\n  overflow: 'auto'\n});\n/**\n * @private\n */\n\nexport const fileCardBoxStyle = mergeStyles({\n  width: '100%',\n  padding: '0.50rem'\n});\nconst defaultSendBoxInactiveBorderThicknessREM = 0.0625;\nconst defaultSendBoxActiveBorderThicknessREM = 0.125;\n/**\n * @private\n */\n\nexport const borderAndBoxShadowStyle = (props: {\n  theme: Theme;\n  hasErrorMessage: boolean;\n  disabled: boolean;\n}): IStyle => {\n  const {\n    theme,\n    hasErrorMessage,\n    disabled\n  } = props;\n  const borderColor = hasErrorMessage ? theme.semanticColors.errorText : theme.palette.neutralSecondary;\n  const borderColorActive = hasErrorMessage ? theme.semanticColors.errorText : theme.palette.themePrimary;\n  const borderThickness = disabled ? 0 : defaultSendBoxInactiveBorderThicknessREM;\n  const borderActiveThickness = disabled ? 0 : defaultSendBoxActiveBorderThicknessREM;\n  return {\n    borderRadius: theme.effects.roundedCorner4,\n    border: `${borderThickness}rem solid ${borderColor}`,\n    // The border thickness of the sendbox wrapper changes on hover, to prevent the border thickness change causing the\n    // input box to shift we apply a margin to compensate. This margin is then removed on hover when the border is thicker.\n    margin: `${defaultSendBoxActiveBorderThicknessREM - borderThickness}rem`,\n    ':hover, :active, :focus, :focus-within': {\n      border: `${borderActiveThickness}rem solid ${borderColorActive}`,\n      margin: `${defaultSendBoxActiveBorderThicknessREM - borderActiveThickness}rem`\n    }\n  };\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { PartialTheme } from '@fluentui/react';\n/**\n * Custom Fluent theme pallete used by calling related components in this library.\n *\n * @public\n */\n\nexport interface CallingTheme {\n  callingPalette: {\n    callRed: string;\n    callRedDark: string;\n    callRedDarker: string;\n    iconWhite: string;\n  };\n}\n/**\n * Preset light theme for components exported from this library.\n *\n * @public\n */\n\nexport const lightTheme: PartialTheme & CallingTheme = {\n  palette: {\n    themePrimary: '#0078d4',\n    themeLighterAlt: '#eff6fc',\n    themeLighter: '#deecf9',\n    themeLight: '#c7e0f4',\n    themeTertiary: '#71afe5',\n    themeSecondary: '#2b88d8',\n    themeDarkAlt: '#106ebe',\n    themeDark: '#59b0f7',\n    themeDarker: '#004578',\n    neutralLighterAlt: '#faf9f8',\n    neutralLighter: '#f3f2f1',\n    neutralLight: '#edebe9',\n    neutralQuaternaryAlt: '#e1dfdd',\n    neutralQuaternary: '#d0d0d0',\n    neutralTertiaryAlt: '#c8c6c4',\n    neutralTertiary: '#a19f9d',\n    neutralSecondary: '#605e5c',\n    neutralPrimaryAlt: '#3b3a39',\n    neutralPrimary: '#323130',\n    neutralDark: '#201f1e',\n    black: '#000000',\n    white: '#ffffff'\n  },\n  callingPalette: {\n    callRed: '#a42e43',\n    callRedDark: '#8b2c3d',\n    callRedDarker: '#772a38',\n    iconWhite: '#ffffff'\n  },\n  semanticColors: {\n    errorText: '#a80000'\n  }\n};\n/**\n * Preset dark theme for components exported from this library.\n *\n * @public\n */\n\nexport const darkTheme: PartialTheme & CallingTheme = {\n  palette: {\n    themePrimary: '#2899f5',\n    themeLighterAlt: '#02060a',\n    themeLighter: '#061827',\n    themeLight: '#0c2e49',\n    themeTertiary: '#185b93',\n    themeSecondary: '#2286d7',\n    themeDarkAlt: '#3ca2f6',\n    themeDark: '#59b0f7',\n    themeDarker: '#84c5f9',\n    neutralLighterAlt: '#302e2d',\n    neutralLighter: '#383735',\n    neutralLight: '#464443',\n    neutralQuaternaryAlt: '#4e4d4b',\n    neutralQuaternary: '#4d4b49',\n    neutralTertiaryAlt: '#72706e',\n    neutralTertiary: '#c8c8c8',\n    neutralSecondary: '#d0d0d0',\n    neutralPrimaryAlt: '#dadada',\n    neutralPrimary: '#ffffff',\n    neutralDark: '#f4f4f4',\n    black: '#f8f8f8',\n    white: '#252423'\n  },\n  callingPalette: {\n    callRed: '#c4314b',\n    callRedDark: '#a42e43',\n    callRedDarker: '#8b2c3d',\n    iconWhite: '#ffffff'\n  },\n  semanticColors: {\n    errorText: '#f1707b'\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { createContext, useContext } from 'react';\nimport { ThemeProvider, Theme, PartialTheme, getTheme, mergeThemes, mergeStyles } from '@fluentui/react';\nimport { mergeThemes as mergeNorthstarThemes, Provider, teamsTheme } from '@fluentui/react-northstar';\nimport { lightTheme } from './themes';\n/**\n * Props for {@link FluentThemeProvider}.\n *\n * @public\n */\n\nexport interface FluentThemeProviderProps {\n  /** Children to be themed. */\n  children: React.ReactNode;\n  /** Theme for components. Defaults to a light theme if not provided. */\n\n  fluentTheme?: PartialTheme | Theme;\n  /**\n   * Whether components are displayed right-to-left\n   * @defaultValue `false`\n   */\n\n  rtl?: boolean;\n}\nconst wrapper = mergeStyles({\n  height: '100%',\n  width: '100%',\n  overflow: 'auto'\n});\nconst defaultTheme = mergeThemes(getTheme(), lightTheme);\n/** Theme context for library's react components */\n\nconst ThemeContext = createContext<Theme>(defaultTheme);\nconst initialFluentNorthstarTheme = mergeNorthstarThemes(teamsTheme, {\n  componentStyles: {\n    ChatMessage: {\n      root: {\n        lineHeight: '1.4286'\n      }\n    }\n  },\n  fontFaces: [],\n  // suppressing font faces from teamsTheme as recommended by FluentUI N* to avoid font styling to other elements\n  siteVariables: {\n    // suppressing body styles from teamsTheme to avoid inherited styling to other elements\n    bodyPadding: undefined,\n    bodyFontSize: undefined,\n    bodyFontFamily: undefined,\n    bodyBackground: undefined,\n    bodyColor: undefined,\n    bodyLineHeight: undefined\n  }\n});\n/**\n * Provider to apply a Fluent theme across this library's react components.\n *\n * @remarks Components in this library are composed primarily from [Fluent UI](https://developer.microsoft.com/fluentui#/controls/web),\n * controls, and also from [Fluent React Northstar](https://fluentsite.z22.web.core.windows.net/0.53.0) controls.\n * This provider handles applying any theme provided to both the underlying Fluent UI controls, as well as the Fluent React Northstar controls.\n *\n * @public\n */\n\nexport const FluentThemeProvider = (props: FluentThemeProviderProps): JSX.Element => {\n  const {\n    fluentTheme,\n    rtl,\n    children\n  } = props;\n  let fluentUITheme: Theme = mergeThemes(defaultTheme, fluentTheme); // merge in rtl from FluentThemeProviderProps\n\n  fluentUITheme = mergeThemes(fluentUITheme, {\n    rtl\n  });\n  const fluentNorthstarTheme = mergeNorthstarThemes(initialFluentNorthstarTheme, {\n    componentVariables: {\n      Chat: {\n        backgroundColor: fluentUITheme.palette.white\n      },\n      ChatMessage: {\n        authorColor: fluentUITheme.palette.neutralPrimary,\n        contentColor: fluentUITheme.palette.neutralPrimary,\n        backgroundColor: fluentUITheme.palette.neutralLighter,\n        backgroundColorMine: fluentUITheme.palette.themeLight\n      }\n    },\n    componentStyles: {\n      ChatMessage: {\n        timestamp: {\n          WebkitTextFillColor: fluentUITheme.palette.neutralSecondary\n        }\n      }\n    } // add more northstar components to align with Fluent UI theme\n\n  });\n  return <ThemeContext.Provider value={fluentUITheme}>\n      <ThemeProvider theme={fluentUITheme} className={wrapper}>\n        <Provider theme={fluentNorthstarTheme} className={wrapper} rtl={rtl}>\n          {children}\n        </Provider>\n      </ThemeProvider>\n    </ThemeContext.Provider>;\n};\n/**\n * React hook to access theme\n *\n * @public\n */\n\nexport const useTheme = (): Theme => useContext(ThemeContext);","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles } from '@fluentui/react';\nimport { ArrowClockwise16Regular, CallEnd20Filled, Checkmark20Regular, CheckmarkCircle16Regular, Circle16Regular, Delete20Regular, Dismiss20Regular, Dismiss16Regular, Edit20Regular, ErrorCircle16Regular, EyeShow16Regular, MicOff16Filled, MicOff16Regular, MicOff20Filled, MicOn16Filled, MicOn20Filled, MicOn20Regular, MoreHorizontal20Filled, MoreHorizontal20Regular, People20Filled, Settings20Filled, Send20Filled, Send20Regular, ShareScreenStart20Filled, ShareScreenStop20Filled, Speaker220Regular, Video16Filled, Video20Filled, Video20Regular, VideoOff20Filled, ChevronLeft20Regular, ChevronRight20Regular, WifiWarning20Filled, SpeakerMute16Filled, MicProhibited16Filled, VideoProhibited16Filled } from '@fluentui/react-icons';\nimport { _pxToRem } from '@internal/acs-ui-common';\nimport React from 'react';\n\n/**\n * Icons used by the React components exported from this library.\n *\n * @remark See {@link CompositeIcons} for icons used by composites only.\n *\n * @public\n */\nexport type ComponentIcons = Record<keyof typeof DEFAULT_COMPONENT_ICONS, JSX.Element>;\n\nconst WifiWarning16Filled = (): JSX.Element => // All ErrorBar icons are 16px x 16px (when 1rem = 16 px).\n// There is no 16px version of this icon in the fluent icon package, so scale the larger\n// one down to required size.\n<div className={mergeStyles({\n  transform: 'scale(0.8)'\n})}>\n    <WifiWarning20Filled />\n  </div>;\n\nconst MoreHorizontal18Regular = (): JSX.Element => // MoreHorizontal icons are 16px x 16px or 20px x 20px so scaling to get desired size\n<div className={mergeStyles({\n  transform: 'scale(0.9)'\n})}>\n    <MoreHorizontal20Regular />\n  </div>;\n\n/**\n * The default set of icons that are available to use in the UI components.\n *\n * @remark Icons used only in the composites are available in {@link DEFAULT_COMPOSITE_ICONS}.\n *\n * @public\n */\nexport const DEFAULT_COMPONENT_ICONS = {\n  ChatMessageOptions: <MoreHorizontal18Regular />,\n  ControlButtonCameraOff: <VideoOff20Filled />,\n  ControlButtonCameraOn: <Video20Filled />,\n  ControlButtonEndCall: <CallEnd20Filled />,\n  ControlButtonMicOff: <MicOff20Filled />,\n  ControlButtonMicOn: <MicOn20Filled />,\n  ControlButtonOptions: <Settings20Filled />,\n  ControlButtonParticipants: <People20Filled />,\n  ControlButtonScreenShareStart: <ShareScreenStart20Filled />,\n  ControlButtonScreenShareStop: <ShareScreenStop20Filled />,\n  EditBoxCancel: <Dismiss20Regular />,\n  EditBoxSubmit: <Checkmark20Regular />,\n  ErrorBarCallCameraAccessDenied: <VideoProhibited16Filled />,\n  ErrorBarCallCameraAlreadyInUse: <VideoProhibited16Filled />,\n  ErrorBarCallLocalVideoFreeze: <WifiWarning16Filled />,\n  ErrorBarCallMacOsCameraAccessDenied: <VideoProhibited16Filled />,\n  ErrorBarCallMacOsMicrophoneAccessDenied: <MicProhibited16Filled />,\n  ErrorBarCallMicrophoneAccessDenied: <MicProhibited16Filled />,\n  ErrorBarCallMicrophoneMutedBySystem: <MicOff16Filled />,\n  ErrorBarCallMicrophoneUnmutedBySystem: <MicOn16Filled />,\n  ErrorBarCallNetworkQualityLow: <WifiWarning16Filled />,\n  ErrorBarCallNoMicrophoneFound: <MicProhibited16Filled />,\n  ErrorBarCallNoSpeakerFound: <SpeakerMute16Filled />,\n  ErrorBarClear: <Dismiss16Regular />,\n  ErrorBarCallVideoRecoveredBySystem: <Video16Filled />,\n  ErrorBarCallVideoStoppedBySystem: <VideoProhibited16Filled />,\n  HorizontalGalleryLeftButton: <ChevronLeft20Regular />,\n  HorizontalGalleryRightButton: <ChevronRight20Regular />,\n  MessageDelivered: <CheckmarkCircle16Regular />,\n  MessageEdit: <Edit20Regular />,\n  MessageFailed: <ErrorCircle16Regular />,\n  MessageRemove: <Delete20Regular />,\n  MessageResend: <ArrowClockwise16Regular />,\n  MessageSeen: <EyeShow16Regular />,\n  MessageSending: <Circle16Regular />,\n  OptionsCamera: <Video20Regular />,\n  OptionsMic: <MicOn20Regular />,\n  OptionsSpeaker: <Speaker220Regular />,\n  ParticipantItemMicOff: <MicOff16Regular />,\n  ParticipantItemOptions: <></>,\n  ParticipantItemOptionsHovered: <MoreHorizontal20Filled />,\n  ParticipantItemScreenShareStart: <ShareScreenStart20Filled />,\n  SendBoxSend: <Send20Regular />,\n  SendBoxSendHovered: <Send20Filled />,\n  VideoTileMicOff: <MicOff16Filled />\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles, IStyle, FontWeights } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const inputBoxWrapperStyle = mergeStyles({\n  padding: '0'\n});\n/**\n * @private\n */\n\nexport const inputBoxStyle = mergeStyles({\n  overflow: 'auto',\n  minHeight: '2.25rem',\n  // prevents the input text box from being sized to 0px when the CallWithChatComposite chat pane is closed.\n  maxHeight: '8.25rem',\n  outline: 'red 5px',\n  fontWeight: FontWeights.regular,\n  fontSize: '0.875rem',\n  width: '100%',\n  height: '2.25rem',\n  lineHeight: '1.5rem',\n  '::-webkit-input-placeholder': {\n    fontSize: '0.875rem'\n  },\n  '::-moz-placeholder': {\n    fontSize: '0.875rem'\n  },\n  ':-moz-placeholder': {\n    fontSize: '0.875rem'\n  }\n});\n/**\n * @private\n */\n\nexport const inputBoxNewLineSpaceAffordance: IStyle = {\n  marginBottom: '2rem'\n};\n/**\n *\n * @private\n */\n\nexport const textContainerStyle: IStyle = {\n  alignSelf: 'center',\n  position: 'relative',\n  width: '100%'\n};\n/**\n * @private\n */\n\nexport const textFieldStyle: IStyle = {\n  root: {\n    width: '100%',\n    minHeight: '0',\n    fontSize: '8.25rem'\n  },\n  wrapper: {},\n  fieldGroup: {\n    outline: 'none',\n    border: 'none',\n    height: 'auto',\n    minHeight: '0',\n\n    /**\n     * Removing fieldGroup border to make sure no border is rendered around the text area in sendbox.\n     */\n    ':after': {\n      border: 'none'\n    }\n  },\n  field: {\n    borderRadius: '0.25rem'\n  }\n};\n/**\n * @private\n */\n\nexport const inputButtonStyle = mergeStyles({\n  color: 'grey',\n  margin: 'auto',\n  width: '1.0625rem',\n  height: '1.0625rem',\n  '&:hover': {\n    backgroundColor: 'transparent'\n  }\n});\n/**\n * @private\n */\n\nexport const inlineButtonsContainerStyle: IStyle = {\n  position: 'absolute',\n  right: '0.3rem',\n  top: '0',\n  bottom: '0',\n  gap: '0.25rem',\n  alignItems: 'center'\n};\n/**\n * @private\n */\n\nexport const newLineButtonsContainerStyle: IStyle = {\n  position: 'absolute',\n  right: '0.8rem',\n  bottom: '0.8rem',\n  gap: '1rem'\n};\n/**\n * @private\n */\n\nexport const inputButtonTooltipStyle = mergeStyles({\n  // The toolTip host container show be a flex box, so that alignItems: 'center' works for inside buttons\n  display: 'flex'\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Theme } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const isDarkThemed = (theme: Theme): boolean => {\n  const themeBlackBrightness = getPerceptualBrightnessOfHexColor(theme.palette.black);\n  const themeWhiteBrightness = getPerceptualBrightnessOfHexColor(theme.palette.white);\n\n  if (Number.isNaN(themeBlackBrightness) || Number.isNaN(themeWhiteBrightness)) {\n    return false;\n  }\n\n  return themeBlackBrightness > themeWhiteBrightness;\n};\n\nconst getPerceptualBrightnessOfHexColor = (hexColor: string): number => {\n  // return NaN if hexColor is not a hex code\n  if (!/^#[0-9A-Fa-f]{6}$/i.test(hexColor)) {\n    return NaN;\n  }\n\n  const r = parseInt(hexColor.substring(1, 3), 16);\n  const g = parseInt(hexColor.substring(3, 5), 16);\n  const b = parseInt(hexColor.substring(5, 7), 16); // arithmetic mean  of the red, green, and blue color coordinates. Source: https://en.wikipedia.org/wiki/Brightness\n\n  return (r + g + b) / 3;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { useState, ReactNode, FormEvent, useCallback } from 'react';\nimport { Stack, TextField, mergeStyles, IStyle, ITextField, concatStyleSets, IconButton, TooltipHost, ICalloutContentStyles } from '@fluentui/react';\nimport { BaseCustomStyles } from '../types';\nimport { inputBoxStyle, inputBoxWrapperStyle, inputButtonStyle, textFieldStyle, textContainerStyle, inlineButtonsContainerStyle, newLineButtonsContainerStyle, inputBoxNewLineSpaceAffordance, inputButtonTooltipStyle } from './styles/InputBoxComponent.style';\nimport { isDarkThemed } from '../theming/themeUtils';\nimport { useTheme } from '../theming';\n/**\n * @private\n */\n\nexport interface InputBoxStylesProps extends BaseCustomStyles {\n  /** Styles for the text field. */\n  textField?: IStyle;\n  /** Styles for the system message; These styles will be ignored when a custom system message component is provided. */\n\n  systemMessage?: IStyle;\n  /** Styles for customizing the container of the text field */\n\n  textFieldContainer?: IStyle;\n}\ntype InputBoxComponentProps = {\n  children: ReactNode;\n  /**\n   * Inline child elements passed in. Setting to false will mean they are on a new line.\n   */\n\n  inlineChildren: boolean;\n  'data-ui-id'?: string;\n  id?: string;\n  textValue: string;\n  onChange: (event: FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string | undefined) => void;\n  textFieldRef?: React.RefObject<ITextField>;\n  inputClassName?: string;\n  placeholderText?: string;\n  supportNewline?: boolean;\n  maxLength: number;\n  onKeyDown?: (ev: React.KeyboardEvent<HTMLInputElement | HTMLTextAreaElement>) => void;\n  onEnterKeyDown?: () => void;\n  errorMessage?: string | React.ReactElement;\n  disabled?: boolean;\n  styles?: InputBoxStylesProps;\n  autoFocus?: 'sendBoxTextField';\n};\n/**\n * @private\n */\n\nexport const InputBoxComponent = (props: InputBoxComponentProps): JSX.Element => {\n  const {\n    styles,\n    id,\n    'data-ui-id': dataUiId,\n    textValue,\n    onChange,\n    textFieldRef,\n    placeholderText,\n    onKeyDown,\n    onEnterKeyDown,\n    supportNewline,\n    inputClassName,\n    errorMessage,\n    disabled,\n    children\n  } = props;\n  const mergedRootStyle = mergeStyles(inputBoxWrapperStyle, styles?.root);\n  const mergedTextFiledStyle = mergeStyles(inputBoxStyle, inputClassName, props.inlineChildren ? {} : inputBoxNewLineSpaceAffordance);\n  const mergedTextContainerStyle = mergeStyles(textContainerStyle, styles?.textFieldContainer);\n  const mergedTextFieldStyle = concatStyleSets(textFieldStyle, {\n    fieldGroup: styles?.textField,\n    errorMessage: styles?.systemMessage\n  });\n  const onTexFieldKeyDown = useCallback((ev: React.KeyboardEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    // Uses KeyCode 229 and which code 229 to determine if the press of the enter key is from a composition session or not (Safari only)\n    if (ev.nativeEvent.isComposing || ev.nativeEvent.keyCode === 229 || ev.nativeEvent.which === 229) {\n      return;\n    }\n\n    if (ev.key === 'Enter' && (ev.shiftKey === false || !supportNewline)) {\n      ev.preventDefault();\n      onEnterKeyDown && onEnterKeyDown();\n    }\n\n    onKeyDown && onKeyDown(ev);\n  }, [onEnterKeyDown, onKeyDown, supportNewline]);\n  return <Stack className={mergedRootStyle}>\n      <div className={mergedTextContainerStyle}>\n        <TextField autoFocus={props.autoFocus === 'sendBoxTextField'} data-ui-id={dataUiId} multiline autoAdjustHeight multiple={false} resizable={false} componentRef={textFieldRef} id={id} inputClassName={mergedTextFiledStyle} placeholder={placeholderText} value={textValue} onChange={onChange} autoComplete=\"off\" onKeyDown={onTexFieldKeyDown} styles={mergedTextFieldStyle} disabled={disabled} errorMessage={errorMessage} />\n        <Stack horizontal className={mergeStyles(props.inlineChildren ? inlineButtonsContainerStyle : newLineButtonsContainerStyle)}>\n          {children}\n        </Stack>\n      </div>\n    </Stack>;\n};\n/**\n * Props for displaying a send button besides the text input area.\n *\n * @private\n */\n\nexport type InputBoxButtonProps = {\n  onRenderIcon: (isHover: boolean) => JSX.Element;\n  onClick: (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => void;\n  className?: string;\n  id?: string;\n  ariaLabel?: string;\n  tooltipContent?: string;\n};\n/**\n * @private\n */\n\nexport const InputBoxButton = (props: InputBoxButtonProps): JSX.Element => {\n  const {\n    onRenderIcon,\n    onClick,\n    ariaLabel,\n    className,\n    id,\n    tooltipContent\n  } = props;\n  const [isHover, setIsHover] = useState(false);\n  const mergedButtonStyle = mergeStyles(inputButtonStyle, className);\n  const theme = useTheme();\n  const calloutStyle: Partial<ICalloutContentStyles> = {\n    root: {\n      padding: 0\n    },\n    calloutMain: {\n      padding: '0.5rem'\n    }\n  }; // Place callout with no gap between it and the button.\n\n  const calloutProps = {\n    gapSpace: 0,\n    styles: calloutStyle,\n    backgroundColor: isDarkThemed(theme) ? theme.palette.neutralLighter : ''\n  };\n  return <TooltipHost hostClassName={inputButtonTooltipStyle} content={tooltipContent} calloutProps={{ ...calloutProps\n  }}>\n      <IconButton className={mergedButtonStyle} ariaLabel={ariaLabel} onClick={onClick} id={id} onMouseEnter={() => {\n      setIsHover(true);\n    }} onMouseLeave={() => {\n      setIsHover(false);\n    }} onRenderIcon={() => onRenderIcon(isHover)} />\n    </TooltipHost>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const buttonStyle = mergeStyles({\n  color: 'grey',\n  margin: '0',\n  padding: '0',\n  width: '1.0625rem',\n  height: '1.0625rem',\n  border: 'none',\n  minWidth: '0',\n  '&:hover': {\n    backgroundColor: 'transparent'\n  }\n});\n/**\n * @private\n */\n\nexport const iconWrapperStyle = mergeStyles({\n  position: 'absolute',\n  pointerEvents: 'none'\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { DefaultButton, ICalloutContentStyles, mergeStyles, TooltipHost } from '@fluentui/react';\nimport React, { useState } from 'react';\nimport { iconWrapperStyle, buttonStyle } from './styles/VoiceOverButton.style';\nimport { useTheme } from '../theming';\nimport { isDarkThemed } from '../theming/themeUtils';\nimport { InputBoxButtonProps } from './InputBoxComponent';\nimport { inputButtonTooltipStyle } from './styles/InputBoxComponent.style';\n/**\n * @private\n */\n\nexport const VoiceOverButton = (props: InputBoxButtonProps): JSX.Element => {\n  const {\n    onRenderIcon,\n    onClick,\n    ariaLabel,\n    className,\n    id,\n    tooltipContent\n  } = props;\n  const [isHover, setIsHover] = useState(false);\n  const mergedButtonStyle = mergeStyles(buttonStyle, className);\n  const theme = useTheme();\n  const calloutStyle: Partial<ICalloutContentStyles> = {\n    root: {\n      padding: 0\n    },\n    calloutMain: {\n      padding: '0.5rem'\n    }\n  }; // Place callout with no gap between it and the button.\n\n  const calloutProps = {\n    gapSpace: 0,\n    styles: calloutStyle,\n    backgroundColor: isDarkThemed(theme) ? theme.palette.neutralLighter : ''\n  };\n  return <TooltipHost hostClassName={inputButtonTooltipStyle} content={tooltipContent} calloutProps={{ ...calloutProps\n  }}>\n      <DefaultButton className={mergedButtonStyle} ariaLabel={ariaLabel} onClick={onClick} id={id} onMouseEnter={() => {\n      setIsHover(true);\n    }} onMouseLeave={() => {\n      setIsHover(false);\n    }} />\n      {\n      /* VoiceOver fix: Avoid rerender of DefaultButton above that handles clicking and hovering by keeping rerendering icon separate */\n    }\n      <div className={iconWrapperStyle}>{onRenderIcon(isHover)}</div>\n    </TooltipHost>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStackStyles, Stack } from '@fluentui/react';\nimport React from 'react';\n/**\n * @internal\n *  aria props for this hidden component.\n */\n\nexport type AnnouncerProps = {\n  announcementString?: string;\n  ariaLive: 'off' | 'polite' | 'assertive' | undefined;\n};\n/**\n * @internal\n * Announcer component to maker aria announcements on actions\n */\n\nexport const Announcer = (props: AnnouncerProps): JSX.Element => {\n  const {\n    announcementString,\n    ariaLive\n  } = props;\n  return <Stack aria-label={announcementString} aria-live={ariaLive} styles={announcerStyles}></Stack>;\n};\n/**\n * Styles to hide the announcer from view but still existing on the DOM tree it so that narration can happen.\n */\n\nconst announcerStyles: IStackStyles = {\n  root: {\n    position: 'absolute',\n    width: '1px',\n    height: '1px',\n    padding: 0,\n    margin: '-1px',\n    overflow: 'hidden',\n    clip: 'rect(0,0,0,0)',\n    whiteSpace: 'nowrap',\n    border: 0\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { MessageBar, MessageBarType } from '@fluentui/react';\nimport React, { useEffect } from 'react';\nimport { Announcer } from './Announcer';\n/**\n * @beta\n * Error to be displayed to the user in an error bar above sendbox.\n */\n\nexport interface SendBoxErrorBarError {\n  /** Error Message to be displayed */\n  message: string;\n  /**\n   * Unix Timestamp. Preferred generation using `Date.now()`\n   */\n\n  timestamp: number;\n}\n/**\n * @private\n */\n\nexport interface SendBoxErrorBarProps {\n  /** Error to render */\n  error?: SendBoxErrorBarError;\n  /**\n   * Automatically dismisses the error bar after the specified delay in ms.\n   * Example: `10 * 1000` would be 10 seconds\n   */\n\n  dismissAfterMs?: number;\n  /**\n   * Callback to invoke when the error bar is dismissed\n   */\n\n  onDismiss?: () => void;\n}\n/**\n * @private\n */\n\nexport const SendBoxErrorBar = (props: SendBoxErrorBarProps): JSX.Element => {\n  const {\n    error,\n    dismissAfterMs,\n    onDismiss\n  } = props;\n  const [errorMessage, setErrorMessage] = React.useState(error?.message); // Using `any` because `NodeJS.Timeout` here will cause `declaration error` with jest.\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n  const timeoutRef = React.useRef<any>();\n  React.useEffect(() => {\n    setErrorMessage(error?.message);\n  }, [error]);\n  useEffect(() => {\n    if (error && dismissAfterMs !== undefined) {\n      timeoutRef.current = setTimeout(() => {\n        setErrorMessage(undefined);\n        onDismiss && onDismiss();\n      }, dismissAfterMs);\n    }\n\n    return () => {\n      timeoutRef.current && clearTimeout(timeoutRef.current);\n    };\n  }, [dismissAfterMs, onDismiss, error]);\n\n  if (errorMessage) {\n    return <>\n        <Announcer announcementString={errorMessage} ariaLive={'polite'} />\n        <MessageBar messageBarType={MessageBarType.warning} styles={{\n        iconContainer: {\n          display: 'none'\n        }\n      }}>\n          {errorMessage}\n        </MessageBar>\n      </>;\n  } else {\n    return <></>;\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React from 'react';\nimport { SendBoxErrorBar, SendBoxErrorBarError } from './SendBoxErrorBar';\n/**\n * @private\n */\n\nexport interface SendBoxErrorsProps {\n  fileUploadsPendingError?: SendBoxErrorBarError;\n  fileUploadError?: SendBoxErrorBarError;\n}\n/**\n * @private\n */\n\nexport const SendBoxErrors = (props: SendBoxErrorsProps): JSX.Element => {\n  const {\n    fileUploadError,\n    fileUploadsPendingError\n  } = props;\n  const errorToDisplay = React.useMemo(() => {\n    if (fileUploadError && fileUploadsPendingError) {\n      return fileUploadError.timestamp > fileUploadsPendingError.timestamp ? fileUploadError : fileUploadsPendingError;\n    }\n\n    return fileUploadError || fileUploadsPendingError;\n  }, [fileUploadError, fileUploadsPendingError]);\n  return <SendBoxErrorBar error={errorToDisplay} dismissAfterMs={10 * 1000} />;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { useState, useMemo, useCallback } from 'react';\nimport { IStyle, ITextField, mergeStyles, concatStyleSets, Icon, Stack } from '@fluentui/react';\nimport { sendBoxStyle, sendButtonStyle, sendIconStyle, sendBoxWrapperStyles, borderAndBoxShadowStyle } from './styles/SendBox.styles';\nimport { BaseCustomStyles } from '../types';\nimport { useTheme } from '../theming';\nimport { useLocale } from '../localization';\nimport { useIdentifiers } from '../identifiers';\nimport { InputBoxComponent } from './InputBoxComponent';\nimport { VoiceOverButton } from './VoiceOverButton';\nimport { SendBoxErrors } from './SendBoxErrors';\nimport { SendBoxErrorBarError } from './SendBoxErrorBar';\nconst EMPTY_MESSAGE_REGEX = /^\\s*$/;\nconst MAXIMUM_LENGTH_OF_MESSAGE = 8000;\n/**\n * Fluent styles for {@link Sendbox}.\n *\n * @public\n */\n\nexport interface SendBoxStylesProps extends BaseCustomStyles {\n  /** Styles for the text field. */\n  textField?: IStyle;\n  /** styles for the text field container */\n\n  textFieldContainer?: IStyle;\n  /** Styles for the container of the send message icon. */\n\n  sendMessageIconContainer?: IStyle;\n  /** Styles for the send message icon; These styles will be ignored when a custom send message icon is provided. */\n\n  sendMessageIcon?: IStyle;\n  /** Styles for the system message; These styles will be ignored when a custom system message component is provided. */\n\n  systemMessage?: IStyle;\n}\n/**\n * Attributes required for SendBox to show file uploads like name, progress etc.\n * @beta\n */\n\nexport interface ActiveFileUpload {\n  /**\n   * Unique identifier for the file upload.\n   */\n  id: string;\n  /**\n   * File name to be rendered for uploaded file.\n   */\n\n  filename: string;\n  /**\n   * A number between 0 and 1 indicating the progress of the upload.\n   * This is unrelated to the `uploadComplete` property.\n   * It is only used to show the progress of the upload.\n   * Progress of 1 doesn't mark the upload as complete, set the `uploadComplete`\n   * property to true to mark the upload as complete.\n   */\n\n  progress: number;\n  /**\n   * Error to be displayed to the user if the upload fails.\n   */\n\n  error?: SendBoxErrorBarError;\n  /**\n   * `true` means that the upload is completed.\n   * This is independent of the upload `progress`.\n   */\n\n  uploadComplete?: boolean;\n}\n/**\n * Strings of {@link SendBox} that can be overridden.\n *\n * @public\n */\n\nexport interface SendBoxStrings {\n  /**\n   * Placeholder text in SendBox when there is no user input\n   */\n  placeholderText: string;\n  /**\n   * The warning message when send box text length is more than max limit\n   */\n\n  textTooLong: string;\n  /**\n   * Aria label for send message button\n   */\n\n  sendButtonAriaLabel: string;\n}\n/**\n * Props for {@link SendBox}.\n *\n * @public\n */\n\nexport interface SendBoxProps {\n  /**\n   * Optional boolean to disable text box\n   * @defaultValue false\n   */\n  disabled?: boolean;\n  /**\n   * Optional text for system message below text box\n   */\n\n  systemMessage?: string;\n  /**\n   * Optional callback called when message is sent\n   */\n\n  onSendMessage?: (content: string) => Promise<void>;\n  /**\n   * Optional callback called when user is typing\n   */\n\n  onTyping?: () => Promise<void>;\n  /**\n   * Optional callback to render system message below the SendBox.\n   * @defaultValue MessageBar\n   */\n\n  onRenderSystemMessage?: (systemMessage: string | undefined) => React.ReactElement;\n  /**\n   * Optional boolean to support new line in SendBox.\n   * @defaultValue false\n   */\n\n  supportNewline?: boolean;\n  /**\n   * Optional callback to render send button icon to the right of the SendBox.\n   * @defaultValue SendBoxSendHovered icon when mouse over icon and SendBoxSend icon otherwise\n   */\n\n  onRenderIcon?: (isHover: boolean) => JSX.Element;\n  /**\n   * Allows users to pass in an object contains custom CSS styles.\n   * @Example\n   * ```\n   * <SendBox styles={{ root: { background: 'blue' } }} />\n   * ```\n   */\n\n  styles?: SendBoxStylesProps;\n  /**\n   * Optional strings to override in component\n   */\n\n  strings?: Partial<SendBoxStrings>;\n  /**\n   * enumerable to determine if the input box has focus on render or not.\n   * When undefined nothing has focus on render\n   */\n\n  autoFocus?: 'sendBoxTextField';\n}\n/**\n * Component for typing and sending messages.\n *\n * Supports sending typing notification when user starts entering text.\n * Supports an optional message below the text input field.\n *\n * @public\n */\n\nexport const SendBox = (props: SendBoxProps): JSX.Element => {\n  const {\n    disabled,\n    systemMessage,\n    supportNewline,\n    onSendMessage,\n    onTyping,\n    onRenderIcon,\n    onRenderSystemMessage,\n    styles,\n    autoFocus\n  } = props;\n  const theme = useTheme();\n  const localeStrings = useLocale().strings.sendBox;\n  const strings = { ...localeStrings,\n    ...props.strings\n  };\n  const ids = useIdentifiers();\n  const activeFileUploads = activeFileUploadsTrampoline(props);\n  const [textValue, setTextValue] = useState('');\n  const [textValueOverflow, setTextValueOverflow] = useState(false);\n  const sendTextFieldRef = React.useRef<ITextField>(null);\n  const [fileUploadsPendingError, setFileUploadsPendingError] = useState<SendBoxErrorBarError | undefined>(undefined);\n\n  const sendMessageOnClick = (): void => {\n    // don't send a message when disabled\n    if (disabled || textValueOverflow) {\n      return;\n    } // Don't send message until all files have been uploaded successfully\n\n\n    setFileUploadsPendingError(undefined);\n\n    if (hasIncompleteFileUploads(props)) {\n      return;\n    } // we dont want to send empty messages including spaces, newlines, tabs\n    // Message can be empty if there is a valid file upload\n\n\n    if (!EMPTY_MESSAGE_REGEX.test(textValue) || hasFile(props)) {\n      onSendMessage && onSendMessage(sanitizeText(textValue));\n      setTextValue('');\n    }\n\n    sendTextFieldRef.current?.focus();\n  };\n\n  const setText = (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string | undefined): void => {\n    if (newValue === undefined) {\n      return;\n    }\n\n    if (newValue.length > MAXIMUM_LENGTH_OF_MESSAGE) {\n      setTextValueOverflow(true);\n    } else {\n      setTextValueOverflow(false);\n    }\n\n    setTextValue(newValue);\n  };\n\n  const textTooLongMessage = textValueOverflow ? strings.textTooLong : undefined;\n  const errorMessage = systemMessage ?? textTooLongMessage;\n  const mergedSendButtonStyle = useMemo(() => mergeStyles(sendButtonStyle, styles?.sendMessageIconContainer), [styles?.sendMessageIconContainer]);\n  const mergedStyles = useMemo(() => concatStyleSets(styles), [styles]);\n  const hasText = !!textValue;\n  const hasTextOrFile = hasText || hasFile(props);\n  const mergedSendIconStyle = useMemo(() => mergeStyles(sendIconStyle, {\n    color: !!errorMessage || !hasTextOrFile ? theme.palette.neutralTertiary : theme.palette.themePrimary\n  }, styles?.sendMessageIcon), [errorMessage, hasTextOrFile, theme, styles?.sendMessageIcon]);\n  const onRenderSendIcon = useCallback((isHover: boolean) => onRenderIcon ? onRenderIcon(isHover) : <Icon iconName={isHover && textValue ? 'SendBoxSendHovered' : 'SendBoxSend'} className={mergedSendIconStyle} />, [mergedSendIconStyle, onRenderIcon, textValue]); // Ensure that errors are cleared when there are no files in sendbox\n\n  React.useEffect(() => {\n    if (!activeFileUploads?.filter(upload => !upload.error).length) {\n      setFileUploadsPendingError(undefined);\n    }\n  }, [activeFileUploads]);\n  const sendBoxErrorsProps = useMemo(() => {\n    return {\n      fileUploadsPendingError: fileUploadsPendingError,\n      fileUploadError: activeFileUploads?.filter(fileUpload => fileUpload.error).pop()?.error\n    };\n  }, [activeFileUploads, fileUploadsPendingError]);\n  return <Stack className={mergeStyles(sendBoxWrapperStyles)}>\n      <SendBoxErrors {...sendBoxErrorsProps} />\n      <Stack className={mergeStyles(borderAndBoxShadowStyle({\n      theme,\n      hasErrorMessage: !!errorMessage,\n      disabled: !!disabled\n    }))}>\n        <InputBoxComponent autoFocus={autoFocus} data-ui-id={ids.sendboxTextField} inlineChildren={true} disabled={disabled} errorMessage={onRenderSystemMessage ? onRenderSystemMessage(errorMessage) : errorMessage} textFieldRef={sendTextFieldRef} id=\"sendbox\" inputClassName={sendBoxStyle} placeholderText={strings.placeholderText} textValue={textValue} onChange={setText} onKeyDown={() => {\n        onTyping && onTyping();\n      }} onEnterKeyDown={() => {\n        sendMessageOnClick();\n      }} styles={mergedStyles} supportNewline={supportNewline} maxLength={MAXIMUM_LENGTH_OF_MESSAGE}>\n          <VoiceOverButton onRenderIcon={onRenderSendIcon} onClick={e => {\n          if (!textValueOverflow) {\n            sendMessageOnClick();\n          }\n\n          e.stopPropagation();\n        }} id={'sendIconWrapper'} className={mergedSendButtonStyle} ariaLabel={localeStrings.sendButtonAriaLabel} tooltipContent={localeStrings.sendButtonAriaLabel} />\n        </InputBoxComponent>\n        {}\n      </Stack>\n    </Stack>;\n};\n/**\n * @private\n */\n\nconst hasIncompleteFileUploads = (props: SendBoxProps): boolean => {\n  const activeFileUploads = activeFileUploadsTrampoline(props);\n  return !!(activeFileUploads?.length && !activeFileUploads.filter(fileUpload => !fileUpload.error).every(fileUpload => fileUpload.uploadComplete));\n};\n\nconst hasFile = (props: SendBoxProps): boolean => {\n  const activeFileUploads = activeFileUploadsTrampoline(props);\n  return !!activeFileUploads?.find(file => !file.error);\n  return false;\n};\n\nconst sanitizeText = (message: string): string => {\n  if (EMPTY_MESSAGE_REGEX.test(message)) {\n    return '';\n  } else {\n    return message;\n  }\n};\n\nconst activeFileUploadsTrampoline = (props: SendBoxProps): ActiveFileUpload[] | undefined => {\n  return [];\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles } from '@fluentui/react';\n/** @private */\n\nexport const MESSAGE_STATUS_INDICATOR_SIZE_REM = 1;\n/**\n * ErrorIcon seems designed slightly smaller than other icons we try to match the size and then fix positioning here.\n *\n * @private\n */\n\nexport const MessageStatusIndicatorErrorIconStyle = mergeStyles({\n  marginRight: '-0.06rem',\n  fontSize: '1.06rem'\n});\n/**\n * @private\n */\n\nexport const MessageStatusIndicatorIconStyle = mergeStyles({\n  fontSize: `${MESSAGE_STATUS_INDICATOR_SIZE_REM}rem`,\n  width: `${MESSAGE_STATUS_INDICATOR_SIZE_REM}rem`,\n  height: `${MESSAGE_STATUS_INDICATOR_SIZE_REM}rem`\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ICalloutContentStyles, Icon, ITooltipHostStyles, mergeStyles, TooltipHost } from '@fluentui/react';\nimport { MessageStatus, _formatString } from '@internal/acs-ui-common';\nimport React, { useState } from 'react';\nimport { LiveMessage } from 'react-aria-live';\nimport { useLocale } from '../localization';\nimport { useTheme } from '../theming';\nimport { isDarkThemed } from '../theming/themeUtils';\nimport { BaseCustomStyles } from '../types';\nimport { MessageStatusIndicatorErrorIconStyle, MessageStatusIndicatorIconStyle } from './styles/MessageStatusIndicator.styles';\n/**\n * Strings of {@link MessageStatusIndicator} that can be overridden.\n *\n * @public\n */\n\nexport interface MessageStatusIndicatorStrings {\n  /** Aria label to notify user when their message has been delivered. */\n  deliveredAriaLabel?: string;\n  /** Text to display in the delivered message icon tooltip. */\n\n  deliveredTooltipText: string;\n  /** Aria label to notify user when their message has been seen by others. */\n\n  seenAriaLabel?: string;\n  /** Text to display in the seen message icon tooltip if read number/ participant number is 1 */\n\n  seenTooltipText: string;\n  /** Text to display in the seen message icon tooltip if read number logic is working correctly (more than 1 read number and more than 1 particiants)*/\n\n  readByTooltipText?: string;\n  /** Aria label to notify user when their message is being sent. */\n\n  sendingAriaLabel?: string;\n  /** Text to display in the sending message icon tooltip. */\n\n  sendingTooltipText: string;\n  /** Aria label to notify user when their message has failed to be sent. */\n\n  failedToSendAriaLabel?: string;\n  /** Text to display in the failed message icon tooltip. */\n\n  failedToSendTooltipText: string;\n}\n/**\n * Props for {@link MessageStatusIndicator}.\n *\n * @public\n */\n\nexport interface MessageStatusIndicatorProps {\n  /** Message status that determines the icon to display. */\n  status?: MessageStatus;\n  readCount?: number;\n  onToggleToolTip?: (isToggled: boolean) => void;\n  /** number of participants not including myself */\n\n  remoteParticipantsCount?: number;\n  /**\n   * Allows users to pass an object containing custom CSS styles.\n   * @Example\n   * ```\n   * <MessageStatus styles={{ root: { background: 'blue' } }} />\n   * ```\n   */\n\n  styles?: BaseCustomStyles;\n  /**\n   * Optional strings to override in component\n   */\n\n  strings?: MessageStatusIndicatorStrings;\n}\n/**\n * Component to display the status of a sent message.\n *\n * Adds an icon and tooltip corresponding to the message status.\n *\n * @public\n */\n\nexport const MessageStatusIndicator = (props: MessageStatusIndicatorProps): JSX.Element => {\n  const {\n    status,\n    styles,\n    remoteParticipantsCount,\n    onToggleToolTip,\n    readCount\n  } = props;\n  const localeStrings = useLocale().strings.messageStatusIndicator;\n  const [isTooltipToggled, setIsTooltipToggled] = useState<boolean>(false);\n  const strings = { ...localeStrings,\n    ...props.strings\n  };\n  const theme = useTheme();\n  const calloutStyle: Partial<ICalloutContentStyles> = {\n    root: {\n      padding: 0\n    },\n    calloutMain: {\n      padding: '0.5rem'\n    }\n  }; // Place callout with no gap between it and the button.\n\n  const calloutProps = {\n    gapSpace: 0,\n    styles: calloutStyle,\n    backgroundColor: isDarkThemed(theme) ? theme.palette.neutralLighter : ''\n  };\n\n  switch (status) {\n    case 'failed':\n      return <TooltipHost content={strings.failedToSendTooltipText} data-ui-id=\"chat-composite-message-tooltip\" calloutProps={{ ...calloutProps\n      }} styles={hostStyles}>\n          {strings.failedToSendAriaLabel && // live message is used here and in the following tooltips so that aria labels are announced on mobile\n        <LiveMessage message={strings.failedToSendAriaLabel} aria-live=\"polite\" />}\n          <Icon role=\"status\" data-ui-id=\"chat-composite-message-status-icon\" aria-label={strings.failedToSendAriaLabel} iconName=\"MessageFailed\" className={mergeStyles(MessageStatusIndicatorErrorIconStyle, {\n          color: theme.palette.redDark\n        }, styles?.root)} />\n        </TooltipHost>;\n\n    case 'sending':\n      return <TooltipHost content={strings.sendingTooltipText} data-ui-id=\"chat-composite-message-tooltip\" calloutProps={{ ...calloutProps\n      }} styles={hostStyles}>\n          {strings.sendingAriaLabel && <LiveMessage message={strings.sendingAriaLabel} aria-live=\"polite\" />}\n\n          <Icon role=\"status\" data-ui-id=\"chat-composite-message-status-icon\" aria-label={strings.sendingAriaLabel} iconName=\"MessageSending\" className={mergeStyles(MessageStatusIndicatorIconStyle, {\n          color: theme.palette.themePrimary\n        }, styles?.root)} />\n        </TooltipHost>;\n\n    case 'seen':\n      return <TooltipHost calloutProps={{ ...calloutProps\n      }} data-ui-id=\"chat-composite-message-tooltip\" styles={hostStyles} content={// when it's just 1 to 1 texting, we don't need to know who has read the message, just show message as 'seen'\n      // when readcount is 0, we have a bug, show 'seen' to cover up as a fall back\n      // when participant count is 0, we have a bug, show 'seen' to cover up as a fall back\n      readCount === 0 || remoteParticipantsCount && remoteParticipantsCount <= 1 || !readCount || !remoteParticipantsCount || strings.readByTooltipText === undefined ? strings.seenTooltipText : _formatString(strings.readByTooltipText, {\n        messageThreadReadCount: `${readCount}`,\n        remoteParticipantsCount: `${remoteParticipantsCount}`\n      })} onTooltipToggle={() => {\n        if (onToggleToolTip) {\n          onToggleToolTip(!isTooltipToggled);\n          setIsTooltipToggled(!isTooltipToggled);\n        }\n      }}>\n          {strings.seenAriaLabel && <LiveMessage message={strings.seenAriaLabel} aria-live=\"polite\" />}\n\n          <Icon data-ui-id=\"chat-composite-message-status-icon\" role=\"status\" aria-label={strings.seenAriaLabel} iconName=\"MessageSeen\" className={mergeStyles({\n          color: theme.palette.themePrimary\n        }, styles?.root)} />\n        </TooltipHost>;\n\n    case 'delivered':\n      return <TooltipHost calloutProps={{ ...calloutProps\n      }} content={strings.deliveredTooltipText} data-ui-id=\"chat-composite-message-tooltip\" styles={hostStyles}>\n          {strings.deliveredAriaLabel && <LiveMessage message={strings.deliveredAriaLabel} aria-live=\"polite\" />}\n          <Icon role=\"status\" data-ui-id=\"chat-composite-message-status-icon\" aria-label={strings.deliveredAriaLabel} iconName=\"MessageDelivered\" className={mergeStyles(MessageStatusIndicatorIconStyle, {\n          color: theme.palette.themePrimary\n        }, styles?.root)} />\n        </TooltipHost>;\n\n    default:\n      return <></>;\n  }\n}; // The TooltipHost root uses display: inline by default.\n// To prevent sizing issues or tooltip positioning issues, we override to inline-block.\n// For more details see \"Icon Button with Tooltip\" on https://developer.microsoft.com/en-us/fluentui#/controls/web/button\n\nconst hostStyles: Partial<ITooltipHostStyles> = {\n  root: {\n    display: 'inline-block'\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IButtonStyles, mergeStyles } from '@fluentui/react';\nimport { ComponentSlotStyle } from '@fluentui/react-northstar';\nimport { CSSProperties } from 'react';\nimport { MESSAGE_STATUS_INDICATOR_SIZE_REM } from './MessageStatusIndicator.styles'; // Minimum chat bubble width. This matches the minimum chat bubble width from FluentUI\n// that can contain a message and a timestamp.\n\nconst CHAT_MESSAGE_CONTAINER_MIN_WIDTH_REM = 6.25; // Chat messages should span just short of the width of the container.\n// When calculating the width of a message we also must take into account\n// the width of the avatar/gutter and the gap between the message and avatar/gutter.\n\nconst AVATAR_WIDTH_REM = 2;\nconst AVATAR_MESSAGE_GAP_REM = 0.5;\nconst MESSAGE_AMOUNT_OUT_FROM_EDGE_REM = 2; // Avatars should display on top of chat messages when the chat thread is narrow\n\nconst MESSAGE_AVATAR_OVERLAP_REM = 0.425;\nconst CHAT_MESSAGE_ZINDEX = 1;\nconst AVATAR_ZINDEX = 2; // new message button should be on top of chat message\n\nconst NEW_MESSAGE_BUTTON_ZINDEX = 2;\n/**\n * @private\n */\n\nexport const messageThreadContainerStyle = mergeStyles({\n  height: '100%',\n  width: '100%',\n  maxHeight: '100%',\n  overflow: 'auto',\n  position: 'relative',\n  alignSelf: 'center'\n});\n/**\n * @private\n */\n\nexport const noMessageStatusStyle = mergeStyles({\n  // This should match the size of the message status indicator icon to ensure\n  // multiple messages sent by the user are aligned correctly.\n  width: `${MESSAGE_STATUS_INDICATOR_SIZE_REM}rem`\n});\n/**\n * @private\n */\n\nexport const chatStyle: ComponentSlotStyle = {\n  paddingBottom: '0.5rem',\n  paddingTop: '0.8rem',\n  border: 'none',\n  overflow: 'auto',\n  // `height: 100%` ensures that the Chat component covers 100% of it's parents height\n  // to prevent intermittent scrollbars when gifs are present in the chat.\n  height: '100%'\n};\n/**\n * @private\n */\n\nexport const newMessageButtonContainerStyle = mergeStyles({\n  position: 'absolute',\n  zIndex: NEW_MESSAGE_BUTTON_ZINDEX,\n  bottom: 0,\n  right: '1.5rem'\n});\n/**\n * @private\n */\n\nexport const chatMessageStyle: CSSProperties = {\n  overflowY: 'hidden'\n};\n/**\n * @private\n */\n\nexport const chatMessageDateStyle: CSSProperties = {\n  fontWeight: 600\n};\n/**\n * @private\n */\n\nexport const defaultChatItemMessageContainer = (overlapAvatarAndMessage: boolean): ComponentSlotStyle => {\n  const messageAvatarGap = overlapAvatarAndMessage ? -MESSAGE_AVATAR_OVERLAP_REM : AVATAR_MESSAGE_GAP_REM;\n  return {\n    marginRight: '0rem',\n    marginLeft: `${messageAvatarGap}rem`,\n    width: `calc(100% - ${AVATAR_WIDTH_REM + MESSAGE_AMOUNT_OUT_FROM_EDGE_REM + messageAvatarGap}rem)`,\n    zIndex: CHAT_MESSAGE_ZINDEX\n  };\n};\n/**\n * @private\n */\n\nexport const defaultMyChatMessageContainer: ComponentSlotStyle = {\n  maxWidth: '100%',\n  minWidth: `${CHAT_MESSAGE_CONTAINER_MIN_WIDTH_REM}rem`,\n  marginLeft: '0rem',\n  // This makes message bubble show border in high contrast mode making each message distinguishable\n  border: '1px solid transparent'\n};\n/**\n * @private\n */\n\nexport const FailedMyChatMessageContainer: ComponentSlotStyle = { ...defaultChatItemMessageContainer,\n  backgroundColor: 'rgba(168, 0, 0, 0.2)'\n};\n/**\n * @private\n */\n\nexport const defaultChatMessageContainer: ComponentSlotStyle = {\n  maxWidth: '100%',\n  minWidth: `${CHAT_MESSAGE_CONTAINER_MIN_WIDTH_REM}rem`,\n  marginRight: '0rem',\n  '& img': {\n    maxWidth: '100% !important',\n    // Add !important to make sure it won't be overridden by style defined in element\n    height: 'auto !important'\n  },\n  '& p': {\n    // Deal with awkward padding seen in messages from Teams.\n    // For more info see https://github.com/Azure/communication-ui-library/pull/1507\n    marginBlock: '0.125rem'\n  },\n  // This makes message bubble show border in high contrast mode making each message distinguishable\n  border: '1px solid transparent'\n};\n/**\n * @private\n */\n\nexport const gutterWithAvatar: ComponentSlotStyle = {\n  width: `${AVATAR_WIDTH_REM}`,\n  position: 'relative',\n  float: 'left',\n  display: 'block',\n  visibility: 'visible',\n  zIndex: AVATAR_ZINDEX\n};\n/**\n * @private\n */\n\nexport const gutterWithHiddenAvatar: ComponentSlotStyle = { ...gutterWithAvatar,\n  visibility: 'hidden',\n  // we use this hidden avatar just as a width placeholder\n  // the placeholder is needed for responsive bubble width\n  height: 0\n};\n/**\n * @private\n */\n\nexport const messageStatusContainerStyle = (mine: boolean): string => mergeStyles({\n  marginLeft: mine ? '0.25rem' : '0rem'\n});\n/**\n * @private\n */\n\nexport const newMessageButtonStyle = mergeStyles({\n  float: 'right',\n  width: 'fit-content'\n});\n/**\n * @private\n */\n\nexport const buttonWithIconStyles: IButtonStyles = {\n  textContainer: {\n    display: 'contents'\n  }\n};\n/**\n * @private\n */\n\nexport const loadPreviousMessageButtonStyle = mergeStyles({\n  border: 'none',\n  minHeight: '1.5rem',\n  '&:hover': {\n    background: 'none'\n  },\n  '&:active': {\n    background: 'none'\n  }\n});\n/**\n * @private\n */\n\nexport const DownIconStyle = mergeStyles({\n  marginRight: '0.5em'\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/**\n * @private\n */\nexport const delay = (delay: number): Promise<void> => {\n  return new Promise(function (resolve) {\n    setTimeout(resolve, delay);\n  });\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const systemMessageIconStyle = mergeStyles({\n  margin: '0 0.688rem 0 0'\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStyle, FontIcon, mergeStyles, Stack, Text } from '@fluentui/react';\nimport { ComponentSlotStyle } from '@fluentui/react-northstar';\nimport React from 'react';\nimport { systemMessageIconStyle } from './styles/SystemMessage.styles';\n/**\n * Todo: We need to add more types of system messages that we support.\n *\n * @private\n */\n\nexport type SystemMessageIconTypes = 'PeopleAdd' | 'PeopleBlock' | 'Edit';\n/**\n * @private\n */\n\nexport type SystemMessageProps = {\n  /**\n   * Icon name for the system message.\n   */\n  iconName: SystemMessageIconTypes;\n  /**\n   * Content string for the system message.\n   */\n\n  content: string;\n  /*\n   * Custom CSS Style for the system message container.\n   */\n\n  containerStyle?: ComponentSlotStyle;\n};\n/**\n * @private\n */\n\nexport const SystemMessage = (props: SystemMessageProps): JSX.Element => {\n  const {\n    iconName,\n    content\n  } = props;\n  const Icon: JSX.Element = <FontIcon iconName={iconName} className={mergeStyles(systemMessageIconStyle)} />;\n  return <Stack horizontal className={mergeStyles((props?.containerStyle as IStyle))} tabIndex={0}>\n      {Icon}\n      <Text style={{\n      wordBreak: 'break-word'\n    }} role=\"status\" title={content}>\n        {content}\n      </Text>\n    </Stack>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const editBoxStyle = (inlineEditButtons: boolean): string => mergeStyles({\n  marginTop: '0.0875rem',\n  marginBottom: '0.0875rem',\n  // @TODO future refactor: This is being used to give enough space to the accept/reject edits buttons\n  // This space affordance should be handled by the InputBoxComponent not the here (by the parent of the InputBoxComponent)\n  paddingRight: inlineEditButtons ? '3.25rem' : '0.5rem'\n});\n/**\n * @private\n */\n\nexport const editingButtonStyle = mergeStyles({\n  margin: 'auto .3rem'\n});\n/**\n * @private\n */\n\nexport const inputBoxIcon = mergeStyles({\n  margin: 'auto',\n  '&:hover svg': {\n    stroke: 'currentColor'\n  }\n});\n/**\n * @private\n */\n\nexport const editBoxStyleSet = {\n  root: {\n    width: '100%'\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { _FileUploadCardsStrings } from '../FileUploadCards';\nimport { ParticipantState } from '../../types';\n/**\n * Conditionally modify locale strings passed to the file card\n * @returns file upload card strings\n */\n\nexport const useLocaleFileCardStringsTrampoline = (): _FileUploadCardsStrings => {\n  return {\n    removeFile: '',\n    uploadCompleted: '',\n    uploading: ''\n  };\n};\n/**\n * Identify if a participant state if part of the Calling states or Hold states.\n */\n\nexport const _isParticipantStateCallingOrHold = (participantState?: ParticipantState): boolean => {\n  return !!participantState && ['Idle', 'Connecting', 'EarlyMedia', 'Ringing', 'Hold'].includes(participantState);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { // eslint-disable-next-line no-restricted-imports\nIcon, IProgressIndicatorStyleProps, IProgressIndicatorStyles, IStyleFunctionOrObject, mergeStyles, ProgressIndicator, Stack, Text, useTheme } from '@fluentui/react';\nimport { getFileTypeIconProps } from '@fluentui/react-file-type-icons';\nimport React from 'react';\nimport { _pxToRem } from '@internal/acs-ui-common';\nimport { Announcer } from './Announcer';\nimport { useEffect, useState } from 'react';\nimport { _FileUploadCardsStrings } from './FileUploadCards';\nimport { useLocaleFileCardStringsTrampoline } from './utils/common';\n/**\n * @internal\n * _FileCard Component Props.\n */\n\nexport interface _FileCardProps {\n  /**\n   * File name.\n   */\n  fileName: string;\n  /**\n   * Extension of the file used for rendering the file icon.\n   */\n\n  fileExtension: string;\n  /**\n   * File upload progress percentage between 0 and 1.\n   * File transfer progress indicator is only shown when the value is greater than 0 and less than 1.\n   */\n\n  progress?: number;\n  /**\n   * Icon to display for actions like download, upload, etc. along the file name.\n   */\n\n  actionIcon?: JSX.Element;\n  /**\n   * Function that runs when actionIcon is clicked\n   */\n\n  actionHandler?: () => void;\n  /**\n   * Optional arialabel strings for file cards\n   */\n\n  strings?: _FileUploadCardsStrings;\n}\n/**\n * @internal\n * A component for displaying a file card with file icon and progress bar.\n */\n\nexport const _FileCard = (props: _FileCardProps): JSX.Element => {\n  const {\n    fileName,\n    fileExtension,\n    progress,\n    actionIcon\n  } = props;\n  const theme = useTheme();\n  const [announcerString, setAnnouncerString] = useState<string | undefined>(undefined);\n  const localeStrings = useLocaleFileCardStringsTrampoline();\n  const uploadStartedString = props.strings?.uploading ?? localeStrings.uploading;\n  const uploadCompletedString = props.strings?.uploadCompleted ?? localeStrings.uploadCompleted;\n  const showProgressIndicator = progress !== undefined && progress > 0 && progress < 1;\n  useEffect(() => {\n    if (showProgressIndicator) {\n      setAnnouncerString(`${uploadStartedString} ${fileName}`);\n    } else if (progress === 1) {\n      setAnnouncerString(`${fileName} ${uploadCompletedString}`);\n    } else {\n      setAnnouncerString(undefined);\n    }\n  }, [progress, showProgressIndicator, fileName, uploadStartedString, uploadCompletedString]);\n  const progressBarThicknessPx = 4;\n  const containerClassName = mergeStyles({\n    width: '12rem',\n    background: theme.palette.neutralLighter,\n    borderRadius: theme.effects.roundedCorner4,\n    border: `${_pxToRem(1)} solid ${theme.palette.neutralQuaternary}`,\n    cursor: 'pointer'\n  });\n  const fileInfoWrapperClassName = mergeStyles({\n    padding: _pxToRem(12),\n    // To make space for the progress indicator.\n    paddingBottom: showProgressIndicator ? _pxToRem(12 - progressBarThicknessPx * 2) : _pxToRem(12)\n  });\n  const fileNameContainerClassName = mergeStyles({\n    paddingLeft: _pxToRem(4),\n    minWidth: '75%',\n    maxWidth: '75%'\n  });\n  const fileNameTextClassName = mergeStyles({\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    lineHeight: 'normal',\n    whiteSpace: 'nowrap',\n    paddingRight: _pxToRem(4)\n  });\n  const actionIconClassName = mergeStyles({\n    cursor: 'pointer'\n  });\n  const progressIndicatorStyles: IStyleFunctionOrObject<IProgressIndicatorStyleProps, IProgressIndicatorStyles> = {\n    itemProgress: {\n      padding: `${_pxToRem(progressBarThicknessPx - 1)} 0`,\n      // item progress height won't apply without an explicit padding\n      // To make the progress indicator border curve along the bottom of file card.\n      borderRadius: `0 0 ${theme.effects.roundedCorner4} ${theme.effects.roundedCorner4}`\n    },\n    progressBar: {\n      height: _pxToRem(progressBarThicknessPx)\n    }\n  };\n  return <div data-is-focusable={true}>\n      <Announcer announcementString={announcerString} ariaLive={'polite'} />\n      <Stack className={containerClassName} onClick={() => {\n      props.actionHandler?.();\n    }}>\n        <Stack horizontal horizontalAlign=\"space-between\" verticalAlign=\"center\" className={fileInfoWrapperClassName}>\n          <Stack>\n            {\n            /* We are not using <ChatCompositeIcon /> here as we currently do not support customizing these filetype icons. */\n          }\n            <Icon data-ui-id={'filetype-icon'} {...getFileTypeIconProps({\n            extension: fileExtension,\n            size: 24,\n            imageFileType: 'svg'\n          })} />\n          </Stack>\n          <Stack className={fileNameContainerClassName}>\n            <Text className={fileNameTextClassName}>{fileName}</Text>\n          </Stack>\n          <Stack verticalAlign=\"center\" className={actionIconClassName}>\n            {actionIcon && actionIcon}\n          </Stack>\n        </Stack>\n        {showProgressIndicator && <ProgressIndicator percentComplete={progress} styles={progressIndicatorStyles} />}\n      </Stack>\n    </div>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles, Stack } from '@fluentui/react';\nimport { _pxToRem } from '@internal/acs-ui-common';\nimport React from 'react';\n/**\n * @internal\n * Props for `_FileCardGroup` component.\n */\n\nexport interface _FileCardGroupProps {\n  children: React.ReactNode;\n}\n/**\n * Note: If we use stack tokens.childrenGap, when child elements are wrapped and moved to the next line,\n * an extra margin is added to the left of each line.\n * This is a workaround to avoid this issue.\n */\n\nconst fileCardGroupClassName = mergeStyles({\n  flexFlow: 'row wrap',\n  '& > *': {\n    margin: _pxToRem(2)\n  },\n\n  /**\n   * margin for children is overriden by parent stack, so adding left margin for each child\n   */\n  '& > *:not(:first-child)': {\n    marginLeft: _pxToRem(2)\n  }\n});\n/**\n * @internal\n * Used with `_FileCard` component where `_FileCard` components are passed as children.\n * Renders the children equally spaced in multiple rows.\n */\n\nexport const _FileCardGroup = (props: _FileCardGroupProps): JSX.Element => {\n  const {\n    children\n  } = props;\n\n  if (!children) {\n    return <></>;\n  }\n\n  return <Stack horizontal className={fileCardGroupClassName}>\n      {children}\n    </Stack>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const iconButtonClassName = mergeStyles({\n  color: 'unset',\n  width: '1rem',\n  height: '1rem',\n  background: 'transparent',\n  ':hover': {\n    color: 'unset',\n    background: 'transparent'\n  }\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Icon, IconButton } from '@fluentui/react';\nimport React from 'react';\nimport { ActiveFileUpload } from './SendBox';\nimport { _FileCard } from './FileCard';\nimport { _FileCardGroup } from './FileCardGroup';\nimport { extension } from './utils';\nimport { iconButtonClassName } from './styles/IconButton.styles';\nimport { useMemo } from 'react';\nimport { useLocaleFileCardStringsTrampoline } from './utils/common';\n/**\n * Strings of _FileUploadCards that can be overridden.\n *\n * @internal\n */\n\nexport interface _FileUploadCardsStrings {\n  /** Aria label to notify user when focus is on cancel file upload button. */\n  removeFile: string;\n  /** Aria label to notify user file uploading starts. */\n\n  uploading: string;\n  /** Aria label to notify user file is uploaded. */\n\n  uploadCompleted: string;\n}\n/**\n * @internal\n */\n\nexport interface FileUploadCardsProps {\n  /**\n   * Optional array of active file uploads where each object has attibutes\n   * of a file upload like name, progress, errormessage etc.\n   */\n  activeFileUploads?: ActiveFileUpload[];\n  /**\n   * Optional callback to remove the file upload before sending by clicking on\n   * cancel icon.\n   */\n\n  onCancelFileUpload?: (fileId: string) => void;\n  /**\n   * Optional arialabel strings for file upload cards\n   */\n\n  strings?: _FileUploadCardsStrings;\n}\nconst actionIconStyle = {\n  height: '1rem'\n};\n/**\n * @internal\n */\n\nexport const _FileUploadCards = (props: FileUploadCardsProps): JSX.Element => {\n  const files = props.activeFileUploads;\n  const localeStrings = useLocaleFileCardStringsTrampoline();\n  const removeFileButtonString = useMemo(() => () => {\n    return props.strings?.removeFile ?? localeStrings.removeFile; // Return download button without aria label\n\n    return props.strings?.removeFile ?? '';\n  }, [props.strings?.removeFile, localeStrings.removeFile]);\n\n  if (!files || files.length === 0) {\n    return <></>;\n  }\n\n  return <_FileCardGroup>\n      {files && files.filter(file => !file.error).map(file => <_FileCard fileName={file.filename} progress={file.progress} key={file.id} fileExtension={extension(file.filename)} actionIcon={<IconButton className={iconButtonClassName} ariaLabel={removeFileButtonString()}>\n                  <Icon iconName=\"CancelFileUpload\" style={actionIconStyle} />\n                </IconButton>} actionHandler={() => {\n      props.onCancelFileUpload && props.onCancelFileUpload(file.id);\n    }} strings={props.strings} />)}\n    </_FileCardGroup>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { concatStyleSets, Icon, ITextField, mergeStyles, Stack } from '@fluentui/react';\nimport { _formatString } from '@internal/acs-ui-common';\nimport { useTheme } from '../../theming/FluentThemeProvider';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { editBoxStyle, inputBoxIcon, editingButtonStyle, editBoxStyleSet } from '../styles/EditBox.styles';\nimport { InputBoxButton, InputBoxComponent } from '../InputBoxComponent';\nimport { MessageThreadStrings } from '../MessageThread';\nimport { borderAndBoxShadowStyle } from '../styles/SendBox.styles';\nimport { ChatMessage } from '../../types';\nimport { _FileUploadCards } from '../FileUploadCards';\nimport { FileMetadata } from '../FileDownloadCards';\nconst MAXIMUM_LENGTH_OF_MESSAGE = 8000;\n\nconst onRenderCancelIcon = (color: string): JSX.Element => {\n  const className = mergeStyles(inputBoxIcon, {\n    color\n  });\n  return <Icon iconName={'EditBoxCancel'} className={className} />;\n};\n\nconst onRenderSubmitIcon = (color: string): JSX.Element => {\n  const className = mergeStyles(inputBoxIcon, {\n    color\n  });\n  return <Icon iconName={'EditBoxSubmit'} className={className} />;\n};\n/** @private */\n\n\nexport type ChatMessageComponentAsEditBoxProps = {\n  onCancel?: () => void;\n  onSubmit: (text: string, metadata?: Record<string, string>, options?: {\n    attachedFilesMetadata?: FileMetadata[];\n  }) => void;\n  message: ChatMessage;\n  strings: MessageThreadStrings;\n  /**\n   * Inline the accept and reject edit buttons when editing a message.\n   * Setting to false will mean they are on a new line inside the editable chat message.\n   */\n\n  inlineEditButtons: boolean;\n};\ntype MessageState = 'OK' | 'too short' | 'too long';\n/**\n * @private\n */\n\nexport const ChatMessageComponentAsEditBox = (props: ChatMessageComponentAsEditBoxProps): JSX.Element => {\n  const {\n    onCancel,\n    onSubmit,\n    strings,\n    message\n  } = props;\n  const [textValue, setTextValue] = useState<string>(message.content || '');\n  const [attachedFilesMetadata, setAttachedFilesMetadata] = React.useState(getMessageAttachedFilesMetadata(message));\n  const editTextFieldRef = React.useRef<ITextField>(null);\n  const theme = useTheme();\n  const messageState = getMessageState(textValue, attachedFilesMetadata ?? []);\n  const submitEnabled = messageState === 'OK';\n  useEffect(() => {\n    editTextFieldRef.current?.focus();\n  }, []);\n\n  const setText = (event: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string | undefined): void => {\n    setTextValue(newValue ?? '');\n  };\n\n  const textTooLongMessage = messageState === 'too long' ? _formatString(strings.editBoxTextLimit, {\n    limitNumber: `${MAXIMUM_LENGTH_OF_MESSAGE}`\n  }) : undefined;\n  const onRenderThemedCancelIcon = useCallback(() => onRenderCancelIcon(theme.palette.neutralSecondary), [theme.palette.neutralSecondary]);\n  const onRenderThemedSubmitIcon = useCallback(() => onRenderSubmitIcon(theme.palette.neutralSecondary), [theme.palette.neutralSecondary]);\n  const editBoxStyles = useMemo(() => {\n    return concatStyleSets(editBoxStyleSet, {\n      textField: {\n        borderColor: theme.palette.themePrimary\n      }\n    });\n  }, [theme.palette.themePrimary]);\n  const onRenderFileUploads = useCallback(() => {\n    return attachedFilesMetadata?.length && <div style={{\n      margin: '0.25rem'\n    }}>\n          <_FileUploadCards activeFileUploads={attachedFilesMetadata?.map(file => ({\n        id: file.name,\n        filename: file.name,\n        progress: 1\n      }))} onCancelFileUpload={fileId => {\n        setAttachedFilesMetadata(attachedFilesMetadata?.filter(file => file.name !== fileId));\n      }} />\n        </div>;\n  }, [attachedFilesMetadata]);\n  return <Stack className={mergeStyles(borderAndBoxShadowStyle({\n    theme,\n    hasErrorMessage: false,\n    disabled: false\n  }))}>\n      <InputBoxComponent inlineChildren={props.inlineEditButtons} id={'editbox'} textFieldRef={editTextFieldRef} inputClassName={editBoxStyle(props.inlineEditButtons)} placeholderText={strings.editBoxPlaceholderText} textValue={textValue} onChange={setText} onEnterKeyDown={() => {\n      submitEnabled && onSubmit(textValue, message.metadata, {\n        attachedFilesMetadata\n      });\n    }} supportNewline={false} maxLength={MAXIMUM_LENGTH_OF_MESSAGE} errorMessage={textTooLongMessage} styles={editBoxStyles}>\n        <InputBoxButton className={editingButtonStyle} ariaLabel={strings.editBoxCancelButton} tooltipContent={strings.editBoxCancelButton} onRenderIcon={onRenderThemedCancelIcon} onClick={() => {\n        onCancel && onCancel();\n      }} id={'dismissIconWrapper'} />\n        <InputBoxButton className={editingButtonStyle} ariaLabel={strings.editBoxSubmitButton} tooltipContent={strings.editBoxSubmitButton} onRenderIcon={onRenderThemedSubmitIcon} onClick={e => {\n        submitEnabled && onSubmit(textValue, message.metadata, {\n          attachedFilesMetadata\n        });\n        e.stopPropagation();\n      }} id={'submitIconWrapper'} />\n      </InputBoxComponent>\n      {onRenderFileUploads()}\n    </Stack>;\n};\n\nconst isMessageTooLong = (messageText: string): boolean => messageText.length > MAXIMUM_LENGTH_OF_MESSAGE;\n\nconst isMessageEmpty = (messageText: string, attachedFilesMetadata: FileMetadata[]): boolean => messageText.trim().length === 0 && attachedFilesMetadata.length === 0;\n\nconst getMessageState = (messageText: string, attachedFilesMetadata: FileMetadata[]): MessageState => isMessageEmpty(messageText, attachedFilesMetadata) ? 'too short' : isMessageTooLong(messageText) ? 'too long' : 'OK'; // @TODO: Remove when file-sharing feature becomes stable.\n\n\nconst getMessageAttachedFilesMetadata = (message: ChatMessage): FileMetadata[] | undefined => {\n  return [];\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles, IStyle, FontWeights, Theme, IContextualMenuItemStyles, ITheme, IIconStyles } from '@fluentui/react';\nimport { _pxToRem } from '@internal/acs-ui-common';\nconst MINIMUM_TOUCH_TARGET_HEIGHT_REM = 3;\n/**\n * @private\n */\n\nexport const chatActionsCSS: IStyle = {\n  'ul&': {\n    right: '0',\n    left: 'auto',\n    top: '-1.2rem',\n    bottom: 'auto',\n    position: 'absolute'\n  },\n  '& a': {\n    margin: '0',\n    padding: '0',\n    border: '0'\n  }\n};\n/**\n * @private\n */\n\nexport const iconWrapperStyle = (theme: ITheme, isSubMenuOpen: boolean): IIconStyles => ({\n  root: {\n    margin: _pxToRem(3),\n    // Show hover styles when the Edit/Delete menu is showing as this action button is still considered 'active'\n    color: isSubMenuOpen ? theme.palette.black : theme.palette.neutralPrimary,\n    strokeWidth: isSubMenuOpen ? _pxToRem(0.5) : _pxToRem(0),\n    stroke: theme.palette.black,\n    ':hover, :focus': {\n      color: theme.palette.black,\n      strokeWidth: _pxToRem(0.5)\n    }\n  }\n});\n/**\n * @private\n */\n\nexport const chatMessageDateStyle = mergeStyles({\n  fontWeight: FontWeights.semibold\n});\n/**\n * @private\n */\n\nexport const chatMessageEditedTagStyle = (theme: Theme): string => mergeStyles({\n  fontWeight: FontWeights.semibold,\n  color: theme.palette.neutralSecondary\n});\n/**\n * @private\n */\n\nexport const chatMessageFailedTagStyle = (theme: Theme): string => mergeStyles({\n  fontWeight: FontWeights.light,\n  color: theme.semanticColors.errorText\n});\n/**\n * @private\n */\n\nexport const chatMessageMenuStyle = mergeStyles({\n  minWidth: '8.5rem',\n  height: 'max-content',\n  cursor: 'pointer',\n  overflow: 'hidden'\n});\n/**\n * Styles that can be applied to ensure flyout items have the minimum touch target size.\n *\n * @private\n */\n\nexport const menuItemIncreasedSizeStyles: IContextualMenuItemStyles = {\n  root: {\n    height: `${MINIMUM_TOUCH_TARGET_HEIGHT_REM}rem`,\n    lineHeight: `${MINIMUM_TOUCH_TARGET_HEIGHT_REM}rem`,\n    maxHeight: 'unset'\n  },\n  linkContent: {\n    height: `${MINIMUM_TOUCH_TARGET_HEIGHT_REM}rem`,\n    lineHeight: `${MINIMUM_TOUCH_TARGET_HEIGHT_REM}rem`,\n    maxHeight: 'unset'\n  },\n  icon: {\n    maxHeight: 'unset'\n  }\n};\n/**\n * @private\n */\n\nexport const menuIconStyleSet = {\n  root: {\n    height: 'calc(100% - 8px)',\n    // Adjust for the pixel margin Fluent applies\n    width: '1.25rem'\n  }\n};\n/**\n * @private\n */\n\nexport const menuSubIconStyleSet = {\n  root: {\n    height: 'unset',\n    lineHeight: '100%',\n    width: '1.25rem'\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { MessageThreadStrings } from '../MessageThread';\n/**\n * @private\n */\n\nexport const formatTimeForChatMessage = (messageDate: Date): string => {\n  let hours = messageDate.getHours();\n  let minutes = messageDate.getMinutes().toString();\n  const isAm = hours < 12;\n\n  if (hours > 12) {\n    hours = hours - 12;\n  }\n\n  if (hours === 0) {\n    hours = 12;\n  }\n\n  if (minutes.length < 2) {\n    minutes = '0' + minutes;\n  }\n\n  return hours.toString() + ':' + minutes + ' ' + (isAm ? 'a.m.' : 'p.m.');\n};\n/**\n * @private\n */\n\nexport const formatDateForChatMessage = (messageDate: Date): string => {\n  const year = messageDate.getFullYear().toString();\n  let month = (messageDate.getMonth() + 1).toString();\n  let day = messageDate.getDate().toString();\n\n  if (month.length === 1) {\n    month = '0' + month;\n  }\n\n  if (day.length === 1) {\n    day = '0' + day;\n  }\n\n  return year + '-' + month + '-' + day;\n};\n/**\n * Given a message date object in ISO8601 and a current date object, generates a user friendly timestamp text like the\n * following:\n *\n * 1:30 p.m.\n * Yesterday 1:30 p.m.\n * Monday 1:30 p.m.\n * 2021-01-10 1:30 p.m.\n *\n * If message is after yesterday, then only show the time.\n * If message is before yesteray and after day before yesterday, then show 'Yesterday' plus the time.\n * If message is before day before yesterday and within the current week, then show 'Monday/Tuesday/etc' plus the time.\n *   - We consider start of the week as Sunday. If current day is Sunday, then any time before that is in previous week.\n * If message is in previous or older weeks, then show date string plus the time.\n *\n * @param messageDate - date of message\n * @param currentDate - date used as offset to create the user friendly timestamp (e.g. to create 'Yesterday' instead of an absolute date)\n *\n * @private\n */\n\nexport const formatTimestampForChatMessage = (messageDate: Date, todayDate: Date, dateStrings: MessageThreadStrings): string => {\n  // If message was in the same day timestamp string is just the time like '1:30 p.m.'.\n  const startOfDay = new Date(todayDate.getFullYear(), todayDate.getMonth(), todayDate.getDate());\n\n  if (messageDate > startOfDay) {\n    return formatTimeForChatMessage(messageDate);\n  } // If message was yesterday then timestamp string is like this 'Yesterday 1:30 p.m.'.\n\n\n  const yesterdayDate = new Date(todayDate.getFullYear(), todayDate.getMonth(), todayDate.getDate() - 1);\n\n  if (messageDate > yesterdayDate) {\n    return dateStrings.yesterday + ' ' + formatTimeForChatMessage(messageDate);\n  } // If message was before Sunday and today is Sunday (start of week) then timestamp string is like\n  // '2021-01-10 1:30 p.m.'.\n\n\n  const weekDay = todayDate.getDay();\n\n  if (weekDay === 0) {\n    return formatDateForChatMessage(messageDate) + ' ' + formatTimeForChatMessage(messageDate);\n  } // If message was before first day of the week then timestamp string is like Monday 1:30 p.m.\n\n\n  const firstDayOfTheWeekDate = new Date(todayDate.getFullYear(), todayDate.getMonth(), todayDate.getDate() - weekDay);\n\n  if (messageDate > firstDayOfTheWeekDate) {\n    return dayToDayName(messageDate.getDay(), dateStrings) + ' ' + formatTimeForChatMessage(messageDate);\n  } // If message date is in previous or older weeks then timestamp string is like 2021-01-10 1:30 p.m.\n\n\n  return formatDateForChatMessage(messageDate) + ' ' + formatTimeForChatMessage(messageDate);\n};\n\nconst dayToDayName = (day: number, dateStrings: MessageThreadStrings): string => {\n  switch (day) {\n    case 0:\n      return dateStrings.sunday;\n\n    case 1:\n      return dateStrings.monday;\n\n    case 2:\n      return dateStrings.tuesday;\n\n    case 3:\n      return dateStrings.wednesday;\n\n    case 4:\n      return dateStrings.thursday;\n\n    case 5:\n      return dateStrings.friday;\n\n    case 6:\n      return dateStrings.saturday;\n\n    default:\n      throw new Error(`Invalid day [${day}] passed`);\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { concatStyleSets, ContextualMenu, DirectionalHint, IContextualMenuItem, IPersona, Persona, PersonaSize, Target, useTheme } from '@fluentui/react';\nimport { _formatString } from '@internal/acs-ui-common';\nimport React, { useMemo } from 'react';\nimport { OnRenderAvatarCallback } from '../../types';\nimport { MessageThreadStrings } from '../MessageThread';\nimport { chatMessageMenuStyle, menuIconStyleSet, menuItemIncreasedSizeStyles, menuSubIconStyleSet } from '../styles/ChatMessageComponent.styles';\n/** @private */\n\nexport interface ChatMessageActionFlyoutProps {\n  target?: Target;\n  hidden: boolean;\n  strings: MessageThreadStrings;\n  onEditClick?: () => void;\n  onRemoveClick?: () => void;\n  onResendClick?: () => void;\n  onDismiss: () => void;\n  messageReadBy?: {\n    id: string;\n    displayName: string;\n  }[];\n  remoteParticipantsCount?: number;\n  messageStatus?: string;\n  /**\n   * Whether the status indicator for each message is displayed or not.\n   */\n\n  showMessageStatus?: boolean;\n  /**\n   * Increase the height of the flyout items.\n   * Recommended when interacting with the chat message using touch.\n   */\n\n  increaseFlyoutItemSize: boolean;\n  /**\n   * Optional callback to override render of the avatar.\n   *\n   * @param userId - user Id\n   */\n\n  onRenderAvatar?: OnRenderAvatarCallback;\n}\n/**\n * Chat message actions flyout that contains actions such as Edit Message, or Remove Message.\n *\n * @private\n */\n\nexport const ChatMessageActionFlyout = (props: ChatMessageActionFlyoutProps): JSX.Element => {\n  const theme = useTheme();\n  const messageReadByCount = props.messageReadBy?.length;\n  const sortedMessageReadyByList = [...(props.messageReadBy ?? [])].sort((a, b) => a.displayName.localeCompare(b.displayName));\n  const messageReadByList: IContextualMenuItem[] | undefined = sortedMessageReadyByList?.map(person => {\n    const personaOptions: IPersona = {\n      hidePersonaDetails: true,\n      size: PersonaSize.size24,\n      text: person.displayName,\n      showOverflowTooltip: false,\n      styles: {\n        root: {\n          margin: '0.25rem'\n        }\n      }\n    };\n    const {\n      onRenderAvatar\n    } = props;\n    return {\n      key: person.displayName,\n      text: person.displayName,\n      itemProps: {\n        styles: props.increaseFlyoutItemSize ? menuItemIncreasedSizeStyles : undefined\n      },\n      onRenderIcon: () => onRenderAvatar ? onRenderAvatar(person.id ?? '', personaOptions) : <Persona {...personaOptions} />,\n      iconProps: {\n        styles: menuIconStyleSet\n      }\n    };\n  });\n  const menuItems = useMemo((): IContextualMenuItem[] => {\n    const items: IContextualMenuItem[] = [{\n      key: 'Edit',\n      'data-ui-id': 'chat-composite-message-contextual-menu-edit-action',\n      text: props.strings.editMessage,\n      itemProps: {\n        styles: props.increaseFlyoutItemSize ? menuItemIncreasedSizeStyles : undefined\n      },\n      iconProps: {\n        iconName: 'MessageEdit',\n        styles: menuIconStyleSet\n      },\n      onClick: props.onEditClick\n    }, {\n      key: 'Remove',\n      text: props.strings.removeMessage,\n      itemProps: {\n        styles: props.increaseFlyoutItemSize ? menuItemIncreasedSizeStyles : undefined\n      },\n      iconProps: {\n        iconName: 'MessageRemove',\n        styles: menuIconStyleSet\n      },\n      onClick: props.onRemoveClick\n    }]; // only show read by x of x if more than 3 participants in total including myself\n    // TODO: change strings.messageReadCount to be required if we can fallback to our own en-us strings for anything that Contoso doesn't provide\n\n    if (props.remoteParticipantsCount && messageReadByCount !== undefined && props.remoteParticipantsCount >= 2 && props.showMessageStatus && props.strings.messageReadCount && props.messageStatus !== 'failed') {\n      items.push({\n        key: 'Read Count',\n        'data-ui-id': 'chat-composite-message-contextual-menu-read-info',\n        text: _formatString(props.strings.messageReadCount, {\n          messageReadByCount: `${messageReadByCount}`,\n          remoteParticipantsCount: `${props.remoteParticipantsCount}`\n        }),\n        itemProps: {\n          styles: concatStyleSets({\n            linkContent: {\n              color: messageReadByCount > 0 ? theme.palette.neutralPrimary : theme.palette.neutralTertiary\n            },\n            root: {\n              borderTop: `1px solid ${theme.palette.neutralLighter}`\n            }\n          }, props.increaseFlyoutItemSize ? menuItemIncreasedSizeStyles : undefined)\n        },\n        calloutProps: preventUnwantedDismissProps,\n        subMenuProps: {\n          id: 'chat-composite-message-contextual-menu-read-name-list',\n          items: messageReadByList ?? [],\n          calloutProps: preventUnwantedDismissProps\n        },\n        iconProps: {\n          iconName: 'MessageSeen',\n          styles: {\n            root: {\n              color: messageReadByCount > 0 ? theme.palette.themeDarkAlt : theme.palette.neutralTertiary\n            }\n          }\n        },\n        submenuIconProps: {\n          iconName: 'HorizontalGalleryRightButton',\n          styles: menuSubIconStyleSet\n        },\n        disabled: messageReadByCount <= 0\n      });\n    } else if (props.messageStatus === 'failed' && props.strings.resendMessage) {\n      items.push({\n        key: 'Resend',\n        text: props.strings.resendMessage,\n        itemProps: {\n          styles: concatStyleSets({\n            linkContent: {\n              color: theme.palette.neutralPrimary\n            },\n            root: {\n              borderTop: `1px solid ${theme.palette.neutralLighter}`\n            }\n          }, props.increaseFlyoutItemSize ? menuItemIncreasedSizeStyles : undefined)\n        },\n        calloutProps: preventUnwantedDismissProps,\n        iconProps: {\n          iconName: 'MessageResend',\n          styles: {\n            root: {\n              color: theme.palette.themeDarkAlt\n            }\n          }\n        },\n        onClick: props.onResendClick\n      });\n    }\n\n    return items;\n  }, [props.strings.editMessage, props.strings.removeMessage, props.strings.messageReadCount, props.strings.resendMessage, props.messageStatus, props.increaseFlyoutItemSize, props.onEditClick, props.onRemoveClick, props.onResendClick, props.remoteParticipantsCount, props.showMessageStatus, messageReadByCount, theme.palette.neutralPrimary, theme.palette.neutralTertiary, theme.palette.neutralLighter, theme.palette.themeDarkAlt, messageReadByList]); // gap space uses pixels\n\n  return <ContextualMenu id=\"chat-composite-message-contextual-menu\" alignTargetEdge={true} gapSpace={5\n  /*px*/\n  } isBeakVisible={false} items={menuItems} hidden={props.hidden} target={props.target} onDismiss={props.onDismiss} directionalHint={DirectionalHint.topRightEdge} className={chatMessageMenuStyle} calloutProps={preventUnwantedDismissProps} />;\n};\n/**\n * Similar to {@link preventDismissOnEvent}, but not prevent dismissing from scrolling, since it is causing bugs in chat thread.\n */\n\nconst preventUnwantedDismissProps = {\n  preventDismissOnEvent: (ev: Event | React.FocusEvent | React.KeyboardEvent | React.MouseEvent): boolean => {\n    return ev.type === 'resize';\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React from 'react';\nimport { _formatString } from '@internal/acs-ui-common';\nimport { Parser } from 'html-to-react';\nimport Linkify from 'react-linkify';\nimport { ChatMessage } from '../../types/ChatMessage';\nimport { LiveMessage } from 'react-aria-live';\nimport { Link } from '@fluentui/react';\ntype ChatMessageContentProps = {\n  message: ChatMessage;\n  liveAuthorIntro: string;\n  messageContentAriaText?: string;\n};\n/** @private */\n\nexport const ChatMessageContent = (props: ChatMessageContentProps): JSX.Element => {\n  switch (props.message.contentType) {\n    case 'text':\n      return MessageContentAsText(props);\n\n    case 'html':\n      return MessageContentAsRichTextHTML(props);\n\n    case 'richtext/html':\n      return MessageContentAsRichTextHTML(props);\n\n    default:\n      console.warn('unknown message content type');\n      return <></>;\n  }\n};\n\nconst MessageContentAsRichTextHTML = (props: ChatMessageContentProps): JSX.Element => {\n  const htmlToReactParser = new Parser();\n\n  const liveAuthor = _formatString(props.liveAuthorIntro, {\n    author: `${props.message.senderDisplayName}`\n  });\n\n  return <div data-ui-status={props.message.status} role=\"text\" aria-text={props.messageContentAriaText}>\n      <LiveMessage message={`${props.message.mine ? '' : liveAuthor} ${extractContent(props.message.content || '')}`} aria-live=\"polite\" />\n      {htmlToReactParser.parse(props.message.content)}\n    </div>;\n};\n\nconst MessageContentAsText = (props: ChatMessageContentProps): JSX.Element => {\n  const liveAuthor = _formatString(props.liveAuthorIntro, {\n    author: `${props.message.senderDisplayName}`\n  });\n\n  return <div data-ui-status={props.message.status} role=\"text\" aria-label={props.messageContentAriaText}>\n      <LiveMessage message={`${props.message.mine ? '' : liveAuthor} ${props.message.content}`} aria-live=\"polite\" />\n      <Linkify componentDecorator={(decoratedHref: string, decoratedText: string, key: number) => {\n      return <Link target=\"_blank\" href={decoratedHref} key={key}>\n              {decoratedText}\n            </Link>;\n    }}>\n        {props.message.content}\n      </Linkify>\n    </div>;\n}; // https://stackoverflow.com/questions/28899298/extract-the-text-out-of-html-string-using-javascript\n\n\nconst extractContent = (s: string): string => {\n  const span = document.createElement('span');\n  span.innerHTML = s;\n  return span.textContent || span.innerText;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Icon, mergeStyles, Theme } from '@fluentui/react';\nimport { MenuProps, Ref } from '@fluentui/react-northstar';\nimport { _formatString } from '@internal/acs-ui-common';\nimport React from 'react';\nimport { chatActionsCSS, iconWrapperStyle } from '../styles/ChatMessageComponent.styles';\n/** @private */\n\nexport type ChatMessageActionMenuProps = MenuProps & {\n  showActionMenu?: boolean | undefined;\n};\n/**\n * Props for the Chat.Message action menu.\n * This is the 3 dots that appear when hovering over one of your own chat messages.\n *\n * @private\n */\n\nexport const chatMessageActionMenuProps = (menuProps: {\n  /** String for aria label that is read by Screen readers */\n  ariaLabel?: string;\n  /** Whether the action menu button is enabled, if not this will always return undefined */\n\n  enabled: boolean;\n  /** Whether to force showing the action menu button - this has no effect if the action menu button is not enabled */\n\n  forceShow: boolean;\n  menuButtonRef: React.MutableRefObject<HTMLElement | null>;\n  onActionButtonClick: () => void;\n  theme: Theme;\n}): ChatMessageActionMenuProps | undefined => {\n  if (!menuProps.enabled) {\n    return undefined;\n  }\n\n  const menuClass = mergeStyles(chatActionsCSS, {\n    'ul&': {\n      boxShadow: menuProps.theme.effects.elevation4,\n      backgroundColor: menuProps.theme.palette.white\n    }\n  });\n  const actionMenuProps: ChatMessageActionMenuProps = {\n    showActionMenu: menuProps.forceShow === true ? true : undefined,\n    iconOnly: true,\n    activeIndex: -1,\n    className: menuClass,\n    onItemClick: () => menuProps.onActionButtonClick(),\n    items: [{\n      children: <Ref innerRef={menuProps.menuButtonRef}>\n            <Icon iconName=\"ChatMessageOptions\" data-ui-id=\"chat-composite-message-action-icon\" aria-label={menuProps.ariaLabel} styles={iconWrapperStyle(menuProps.theme, menuProps.forceShow)} />\n          </Ref>,\n      key: 'menuButton',\n      indicator: false\n    }]\n  };\n  return actionMenuProps;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Icon, IconButton, Spinner, SpinnerSize } from '@fluentui/react';\nimport React, { useCallback, useState } from 'react';\nimport { useMemo } from 'react';\nimport { _FileCard } from './FileCard';\nimport { _FileCardGroup } from './FileCardGroup';\nimport { iconButtonClassName } from './styles/IconButton.styles';\n/**\n * Meta Data containing information about the uploaded file.\n * @beta\n */\n\nexport interface FileMetadata {\n  /**\n   * File name to be displayed.\n   */\n  name: string;\n  /**\n   * Extension is used for rendering the file icon.\n   * An unknown extension will be rendered as a generic icon.\n   * Example: `jpeg`\n   */\n\n  extension: string;\n  /**\n   * Download URL for the file.\n   */\n\n  url: string;\n}\n/**\n * Strings of _FileDownloadCards that can be overridden.\n *\n * @internal\n */\n\nexport interface _FileDownloadCardsStrings {\n  /** Aria label to notify user when focus is on file download button. */\n  downloadFile: string;\n}\n/**\n * @beta\n * A file download error returned via a {@link FileDownloadHandler}.\n * This error message is used to render an error message in the UI.\n */\n\nexport interface FileDownloadError {\n  /** The error message to display in the UI */\n  errorMessage: string;\n}\n/**\n * @beta\n *\n * A callback function for handling file downloads.\n * The function needs to return a promise that resolves to a file download URL.\n * If the promise is rejected, the {@link Error.message} will be used to display an error message to the user.\n *\n * @example\n * ```ts\n * const fileDownloadHandler: FileDownloadHandler = async (userId, fileData) => {\n *   if (isUnauthorizedUser(userId)) {\n *     return { errorMessage: 'You dont have permission to download this file.' };\n *   } else {\n *     return new URL(fileData.url);\n *   }\n * }\n *\n * const App = () => (\n *   <ChatComposite\n *     ...\n *     fileSharing={{\n *       fileDownloadHandler: fileDownloadHandler\n *     }}\n *   />\n * )\n *\n * ```\n * @param userId - The user ID of the user downloading the file.\n * @param fileMetadata - The {@link FileMetadata} containing file `url`, `extension` and `name`.\n */\n\nexport type FileDownloadHandler = (userId: string, fileMetadata: FileMetadata) => Promise<URL | FileDownloadError>;\n/**\n * @internal\n */\n\nexport interface _FileDownloadCards {\n  /**\n   * User id of the local participant\n   */\n  userId: string;\n  /**\n   * A chat message metadata that inculdes file metadata\n   */\n\n  fileMetadata: FileMetadata[];\n  /**\n   * A function of type {@link FileDownloadHandler} for handling file downloads.\n   * If the function is not specified, the file's `url` will be opened in a new tab to\n   * initiate the download.\n   */\n\n  downloadHandler?: FileDownloadHandler;\n  /**\n   * Optional callback that runs if downloadHandler returns {@link FileDownloadError}.\n   */\n\n  onDownloadErrorMessage?: (errMsg: string) => void;\n  /**\n   * Optional arialabel strings for file download cards\n   */\n\n  strings?: _FileDownloadCardsStrings;\n}\nconst fileDownloadCardsStyle = {\n  marginTop: '0.25rem'\n};\nconst actionIconStyle = {\n  height: '1rem'\n};\n/**\n * @internal\n */\n\nexport const _FileDownloadCards = (props: _FileDownloadCards): JSX.Element => {\n  const {\n    userId,\n    fileMetadata\n  } = props;\n  const [showSpinner, setShowSpinner] = useState(false);\n  const localeStrings = useLocaleStringsTrampoline();\n  const downloadFileButtonString = useMemo(() => () => {\n    return props.strings?.downloadFile ?? localeStrings.downloadFile; // Return download button without aria label\n\n    return props.strings?.downloadFile ?? '';\n  }, [props.strings?.downloadFile, localeStrings.downloadFile]);\n  const fileDownloadHandler = useCallback(async (userId, file) => {\n    if (!props.downloadHandler) {\n      window.open(file.url, '_blank', 'noopener,noreferrer');\n    } else {\n      setShowSpinner(true);\n\n      try {\n        const response = await props.downloadHandler(userId, file);\n        setShowSpinner(false);\n\n        if (response instanceof URL) {\n          window.open(response.toString(), '_blank', 'noopener,noreferrer');\n        } else {\n          props.onDownloadErrorMessage && props.onDownloadErrorMessage(response.errorMessage);\n        }\n      } finally {\n        setShowSpinner(false);\n      }\n    }\n  }, [props]);\n\n  if (!fileMetadata || fileMetadata.length === 0) {\n    return <></>;\n  }\n\n  return <div style={fileDownloadCardsStyle} data-ui-id=\"file-download-card-group\">\n      <_FileCardGroup>\n        {fileMetadata && fileMetadata.map(file => <_FileCard fileName={file.name} key={file.name} fileExtension={file.extension} actionIcon={showSpinner ? <Spinner size={SpinnerSize.medium} aria-live={'polite'} role={'status'} /> : <IconButton className={iconButtonClassName} ariaLabel={downloadFileButtonString()}>\n                    <DownloadIconTrampoline />\n                  </IconButton>} actionHandler={() => fileDownloadHandler(userId, file)} />)}\n      </_FileCardGroup>\n    </div>;\n};\n/**\n * @private\n */\n\nconst DownloadIconTrampoline = (): JSX.Element => {\n  // Return _some_ available icon, as the real icon is beta-only.\n  return <Icon iconName=\"EditBoxCancel\" style={actionIconStyle} />;\n};\n\nconst useLocaleStringsTrampoline = (): _FileDownloadCardsStrings => {\n  return {\n    downloadFile: ''\n  };\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStyle, mergeStyles } from '@fluentui/react';\nimport { Chat, Text, ComponentSlotStyle } from '@fluentui/react-northstar';\nimport { _formatString } from '@internal/acs-ui-common';\nimport React, { useCallback, useRef, useState } from 'react';\nimport { chatMessageEditedTagStyle, chatMessageDateStyle, chatMessageFailedTagStyle } from '../styles/ChatMessageComponent.styles';\nimport { formatTimeForChatMessage, formatTimestampForChatMessage } from '../utils/Datetime';\nimport { useIdentifiers } from '../../identifiers/IdentifierProvider';\nimport { useTheme } from '../../theming';\nimport { ChatMessageActionFlyout } from './ChatMessageActionsFlyout';\nimport { ChatMessageContent } from './ChatMessageContent';\nimport { ChatMessage } from '../../types/ChatMessage';\nimport { MessageThreadStrings } from '../MessageThread';\nimport { chatMessageActionMenuProps } from './ChatMessageActionMenu';\nimport { OnRenderAvatarCallback } from '../../types';\nimport { _FileDownloadCards, FileDownloadHandler } from '../FileDownloadCards';\nimport { ComponentLocale, useLocale } from '../../localization';\ntype ChatMessageComponentAsMessageBubbleProps = {\n  message: ChatMessage;\n  messageContainerStyle?: ComponentSlotStyle;\n  showDate?: boolean;\n  disableEditing?: boolean;\n  onEditClick: () => void;\n  onRemoveClick?: () => void;\n  onResendClick?: () => void;\n  strings: MessageThreadStrings;\n  userId: string;\n  messageStatus?: string;\n  /**\n   * Whether the status indicator for each message is displayed or not.\n   */\n\n  showMessageStatus?: boolean;\n  /**\n   * Optional callback to render uploaded files in the message component.\n   */\n\n  onRenderFileDownloads?: (userId: string, message: ChatMessage) => JSX.Element;\n  /**\n   * Optional function called when someone clicks on the file download icon.\n   */\n\n  fileDownloadHandler?: FileDownloadHandler;\n  remoteParticipantsCount?: number;\n  onActionButtonClick: (message: ChatMessage, setMessageReadBy: (readBy: {\n    id: string;\n    displayName: string;\n  }[]) => void) => void;\n  /**\n   * Optional callback to override render of the avatar.\n   *\n   * @param userId - user Id\n   */\n\n  onRenderAvatar?: OnRenderAvatarCallback;\n  /**\n   * Optional function to provide customized date format.\n   * @beta\n   */\n\n  onDisplayDateTimeString?: (messageDate: Date) => string;\n};\n\nconst generateDefaultTimestamp = (createdOn: Date, showDate: boolean | undefined, strings: MessageThreadStrings): string => {\n  const formattedTimestamp = showDate ? formatTimestampForChatMessage(createdOn, new Date(), strings) : formatTimeForChatMessage(createdOn);\n  return formattedTimestamp;\n}; // onDisplayDateTimeString from props overwrite onDisplayDateTimeString from locale\n\n\nconst generateCustomizedTimestamp = (props: ChatMessageComponentAsMessageBubbleProps, createdOn: Date, locale: ComponentLocale): string => {\n  return '';\n};\n/** @private */\n\n\nconst MessageBubble = (props: ChatMessageComponentAsMessageBubbleProps): JSX.Element => {\n  const ids = useIdentifiers();\n  const theme = useTheme();\n  const locale = useLocale();\n  const {\n    userId,\n    message,\n    onRemoveClick,\n    onResendClick,\n    disableEditing,\n    showDate,\n    messageContainerStyle,\n    strings,\n    onEditClick,\n    remoteParticipantsCount = 0,\n    onRenderAvatar,\n    showMessageStatus,\n    messageStatus,\n    fileDownloadHandler\n  } = props;\n  const defaultTimeStamp = message.createdOn ? generateDefaultTimestamp(message.createdOn, showDate, strings) : undefined;\n  const customTimestamp = message.createdOn ? generateCustomizedTimestamp(props, message.createdOn, locale) : '';\n  const formattedTimestamp = customTimestamp || defaultTimeStamp; // Track if the action menu was opened by touch - if so we increase the touch targets for the items\n\n  const [wasInteractionByTouch, setWasInteractionByTouch] = useState(false); // The chat message action flyout should target the Chat.Message action menu if clicked,\n  // or target the chat message if opened via touch press.\n  // Undefined indicates the flyout menu should not be being shown.\n\n  const messageRef = useRef<HTMLDivElement | null>(null);\n  const messageActionButtonRef = useRef<HTMLElement | null>(null);\n  const [chatMessageActionFlyoutTarget, setChatMessageActionFlyoutTarget] = useState<React.MutableRefObject<HTMLElement | null> | undefined>(undefined);\n  const chatActionsEnabled = !disableEditing && message.status !== 'sending' && !!message.mine;\n  const [messageReadBy, setMessageReadBy] = useState<{\n    id: string;\n    displayName: string;\n  }[]>([]);\n  const actionMenuProps = wasInteractionByTouch ? undefined : chatMessageActionMenuProps({\n    ariaLabel: strings.actionMenuMoreOptions ?? '',\n    enabled: chatActionsEnabled,\n    menuButtonRef: messageActionButtonRef,\n    // Force show the action button while the flyout is open (otherwise this will dismiss when the pointer is hovered over the flyout)\n    forceShow: chatMessageActionFlyoutTarget === messageActionButtonRef,\n    onActionButtonClick: () => {\n      props.onActionButtonClick(message, setMessageReadBy);\n      setChatMessageActionFlyoutTarget(messageActionButtonRef);\n    },\n    theme\n  });\n  const onActionFlyoutDismiss = useCallback((): void => {\n    // When the flyout dismiss is called, since we control if the action flyout is visible\n    // or not we need to set the target to undefined here to actually hide the action flyout\n    setChatMessageActionFlyoutTarget(undefined);\n  }, [setChatMessageActionFlyoutTarget]);\n  const defaultOnRenderFileDownloads = useCallback(() => <_FileDownloadCards userId={userId} fileMetadata={message['attachedFilesMetadata'] || []} downloadHandler={fileDownloadHandler} />, [userId, message, fileDownloadHandler]);\n  const messageContentAriaText = props.message.content ? props.message.mine ? _formatString(strings.messageContentMineAriaText, {\n    message: props.message.content\n  }) : _formatString(strings.messageContentAriaText, {\n    author: `${props.message.senderDisplayName}`,\n    message: props.message.content\n  }) : undefined;\n  const chatMessage = <>\n      <div ref={messageRef}>\n        <Chat.Message data-ui-id=\"chat-composite-message\" className={mergeStyles((messageContainerStyle as IStyle))} styles={messageContainerStyle} content={<div tabIndex={0}>\n              <ChatMessageContent message={message} liveAuthorIntro={strings.liveAuthorIntro} messageContentAriaText={messageContentAriaText} />\n              {props.onRenderFileDownloads ? props.onRenderFileDownloads(userId, message) : defaultOnRenderFileDownloads()}\n            </div>} author={<Text className={chatMessageDateStyle}>{message.senderDisplayName}</Text>} mine={message.mine} timestamp={<Text data-ui-id={ids.messageTimestamp}>{formattedTimestamp}</Text>} details={messageStatus === 'failed' ? <div className={chatMessageFailedTagStyle(theme)}>{strings.failToSendTag}</div> : message.editedOn ? <div className={chatMessageEditedTagStyle(theme)}>{strings.editedTag}</div> : undefined} positionActionMenu={false} actionMenu={actionMenuProps} onTouchStart={() => setWasInteractionByTouch(true)} onPointerDown={() => setWasInteractionByTouch(false)} onKeyDown={() => setWasInteractionByTouch(false)} onBlur={() => setWasInteractionByTouch(false)} onClick={() => {\n        if (!wasInteractionByTouch) {\n          return;\n        } // If the message was touched via touch we immediately open the menu\n        // flyout (when using mouse the 3-dot menu that appears on hover\n        // must be clicked to open the flyout).\n        // In doing so here we set the target of the flyout to be the message and\n        // not the 3-dot menu button to position the flyout correctly.\n\n\n        setChatMessageActionFlyoutTarget(messageRef);\n        props.onActionButtonClick(message, setMessageReadBy);\n      }} />\n      </div>\n      {chatActionsEnabled && <ChatMessageActionFlyout hidden={!chatMessageActionFlyoutTarget} target={chatMessageActionFlyoutTarget} increaseFlyoutItemSize={wasInteractionByTouch} onDismiss={onActionFlyoutDismiss} onEditClick={onEditClick} onRemoveClick={onRemoveClick} onResendClick={onResendClick} strings={strings} messageReadBy={messageReadBy} messageStatus={messageStatus ?? 'failed'} remoteParticipantsCount={remoteParticipantsCount} onRenderAvatar={onRenderAvatar} showMessageStatus={showMessageStatus} />}\n    </>;\n  return chatMessage;\n};\n/** @private */\n\n\nexport const ChatMessageComponentAsMessageBubble = React.memo(MessageBubble);","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ComponentSlotStyle } from '@fluentui/react-northstar';\nimport { _formatString } from '@internal/acs-ui-common';\nimport React, { useCallback, useState } from 'react';\nimport { ChatMessageComponentAsEditBox } from './ChatMessageComponentAsEditBox';\nimport { MessageThreadStrings } from '../MessageThread';\nimport { ChatMessage, OnRenderAvatarCallback } from '../../types';\nimport { ChatMessageComponentAsMessageBubble } from './ChatMessageComponentAsMessageBubble';\nimport { FileDownloadHandler, FileMetadata } from '../FileDownloadCards';\ntype ChatMessageComponentProps = {\n  message: ChatMessage;\n  userId: string;\n  messageContainerStyle?: ComponentSlotStyle;\n  showDate?: boolean;\n  disableEditing?: boolean;\n  onUpdateMessage?: (messageId: string, content: string, metadata?: Record<string, string>, options?: {\n    attachedFilesMetadata?: FileMetadata[];\n  }) => Promise<void>;\n  onDeleteMessage?: (messageId: string) => Promise<void>;\n  /**\n   * Optional callback called when message is sent\n   */\n\n  onSendMessage?: (content: string) => Promise<void>;\n  strings: MessageThreadStrings;\n  messageStatus?: string;\n  /**\n   * Whether the status indicator for each message is displayed or not.\n   */\n\n  showMessageStatus?: boolean;\n  /**\n   * Inline the accept and reject edit buttons when editing a message.\n   * Setting to false will mean they are on a new line inside the editable chat message.\n   */\n\n  inlineAcceptRejectEditButtons: boolean;\n  /**\n   * Optional callback to render uploaded files in the message component.\n   */\n\n  onRenderFileDownloads?: (userId: string, message: ChatMessage) => JSX.Element;\n  /**\n   * Optional function called when someone clicks on the file download icon.\n   */\n\n  fileDownloadHandler?: FileDownloadHandler;\n  remoteParticipantsCount?: number;\n  onActionButtonClick: (message: ChatMessage, setMessageReadBy: (readBy: {\n    id: string;\n    displayName: string;\n  }[]) => void) => void;\n  /**\n   * Optional callback to override render of the avatar.\n   *\n   * @param userId - user Id\n   */\n\n  onRenderAvatar?: OnRenderAvatarCallback;\n  /**\n   * Optional function to provide customized date format.\n   * @beta\n   */\n\n  onDisplayDateTimeString?: (messageDate: Date) => string;\n};\n/**\n * @private\n */\n\nexport const ChatMessageComponent = (props: ChatMessageComponentProps): JSX.Element => {\n  const [isEditing, setIsEditing] = useState(false);\n  const onEditClick = useCallback(() => setIsEditing(true), [setIsEditing]);\n  const {\n    onDeleteMessage,\n    onSendMessage,\n    message\n  } = props;\n  const onRemoveClick = useCallback(() => {\n    if (onDeleteMessage && message.messageId) {\n      onDeleteMessage(message.messageId);\n    } // when fail to send, message does not have message id, delete message using clientmessageid\n    else if (onDeleteMessage && message.clientMessageId) {\n      onDeleteMessage(message.clientMessageId);\n    }\n  }, [message.messageId, message.clientMessageId, onDeleteMessage]);\n  const onResendClick = useCallback(() => {\n    onDeleteMessage && message.clientMessageId && onDeleteMessage(message.clientMessageId);\n    onSendMessage && onSendMessage(message.content ?? '');\n  }, [message.clientMessageId, message.content, onSendMessage, onDeleteMessage]);\n\n  if (props.message.messageType !== 'chat') {\n    return <></>;\n  } else if (isEditing) {\n    return <ChatMessageComponentAsEditBox message={message} inlineEditButtons={props.inlineAcceptRejectEditButtons} strings={props.strings} onSubmit={async (text, metadata, options) => {\n      props.onUpdateMessage && props.message.messageId && (await props.onUpdateMessage(props.message.messageId, text, metadata, options));\n      setIsEditing(false);\n    }} onCancel={() => {\n      setIsEditing(false);\n    }} />;\n  } else {\n    return <ChatMessageComponentAsMessageBubble {...props} onRemoveClick={onRemoveClick} onEditClick={onEditClick} onResendClick={onResendClick} onRenderAvatar={props.onRenderAvatar} strings={props.strings} />;\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { RefObject, useEffect, useState, useRef } from 'react';\nimport { _convertRemToPx as convertRemToPx } from '@internal/acs-ui-common';\n/**\n * A utility hook for providing the width of a parent element.\n * Returns updated width if parent/window resizes.\n * @param containerRef - Ref of a parent element whose width will be returned.\n * @internal\n */\n\nexport const _useContainerWidth = (containerRef: RefObject<HTMLElement>): number | undefined => {\n  const [width, setWidth] = useState<number | undefined>(undefined);\n  const observer = useRef(new ResizeObserver(entries => {\n    const {\n      width\n    } = entries[0].contentRect;\n    setWidth(width);\n  }));\n  useEffect(() => {\n    if (containerRef.current) {\n      observer.current.observe(containerRef.current);\n    }\n\n    const currentObserver = observer.current;\n    return () => {\n      currentObserver.disconnect();\n    };\n  }, [containerRef, observer]);\n  return width;\n};\n/**\n * A utility hook for providing the height of a parent element.\n * Returns updated height if parent/window resizes.\n * @param containerRef - Ref of a parent element whose height will be returned.\n * @internal\n */\n\nexport const _useContainerHeight = (containerRef: RefObject<HTMLElement>): number | undefined => {\n  const [height, setHeight] = useState<number | undefined>(undefined);\n  const observer = useRef(new ResizeObserver(entries => {\n    const {\n      height\n    } = entries[0].contentRect;\n    setHeight(height);\n  }));\n  useEffect(() => {\n    if (containerRef.current) {\n      observer.current.observe(containerRef.current);\n    }\n\n    const currentObserver = observer.current;\n    return () => {\n      currentObserver.disconnect();\n    };\n  }, [containerRef, observer]);\n  return height;\n};\nconst NARROW_WIDTH_REM = 30;\n/**\n * Utility function to determine if container width is narrow\n * @param containerWidthRem  container width in rem\n * @returns boolean\n */\n\nexport const isNarrowWidth = (containerWidthRem: number): boolean => containerWidthRem <= convertRemToPx(NARROW_WIDTH_REM);","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ChatMessage, ReadReceiptsBySenderId } from '../..';\n/**\n * @private\n *logic: Looking at message A, how do we know it's read number?\n * Assumption: if user read the latest message, user has read all messages before that\n * ReadReceipt behaviour: read receipt is only sent to the last message\n *\n * If participant read a message that is sent later than message A, then the participant has read message A\n * How do we check if the message is sent later than message A?\n * We compare if the messageID of the last read message is larger than or equal to the message A's id\n * Because messageID is the creation timestamp of each message\n * Timestamps are in epoch time so lecixographical ordering is the same as time ordering.\n *\n * if MessageId of B is larger than message Id of A, then B is created after A\n * if the last read message is created after the message A is sent, then user should have read message A as well */\n\nexport const getParticipantsWhoHaveReadMessage = (message: ChatMessage, readReceiptsBySenderId: ReadReceiptsBySenderId): {\n  id: string;\n  displayName: string;\n}[] => {\n  return Object.entries(readReceiptsBySenderId) // Filter to only read receipts that match the message OR the participant has read a different message after this message has been created\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  .filter(([_, readReceipt]) => readReceipt.lastReadMessage >= message.messageId) // make sure the person is not removed from chat\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  .filter(([_, readReceipt]) => readReceipt.displayName && readReceipt.displayName !== '') // Map properties to useful array\n  .map(([id, readReceipt]) => ({\n    id,\n    displayName: readReceipt.displayName\n  }));\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { Chat, ChatItemProps, Flex, Ref, ShorthandValue, mergeStyles as mergeNorthstarThemes } from '@fluentui/react-northstar';\nimport { DownIconStyle, newMessageButtonContainerStyle, messageThreadContainerStyle, chatStyle, buttonWithIconStyles, newMessageButtonStyle, messageStatusContainerStyle, noMessageStatusStyle, defaultChatItemMessageContainer, defaultMyChatMessageContainer, defaultChatMessageContainer, gutterWithAvatar, gutterWithHiddenAvatar, FailedMyChatMessageContainer } from './styles/MessageThread.styles';\nimport { Icon, IStyle, mergeStyles, Persona, PersonaSize, PrimaryButton, Stack, IPersona, Theme } from '@fluentui/react';\nimport { ComponentSlotStyle } from '@fluentui/react-northstar';\nimport { LiveAnnouncer } from 'react-aria-live';\nimport { delay } from './utils/delay';\nimport { BaseCustomStyles, ChatMessage, CustomMessage, SystemMessage, CommunicationParticipant, OnRenderAvatarCallback, ParticipantAddedSystemMessage, ParticipantRemovedSystemMessage, Message, ReadReceiptsBySenderId } from '../types';\nimport { MessageStatusIndicator, MessageStatusIndicatorProps } from './MessageStatusIndicator';\nimport { memoizeFnAll, MessageStatus } from '@internal/acs-ui-common';\nimport { SystemMessage as SystemMessageComponent, SystemMessageIconTypes } from './SystemMessage';\nimport { ChatMessageComponent } from './ChatMessage/ChatMessageComponent';\nimport { useLocale } from '../localization/LocalizationProvider';\nimport { isNarrowWidth, _useContainerWidth } from './utils/responsive';\nimport { getParticipantsWhoHaveReadMessage } from './utils/getParticipantsWhoHaveReadMessage';\nimport { useTheme } from '../theming';\n\nconst isMessageSame = (first: ChatMessage, second: ChatMessage): boolean => {\n  return first.messageId === second.messageId && first.content === second.content && first.contentType === second.contentType && JSON.stringify(first.createdOn) === JSON.stringify(second.createdOn) && first.senderId === second.senderId && first.senderDisplayName === second.senderDisplayName && first.status === second.status;\n};\n/**\n * Get the latest message from the message array.\n *\n * @param messages\n */\n\n\nconst getLatestChatMessage = (messages: (ChatMessage | SystemMessage | CustomMessage)[]): ChatMessage | undefined => {\n  for (let i = messages.length - 1; i >= 0; i--) {\n    const message = messages[i];\n\n    if (message.messageType === 'chat' && !!message.createdOn) {\n      return message;\n    }\n  }\n\n  return undefined;\n};\n/**\n * Compare latestMessageFromPreviousMessages & latestMessageFromNewMessages to see if the new message is not from\n * current user.\n */\n\n\nconst isThereNewMessageNotFromCurrentUser = (userId: string, latestMessageFromPreviousMessages?: ChatMessage, latestMessageFromNewMessages?: ChatMessage): boolean => {\n  if (latestMessageFromNewMessages === undefined) {\n    return false;\n  }\n\n  if (latestMessageFromPreviousMessages === undefined) {\n    return latestMessageFromNewMessages.senderId !== userId;\n  }\n\n  return !isMessageSame(latestMessageFromNewMessages, latestMessageFromPreviousMessages) && latestMessageFromNewMessages.senderId !== userId;\n};\n/**\n * Returns true if the current user sent the latest message and false otherwise. It will ignore messages that have no\n * sender, messages that have failed to send, and messages from the current user that is marked as SEEN. This is meant\n * as an indirect way to detect if user is at bottom of the chat when the component updates with new messages. If we\n * updated this component due to current user sending a message we want to then call scrollToBottom.\n */\n\n\nconst didUserSendTheLatestMessage = (userId: string, latestMessageFromPreviousMessages?: ChatMessage, latestMessageFromNewMessages?: ChatMessage): boolean => {\n  if (latestMessageFromNewMessages === undefined) {\n    return false;\n  }\n\n  if (latestMessageFromPreviousMessages === undefined) {\n    return latestMessageFromNewMessages.senderId === userId;\n  }\n\n  return !isMessageSame(latestMessageFromNewMessages, latestMessageFromPreviousMessages) && latestMessageFromNewMessages.senderId === userId;\n};\n/**\n * Fluent styles for {@link MessageThread}.\n *\n * @public\n */\n\n\nexport interface MessageThreadStyles extends BaseCustomStyles {\n  /** Styles for load previous messages container. */\n  loadPreviousMessagesButtonContainer?: IStyle;\n  /** Styles for new message container. */\n\n  newMessageButtonContainer?: IStyle;\n  /** Styles for chat container. */\n\n  chatContainer?: ComponentSlotStyle;\n  /** styles for my chat items.  */\n\n  myChatItemMessageContainer?: ComponentSlotStyle;\n  /** styles for chat items.  */\n\n  chatItemMessageContainer?: ComponentSlotStyle;\n  /** Styles for my chat message container. */\n\n  myChatMessageContainer?: ComponentSlotStyle;\n  /** Styles for my chat message container in case of failure. */\n\n  failedMyChatMessageContainer?: ComponentSlotStyle;\n  /** Styles for chat message container. */\n\n  chatMessageContainer?: ComponentSlotStyle;\n  /** Styles for system message container. */\n\n  systemMessageContainer?: ComponentSlotStyle;\n  /** Styles for message status indicator container. */\n\n  messageStatusContainer?: (mine: boolean) => IStyle;\n}\n/**\n * Strings of {@link MessageThread} that can be overridden.\n *\n * @public\n */\n\nexport interface MessageThreadStrings {\n  /** String for Sunday */\n  sunday: string;\n  /** String for Monday */\n\n  monday: string;\n  /** String for Tuesday */\n\n  tuesday: string;\n  /** String for Wednesday */\n\n  wednesday: string;\n  /** String for Thursday */\n\n  thursday: string;\n  /** String for Friday */\n\n  friday: string;\n  /** String for Saturday */\n\n  saturday: string;\n  /** String for Yesterday */\n\n  yesterday: string;\n  /** String for participants joined */\n\n  participantJoined: string;\n  /** String for participants left */\n\n  participantLeft: string;\n  /** Tag shown on a message that has been edited */\n\n  editedTag: string;\n  /** String for editing message in floating menu */\n\n  editMessage: string;\n  /** String for removing message in floating menu */\n\n  removeMessage: string;\n  /** String for resending failed message in floating menu */\n\n  resendMessage?: string;\n  /** String for indicating failed to send messages */\n\n  failToSendTag?: string;\n  /** String for LiveMessage introduction for the Chat Message */\n\n  liveAuthorIntro: string;\n  /** String for aria text of remote user's message content */\n\n  messageContentAriaText: string;\n  /** String for aria text of local user's message content */\n\n  messageContentMineAriaText: string;\n  /** String for warning on text limit exceeded in EditBox*/\n\n  editBoxTextLimit: string;\n  /** String for placeholder text in EditBox when there is no user input*/\n\n  editBoxPlaceholderText: string;\n  /** String for new messages indicator*/\n\n  newMessagesIndicator: string;\n  /** String for showing message read status in floating menu */\n\n  messageReadCount?: string;\n  /** String for replacing display name when there is none*/\n\n  noDisplayNameSub: string;\n  /** String for Cancel button in EditBox*/\n\n  editBoxCancelButton: string;\n  /** String for Submit in EditBox when there is no user input*/\n\n  editBoxSubmitButton: string;\n  /** String for action menu indicating there are more options */\n\n  actionMenuMoreOptions?: string;\n}\n/**\n * Arguments for {@link MessageThreadProps.onRenderJumpToNewMessageButton}.\n *\n * @public\n */\n\nexport interface JumpToNewMessageButtonProps {\n  /** String for button text */\n  text: string;\n  /** Callback for when button is clicked */\n\n  onClick: () => void;\n}\n\nconst DefaultJumpToNewMessageButton = (props: JumpToNewMessageButtonProps): JSX.Element => {\n  const {\n    text,\n    onClick\n  } = props;\n  return <PrimaryButton className={newMessageButtonStyle} styles={buttonWithIconStyles} text={text} onClick={onClick} onRenderIcon={() => <Icon iconName=\"Down\" className={DownIconStyle} />} />;\n};\n\nconst generateParticipantsStr = (participants: CommunicationParticipant[], defaultName: string): string => participants.map(participant => `${!participant.displayName || participant.displayName === '' ? defaultName : participant.displayName}`).join(', ');\n/**\n * A component to render a single message.\n *\n * @public\n */\n\n\nexport type MessageRenderer = (props: MessageProps) => JSX.Element;\n\nconst ParticipantSystemMessageComponent = ({\n  message,\n  style,\n  defaultName\n}: {\n  message: ParticipantAddedSystemMessage | ParticipantRemovedSystemMessage;\n  style?: ComponentSlotStyle;\n  defaultName: string;\n}): JSX.Element => {\n  const {\n    strings\n  } = useLocale();\n  const participantsStr = generateParticipantsStr(message.participants, defaultName);\n  const messageSuffix = message.systemMessageType === 'participantAdded' ? strings.messageThread.participantJoined : strings.messageThread.participantLeft;\n\n  if (participantsStr !== '') {\n    return <SystemMessageComponent iconName={((message.iconName ? message.iconName : '') as SystemMessageIconTypes)} content={`${participantsStr} ${messageSuffix}`} containerStyle={style} />;\n  }\n\n  return <></>;\n};\n\nconst DefaultSystemMessage: MessageRenderer = (props: MessageProps) => {\n  const message = props.message;\n\n  switch (message.messageType) {\n    case 'system':\n      switch (message.systemMessageType) {\n        case 'content':\n          return <SystemMessageComponent iconName={((message.iconName ? message.iconName : '') as SystemMessageIconTypes)} content={message.content ?? ''} containerStyle={props?.messageContainerStyle} />;\n\n        case 'participantAdded':\n        case 'participantRemoved':\n          return <ParticipantSystemMessageComponent message={message} style={props.messageContainerStyle} defaultName={props.strings.noDisplayNameSub} />;\n      }\n\n  }\n\n  return <></>;\n};\n\nconst memoizeAllMessages = memoizeFnAll((_messageKey: string, message: Message, showMessageDate: boolean, showMessageStatus: boolean, onRenderAvatar: OnRenderAvatarCallback | undefined, shouldOverlapAvatarAndMessage: boolean, styles: MessageThreadStyles | undefined, onRenderMessageStatus: ((messageStatusIndicatorProps: MessageStatusIndicatorProps) => JSX.Element | null) | undefined, defaultStatusRenderer: (message: ChatMessage, status: MessageStatus, participantCount: number, readCount: number) => JSX.Element, defaultChatMessageRenderer: (message: MessageProps) => JSX.Element, strings: MessageThreadStrings, _attached?: boolean | string, statusToRender?: MessageStatus, participantCount?: number, readCount?: number, onRenderMessage?: (message: MessageProps, defaultOnRender?: MessageRenderer) => JSX.Element, onUpdateMessage?: UpdateMessageCallback, onDeleteMessage?: (messageId: string) => Promise<void>, onSendMessage?: (content: string) => Promise<void>): ShorthandValue<ChatItemProps> => {\n  const messageProps: MessageProps = {\n    message,\n    strings,\n    showDate: showMessageDate,\n    onUpdateMessage,\n    onDeleteMessage,\n    onSendMessage\n  };\n\n  switch (message.messageType) {\n    case 'chat':\n      {\n        const myChatMessageStyle = message.status === 'failed' ? styles?.failedMyChatMessageContainer ?? styles?.myChatMessageContainer ?? FailedMyChatMessageContainer : styles?.myChatMessageContainer ?? defaultMyChatMessageContainer;\n        const chatMessageStyle = styles?.chatMessageContainer ?? defaultChatMessageContainer;\n        messageProps.messageContainerStyle = message.mine ? myChatMessageStyle : chatMessageStyle;\n        const chatMessageComponent = onRenderMessage === undefined ? defaultChatMessageRenderer(messageProps) : onRenderMessage(messageProps, defaultChatMessageRenderer);\n        const personaOptions: IPersona = {\n          hidePersonaDetails: true,\n          size: PersonaSize.size32,\n          text: message.senderDisplayName,\n          showOverflowTooltip: false\n        };\n        const chatItemMessageStyle = (message.mine ? styles?.myChatItemMessageContainer : styles?.chatItemMessageContainer) || defaultChatItemMessageContainer(shouldOverlapAvatarAndMessage);\n        const chatGutterStyles = message.attached === 'top' || message.attached === false ? gutterWithAvatar : gutterWithHiddenAvatar;\n        return {\n          gutter: {\n            styles: chatGutterStyles,\n            content: message.mine ? '' : onRenderAvatar ? onRenderAvatar(message.senderId ?? '', personaOptions) : <Persona {...personaOptions} />\n          },\n          contentPosition: message.mine ? 'end' : 'start',\n          message: {\n            styles: chatItemMessageStyle,\n            content: <Flex hAlign={message.mine ? 'end' : undefined} vAlign=\"end\">\n                {chatMessageComponent}\n                <div className={mergeStyles(messageStatusContainerStyle(message.mine ?? false), styles?.messageStatusContainer ? styles.messageStatusContainer(message.mine ?? false) : '')}>\n                  {showMessageStatus && statusToRender ? onRenderMessageStatus ? onRenderMessageStatus({\n                  status: statusToRender\n                }) : defaultStatusRenderer(message, statusToRender, participantCount ?? 0, readCount ?? 0) : <div className={mergeStyles(noMessageStatusStyle)} />}\n                </div>\n              </Flex>\n          },\n          attached: message.attached,\n          key: _messageKey\n        };\n      }\n\n    case 'system':\n      {\n        messageProps.messageContainerStyle = styles?.systemMessageContainer;\n        const systemMessageComponent = onRenderMessage === undefined ? <DefaultSystemMessage {...messageProps} /> : onRenderMessage(messageProps, props => <DefaultSystemMessage {...props} />);\n        return {\n          children: systemMessageComponent,\n          key: _messageKey\n        };\n      }\n\n    default:\n      {\n        // We do not handle custom type message by default, users can handle custom type by using onRenderMessage function.\n        const customMessageComponent = onRenderMessage === undefined ? <></> : onRenderMessage(messageProps);\n        return {\n          children: customMessageComponent,\n          key: _messageKey\n        };\n      }\n  }\n});\n\nconst getLastChatMessageIdWithStatus = (messages: Message[], status: MessageStatus): string | undefined => {\n  for (let i = messages.length - 1; i >= 0; i--) {\n    const message = messages[i];\n\n    if (message.messageType === 'chat' && message.status === status && message.mine) {\n      return message.messageId;\n    }\n  }\n\n  return undefined;\n};\n/**\n * @public\n * Callback function run when a message is updated.\n */\n\n\nexport type UpdateMessageCallback = (messageId: string, content: string) => Promise<void>;\n/**\n * Props for {@link MessageThread}.\n *\n * @public\n */\n\nexport type MessageThreadProps = {\n  /**\n   * UserId of the current user.\n   */\n  userId: string;\n  /**\n   * Messages to render in message thread. A message can be of type `ChatMessage`, `SystemMessage` or `CustomMessage`.\n   */\n\n  messages: (ChatMessage | SystemMessage | CustomMessage)[];\n  /**\n   * number of participants in the thread\n   */\n\n  participantCount?: number;\n  /**\n   * read receipts for each sender in the chat\n   */\n\n  readReceiptsBySenderId?: ReadReceiptsBySenderId;\n  /**\n   * Allows users to pass an object containing custom CSS styles.\n   * @Example\n   * ```\n   * <MessageThread styles={{ root: { background: 'blue' } }} />\n   * ```\n   */\n\n  styles?: MessageThreadStyles;\n  /**\n   * Whether the new message button is disabled or not.\n   *\n   * @defaultValue `false`\n   */\n\n  disableJumpToNewMessageButton?: boolean;\n  /**\n   * Whether the date of each message is displayed or not.\n   * It is ignored when onDisplayDateTimeString is supplied.\n   *\n   * @defaultValue `false`\n   */\n\n  showMessageDate?: boolean;\n  /**\n   * Whether the status indicator for each message is displayed or not.\n   *\n   * @defaultValue `false`\n   */\n\n  showMessageStatus?: boolean;\n  /**\n   * Number of chat messages to reload each time onLoadPreviousChatMessages is called.\n   *\n   * @defaultValue 0\n   */\n\n  numberOfChatMessagesToReload?: number;\n  /**\n   * Optional callback to override actions on message being seen.\n   *\n   * @param messageId - message Id\n   */\n\n  onMessageSeen?: (messageId: string) => Promise<void>;\n  /**\n   * Optional callback to override render of the message status indicator.\n   *\n   * @param messageStatusIndicatorProps - props of type MessageStatusIndicatorProps\n   */\n\n  onRenderMessageStatus?: (messageStatusIndicatorProps: MessageStatusIndicatorProps) => JSX.Element | null;\n  /**\n   * Optional callback to override render of the avatar.\n   *\n   * @param userId - user Id\n   */\n\n  onRenderAvatar?: OnRenderAvatarCallback;\n  /**\n   * Optional callback to override render of the button for jumping to the new message.\n   *\n   * @param newMessageButtonProps - button props of type JumpToNewMessageButtonProps\n   */\n\n  onRenderJumpToNewMessageButton?: (newMessageButtonProps: JumpToNewMessageButtonProps) => JSX.Element;\n  /**\n   * Optional callback to override loading of previous messages.\n   * It accepts the number of history chat messages that we want to load and return a boolean Promise indicating if we have got all the history messages.\n   * If the promise resolves to `true`, we have load all chat messages into the message thread and `loadPreviousMessagesButton` will not be rendered anymore.\n   */\n\n  onLoadPreviousChatMessages?: (messagesToLoad: number) => Promise<boolean>;\n  /**\n   * Optional callback to override render of a message.\n   *\n   * @param messageProps - props of type {@link communication-react#MessageProps}\n   * @param defaultOnRender - default render of type {@link communication-react#MessageRenderer}\n   *\n   * @remarks\n   * `messageRenderer` is not provided for `CustomMessage` and thus only available for `ChatMessage` and `SystemMessage`.\n   */\n\n  onRenderMessage?: (messageProps: MessageProps, messageRenderer?: MessageRenderer) => JSX.Element;\n\n  /**\n   * Optional callback to edit a message.\n   *\n   * @param messageId - message id from chatClient\n   * @param content - new content of the message\n   *\n   */\n  onUpdateMessage?: UpdateMessageCallback;\n  /**\n   * Optional callback to delete a message.\n   *\n   * @param messageId - message id from chatClient\n   *\n   */\n\n  onDeleteMessage?: (messageId: string) => Promise<void>;\n  /**\n   * Optional callback to send a message.\n   *\n   * @param messageId - message id from chatClient\n   *\n   */\n\n  onSendMessage?: (messageId: string) => Promise<void>;\n  /**\n  /**\n   * Disable editing messages.\n   *\n   * @remarks This removes the action menu on messages.\n   *\n   * @defaultValue `false`\n   */\n\n  disableEditing?: boolean;\n  /**\n   * Optional strings to override in component\n   */\n\n  strings?: Partial<MessageThreadStrings>;\n};\n/**\n * Props to render a single message.\n *\n * See {@link MessageRenderer}.\n *\n * @public\n */\n\nexport type MessageProps = {\n  /**\n   * Message to render. It can type `ChatMessage` or `SystemMessage` or `CustomMessage`.\n   */\n  message: Message;\n  /**\n   * Strings from parent MessageThread component\n   */\n\n  strings: MessageThreadStrings;\n  /**\n   * Custom CSS styles for chat message container.\n   */\n\n  messageContainerStyle?: ComponentSlotStyle;\n  /**\n   * Whether the date of a message is displayed or not.\n   *\n   * @defaultValue `false`\n   */\n\n  showDate?: boolean;\n  /**\n   * Disable editing messages.\n   *\n   * @remarks This removes the action menu on messages.\n   *\n   * @defaultValue `false`\n   */\n\n  disableEditing?: boolean;\n  /**\n   * Optional callback to edit a message.\n   *\n   * @param messageId - message id from chatClient\n   * @param content - new content of the message\n   */\n\n  onUpdateMessage?: UpdateMessageCallback;\n  /**\n   * Optional callback to delete a message.\n   *\n   * @param messageId - message id from chatClient\n   *\n   */\n\n  onDeleteMessage?: (messageId: string) => Promise<void>;\n  /**\n   * Optional callback to send a message.\n   *\n   * @param messageId - message id from chatClient\n   *\n   */\n\n  onSendMessage?: (messageId: string) => Promise<void>;\n};\n/**\n * `MessageThread` allows you to easily create a component for rendering chat messages, handling scrolling behavior of new/old messages and customizing icons & controls inside the chat thread.\n * @param props - of type MessageThreadProps\n *\n * Users will need to provide at least chat messages and userId to render the `MessageThread` component.\n * Users can also customize `MessageThread` by passing in their own Avatar, `MessageStatusIndicator` icon, `JumpToNewMessageButton`, `LoadPreviousMessagesButton` and the behavior of these controls.\n *\n * `MessageThread` internally uses the `Chat` & `Chat.Message` component from `@fluentui/react-northstar`. You can checkout the details about these [two components](https://fluentsite.z22.web.core.windows.net/0.53.0/components/chat/props).\n *\n * @public\n */\n\nexport const MessageThread = (props: MessageThreadProps): JSX.Element => {\n  const {\n    messages: newMessages,\n    userId,\n    participantCount,\n    readReceiptsBySenderId,\n    styles,\n    disableJumpToNewMessageButton = false,\n    showMessageDate = false,\n    showMessageStatus = false,\n    numberOfChatMessagesToReload = 5,\n    onMessageSeen,\n    onRenderMessageStatus,\n    onRenderAvatar,\n    onLoadPreviousChatMessages,\n    onRenderJumpToNewMessageButton,\n    onRenderMessage,\n    onUpdateMessage,\n    onDeleteMessage,\n    onSendMessage\n  } = props;\n  const onRenderFileDownloads = onRenderFileDownloadsTrampoline(props);\n  const [messages, setMessages] = useState<(ChatMessage | SystemMessage | CustomMessage)[]>([]); // We need this state to wait for one tick and scroll to bottom after messages have been initialized.\n  // Otherwise chatScrollDivRef.current.clientHeight is wrong if we scroll to bottom before messages are initialized.\n\n  const [chatMessagesInitialized, setChatMessagesInitialized] = useState<boolean>(false);\n  const [isAtBottomOfScroll, setIsAtBottomOfScroll] = useState<boolean>(true);\n  const [forceUpdate, setForceUpdate] = useState<number>(0); // Used to decide if should auto scroll to bottom or show \"new message\" button\n\n  const [latestPreviousChatMessage, setLatestPreviousChatMessage] = useState<ChatMessage | undefined>(undefined);\n  const [latestCurrentChatMessage, setLatestCurrentChatMessage] = useState<ChatMessage | undefined>(undefined);\n  const [existsNewChatMessage, setExistsNewChatMessage] = useState<boolean>(false);\n  const [lastSeenChatMessage, setLastSeenChatMessage] = useState<string | undefined>(undefined);\n  const [lastDeliveredChatMessage, setLastDeliveredChatMessage] = useState<string | undefined>(undefined);\n  const [lastSendingChatMessage, setLastSendingChatMessage] = useState<string | undefined>(undefined); // readCount and participantCount will only need to be updated on-fly when user hover on an indicator\n\n  const [readCountForHoveredIndicator, setReadCountForHoveredIndicator] = useState<number | undefined>(undefined);\n  const isAllChatMessagesLoadedRef = useRef(false);\n  const previousTopRef = useRef<number>(-1);\n  const previousHeightRef = useRef<number>(-1);\n  const messageIdSeenByMeRef = useRef<string>('');\n  const chatScrollDivRef = useRef<HTMLElement>(null);\n  const chatThreadRef = useRef<HTMLElement>(null);\n  const isLoadingChatMessagesRef = useRef(false); // When the chat thread is narrow, we perform space optimizations such as overlapping\n  // the avatar on top of the chat message and moving the chat accept/reject edit buttons\n  // to a new line\n\n  const chatThreadWidth = _useContainerWidth(chatThreadRef);\n\n  const isNarrow = chatThreadWidth ? isNarrowWidth(chatThreadWidth) : false;\n  const messagesRef = useRef(messages);\n\n  const setMessagesRef = (messagesWithAttachedValue: (ChatMessage | SystemMessage | CustomMessage)[]): void => {\n    messagesRef.current = messagesWithAttachedValue;\n    setMessages(messagesWithAttachedValue);\n  };\n\n  const isAtBottomOfScrollRef = useRef(isAtBottomOfScroll);\n\n  const setIsAtBottomOfScrollRef = (isAtBottomOfScrollValue: boolean): void => {\n    isAtBottomOfScrollRef.current = isAtBottomOfScrollValue;\n    setIsAtBottomOfScroll(isAtBottomOfScrollValue);\n  };\n\n  const chatMessagesInitializedRef = useRef(chatMessagesInitialized);\n\n  const setChatMessagesInitializedRef = (chatMessagesInitialized: boolean): void => {\n    chatMessagesInitializedRef.current = chatMessagesInitialized;\n    setChatMessagesInitialized(chatMessagesInitialized);\n  }; // we try to only send those message status if user is scrolled to the bottom.\n\n\n  const sendMessageStatusIfAtBottom = useCallback(async (): Promise<void> => {\n    if (!isAtBottomOfScrollRef.current || !document.hasFocus() || !messagesRef.current || messagesRef.current.length === 0 || !showMessageStatus) {\n      return;\n    }\n\n    const messagesWithId = messagesRef.current.filter(message => {\n      return message.messageType === 'chat' && !message.mine && !!message.messageId;\n    });\n\n    if (messagesWithId.length === 0) {\n      return;\n    }\n\n    const lastMessage: ChatMessage = (messagesWithId[messagesWithId.length - 1] as ChatMessage);\n\n    try {\n      if (onMessageSeen && lastMessage && lastMessage.messageId && lastMessage.messageId !== messageIdSeenByMeRef.current) {\n        await onMessageSeen(lastMessage.messageId);\n        messageIdSeenByMeRef.current = lastMessage.messageId;\n      }\n    } catch (e) {\n      console.log('onMessageSeen Error', lastMessage, e);\n    }\n  }, [showMessageStatus, onMessageSeen]);\n  const scrollToBottom = useCallback((): void => {\n    if (chatScrollDivRef.current) {\n      chatScrollDivRef.current.scrollTop = chatScrollDivRef.current.scrollHeight;\n    }\n\n    setExistsNewChatMessage(false);\n    setIsAtBottomOfScrollRef(true);\n    sendMessageStatusIfAtBottom();\n  }, [sendMessageStatusIfAtBottom]);\n  const handleScrollToTheBottom = useCallback((): void => {\n    if (!chatScrollDivRef.current) {\n      return;\n    }\n\n    const atBottom = Math.ceil(chatScrollDivRef.current.scrollTop) >= chatScrollDivRef.current.scrollHeight - chatScrollDivRef.current.clientHeight;\n\n    if (atBottom) {\n      sendMessageStatusIfAtBottom();\n\n      if (!isAtBottomOfScrollRef.current) {\n        scrollToBottom();\n      }\n    }\n\n    setIsAtBottomOfScrollRef(atBottom);\n  }, [scrollToBottom, sendMessageStatusIfAtBottom]); // Infinite scrolling + threadInitialize function\n\n  const fetchNewMessageWhenAtTop = useCallback(async () => {\n    if (chatScrollDivRef.current && !isLoadingChatMessagesRef.current) {\n      if (onLoadPreviousChatMessages) {\n        isLoadingChatMessagesRef.current = true; // Fetch message until scrollTop reach the threshold for fetching new message\n\n        while (!isAllChatMessagesLoadedRef.current && chatScrollDivRef.current.scrollTop <= 500) {\n          isAllChatMessagesLoadedRef.current = await onLoadPreviousChatMessages(numberOfChatMessagesToReload);\n          await delay(200);\n        }\n\n        isLoadingChatMessagesRef.current = false;\n      }\n    }\n  }, [numberOfChatMessagesToReload, onLoadPreviousChatMessages]);\n  const handleInfiniteScroll = useCallback((): void => {\n    if (!chatScrollDivRef.current) {\n      return;\n    }\n\n    fetchNewMessageWhenAtTop();\n  }, [fetchNewMessageWhenAtTop]); // The below 2 of useEffects are design for fixing infinite scrolling problem\n  // Scrolling element will behave differently when scrollTop = 0(it sticks at the top)\n  // we need to get previousTop before it prepend contents\n  // Execute order [newMessage useEffect] => get previousTop => dom update => [messages useEffect]\n\n  useEffect(() => {\n    if (!chatScrollDivRef.current) {\n      return;\n    }\n\n    previousTopRef.current = chatScrollDivRef.current.scrollTop;\n    previousHeightRef.current = chatScrollDivRef.current.scrollHeight;\n  }, [newMessages]);\n  useEffect(() => {\n    if (!chatScrollDivRef.current) {\n      return;\n    }\n\n    chatScrollDivRef.current.scrollTop = chatScrollDivRef.current.scrollHeight - (previousHeightRef.current - previousTopRef.current);\n  }, [messages]); // Fetch more messages to make the scroll bar appear, infinity scroll is then handled in the handleScroll function.\n\n  useEffect(() => {\n    fetchNewMessageWhenAtTop();\n  }, [fetchNewMessageWhenAtTop]);\n  /**\n   * One time run useEffects. Sets up listeners when component is mounted and tears down listeners when component\n   * unmounts unless these function changed\n   */\n\n  useEffect(() => {\n    window && window.addEventListener('click', sendMessageStatusIfAtBottom);\n    window && window.addEventListener('focus', sendMessageStatusIfAtBottom);\n    return () => {\n      window && window.removeEventListener('click', sendMessageStatusIfAtBottom);\n      window && window.removeEventListener('focus', sendMessageStatusIfAtBottom);\n    };\n  }, [sendMessageStatusIfAtBottom]);\n  useEffect(() => {\n    const chatScrollDiv = chatScrollDivRef.current;\n    chatScrollDiv?.addEventListener('scroll', handleScrollToTheBottom);\n    chatScrollDiv?.addEventListener('scroll', handleInfiniteScroll);\n    return () => {\n      chatScrollDiv?.removeEventListener('scroll', handleScrollToTheBottom);\n      chatScrollDiv?.removeEventListener('scroll', handleInfiniteScroll);\n    };\n  }, [handleInfiniteScroll, handleScrollToTheBottom]);\n  /**\n   * ClientHeight controls the number of messages to render. However ClientHeight will not be initialized after the\n   * first render (not sure but I guess Fluent is updating it in hook which is after render maybe?) so we need to\n   * trigger a re-render until ClientHeight is initialized. This force re-render should only happen once.\n   */\n\n  const clientHeight = chatThreadRef.current?.clientHeight;\n  useEffect(() => {\n    if (clientHeight === undefined) {\n      setForceUpdate(forceUpdate + 1);\n      return;\n    } // Only scroll to bottom if isAtBottomOfScrollRef is true\n\n\n    isAtBottomOfScrollRef.current && scrollToBottom();\n  }, [clientHeight, forceUpdate, scrollToBottom, chatMessagesInitialized]);\n  /**\n   * This needs to run to update latestPreviousChatMessage & latestCurrentChatMessage.\n   * These two states are used to manipulate scrollbar\n   */\n\n  useEffect(() => {\n    setLatestPreviousChatMessage(getLatestChatMessage(messagesRef.current));\n    setLatestCurrentChatMessage(getLatestChatMessage(newMessages));\n    setMessagesRef(newMessages);\n    !chatMessagesInitializedRef.current && setChatMessagesInitializedRef(true);\n    setLastDeliveredChatMessage(getLastChatMessageIdWithStatus(newMessages, 'delivered'));\n    setLastSeenChatMessage(getLastChatMessageIdWithStatus(newMessages, 'seen'));\n    setLastSendingChatMessage(getLastChatMessageIdWithStatus(newMessages, 'sending'));\n  }, [newMessages]);\n  /**\n   * This needs to run after messages are rendererd so we can manipulate the scroll bar.\n   */\n\n  useEffect(() => {\n    // If user just sent the latest message then we assume we can move user to bottom of scroll.\n    if (isThereNewMessageNotFromCurrentUser(userId, latestPreviousChatMessage, latestCurrentChatMessage) && !isAtBottomOfScrollRef.current) {\n      setExistsNewChatMessage(true);\n    } else if (didUserSendTheLatestMessage(userId, latestPreviousChatMessage, latestCurrentChatMessage) || isAtBottomOfScrollRef.current) {\n      scrollToBottom();\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [messages]);\n  const participantCountRef = useRef(participantCount);\n  const readReceiptsBySenderIdRef = useRef(readReceiptsBySenderId);\n  participantCountRef.current = participantCount;\n  readReceiptsBySenderIdRef.current = readReceiptsBySenderId;\n  const onActionButtonClickMemo = useCallback((message: ChatMessage, setMessageReadBy: (readBy: {\n    id: string;\n    displayName: string;\n  }[]) => void) => {\n    if (participantCountRef.current && participantCountRef.current - 1 > 1 && readReceiptsBySenderIdRef.current) {\n      setMessageReadBy(getParticipantsWhoHaveReadMessage(message, readReceiptsBySenderIdRef.current));\n    }\n  }, []);\n  const localeStrings = useLocale().strings.messageThread;\n  const strings = useMemo(() => ({ ...localeStrings,\n    ...props.strings\n  }), [localeStrings, props.strings]); // To rerender the defaultChatMessageRenderer if app running across days(every new day chat time stamp need to be regenerated)\n\n  const defaultChatMessageRenderer = useCallback((messageProps: MessageProps) => {\n    if (messageProps.message.messageType === 'chat') {\n      return <ChatMessageComponent {...messageProps} onRenderFileDownloads={onRenderFileDownloads} message={messageProps.message} userId={props.userId} remoteParticipantsCount={participantCount ? participantCount - 1 : 0} inlineAcceptRejectEditButtons={!isNarrow} onRenderAvatar={onRenderAvatar} showMessageStatus={showMessageStatus} messageStatus={messageProps.message.status} onActionButtonClick={onActionButtonClickMemo} />;\n    }\n\n    return <></>;\n  }, [onRenderFileDownloads, props.userId, participantCount, isNarrow, onRenderAvatar, showMessageStatus, onActionButtonClickMemo]);\n  const defaultStatusRenderer = useCallback((message: ChatMessage, status: MessageStatus, participantCount: number, readCount: number) => {\n    const onToggleToolTip = (isToggled: boolean): void => {\n      if (isToggled && readReceiptsBySenderIdRef.current) {\n        setReadCountForHoveredIndicator(getParticipantsWhoHaveReadMessage(message, readReceiptsBySenderIdRef.current).length);\n      } else {\n        setReadCountForHoveredIndicator(undefined);\n      }\n    };\n\n    return <MessageStatusIndicator status={status} readCount={readCount} onToggleToolTip={onToggleToolTip} // -1 because participant count does not include myself\n    remoteParticipantsCount={participantCount ? participantCount - 1 : 0} />;\n  }, []);\n  const messagesToDisplay = useMemo(() => memoizeAllMessages(memoizedMessageFn => {\n    return messages.map((message: Message, index: number): ShorthandValue<ChatItemProps> => {\n      let key: string | undefined = message.messageId;\n      let statusToRender: MessageStatus | undefined = undefined;\n\n      if (message.messageType === 'chat') {\n        if (!message.messageId || message.messageId === '') {\n          key = message.clientMessageId;\n        }\n\n        if (showMessageStatus && message.mine) {\n          switch (message.messageId) {\n            case lastSeenChatMessage:\n              {\n                statusToRender = 'seen';\n                break;\n              }\n\n            case lastSendingChatMessage:\n              {\n                statusToRender = 'sending';\n                break;\n              }\n\n            case lastDeliveredChatMessage:\n              {\n                statusToRender = 'delivered';\n                break;\n              }\n          }\n        }\n\n        if (message.mine && message.status === 'failed') {\n          statusToRender = 'failed';\n        }\n      }\n\n      return memoizedMessageFn(key ?? 'id_' + index, message, showMessageDate, showMessageStatus, onRenderAvatar, isNarrow, styles, onRenderMessageStatus, defaultStatusRenderer, defaultChatMessageRenderer, strings, // Temporary solution to make sure we re-render if attach attribute is changed.\n      // The proper fix should be in selector.\n      message.messageType === 'chat' ? message.attached : undefined, statusToRender, participantCount, readCountForHoveredIndicator, onRenderMessage, onUpdateMessage, onDeleteMessage, onSendMessage);\n    });\n  }), [messages, showMessageDate, showMessageStatus, onRenderAvatar, isNarrow, styles, onRenderMessageStatus, defaultStatusRenderer, defaultChatMessageRenderer, strings, participantCount, readCountForHoveredIndicator, onRenderMessage, onUpdateMessage, onDeleteMessage, onSendMessage, lastSeenChatMessage, lastSendingChatMessage, lastDeliveredChatMessage]);\n  const theme = useTheme();\n  const chatBody = useMemo(() => {\n    return <LiveAnnouncer>\n        <Chat styles={mergeNorthstarThemes(chatStyle, linkStyles(theme), styles?.chatContainer ?? {})} items={messagesToDisplay} />\n      </LiveAnnouncer>;\n  }, [theme, styles?.chatContainer, messagesToDisplay]);\n  return <Ref innerRef={chatThreadRef}>\n      <Stack className={mergeStyles(messageThreadContainerStyle, styles?.root)} grow>\n        {\n        /* Always ensure New Messages button is above the chat body element in the DOM tree. This is to ensure correct\n           tab ordering. Because the New Messages button floats on top of the chat body it is in a higher z-index and\n           thus Users should be able to tab navigate to the new messages button _before_ tab focus is taken to the chat body.*/\n      }\n        {existsNewChatMessage && !disableJumpToNewMessageButton && <div className={mergeStyles(newMessageButtonContainerStyle, styles?.newMessageButtonContainer)}>\n            {onRenderJumpToNewMessageButton ? onRenderJumpToNewMessageButton({\n          text: strings.newMessagesIndicator,\n          onClick: scrollToBottom\n        }) : <DefaultJumpToNewMessageButton text={strings.newMessagesIndicator} onClick={scrollToBottom} />}\n          </div>}\n\n        <Ref innerRef={chatScrollDivRef}>{chatBody}</Ref>\n      </Stack>\n    </Ref>;\n};\n\nconst onRenderFileDownloadsTrampoline = (props: MessageThreadProps): ((userId: string, message: ChatMessage) => JSX.Element) | undefined => {\n  return undefined;\n};\n\nconst linkStyles = (theme: Theme): ComponentSlotStyle => {\n  return {\n    '& a:link': {\n      color: theme.palette.themePrimary\n    },\n    '& a:visited': {\n      color: theme.palette.themeDarker\n    },\n    '& a:hover': {\n      color: theme.palette.themeDarker\n    },\n    '& a:selected': {\n      color: theme.palette.themeDarker\n    }\n  };\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ISpinnerStyles, mergeStyles, Theme } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const container = (): string => mergeStyles({\n  position: 'relative',\n  // ensures child element's `position: absolute` is relative to this container\n  display: 'contents'\n});\n/**\n * @private\n */\n\nexport const loadingSpinnerContainer = (): string => mergeStyles({\n  // Position centrally on top of content. Parent must have position: relative.\n  position: 'absolute',\n  top: '50%',\n  bottom: '0',\n  left: '50%',\n  right: '0',\n  transform: 'translate(-50%, -50%)'\n});\n/**\n * @private\n */\n\nexport const loadSpinnerStyles: ISpinnerStyles = {\n  root: {\n    height: '100%' // ensure height fills container\n\n  },\n  circle: {\n    maxHeight: '5rem',\n    height: '50%',\n    width: 'unset',\n    // remove default width applied by fluent for spinners\n    aspectRatio: '1 / 1',\n    // make height match width to ensure a circle shape\n    borderWidth: '0.25em'\n  }\n};\n/**\n * @private\n */\n\nexport const mediaContainer = (theme: Theme): string => mergeStyles({\n  position: 'relative',\n  height: '100%',\n  width: '100%',\n  background: 'transparent',\n  display: 'flex',\n  '& video': {\n    borderRadius: theme.effects.roundedCorner4\n  }\n});\n/**\n * @private\n */\n\nexport const invertedVideoInPipStyle = (theme: Theme): string => mergeStyles(mediaContainer(theme), {\n  // The HTMLElement returned by the headless SDK is already inverted.\n  // But in picture-in-picture mode, we do not want to invert the host HTMLElement.\n  // Instead, we need to target the :picture-in-picture pseudoclass.\n  //\n  // First reset the host HTMLElement.\n  transform: 'rotateY(180deg)',\n  // This doesn't work yet on latest Edge.\n  // Probably just not implemented yet.\n  // picture-in-picture API is not yet stable: https://www.w3.org/TR/picture-in-picture/#css-pseudo-class\n  '& video:picture-in-picture': {\n    transform: 'rotateY(180deg)'\n  }\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles, Spinner } from '@fluentui/react';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { invertedVideoInPipStyle, mediaContainer, container, loadingSpinnerContainer, loadSpinnerStyles } from './styles/StreamMedia.styles';\nimport { useTheme } from '../theming';\nimport { BaseCustomStyles } from '../types';\n/**\n * Whether the stream is loading or not.\n * @public\n */\n\nexport type LoadingState = 'loading' | 'none';\n/**\n * Props for {@link StreamMedia}.\n *\n * @public\n */\n\nexport interface StreamMediaProps {\n  /** Video stream element to render. */\n  videoStreamElement: HTMLElement | null;\n  /** Decides whether to mirror the video or not. */\n\n  isMirrored?: boolean;\n  /** Whether the stream is loading data */\n\n  loadingState?: LoadingState;\n  /**\n   * Allows users to pass in an object contains custom CSS styles.\n   * @Example\n   * ```\n   * <StreamMedia styles={{ root: { background: 'blue' } }} />\n   * ```\n   */\n\n  styles?: BaseCustomStyles;\n}\n/**\n * Utility component to convert an HTMLElement with a video stream into a JSX element.\n *\n * Use to convert an HTMLElement returned by headless calling API into a component that can be rendered as a {@link VideoTile}.\n *\n * @public\n */\n\nexport const StreamMedia = (props: StreamMediaProps): JSX.Element => {\n  const containerEl = useRef<HTMLDivElement>(null);\n  const theme = useTheme();\n  const {\n    isMirrored,\n    videoStreamElement,\n    styles,\n    loadingState = 'none'\n  } = props;\n  const [pipEnabled, setPipEnabled] = useState(false);\n  useEffect(() => {\n    const container = containerEl.current;\n\n    if (!container) {\n      return;\n    } // If videoStreamElement changes, we clear the container to make sure we don't have duplicate, and replace it with\n    // the new videoStreamElement. If videoStreamElement is undefined nothing is appended and container should be empty\n    // and we don't render anyting.\n\n\n    container.innerHTML = '';\n    setPipEnabled(false);\n\n    if (videoStreamElement) {\n      videoStreamElement.addEventListener('enterpictureinpicture', () => {\n        setPipEnabled(true);\n      });\n      videoStreamElement.addEventListener('leavepictureinpicture', () => {\n        setPipEnabled(false);\n      });\n      container.appendChild(videoStreamElement);\n    }\n\n    return () => {\n      container.innerHTML = '';\n      setPipEnabled(false);\n    };\n  }, [videoStreamElement]);\n  return <div className={container()}>\n      <div data-ui-id=\"stream-media-container\" className={mergeStyles(isMirrored && pipEnabled ? invertedVideoInPipStyle(theme) : mediaContainer(theme), styles?.root)} ref={containerEl} />\n      {loadingState === 'loading' && <div className={loadingSpinnerContainer()}>\n          <Spinner data-ui-id=\"stream-media-loading-spinner\" styles={loadSpinnerStyles} />\n        </div>}\n    </div>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStyle, mergeStyles } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const participantItemContainerStyle = (options: {\n  localparticipant: boolean | undefined;\n  clickable: boolean;\n}): IStyle => {\n  return {\n    paddingTop: '0.25rem',\n    paddingBottom: '0.25rem',\n    display: 'flex',\n    maxWidth: '100%',\n    minWidth: '8rem',\n    cursor: options.localparticipant || !options.clickable ? 'default' : 'pointer',\n    alignItems: 'center'\n  };\n};\n/**\n * @private\n */\n\nexport const menuButtonContainerStyle = {\n  width: '1.5rem'\n};\n/**\n * @private\n */\n\nexport const participantStateMaxWidth = '5rem';\n/**\n * @private\n */\n\nexport const participantStateStringStyles: IStyle = {\n  maxWidth: participantStateMaxWidth,\n  overflow: 'hidden',\n  textOverflow: 'ellipsis',\n  whiteSpace: 'nowrap',\n  lineHeight: 'normal',\n  paddingLeft: '1rem',\n  marginLeft: 'auto',\n  marginRight: 0\n};\n/**\n * @private\n */\n\nexport const iconContainerStyle = {\n  display: 'flex',\n  alignItems: 'center',\n  height: '100%',\n  paddingTop: '0.2rem'\n};\n/**\n * @private\n */\n\nexport const iconStyles = mergeStyles({\n  display: 'flex',\n  lineHeight: 0,\n  // ensure the icon center is on the center line and not slightly above it\n  alignItems: 'center'\n});\n/**\n * @private\n */\n\nexport const meContainerStyle = {\n  paddingRight: '0.5rem'\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ContextualMenu, DirectionalHint, Icon, IContextualMenuItem, IStyle, mergeStyles, Persona, PersonaPresence, PersonaSize, Stack, Text } from '@fluentui/react';\nimport React, { useMemo, useRef, useState } from 'react';\nimport { useIdentifiers } from '../identifiers';\nimport { useLocale } from '../localization';\nimport { useTheme } from '../theming';\nimport { BaseCustomStyles, OnRenderAvatarCallback } from '../types';\nimport { iconContainerStyle, iconStyles, meContainerStyle, menuButtonContainerStyle, participantItemContainerStyle, participantStateMaxWidth, participantStateStringStyles } from './styles/ParticipantItem.styles';\nimport { _preventDismissOnEvent as preventDismissOnEvent } from '@internal/acs-ui-common';\n\n/**\n * Fluent styles for {@link ParticipantItem}.\n *\n * @public\n */\nexport interface ParticipantItemStyles extends BaseCustomStyles {\n  /** Styles for the avatar. */\n  avatar?: IStyle;\n  /** Styles for the (You) string. */\n\n  me?: IStyle;\n  /** Styles for the container of the icon. */\n\n  iconContainer?: IStyle;\n  /** Styles for the menu. */\n\n  menu?: IStyle;\n}\n/**\n * Strings of {@link ParticipantItem} that can be overridden.\n *\n * @public\n */\n\nexport interface ParticipantItemStrings {\n  /** String shown when participant is me */\n  isMeText: string;\n  /** String shown when hovering over menu button */\n\n  menuTitle: string;\n  /** Label for the remove button in participant menu  */\n\n  removeButtonLabel: string;\n  /** Label for the sharing icon in participant state stack  */\n\n  sharingIconLabel: string;\n  /** Label for the muted icon in participant state stack  */\n\n  mutedIconLabel: string;\n  /** placeholder text for participants who does not have a display name*/\n\n  displayNamePlaceholder?: string;\n}\n/**\n * Props for {@link ParticipantItem}.\n *\n * @public\n */\n\nexport interface ParticipantItemProps {\n  /** Unique User ID of the participant. This `userId` is available in the `onRenderAvatar` callback function */\n  userId?: string;\n  /** Name of participant. */\n\n  displayName?: string;\n  /** Optional indicator to show participant is the user. */\n\n  me?: boolean;\n  /** Optional callback returning a JSX element to override avatar. */\n\n  onRenderAvatar?: OnRenderAvatarCallback;\n  /** Optional array of IContextualMenuItem for contextual menu. */\n\n  menuItems?: IContextualMenuItem[];\n  /** Optional callback returning a JSX element rendered on the right portion of the ParticipantItem. Intended for adding icons. */\n\n  onRenderIcon?: (props?: ParticipantItemProps) => JSX.Element | null;\n  /** Optional PersonaPresence to show participant presence. This will not have an effect if property avatar is assigned. */\n\n  presence?: PersonaPresence;\n  /**\n   * Allows users to pass in an object contains custom CSS styles.\n   * @Example\n   * ```\n   * <ParticipantItem styles={{ root: { background: 'blue' } }} />\n   * ```\n   */\n\n  styles?: ParticipantItemStyles;\n  /**\n   * Optional strings to override in component\n   */\n\n  strings?: Partial<ParticipantItemStrings>;\n  /**\n   * Optional callback when component is clicked\n   */\n\n  onClick?: (props?: ParticipantItemProps) => void;\n  /** prop to determine if we should show tooltip for participants or not */\n\n  showParticipantOverflowTooltip?: boolean;\n}\n/**\n * Component to render a calling or chat participant.\n *\n * Displays the participant's avatar, displayName and status as well as optional icons and context menu.\n *\n * @public\n */\n\nexport const ParticipantItem = (props: ParticipantItemProps): JSX.Element => {\n  const {\n    userId,\n    displayName,\n    onRenderAvatar,\n    menuItems,\n    onRenderIcon,\n    presence,\n    styles,\n    me,\n    onClick,\n    showParticipantOverflowTooltip\n    /* @conditional-compile-remove(PSTN-calls) */\n\n  } = props;\n  const [itemHovered, setItemHovered] = useState<boolean>(false);\n  const [itemFocused, setItemFocused] = useState<boolean>(false);\n  const [menuHidden, setMenuHidden] = useState<boolean>(true);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const theme = useTheme();\n  const localeStrings = useLocale().strings.participantItem;\n  const ids = useIdentifiers();\n  const strings = { ...localeStrings,\n    ...props.strings\n  };\n  const avatarOptions = {\n    text: displayName,\n    size: PersonaSize.size32,\n    presence: presence,\n    initialsTextColor: 'white',\n    showOverflowTooltip: showParticipantOverflowTooltip\n  };\n  const avatar = onRenderAvatar ? onRenderAvatar(userId ?? '', avatarOptions) : <Persona className={mergeStyles({\n    // Prevents persona text from being vertically truncated if a global line height is less than 1.15.\n    lineHeight: '1.15rem'\n  }, styles?.avatar)} {...avatarOptions} />;\n  const meTextStyle = useMemo(() => mergeStyles(meContainerStyle, {\n    color: theme.palette.neutralTertiary\n  }, styles?.me), [theme.palette.neutralTertiary, styles?.me]);\n  const contextualMenuStyle = useMemo(() => mergeStyles({\n    background: theme.palette.neutralLighterAlt\n  }, styles?.menu), [theme.palette.neutralLighterAlt, styles?.menu]);\n  const infoContainerStyle = useMemo(() => mergeStyles(iconContainerStyle, {\n    color: theme.palette.neutralTertiary\n  }, styles?.iconContainer), [theme.palette.neutralTertiary, styles?.iconContainer]);\n  const menuButton = useMemo(() => <Stack horizontal={true} horizontalAlign=\"end\" className={mergeStyles(menuButtonContainerStyle)} title={strings.menuTitle} data-ui-id={ids.participantItemMenuButton}>\n        <Icon iconName={itemHovered || itemFocused || !menuHidden ? 'ParticipantItemOptionsHovered' : 'ParticipantItemOptions'} className={iconStyles} />\n      </Stack>, [strings.menuTitle, ids.participantItemMenuButton, itemHovered, itemFocused, menuHidden]);\n\n  const onDismissMenu = (): void => {\n    setItemHovered(false);\n    setItemFocused(false);\n    setMenuHidden(true);\n  };\n\n  const participantStateString = participantStateStringTrampoline(props, strings);\n  return <div ref={containerRef} role={'menuitem'} data-is-focusable={true} data-ui-id=\"participant-item\" className={mergeStyles(participantItemContainerStyle({\n    localparticipant: me,\n    clickable: !!menuItems\n  }), styles?.root)} onMouseEnter={() => setItemHovered(true)} onMouseLeave={() => setItemHovered(false)} onFocus={() => setItemFocused(true)} onBlur={() => setItemFocused(false)} onClick={() => {\n    if (!participantStateString) {\n      setItemHovered(true);\n      setMenuHidden(false);\n      onClick?.(props);\n    }\n  }} tabIndex={0}>\n      <Stack horizontal className={mergeStyles({\n      width: `calc(100% - ${!me && participantStateString ? participantStateMaxWidth : menuButtonContainerStyle.width})`,\n      alignItems: 'center'\n    })}>\n        {avatar}\n        {me && <Text className={meTextStyle}>{strings.isMeText}</Text>}\n        <Stack horizontal className={mergeStyles(infoContainerStyle)}>\n          {onRenderIcon && onRenderIcon(props)}\n        </Stack>\n      </Stack>\n      {\n      /* When the participantStateString has a value, we don't show the menu  */\n    }\n      {!me && participantStateString ? <Text data-ui-id=\"participant-item-state-string\" className={mergeStyles(participantStateStringStyles)}>\n          {participantStateString}\n        </Text> : <div>\n          {menuItems && menuItems.length > 0 && <>\n              {menuButton}\n              <ContextualMenu items={menuItems} hidden={menuHidden} target={containerRef} onItemClick={onDismissMenu} onDismiss={onDismissMenu} directionalHint={DirectionalHint.bottomRightEdge} className={contextualMenuStyle} calloutProps={{\n          preventDismissOnEvent\n        }} />\n            </>}\n        </div>}\n    </div>;\n};\n\nconst participantStateStringTrampoline = (props: ParticipantItemProps, strings: ParticipantItemStrings): string | undefined => {\n  return undefined;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles } from '@fluentui/react';\nimport { ParticipantListItemStyles } from '../ParticipantList';\n/**\n * @private\n */\n\nexport const participantListStyle = mergeStyles({\n  height: '100%',\n  padding: '0.125rem'\n});\n/**\n * @private\n */\n\nexport const participantListItemStyle: ParticipantListItemStyles = {\n  root: {\n    paddingLeft: '1rem',\n    paddingRight: '1rem'\n  }\n};\n/**\n * @private\n */\n\nexport const iconStyles = mergeStyles({\n  display: 'flex',\n  lineHeight: 0,\n  alignItems: 'center'\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Icon, IContextualMenuItem, IContextualMenuItemStyles, merge, mergeStyles, PersonaPresence, Stack } from '@fluentui/react';\nimport React, { useCallback, useMemo } from 'react';\nimport { useIdentifiers } from '../identifiers';\nimport { useLocale } from '../localization';\nimport { BaseCustomStyles, CallParticipantListParticipant, OnRenderAvatarCallback, ParticipantListParticipant } from '../types';\nimport { ParticipantItem, ParticipantItemStrings, ParticipantItemStyles } from './ParticipantItem';\nimport { iconStyles, participantListItemStyle, participantListStyle } from './styles/ParticipantList.styles';\n/**\n * Styles for the {@link ParticipantList} {@link ParticipantItem}.\n *\n * @public\n */\n\nexport interface ParticipantListItemStyles extends ParticipantItemStyles {\n  /** Styles applied to the sub-menu of the {@link ParticipantList} {@link ParticipantItem}. */\n  participantSubMenuItemsStyles?: IContextualMenuItemStyles;\n}\n/**\n * Styles for the {@link ParticipantList}.\n *\n * @public\n */\n\nexport interface ParticipantListStyles extends BaseCustomStyles {\n  /** Styles for the {@link ParticipantList} {@link ParticipantItem}. */\n  participantItemStyles?: ParticipantListItemStyles;\n}\n/**\n * A callback for providing custom menu items for each participant in {@link ParticipantList}.\n *\n * @public\n */\n\nexport type ParticipantMenuItemsCallback = (participantUserId: string, userId?: string, defaultMenuItems?: IContextualMenuItem[]) => IContextualMenuItem[];\n/**\n * Props for {@link ParticipantList}.\n *\n * @public\n */\n\nexport type ParticipantListProps = {\n  /** Participants in user call or chat */\n  participants: ParticipantListParticipant[];\n  /** User ID of user */\n\n  myUserId?: string;\n  /**\n   * If set to `true`, excludes the local participant from the participant list with use of `myUserId` props (required in this case).\n   *\n   * @defaultValue `false`\n   */\n\n  excludeMe?: boolean;\n  /** Optional callback to render each participant. If no callback is provided, each participant will be rendered with `ParticipantItem`  */\n\n  onRenderParticipant?: (participant: ParticipantListParticipant) => JSX.Element | null;\n  /** Optional callback to render the avatar for each participant. This property will have no effect if `onRenderParticipant` is assigned.  */\n\n  onRenderAvatar?: OnRenderAvatarCallback;\n  /** Optional callback to render the context menu for each participant  */\n\n  onRemoveParticipant?: (userId: string) => void;\n  /** Optional callback to render custom menu items for each participant. */\n\n  onFetchParticipantMenuItems?: ParticipantMenuItemsCallback;\n  /** Optional callback when rendered ParticipantItem is clicked */\n\n  onParticipantClick?: (participant?: ParticipantListParticipant) => void;\n  /** Styles for the {@link ParticipantList} */\n\n  styles?: ParticipantListStyles;\n  /** prop to determine if we should show tooltip for participants or not */\n\n  showParticipantOverflowTooltip?: boolean;\n};\n\nconst onRenderParticipantDefault = (participant: ParticipantListParticipant, strings: ParticipantItemStrings, myUserId?: string, onRenderAvatar?: OnRenderAvatarCallback, createParticipantMenuItems?: (participant: ParticipantListParticipant) => IContextualMenuItem[], styles?: ParticipantListItemStyles, onParticipantClick?: (participant?: ParticipantListParticipant) => void, showParticipantOverflowTooltip?: boolean): JSX.Element | null => {\n  const callingParticipant = (participant as CallParticipantListParticipant);\n  let presence: PersonaPresence | undefined = undefined;\n\n  if (callingParticipant) {\n    if (callingParticipant.state === 'Connected') {\n      presence = PersonaPresence.online;\n    } else if (callingParticipant.state === 'Idle') {\n      presence = PersonaPresence.away;\n    }\n  }\n\n  const menuItems = createParticipantMenuItems && createParticipantMenuItems(participant);\n  const onRenderIcon = callingParticipant?.isScreenSharing || callingParticipant?.isMuted ? () => <Stack horizontal={true} tokens={{\n    childrenGap: '0.5rem'\n  }}>\n            {callingParticipant.isScreenSharing && <Icon iconName=\"ParticipantItemScreenShareStart\" className={iconStyles} ariaLabel={strings.sharingIconLabel} />}\n            {callingParticipant.isMuted && <Icon iconName=\"ParticipantItemMicOff\" className={iconStyles} ariaLabel={strings.mutedIconLabel} />}\n          </Stack> : () => null;\n  const displayName = !participant.displayName ? strings.displayNamePlaceholder : participant.displayName;\n  return <ParticipantItem styles={styles} key={participant.userId} userId={participant.userId} displayName={displayName} me={myUserId ? participant.userId === myUserId : false} menuItems={menuItems} presence={presence} onRenderIcon={onRenderIcon} onRenderAvatar={onRenderAvatar} onClick={() => onParticipantClick?.(participant)} showParticipantOverflowTooltip={showParticipantOverflowTooltip} />;\n};\n\nconst getParticipantsForDefaultRender = (participants: ParticipantListParticipant[], excludeMe: boolean, myUserId: string | undefined): ParticipantListParticipant[] => {\n  if (!excludeMe || !myUserId) {\n    return [...participants];\n  }\n\n  const userIndex = participants.map(p => p.userId).indexOf(myUserId);\n\n  if (userIndex === -1) {\n    return [...participants];\n  }\n\n  const remoteParticipants = [...participants];\n  remoteParticipants.splice(userIndex, 1);\n  return remoteParticipants;\n};\n/**\n * Component to render all calling or chat participants.\n *\n * By default, each participant is rendered with {@link ParticipantItem}. See {@link ParticipantListProps.onRenderParticipant} to override.\n *\n * @public\n */\n\n\nexport const ParticipantList = (props: ParticipantListProps): JSX.Element => {\n  const {\n    excludeMe = false,\n    myUserId,\n    participants,\n    onRemoveParticipant,\n    onRenderAvatar,\n    onRenderParticipant,\n    onFetchParticipantMenuItems,\n    showParticipantOverflowTooltip\n  } = props;\n  const ids = useIdentifiers();\n  const strings = useLocale().strings.participantItem;\n  const displayedParticipants: ParticipantListParticipant[] = useMemo(() => {\n    return onRenderParticipant ? participants : getParticipantsForDefaultRender(participants, excludeMe, myUserId);\n  }, [participants, excludeMe, myUserId, onRenderParticipant]);\n  const createParticipantMenuItems = useCallback((participant: ParticipantListParticipant): IContextualMenuItem[] => {\n    let menuItems: IContextualMenuItem[] = [];\n    let participantIsRemovable = participant.isRemovable;\n\n    if (participant.userId !== myUserId && onRemoveParticipant && participantIsRemovable) {\n      menuItems.push({\n        key: 'remove',\n        text: strings.removeButtonLabel,\n        onClick: () => onRemoveParticipant(participant.userId),\n        itemProps: {\n          styles: props.styles?.participantItemStyles?.participantSubMenuItemsStyles\n        },\n        'data-ui-id': ids.participantListRemoveParticipantButton\n      });\n    }\n\n    if (onFetchParticipantMenuItems) {\n      menuItems = onFetchParticipantMenuItems(participant.userId, myUserId, menuItems);\n    }\n\n    return menuItems;\n  }, [ids.participantListRemoveParticipantButton, myUserId, onFetchParticipantMenuItems, onRemoveParticipant, props.styles?.participantItemStyles?.participantSubMenuItemsStyles, strings.removeButtonLabel]);\n  const participantItemStyles = useMemo(() => merge(participantListItemStyle, props.styles?.participantItemStyles), [props.styles?.participantItemStyles]);\n  return <Stack data-ui-id={ids.participantList} className={mergeStyles(participantListStyle, props.styles?.root)}>\n      {displayedParticipants.map((participant: ParticipantListParticipant) => onRenderParticipant ? onRenderParticipant(participant) : onRenderParticipantDefault(participant, strings, myUserId, onRenderAvatar, createParticipantMenuItems, participantItemStyles, props.onParticipantClick, showParticipantOverflowTooltip))}\n    </Stack>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { VideoGalleryRemoteParticipant } from '../types';\ntype SmartDominantSpeakerParticipantsArgs = {\n  /**\n   * Array containing all participants of a call. {@link @azure/communication-react#VideoGalleryRemoteParticipant}\n   */\n  participants: VideoGalleryRemoteParticipant[];\n  /**\n   * An array containing the userId of dominant speakers\n   * in a call in the order of their dominance. 0th index is the most dominant, 1st is the second most etc\n   */\n\n  dominantSpeakers?: string[];\n  /**\n   * Array containing currently rendered (visible)\n   * participants in the call. {@link @azure/communication-react#VideoGalleryRemoteParticipant}\n   */\n\n  lastVisibleParticipants?: VideoGalleryRemoteParticipant[];\n  /**\n   * Maximum number of dominant speaker positions to move participants in.\n   */\n\n  maxDominantSpeakers: number;\n};\n/**\n * Calculates the participants that should be rendered based on the list of dominant\n * speakers and currently rendered participants in a call.\n * @param args - SmartDominantSpeakerParticipantsArgs\n * @returns VideoGalleryRemoteParticipant[] {@link @azure/communication-react#VideoGalleryRemoteParticipant}\n */\n\nexport const smartDominantSpeakerParticipants = (args: SmartDominantSpeakerParticipantsArgs): VideoGalleryRemoteParticipant[] => {\n  const {\n    participants,\n    dominantSpeakers = [],\n    lastVisibleParticipants = [],\n    maxDominantSpeakers\n  } = args; // Don't apply any logic if total number of video streams is less than max dominant speakers.\n\n  if (participants.length <= maxDominantSpeakers) {\n    return participants;\n  }\n\n  const participantsMap = participantsById(participants); // Only use the Max allowed dominant speakers that exist in participants\n\n  const dominantSpeakerIds = Array.from(new Set(dominantSpeakers).values()).filter(id => !!participantsMap[id]).slice(0, maxDominantSpeakers);\n  const lastVisibleParticipantIds = lastVisibleParticipants.map(p => p.userId);\n  const newVisibleParticipantIds = lastVisibleParticipants.map(p => p.userId).slice(0, maxDominantSpeakers);\n  const newDominantSpeakerIds = dominantSpeakerIds.filter(id => !newVisibleParticipantIds.includes(id)); // Remove participants that are no longer dominant and replace them with new dominant speakers.\n\n  for (let index = 0; index < maxDominantSpeakers; index++) {\n    const newVisibleParticipantId = newVisibleParticipantIds[index];\n\n    if (newVisibleParticipantId === undefined || !dominantSpeakerIds.includes(newVisibleParticipantId)) {\n      const replacement = newDominantSpeakerIds.shift();\n\n      if (!replacement) {\n        break;\n      }\n\n      newVisibleParticipantIds[index] = replacement;\n    }\n  }\n\n  const removedVisibleParticipantIds = lastVisibleParticipantIds.filter(p => !newVisibleParticipantIds.includes(p));\n  removedVisibleParticipantIds.forEach(p => newVisibleParticipantIds.push(p));\n  const newVisibleParticipantIdSet = new Set(newVisibleParticipantIds);\n  const leftoverParticipants = participants.filter(p => !newVisibleParticipantIdSet.has(p.userId));\n  leftoverParticipants.forEach(p => {\n    newVisibleParticipantIds.push(p.userId);\n  }); // newVisibleParticipantIds can contain identifiers for participants that are no longer in the call. So we ignore those IDs.\n\n  const newVisibleParticipants = newVisibleParticipantIds.map(participantId => participantsMap[participantId]).filter(p => !!p);\n  return newVisibleParticipants;\n};\n\nconst participantsById = (participants: VideoGalleryRemoteParticipant[]): {\n  [key: string]: VideoGalleryRemoteParticipant;\n} => {\n  const response: {\n    [key: string]: VideoGalleryRemoteParticipant;\n  } = {};\n  participants.forEach(p => response[p.userId] = p);\n  return response;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { useEffect, useMemo } from 'react';\nimport { VideoStreamOptions, CreateVideoStreamViewResult, ViewScalingMode } from '../../types';\n/** @private */\n\nexport interface VideoStreamLifecycleMaintainerExtendableProps {\n  isStreamAvailable?: boolean;\n  renderElementExists?: boolean;\n  isMirrored?: boolean;\n  scalingMode?: ViewScalingMode;\n  isScreenSharingOn?: boolean;\n}\ninterface VideoStreamLifecycleMaintainerProps extends VideoStreamLifecycleMaintainerExtendableProps {\n  onCreateStreamView: (options?: VideoStreamOptions) => Promise<void | CreateVideoStreamViewResult> | undefined;\n  onDisposeStreamView: () => void | undefined;\n}\n/**\n * Helper hook to maintain the video stream lifecycle. This calls onCreateStreamView and onDisposeStreamView\n * appropriately based on react lifecycle events and prop changes.\n *\n * @remarks\n *\n * Notes on handling changes to scaling mode:\n *\n * Ideally we have access to the original StreamRenderView and can call view.updateScalingMode() and do not need to recreate the stream view.\n * However, to support backwards compat we cannot guarantee this. If we don't have access to the original StreamRenderView we need to dispose\n * the old view and create a new one.\n *\n * Supporting both of these scenarios became too complex and fragile. When we introduce a breaking change this should be update to ensure that\n * onCreateStreamView _must_ return a view object with updateScalingMode and update logic in this hook to call view.updateScalingMode instead\n * of recreating the stream.\n *\n * @private\n */\n\nconst useVideoStreamLifecycleMaintainer = (props: VideoStreamLifecycleMaintainerProps): void => {\n  const {\n    isMirrored,\n    isScreenSharingOn,\n    isStreamAvailable,\n    onCreateStreamView,\n    onDisposeStreamView,\n    renderElementExists,\n    scalingMode\n  } = props;\n  useEffect(() => {\n    if (isStreamAvailable && !renderElementExists) {\n      onCreateStreamView?.({\n        isMirrored,\n        scalingMode\n      });\n    } // Always clean up element to make tile up to date and be able to dispose correctly\n\n\n    return () => {\n      if (renderElementExists) {\n        // TODO: Remove `if isScreenSharingOn` when we isolate dispose behavior for screen share\n        if (!isScreenSharingOn) {\n          onDisposeStreamView?.();\n        }\n      }\n    };\n  }, [isMirrored, isScreenSharingOn, isStreamAvailable, onCreateStreamView, onDisposeStreamView, renderElementExists, scalingMode]); // The execution order for above useEffect is onCreateRemoteStreamView =>(async time gap) RenderElement generated => element disposed => onDisposeRemoteStreamView\n  // Element disposed could happen during async time gap, which still cause leaks for unused renderElement.\n  // Need to do an entire cleanup when remoteTile gets disposed and make sure element gets correctly disposed\n\n  useEffect(() => {\n    return () => {\n      // TODO: Remove `if isScreenSharingOn` when we isolate dispose behavior for screen share\n      if (!isScreenSharingOn) {\n        onDisposeStreamView?.();\n      }\n    };\n  }, [isScreenSharingOn, onDisposeStreamView]);\n};\n/** @private */\n\n\nexport interface LocalVideoStreamLifecycleMaintainerProps extends VideoStreamLifecycleMaintainerExtendableProps {\n  onCreateLocalStreamView?: (options?: VideoStreamOptions) => Promise<void | CreateVideoStreamViewResult>;\n  onDisposeLocalStreamView?: () => void;\n}\n/**\n * Extension of {@link useVideoStreamLifecycleMaintainer} specifically for local video streams\n *\n * @private\n */\n\nexport const useLocalVideoStreamLifecycleMaintainer = (props: LocalVideoStreamLifecycleMaintainerProps): void => {\n  const {\n    onCreateLocalStreamView,\n    onDisposeLocalStreamView\n  } = props;\n  const onCreateStreamView = useMemo(() => (options?: VideoStreamOptions) => {\n    return onCreateLocalStreamView?.(options);\n  }, [onCreateLocalStreamView]);\n  const onDisposeStreamView = useMemo(() => () => {\n    onDisposeLocalStreamView?.();\n  }, [onDisposeLocalStreamView]);\n  return useVideoStreamLifecycleMaintainer({ ...props,\n    onCreateStreamView,\n    onDisposeStreamView\n  });\n};\n/** @private */\n\nexport interface RemoteVideoStreamLifecycleMaintainerProps extends VideoStreamLifecycleMaintainerExtendableProps {\n  onCreateRemoteStreamView?: (userId: string, options?: VideoStreamOptions) => Promise<void | CreateVideoStreamViewResult>;\n  onDisposeRemoteStreamView?: (userId: string) => Promise<void>;\n  remoteParticipantId: string;\n}\n/**\n * Extension of {@link useVideoStreamLifecycleMaintainer} specifically for remote video streams\n *\n * @private\n */\n\nexport const useRemoteVideoStreamLifecycleMaintainer = (props: RemoteVideoStreamLifecycleMaintainerProps): void => {\n  const {\n    remoteParticipantId,\n    onCreateRemoteStreamView,\n    onDisposeRemoteStreamView\n  } = props;\n  const onCreateStreamView = useMemo(() => (options?: VideoStreamOptions) => {\n    return onCreateRemoteStreamView?.(remoteParticipantId, options);\n  }, [onCreateRemoteStreamView, remoteParticipantId]);\n  const onDisposeStreamView = useMemo(() => () => {\n    onDisposeRemoteStreamView?.(remoteParticipantId);\n  }, [onDisposeRemoteStreamView, remoteParticipantId]);\n  return useVideoStreamLifecycleMaintainer({ ...props,\n    onCreateStreamView,\n    onDisposeStreamView\n  });\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStyle, mergeStyles, Theme } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const rootStyles: IStyle = {\n  position: 'relative',\n  height: '100%',\n  width: '100%'\n};\n/**\n * @private\n */\n\nexport const videoContainerStyles: IStyle = {\n  position: 'absolute',\n  top: '0',\n  left: '0',\n  width: '100%',\n  height: '100%',\n  minWidth: '100%',\n  minHeight: '100%',\n  objectPosition: 'center',\n  objectFit: 'cover',\n  zIndex: 0\n};\n/**\n * @private\n */\n\nexport const overlayContainerStyles: IStyle = {\n  width: '100%',\n  height: '100%',\n  zIndex: 5\n};\n/**\n * @private\n */\n\nexport const tileInfoContainerStyle = mergeStyles({\n  position: 'absolute',\n  bottom: '0',\n  left: '0',\n  padding: '0.5rem',\n  width: '100%'\n});\n/**\n * @private\n */\n\nexport const disabledVideoHint = mergeStyles({\n  backgroundColor: 'inherit',\n  boxShadow: 'none',\n  textAlign: 'left',\n  overflow: 'hidden',\n  whiteSpace: 'nowrap',\n  alignItems: 'center',\n  padding: '0.15rem',\n  maxWidth: '100%'\n});\n/**\n * @private\n */\n\nexport const videoHint = mergeStyles(disabledVideoHint, {\n  // This will appear on top of the video stream, so no dependency on theme and explicitly use a translucent white\n  backgroundColor: 'rgba(255,255,255,0.8)'\n});\n/**\n * @private\n */\n\nexport const displayNameStyle: IStyle = {\n  padding: '0.1rem',\n  fontSize: '0.75rem',\n  fontWeight: 600,\n  // Text component will take body color by default (white in Dark Mode), so forcing it to be parent container color\n  color: 'inherit',\n  overflow: 'hidden',\n  textOverflow: 'ellipsis',\n  maxWidth: '100%'\n};\n/**\n * @private\n */\n\nexport const iconContainerStyle: IStyle = {\n  margin: 'auto',\n  alignItems: 'center',\n  '& svg': {\n    display: 'block',\n    // Similar to text color, icon color will be inherited from parent container\n    color: 'inherit'\n  }\n};\n/**\n * @private\n */\n\nexport const participantStateStringStyles = (theme: Theme): IStyle => {\n  return {\n    minWidth: 'max-content',\n    color: theme.palette.black,\n    fontSize: '0.75rem',\n    lineHeight: 'normal',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    padding: '0.1rem'\n  };\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { DefaultPalette as palette, IStyle, Theme } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const getVideoTileOverrideColor = (isVideoRendered: boolean, theme: Theme, color: string): IStyle => {\n  // when video is being rendered, the info has a grey-ish background, so no use of theme\n  return {\n    color: isVideoRendered ? palette[color] : theme.palette[color]\n  };\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Icon, IStyle, mergeStyles, Persona, Stack, Text } from '@fluentui/react';\nimport { Ref } from '@fluentui/react-northstar';\nimport React, { useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport { useIdentifiers } from '../identifiers';\nimport { ComponentLocale, useLocale } from '../localization';\nimport { useTheme } from '../theming';\nimport { BaseCustomStyles, CustomAvatarOptions, OnRenderAvatarCallback } from '../types';\nimport { disabledVideoHint, displayNameStyle, iconContainerStyle, overlayContainerStyles, rootStyles, videoContainerStyles, videoHint, tileInfoContainerStyle, participantStateStringStyles } from './styles/VideoTile.styles';\nimport { getVideoTileOverrideColor } from './utils/videoTileStylesUtils';\n/**\n * Strings of {@link VideoTile} that can be overridden.\n * @beta\n */\n\nexport interface VideoTileStrings {\n  participantStateConnecting: string;\n  participantStateRinging: string;\n  participantStateHold: string;\n}\n/**\n * Fluent styles for {@link VideoTile}.\n *\n * @public\n */\n\nexport interface VideoTileStylesProps extends BaseCustomStyles {\n  /** Styles for video container. */\n  videoContainer?: IStyle;\n  /** Styles for container overlayed on the video container. */\n\n  overlayContainer?: IStyle;\n  /** Styles for displayName on the video container. */\n\n  displayNameContainer?: IStyle;\n}\n/**\n * Props for {@link VideoTile}.\n *\n * @public\n */\n\nexport interface VideoTileProps {\n  /** React Child components. Child Components will show as overlay component in the VideoTile. */\n  children?: React.ReactNode;\n  /**\n   * Allows users to pass in an object contains custom CSS styles.\n   * @Example\n   * ```\n   * <VideoTile styles={{ root: { background: 'blue' } }} />\n   * ```\n   */\n\n  styles?: VideoTileStylesProps;\n  /** user id for the VideoTile placeholder. */\n\n  userId?: string;\n  /** Component with the video stream. */\n\n  renderElement?: JSX.Element | null;\n  /** Determines if the video is mirrored or not. */\n\n  isMirrored?: boolean;\n  /** Custom render Component function for no video is available. Render a Persona Icon if undefined. */\n\n  onRenderPlaceholder?: OnRenderAvatarCallback;\n  /**\n   * Show label on the VideoTile\n   * @defaultValue true\n   */\n\n  showLabel?: boolean;\n  /**\n   * Whether to display a mute icon beside the user's display name.\n   * @defaultValue true\n   */\n\n  showMuteIndicator?: boolean;\n  /**\n   * Whether the video is muted or not.\n   */\n\n  isMuted?: boolean;\n  /**\n   * Display Name of the Participant to be shown in the label.\n   * @remarks `displayName` is used to generate avatar initials if `initialsName` is not provided.\n   */\n\n  displayName?: string;\n  /**\n   * Name of the participant used to generate initials. For example, a name `John Doe` will display `JD` as initials.\n   * @remarks `displayName` is used if this property is not specified.\n   */\n\n  initialsName?: string;\n  /**\n   * Minimum size of the persona avatar in px.\n   * The persona avatar is the default placeholder shown when no video stream is available.\n   * For more information see https://developer.microsoft.com/en-us/fluentui#/controls/web/persona\n   * @defaultValue 32px\n   */\n\n  personaMinSize?: number;\n  /**\n   * Maximum size of the personal avatar in px.\n   * The persona avatar is the default placeholder shown when no video stream is available.\n   * For more information see https://developer.microsoft.com/en-us/fluentui#/controls/web/persona\n   * @defaultValue 100px\n   */\n\n  personaMaxSize?: number;\n  /** Optional property to set the aria label of the video tile if there is no available stream. */\n\n  noVideoAvailableAriaLabel?: string;\n  /** Whether the participant in the videoTile is speaking. Shows a speaking indicator (border). */\n\n  isSpeaking?: boolean;\n} // Coin max size is set to PersonaSize.size100\n\nconst DEFAULT_PERSONA_MAX_SIZE_PX = 100; // Coin min size is set PersonaSize.size32\n\nconst DEFAULT_PERSONA_MIN_SIZE_PX = 32;\n\nconst DefaultPlaceholder = (props: CustomAvatarOptions): JSX.Element => {\n  const {\n    text,\n    noVideoAvailableAriaLabel,\n    coinSize,\n    hidePersonaDetails\n  } = props;\n  return <Stack className={mergeStyles({\n    position: 'absolute',\n    height: '100%',\n    width: '100%'\n  })}>\n      <Stack styles={defaultPersonaStyles}>\n        <Persona coinSize={coinSize} hidePersonaDetails={hidePersonaDetails} text={text ?? ''} initialsTextColor=\"white\" aria-label={noVideoAvailableAriaLabel ?? ''} showOverflowTooltip={false} />\n      </Stack>\n    </Stack>;\n};\n\nconst defaultPersonaStyles = {\n  root: {\n    margin: 'auto',\n    maxHeight: '100%'\n  }\n};\n/**\n * A component to render the video stream for a single call participant.\n *\n * Use with {@link GridLayout} in a {@link VideoGallery}.\n *\n * @public\n */\n\nexport const VideoTile = (props: VideoTileProps): JSX.Element => {\n  const {\n    children,\n    displayName,\n    initialsName,\n    isMirrored,\n    isMuted,\n    onRenderPlaceholder,\n    renderElement,\n    showLabel = true,\n    showMuteIndicator = true,\n    styles,\n    userId,\n    noVideoAvailableAriaLabel,\n    isSpeaking,\n    personaMinSize = DEFAULT_PERSONA_MIN_SIZE_PX,\n    personaMaxSize = DEFAULT_PERSONA_MAX_SIZE_PX\n  } = props;\n  const [personaSize, setPersonaSize] = useState(100);\n  const videoTileRef = useRef<HTMLElement>(null);\n  const locale = useLocale();\n  const theme = useTheme();\n  const isVideoRendered = !!renderElement;\n  const observer = useRef(new ResizeObserver((entries): void => {\n    const {\n      width,\n      height\n    } = entries[0].contentRect;\n    const personaSize = Math.min(width, height) / 3;\n    setPersonaSize(Math.max(Math.min(personaSize, personaMaxSize), personaMinSize));\n  }));\n  useLayoutEffect(() => {\n    if (videoTileRef.current) {\n      observer.current.observe(videoTileRef.current);\n    }\n\n    const currentObserver = observer.current;\n    return () => currentObserver.disconnect();\n  }, [observer, videoTileRef]);\n  const placeholderOptions = {\n    userId,\n    text: initialsName || displayName,\n    noVideoAvailableAriaLabel,\n    coinSize: personaSize,\n    styles: defaultPersonaStyles,\n    hidePersonaDetails: true\n  };\n  const videoHintWithBorderRadius = mergeStyles(videoHint, {\n    borderRadius: theme.effects.roundedCorner4\n  });\n  const tileInfoStyle = useMemo(() => mergeStyles(isVideoRendered ? videoHintWithBorderRadius : disabledVideoHint, getVideoTileOverrideColor(isVideoRendered, theme, 'neutralPrimary'), styles?.displayNameContainer), [isVideoRendered, videoHintWithBorderRadius, theme, styles?.displayNameContainer]);\n  const ids = useIdentifiers();\n  const canShowLabel = showLabel && (displayName || showMuteIndicator && isMuted);\n  const participantStateString = participantStateStringTrampoline(props, locale);\n  return <Ref innerRef={videoTileRef}>\n      <Stack data-ui-id={ids.videoTile} className={mergeStyles(rootStyles, {\n      background: theme.palette.neutralLighter,\n      borderRadius: theme.effects.roundedCorner4\n    }, isSpeaking && {\n      '&::before': {\n        content: `''`,\n        position: 'absolute',\n        zIndex: 1,\n        border: `0.25rem solid ${theme.palette.themePrimary}`,\n        borderRadius: theme.effects.roundedCorner4,\n        width: '100%',\n        height: '100%'\n      }\n    }, styles?.root)}>\n        {isVideoRendered ? <Stack className={mergeStyles(videoContainerStyles, isMirrored && {\n        transform: 'scaleX(-1)'\n      }, styles?.videoContainer)}>\n            {renderElement}\n          </Stack> : <Stack className={mergeStyles(videoContainerStyles)} style={{\n        opacity: participantStateString ? 0.4 : 1\n      }}>\n            {onRenderPlaceholder ? onRenderPlaceholder(userId ?? '', placeholderOptions, DefaultPlaceholder) : <DefaultPlaceholder {...placeholderOptions} />}\n          </Stack>}\n\n        {(canShowLabel || participantStateString) && <Stack horizontal className={tileInfoContainerStyle} tokens={tileInfoContainerTokens}>\n            <Stack horizontal className={tileInfoStyle}>\n              {canShowLabel && <Text className={mergeStyles(displayNameStyle)} title={displayName} style={{\n            color: participantStateString ? theme.palette.neutralSecondary : 'inherit'\n          }}>\n                  {displayName}\n                </Text>}\n              {participantStateString && <Text className={mergeStyles(participantStateStringStyles(theme))}>\n                  {bracketedParticipantString(participantStateString, !!canShowLabel)}\n                </Text>}\n              {showMuteIndicator && isMuted && <Stack className={mergeStyles(iconContainerStyle)}>\n                  <Icon iconName=\"VideoTileMicOff\" />\n                </Stack>}\n            </Stack>\n          </Stack>}\n\n        {children && <Stack className={mergeStyles(overlayContainerStyles, styles?.overlayContainer)}>{children}</Stack>}\n      </Stack>\n    </Ref>;\n};\n\nconst participantStateStringTrampoline = (props: VideoTileProps, locale: ComponentLocale): string | undefined => {\n  return undefined;\n};\n\nconst tileInfoContainerTokens = {\n  // A horizontal Stack sets the left margin to 0 for all it's children.\n  // We need to allow the children to set their own margins\n  childrenGap: 'none'\n};\n\nconst bracketedParticipantString = (participantString: string, withBrackets: boolean): string => {\n  return withBrackets ? `(${participantString})` : participantString;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { useMemo } from 'react';\nimport { CreateVideoStreamViewResult, OnRenderAvatarCallback, ParticipantState, VideoStreamOptions } from '../types';\nimport { StreamMedia } from './StreamMedia';\nimport { useRemoteVideoStreamLifecycleMaintainer, RemoteVideoStreamLifecycleMaintainerProps } from './VideoGallery/useVideoStreamLifecycleMaintainer';\nimport { VideoTile } from './VideoTile';\n/**\n * A memoized version of VideoTile for rendering remote participants. React.memo is used for a performance\n * boost by memoizing the same rendered component to avoid rerendering a VideoTile when its position in the\n * array changes causing a rerender in the parent component. https://reactjs.org/docs/react-api.html#reactmemo\n *\n * @internal\n */\n\nexport const _RemoteVideoTile = React.memo((props: {\n  userId: string;\n  onCreateRemoteStreamView?: (userId: string, options?: VideoStreamOptions) => Promise<void | CreateVideoStreamViewResult>;\n  onDisposeRemoteStreamView?: (userId: string) => Promise<void>;\n  isAvailable?: boolean;\n  isReceiving?: boolean;\n  isMuted?: boolean;\n  isSpeaking?: boolean;\n  isScreenSharingOn?: boolean; // TODO: Remove this once onDisposeRemoteStreamView no longer disposes of screen share stream\n\n  renderElement?: HTMLElement;\n  displayName?: string;\n  remoteVideoViewOptions?: VideoStreamOptions;\n  onRenderAvatar?: OnRenderAvatarCallback;\n  showMuteIndicator?: boolean;\n  showLabel?: boolean;\n  personaMinSize?: number;\n  participantState?: ParticipantState;\n}) => {\n  const {\n    isAvailable,\n    isReceiving = true,\n    // default to true to prevent any breaking change\n    isMuted,\n    isSpeaking,\n    isScreenSharingOn,\n    onCreateRemoteStreamView,\n    onDisposeRemoteStreamView,\n    remoteVideoViewOptions,\n    renderElement,\n    userId,\n    displayName,\n    onRenderAvatar,\n    showMuteIndicator\n  } = props;\n  const remoteVideoStreamProps: RemoteVideoStreamLifecycleMaintainerProps = useMemo(() => ({\n    isMirrored: remoteVideoViewOptions?.isMirrored,\n    isScreenSharingOn,\n    isStreamAvailable: isAvailable,\n    isStreamReceiving: isReceiving,\n    onCreateRemoteStreamView,\n    onDisposeRemoteStreamView,\n    remoteParticipantId: userId,\n    renderElementExists: !!renderElement,\n    scalingMode: remoteVideoViewOptions?.scalingMode\n  }), [isAvailable, isReceiving, isScreenSharingOn, onCreateRemoteStreamView, onDisposeRemoteStreamView, remoteVideoViewOptions?.isMirrored, remoteVideoViewOptions?.scalingMode, renderElement, userId]); // Handle creating, destroying and updating the video stream as necessary\n\n  useRemoteVideoStreamLifecycleMaintainer(remoteVideoStreamProps);\n  const showLoadingIndicator = isAvailable && isReceiving === false && props.participantState !== 'Disconnected';\n  const renderVideoStreamElement = useMemo(() => {\n    // Checking if renderElement is well defined or not as calling SDK has a number of video streams limitation which\n    // implies that, after their threshold, all streams have no child (blank video)\n    if (!renderElement || !renderElement.childElementCount) {\n      // Returning `undefined` results in the placeholder with avatar being shown\n      return undefined;\n    }\n\n    return <StreamMedia videoStreamElement={renderElement} loadingState={showLoadingIndicator ? 'loading' : 'none'} />;\n  }, [renderElement, showLoadingIndicator]);\n  return <VideoTile key={userId} userId={userId} renderElement={renderVideoStreamElement} displayName={displayName} onRenderPlaceholder={onRenderAvatar} isMuted={isMuted} isSpeaking={isSpeaking} showMuteIndicator={showMuteIndicator} personaMinSize={props.personaMinSize} showLabel={props.showLabel} />;\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStyle, Theme } from '@fluentui/react';\n/**\n * Horizontal Gallery button width in rem\n */\n\nexport const HORIZONTAL_GALLERY_BUTTON_WIDTH = 1.75;\n/**\n * @private\n */\n\nexport const leftRightButtonStyles = (theme: Theme): IStyle => {\n  return {\n    background: 'none',\n    padding: 0,\n    height: 'auto',\n    minWidth: `${HORIZONTAL_GALLERY_BUTTON_WIDTH}rem`,\n    maxWidth: `${HORIZONTAL_GALLERY_BUTTON_WIDTH}rem`,\n    border: `1px solid ${theme.palette.neutralLight}`,\n    borderRadius: theme.effects.roundedCorner4\n  };\n};\n/**\n * Horizontal Gallery gap size in rem between tiles and buttons\n */\n\nexport const HORIZONTAL_GALLERY_GAP = 0.5;\n/**\n * @private\n */\n\nexport const rootStyle: IStyle = {\n  height: '100%',\n  width: '100%',\n  gap: `${HORIZONTAL_GALLERY_GAP}rem`\n};\n/**\n * @private\n */\n\nexport const childrenContainerStyle: IStyle = {\n  height: '100%',\n  gap: `${HORIZONTAL_GALLERY_GAP}rem`\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { DefaultButton, Icon, IStyle, Stack, mergeStyles } from '@fluentui/react';\nimport React, { useMemo, useState } from 'react';\nimport { useTheme } from '../theming';\nimport { BaseCustomStyles } from '../types';\nimport { rootStyle, childrenContainerStyle, leftRightButtonStyles } from './styles/HorizontalGallery.styles';\nimport { useIdentifiers } from '../identifiers';\n/**\n * {@link HorizontalGallery} default children per page\n */\n\nconst DEFAULT_CHILDREN_PER_PAGE = 5;\n/**\n * {@link HorizontalGallery} Component Styles.\n * @public\n */\n\nexport interface HorizontalGalleryStyles extends BaseCustomStyles {\n  /** Styles for each child of {@link HorizontalGallery} */\n  children?: IStyle;\n  /** Styles for navigation button to go to previous page */\n\n  previousButton?: IStyle;\n  /** Styles for navigation button to go to next page */\n\n  nextButton?: IStyle;\n}\n/**\n * {@link HorizontalGallery} Component Props.\n */\n\nexport interface HorizontalGalleryProps {\n  children: React.ReactNode;\n  /**\n   * Styles for HorizontalGallery\n   */\n\n  styles?: HorizontalGalleryStyles;\n  /**\n   * Children shown per page\n   * @defaultValue 5\n   */\n\n  childrenPerPage?: number;\n}\n/**\n * Renders a horizontal gallery that parents children horizontally. Handles pagination based on the childrenPerPage prop.\n * @param props - HorizontalGalleryProps {@link @azure/communication-react#HorizontalGalleryProps}\n * @returns\n */\n\nexport const HorizontalGallery = (props: HorizontalGalleryProps): JSX.Element => {\n  const {\n    children,\n    childrenPerPage = DEFAULT_CHILDREN_PER_PAGE,\n    styles\n  } = props;\n  const ids = useIdentifiers();\n  const [page, setPage] = useState(0);\n  const numberOfChildren = React.Children.count(children);\n  const lastPage = Math.ceil(numberOfChildren / childrenPerPage) - 1;\n  const paginatedChildren: React.ReactNode[][] = useMemo(() => {\n    return bucketize(React.Children.toArray(children), childrenPerPage);\n  }, [children, childrenPerPage]); // If children per page is 0 or less return empty element\n\n  if (childrenPerPage <= 0) {\n    return <></>;\n  }\n\n  const firstIndexOfCurrentPage = page * childrenPerPage;\n  const clippedPage = firstIndexOfCurrentPage < numberOfChildren - 1 ? page : lastPage;\n  const childrenOnCurrentPage = paginatedChildren[clippedPage];\n  const showButtons = numberOfChildren > childrenPerPage;\n  const disablePreviousButton = page === 0;\n  const disableNextButton = page === lastPage;\n  return <Stack horizontal className={mergeStyles(rootStyle, props.styles?.root)}>\n      {showButtons && <HorizontalGalleryNavigationButton key=\"previous-nav-button\" icon={<Icon iconName=\"HorizontalGalleryLeftButton\" />} styles={styles?.previousButton} onClick={() => setPage(Math.max(0, Math.min(lastPage, page - 1)))} disabled={disablePreviousButton} identifier={ids.horizontalGalleryLeftNavButton} />}\n      <Stack horizontal className={mergeStyles(childrenContainerStyle, {\n      '> *': props.styles?.children\n    })}>\n        {childrenOnCurrentPage}\n      </Stack>\n      {showButtons && <HorizontalGalleryNavigationButton key=\"next-nav-button\" icon={<Icon iconName=\"HorizontalGalleryRightButton\" />} styles={styles?.nextButton} onClick={() => setPage(Math.min(lastPage, page + 1))} disabled={disableNextButton} identifier={ids.horizontalGalleryRightNavButton} />}\n    </Stack>;\n};\n\nconst HorizontalGalleryNavigationButton = (props: {\n  icon: JSX.Element;\n  styles: IStyle;\n  onClick?: () => void;\n  disabled?: boolean;\n  identifier?: string;\n}): JSX.Element => {\n  const theme = useTheme();\n  return <DefaultButton className={mergeStyles(leftRightButtonStyles(theme), props.styles)} onClick={props.onClick} disabled={props.disabled} data-ui-id={props.identifier}>\n      {props.icon}\n    </DefaultButton>;\n};\n\nfunction bucketize<T>(arr: T[], bucketSize: number): T[][] {\n  const bucketArray: T[][] = [];\n\n  if (bucketSize <= 0) {\n    return bucketArray;\n  }\n\n  for (let i = 0; i < arr.length; i += bucketSize) {\n    bucketArray.push(arr.slice(i, i + bucketSize));\n  }\n\n  return bucketArray;\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStyle, mergeStyles } from '@fluentui/react';\nimport React, { useRef } from 'react';\nimport { HorizontalGallery, HorizontalGalleryStyles } from './HorizontalGallery';\nimport { _convertRemToPx as convertRemToPx } from '@internal/acs-ui-common';\nimport { _useContainerWidth } from './utils/responsive';\n/**\n * Wrapped HorizontalGallery that adjusts the number of items per page based on the\n * available width obtained from a ResizeObserver, width per child, gap width, and button width\n */\n\nexport const ResponsiveHorizontalGallery = (props: {\n  children: React.ReactNode;\n  containerStyles: IStyle;\n  horizontalGalleryStyles: HorizontalGalleryStyles;\n  childWidthRem: number;\n  gapWidthRem: number;\n  buttonWidthRem?: number;\n}): JSX.Element => {\n  const {\n    childWidthRem,\n    gapWidthRem,\n    buttonWidthRem = 0\n  } = props;\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const containerWidth = _useContainerWidth(containerRef);\n\n  const leftPadding = containerRef.current ? parseFloat(getComputedStyle(containerRef.current).paddingLeft) : 0;\n  const rightPadding = containerRef.current ? parseFloat(getComputedStyle(containerRef.current).paddingRight) : 0;\n  const childrenPerPage = calculateChildrenPerPage({\n    numberOfChildren: React.Children.count(props.children),\n    containerWidth: (containerWidth ?? 0) - leftPadding - rightPadding,\n    childWidthRem,\n    gapWidthRem,\n    buttonWidthRem\n  });\n  return <div ref={containerRef} className={mergeStyles(props.containerStyles)}>\n      <HorizontalGallery childrenPerPage={childrenPerPage} styles={props.horizontalGalleryStyles}>\n        {props.children}\n      </HorizontalGallery>\n    </div>;\n};\n/**\n * Helper function to calculate children per page for HorizontalGallery based on width of container, child, buttons, and\n * gaps in between\n */\n\nconst calculateChildrenPerPage = (args: {\n  numberOfChildren: number;\n  containerWidth: number;\n  childWidthRem: number;\n  gapWidthRem: number;\n  buttonWidthRem: number;\n}): number => {\n  const {\n    numberOfChildren,\n    containerWidth,\n    buttonWidthRem,\n    childWidthRem,\n    gapWidthRem\n  } = args;\n  const childWidth = convertRemToPx(childWidthRem);\n  const gapWidth = convertRemToPx(gapWidthRem);\n  /** First check how many children can fit in containerWidth.\n   *    __________________________________\n   *   |                ||                |\n   *   |                ||                |\n   *   |________________||________________|\n   *   <-----------containerWidth--------->\n   *  containerWidth = n * childWidth + (n - 1) * gapWidth. Isolate n and take the floor.\n   */\n\n  const numberOfChildrenInContainer = Math.floor((containerWidth + gapWidth) / (childWidth + gapWidth)); // If all children fit then return numberOfChildrenInContainer\n\n  if (numberOfChildren <= numberOfChildrenInContainer) {\n    return numberOfChildrenInContainer;\n  }\n\n  const buttonWidth = convertRemToPx(buttonWidthRem);\n  /** We know we need to paginate. So we need to subtract the buttonWidth twice and gapWidth twice from\n   * containerWidth to compute childrenSpace\n   *   <-----------containerWidth--------->\n   *    __________________________________\n   *   | ||             ||             || |\n   *   |<||             ||             ||>|\n   *   |_||_____________||_____________||_|\n   *       <-------childrenSpace------>\n   */\n\n  const childrenSpace = containerWidth - 2 * buttonWidth - 2 * gapWidth; // Now that we have childrenSpace width we can figure out how many children can fit in childrenSpace.\n  // childrenSpace = n * childWidth + (n - 1) * gapWidth. Isolate n and take the floor.\n\n  return Math.floor((childrenSpace + gapWidth) / (childWidth + gapWidth));\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles, IStackStyles, IModalStyleProps, IModalStyles, IStyleFunctionOrObject, Theme, IStyle, concatStyleSets, IButtonStyles } from '@fluentui/react';\nimport { VideoTileStylesProps } from '../VideoTile';\nimport { HorizontalGalleryStyles } from '../HorizontalGallery';\nimport { _pxToRem } from '@internal/acs-ui-common';\n/**\n * @private\n */\n\nexport const videoGalleryOuterDivStyle = mergeStyles({\n  position: 'relative',\n  width: '100%',\n  height: '100%'\n});\n/**\n * @private\n */\n\nexport const videoGalleryContainerStyle: IStackStyles = {\n  root: {\n    position: 'relative',\n    height: '100%',\n    width: '100%',\n    padding: '0.5rem'\n  }\n};\n/**\n * Small floating modal width and height in rem for small screen\n */\n\nexport const SMALL_FLOATING_MODAL_SIZE_PX = {\n  width: 64,\n  height: 88\n};\n/**\n * Large floating modal width and height in rem for large screen\n */\n\nexport const LARGE_FLOATING_MODAL_SIZE_PX = {\n  width: 160,\n  height: 120\n};\n/**\n * @private\n * z-index to ensure that the local video tile is above the video gallery.\n */\n\nexport const LOCAL_VIDEO_TILE_ZINDEX = 2;\n/**\n * @private\n */\n\nexport const floatingLocalVideoModalStyle = (theme: Theme, isNarrow?: boolean): IStyleFunctionOrObject<IModalStyleProps, IModalStyles> => {\n  return concatStyleSets({\n    main: localVideoTileContainerStyle(theme, isNarrow)\n  }, {\n    main: {\n      boxShadow: theme.effects.elevation8,\n      ':focus-within': {\n        boxShadow: theme.effects.elevation16,\n        border: `${_pxToRem(2)} solid ${theme.palette.neutralPrimary}`\n      }\n    }\n  }, localVideoModalStyles);\n};\n/**\n * Padding equal to the amount the modal should stay inside the bounds of the container.\n * i.e. if this is 8px, the modal should always be at least 8px inside the container at all times on all sides.\n * @private\n */\n\nexport const localVideoTileOuterPaddingPX = 8;\n/**\n * @private\n */\n\nexport const localVideoTileContainerStyle = (theme: Theme, isNarrow?: boolean): IStyle => {\n  return {\n    minWidth: isNarrow ? _pxToRem(SMALL_FLOATING_MODAL_SIZE_PX.width) : _pxToRem(LARGE_FLOATING_MODAL_SIZE_PX.width),\n    minHeight: isNarrow ? _pxToRem(SMALL_FLOATING_MODAL_SIZE_PX.height) : _pxToRem(LARGE_FLOATING_MODAL_SIZE_PX.height),\n    position: 'absolute',\n    bottom: _pxToRem(localVideoTileOuterPaddingPX),\n    borderRadius: theme.effects.roundedCorner4,\n    overflow: 'hidden',\n    ...(theme.rtl ? {\n      left: _pxToRem(localVideoTileOuterPaddingPX)\n    } : {\n      right: _pxToRem(localVideoTileOuterPaddingPX)\n    })\n  };\n};\n/**\n * @private\n */\n\nexport const localVideoTileWithControlsContainerStyle = (theme: Theme, isNarrow?: boolean): IStackStyles => {\n  return concatStyleSets(localVideoTileContainerStyle(theme, isNarrow), {\n    root: {\n      boxShadow: theme.effects.elevation8\n    }\n  });\n};\n/**\n * @private\n */\n\nexport const floatingLocalVideoTileStyle: VideoTileStylesProps = {\n  root: {\n    position: 'absolute',\n    zIndex: LOCAL_VIDEO_TILE_ZINDEX,\n    height: '100%',\n    width: '100%'\n  }\n};\n/**\n * @private\n */\n\nexport const horizontalGalleryContainerStyle = (shouldFloatLocalVideo: boolean, isNarrow: boolean): IStyle => {\n  return {\n    minHeight: isNarrow ? `${SMALL_HORIZONTAL_GALLERY_TILE_SIZE_REM.height}rem` : `${LARGE_HORIZONTAL_GALLERY_TILE_SIZE_REM.height}rem`,\n    width: shouldFloatLocalVideo ? isNarrow ? `calc(100% - ${_pxToRem(SMALL_FLOATING_MODAL_SIZE_PX.width)})` : `calc(100% - ${_pxToRem(LARGE_FLOATING_MODAL_SIZE_PX.width)})` : '100%',\n    paddingRight: '0.5rem'\n  };\n};\n/**\n * @private\n */\n\nexport const horizontalGalleryStyle = (isNarrow: boolean): HorizontalGalleryStyles => {\n  return {\n    children: isNarrow ? SMALL_HORIZONTAL_GALLERY_TILE_STYLE : LARGE_HORIZONTAL_GALLERY_TILE_STYLE\n  };\n};\n/**\n * Small horizontal gallery tile size in rem\n * @private\n */\n\nexport const SMALL_HORIZONTAL_GALLERY_TILE_SIZE_REM = {\n  height: 5.5,\n  width: 5.5\n};\n/**\n * Large horizontal gallery tile size in rem\n * @private\n */\n\nexport const LARGE_HORIZONTAL_GALLERY_TILE_SIZE_REM = {\n  height: 7.5,\n  width: 10\n};\n/**\n * @private\n */\n\nexport const SMALL_HORIZONTAL_GALLERY_TILE_STYLE = {\n  minHeight: `${SMALL_HORIZONTAL_GALLERY_TILE_SIZE_REM.height}rem`,\n  minWidth: `${SMALL_HORIZONTAL_GALLERY_TILE_SIZE_REM.width}rem`,\n  maxHeight: `${SMALL_HORIZONTAL_GALLERY_TILE_SIZE_REM.height}rem`,\n  maxWidth: `${SMALL_HORIZONTAL_GALLERY_TILE_SIZE_REM.width}rem`\n};\n/**\n * @private\n */\n\nexport const LARGE_HORIZONTAL_GALLERY_TILE_STYLE = {\n  minHeight: `${LARGE_HORIZONTAL_GALLERY_TILE_SIZE_REM.height}rem`,\n  minWidth: `${LARGE_HORIZONTAL_GALLERY_TILE_SIZE_REM.width}rem`,\n  maxHeight: `${LARGE_HORIZONTAL_GALLERY_TILE_SIZE_REM.height}rem`,\n  maxWidth: `${LARGE_HORIZONTAL_GALLERY_TILE_SIZE_REM.width}rem`\n};\n/**\n * @private\n */\n\nexport const layerHostStyle: IStyle = {\n  position: 'absolute',\n  left: 0,\n  top: 0,\n  width: '100%',\n  height: '100%',\n  overflow: 'hidden',\n  // pointer events for layerHost set to none to make descendants interactive\n  pointerEvents: 'none'\n};\n/**\n * @private\n */\n\nexport const localVideoCameraCycleButtonStyles = (theme: Theme): IButtonStyles => {\n  return {\n    root: {\n      position: 'absolute',\n      width: _pxToRem(32),\n      height: _pxToRem(32),\n      right: '0rem',\n      top: '0rem',\n      color: '#FFFFFF',\n      // only shows up on running video feed to we want to force specific colours.\n      zIndex: 2,\n      // shows the button directly over the local video feed.\n      background: 'rgba(0,0,0,0.4)',\n      borderRadius: theme.effects.roundedCorner2\n    },\n    rootFocused: {\n      // styles to remove the unwanted white highlight and blue colour after tapping on button.\n      color: '#FFFFFF',\n      background: 'rgba(0,0,0,0.4)' // sets opacity of background to be visible on all backdrops in video stream.\n\n    },\n    icon: {\n      paddingLeft: _pxToRem(3),\n      paddingRight: _pxToRem(3),\n      margin: 0\n    },\n    flexContainer: {\n      paddingBottom: _pxToRem(8)\n    }\n  };\n};\n/**\n * Styles for the local video tile modal when it is focused, will cause keyboard move icon to appear over video\n * @private\n */\n\nexport const localVideoModalStyles: Partial<IModalStyles> = {\n  keyboardMoveIconContainer: {\n    zIndex: LOCAL_VIDEO_TILE_ZINDEX + 1 // zIndex to set the keyboard movement Icon above the other layers in the video tile.\n\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles, Theme } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const screenSharingContainerStyle = mergeStyles({\n  width: '100%',\n  height: '100%'\n});\n/**\n * @private\n */\n\nexport const screenSharingNotificationContainerStyle = (theme: Theme): string => mergeStyles({\n  backgroundColor: 'inherit',\n  padding: '1rem',\n  maxWidth: '95%',\n  borderRadius: theme.effects.roundedCorner4,\n  color: theme.palette.neutralSecondary\n});\n/**\n * @private\n */\n\nexport const screenSharingNotificationIconContainerStyle = mergeStyles({\n  height: '2rem',\n  lineHeight: 0\n});\n/**\n * @private\n */\n\nexport const screenSharingNotificationIconStyle = (theme: Theme): string => mergeStyles({\n  // svg is (20px x 20px) but path is only (16px x 12px), so need to scale at 2.5 to get 40px\n  transform: 'scale(2.5)',\n  color: theme.palette.neutralTertiary\n});\n/**\n * @private\n */\n\nexport const screenSharingNotificationTextStyle = mergeStyles({\n  fontSize: '1rem',\n  // Text component will take body color by default (white in Dark Mode), so forcing it to be parent container color\n  color: 'inherit'\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Icon, Stack, Text } from '@fluentui/react';\nimport React from 'react';\nimport { useLocale } from '../../localization';\nimport { useTheme } from '../../theming';\nimport { VideoGalleryLocalParticipant } from '../../types';\nimport { VideoTile } from '../VideoTile';\nimport { screenSharingContainerStyle, screenSharingNotificationContainerStyle, screenSharingNotificationIconContainerStyle, screenSharingNotificationIconStyle, screenSharingNotificationTextStyle } from './styles/LocalScreenShare.styles';\n/**\n * A memoized version of local screen share component. React.memo is used for a performance\n * boost by memoizing the same rendered component to avoid rerendering this when the parent component rerenders.\n * https://reactjs.org/docs/react-api.html#reactmemo\n */\n\nexport const LocalScreenShare = React.memo((props: {\n  localParticipant: VideoGalleryLocalParticipant;\n}) => {\n  const {\n    localParticipant\n  } = props;\n  const theme = useTheme();\n  const locale = useLocale();\n\n  if (!localParticipant || !localParticipant.isScreenSharingOn) {\n    return null;\n  }\n\n  const localScreenSharingNotification = <Stack horizontalAlign=\"center\" verticalAlign=\"center\" className={screenSharingContainerStyle}>\n      <Stack horizontalAlign=\"center\" verticalAlign=\"center\" className={screenSharingNotificationContainerStyle(theme)} tokens={{\n      childrenGap: '1rem'\n    }}>\n        <Stack horizontal verticalAlign=\"center\" className={screenSharingNotificationIconContainerStyle}>\n          <Icon iconName=\"ControlButtonScreenShareStart\" className={screenSharingNotificationIconStyle(theme)} />\n        </Stack>\n        <Text className={screenSharingNotificationTextStyle} aria-live=\"polite\">\n          {locale.strings.videoGallery.screenIsBeingSharedMessage}\n        </Text>\n      </Stack>\n    </Stack>;\n  const displayName = !localParticipant?.displayName ? locale.strings.videoGallery.displayNamePlaceholder : localParticipant?.displayName;\n  return <VideoTile displayName={displayName} isMuted={localParticipant?.isMuted} onRenderPlaceholder={() => <></>}>\n      {localScreenSharingNotification}\n    </VideoTile>;\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const loadingStyle = mergeStyles({\n  height: '100%',\n  width: '100%'\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Spinner, SpinnerSize, Stack } from '@fluentui/react';\nimport React, { useEffect } from 'react';\nimport { useLocale } from '../../localization';\nimport { StreamMedia } from '../StreamMedia';\nimport { VideoTile } from '../VideoTile';\nimport { CreateVideoStreamViewResult, VideoStreamOptions } from '../../types';\nimport { loadingStyle } from './styles/RemoteScreenShare.styles';\nimport { _formatString } from '@internal/acs-ui-common';\n/**\n * A memoized version of VideoTile for rendering the remote screen share stream. React.memo is used for a performance\n * boost by memoizing the same rendered component to avoid rerendering this when the parent component rerenders.\n * https://reactjs.org/docs/react-api.html#reactmemo\n */\n\nexport const RemoteScreenShare = React.memo((props: {\n  userId: string;\n  displayName?: string;\n  onCreateRemoteStreamView?: (userId: string, options?: VideoStreamOptions) => Promise<void | CreateVideoStreamViewResult>;\n  onDisposeRemoteStreamView?: (userId: string) => Promise<void>;\n  isAvailable?: boolean;\n  isReceiving?: boolean;\n  isMuted?: boolean;\n  isSpeaking?: boolean;\n  renderElement?: HTMLElement;\n}) => {\n  const {\n    userId,\n    displayName,\n    isMuted,\n    renderElement,\n    onCreateRemoteStreamView,\n    onDisposeRemoteStreamView,\n    isReceiving\n  } = props;\n  const locale = useLocale();\n\n  if (!renderElement) {\n    onCreateRemoteStreamView && onCreateRemoteStreamView(userId);\n  }\n\n  useEffect(() => {\n    return () => {\n      // TODO: Isolate disposing behaviors for screenShare and videoStream\n      onDisposeRemoteStreamView && onDisposeRemoteStreamView(userId);\n    };\n  }, [onDisposeRemoteStreamView, userId]);\n  const loadingMessage = displayName ? _formatString(locale.strings.videoGallery.screenShareLoadingMessage, {\n    participant: displayName\n  }) : '';\n  return <VideoTile displayName={displayName} isMuted={isMuted} renderElement={renderElement ? <StreamMedia videoStreamElement={renderElement} loadingState={isReceiving === false ? 'loading' : 'none'} /> : undefined} onRenderPlaceholder={() => <LoadingSpinner loadingMessage={loadingMessage} />} />;\n});\n\nconst LoadingSpinner = (props: {\n  loadingMessage: string;\n}): JSX.Element => {\n  return <Stack verticalAlign=\"center\" className={loadingStyle}>\n      <Spinner label={props.loadingMessage} size={SpinnerSize.xSmall} aria-live={'assertive'} />\n    </Stack>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/* eslint-disable react/prop-types */\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\n\n/* eslint-disable @typescript-eslint/explicit-function-return-type */\n\n/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport * as React from 'react';\nimport { useBoolean, useMergedRefs, useConst, useSetTimeout, useId, useUnmount } from '@fluentui/react-hooks';\nimport { allowOverscrollOnElement, allowScrollOnElement, AnimationVariables, classNamesFunction, DirectionalHint, elementContains, EventGroup, FocusTrapZone, getGlobalClassNames, getPropsWithDefaults, Icon, IDragOptions, IFocusTrapZone, ILayerProps, IModalProps, IModalStyleProps, IModalStyles, KeyCodes, Layer, memoizeFunction, mergeStyles, on, Overlay, Popup, ResponsiveMode, styled, useResponsiveMode, ZIndexes } from '@fluentui/react';\nimport { useWindow } from '@fluentui/react-window-provider'; // @TODO - need to change this to a panel whenever the breakpoint is under medium (verify the spec)\n\n/** @internal */\n\nexport interface _ExtendedIModalProps extends IModalProps {\n  minDragPosition?: _ICoordinates;\n  maxDragPosition?: _ICoordinates;\n}\nconst animationDuration = AnimationVariables.durationValue2;\n/** @internal */\n\nexport type _ICoordinates = {\n  x: number;\n  y: number;\n};\ninterface IModalInternalState {\n  onModalCloseTimer: number;\n  allowTouchBodyScroll?: boolean;\n  scrollableContent: HTMLDivElement | null;\n  lastSetCoordinates: _ICoordinates;\n  /** Minimum clamped position, if dragging and clamping (`dragOptions.keepInBounds`) are enabled */\n\n  minPosition?: _ICoordinates;\n  /** Maximum clamped position, if dragging and clamping (`dragOptions.keepInBounds`) are enabled */\n\n  maxPosition?: _ICoordinates;\n  events: EventGroup;\n  /** Ensures we dispose the same keydown callback as was registered */\n\n  disposeOnKeyDown?: () => void;\n  /** Ensures we dispose the same keyup callback as was registered (also tracks whether keyup has been registered) */\n\n  disposeOnKeyUp?: () => void;\n  isInKeyboardMoveMode?: boolean;\n  hasBeenOpened?: boolean;\n}\nconst ZERO: _ICoordinates = {\n  x: 0,\n  y: 0\n};\nconst DEFAULT_PROPS: Partial<_ExtendedIModalProps> = {\n  isOpen: false,\n  isDarkOverlay: true,\n  className: '',\n  containerClassName: '',\n  enableAriaHiddenSiblings: true\n};\nconst getModalClassNames = classNamesFunction<IModalStyleProps, IModalStyles>();\n\nconst getMoveDelta = (ev: React.KeyboardEvent<HTMLElement>): number => {\n  let delta = 10;\n\n  if (ev.shiftKey) {\n    if (!ev.ctrlKey) {\n      delta = 50;\n    }\n  } else if (ev.ctrlKey) {\n    delta = 1;\n  }\n\n  return delta;\n};\n\nconst useComponentRef = (props: IModalProps, focusTrapZone: React.RefObject<IFocusTrapZone>) => {\n  React.useImperativeHandle(props.componentRef, () => ({\n    focus() {\n      if (focusTrapZone.current) {\n        focusTrapZone.current.focus();\n      }\n    }\n\n  }), [focusTrapZone]);\n};\n\nconst ModalBase: React.FunctionComponent<_ExtendedIModalProps> = React.forwardRef<HTMLDivElement, _ExtendedIModalProps>((propsWithoutDefaults, ref) => {\n  const props = getPropsWithDefaults(DEFAULT_PROPS, propsWithoutDefaults);\n  const {\n    allowTouchBodyScroll,\n    className,\n    children,\n    containerClassName,\n    scrollableContentClassName,\n    elementToFocusOnDismiss,\n    firstFocusableSelector,\n    forceFocusInsideTrap,\n    ignoreExternalFocusing,\n    isBlocking,\n    isAlert,\n    isClickableOutsideFocusTrap,\n    isDarkOverlay,\n    onDismiss,\n    layerProps,\n    overlay,\n    isOpen,\n    titleAriaId,\n    styles,\n    subtitleAriaId,\n    theme,\n    topOffsetFixed,\n    responsiveMode,\n    onLayerDidMount,\n    isModeless,\n    dragOptions,\n    onDismissed,\n    minDragPosition,\n    maxDragPosition\n  } = props;\n  const rootRef = React.useRef<HTMLDivElement>(null);\n  const focusTrapZone = React.useRef<IFocusTrapZone>(null);\n  const focusTrapZoneElm = React.useRef<HTMLDivElement>(null);\n  const mergedRef = useMergedRefs(rootRef, ref);\n  const modalResponsiveMode = useResponsiveMode(mergedRef);\n  const focusTrapZoneId = useId('ModalFocusTrapZone');\n  const win = useWindow();\n  const {\n    setTimeout,\n    clearTimeout\n  } = useSetTimeout();\n  const [isModalOpen, setIsModalOpen] = React.useState(isOpen);\n  const [isVisible, setIsVisible] = React.useState(isOpen);\n  const [coordinates, setCoordinates] = React.useState<_ICoordinates>(ZERO);\n  const [modalRectangleTop, setModalRectangleTop] = React.useState<number | undefined>();\n  const [isModalMenuOpen, {\n    toggle: toggleModalMenuOpen,\n    setFalse: setModalMenuClose\n  }] = useBoolean(false);\n  const internalState = useConst<IModalInternalState>(() => ({\n    onModalCloseTimer: 0,\n    allowTouchBodyScroll,\n    scrollableContent: null,\n    lastSetCoordinates: ZERO,\n    events: new EventGroup({})\n  }));\n  const {\n    keepInBounds\n  } = dragOptions || ({} as IDragOptions);\n  const isAlertRole = isAlert ?? (isBlocking && !isModeless);\n  const layerClassName = layerProps === undefined ? '' : layerProps.className;\n  const classNames = getModalClassNames(styles, {\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    theme: theme!,\n    className,\n    containerClassName,\n    scrollableContentClassName,\n    isOpen,\n    isVisible,\n    hasBeenOpened: internalState.hasBeenOpened,\n    modalRectangleTop,\n    topOffsetFixed,\n    isModeless,\n    layerClassName,\n    windowInnerHeight: win?.innerHeight,\n    isDefaultDragHandle: dragOptions && !dragOptions.dragHandleSelector\n  });\n  const mergedLayerProps: ILayerProps = {\n    eventBubblingEnabled: false,\n    ...layerProps,\n    onLayerDidMount: layerProps && layerProps.onLayerDidMount ? layerProps.onLayerDidMount : onLayerDidMount,\n    insertFirst: isModeless,\n    className: classNames.layer\n  }; // Allow the user to scroll within the modal but not on the body\n\n  const allowScrollOnModal = React.useCallback((elt: HTMLDivElement | null): void => {\n    if (elt) {\n      if (internalState.allowTouchBodyScroll) {\n        allowOverscrollOnElement(elt, internalState.events);\n      } else {\n        allowScrollOnElement(elt, internalState.events);\n      }\n    } else {\n      internalState.events.off(internalState.scrollableContent);\n    }\n\n    internalState.scrollableContent = elt;\n  }, [internalState]);\n\n  const registerInitialModalPosition = (): void => {\n    const dialogMain = focusTrapZoneElm.current;\n    const modalRectangle = dialogMain?.getBoundingClientRect();\n\n    if (modalRectangle) {\n      if (topOffsetFixed) {\n        setModalRectangleTop(modalRectangle.top);\n      }\n\n      if (keepInBounds) {\n        // x/y are unavailable in IE, so use the equivalent left/top\n        internalState.minPosition = minDragPosition ?? {\n          x: -modalRectangle.left,\n          y: -modalRectangle.top\n        };\n        internalState.maxPosition = maxDragPosition ?? {\n          x: modalRectangle.left,\n          y: modalRectangle.top\n        }; // Make sure the initial co-ordinates are within clamp bounds.\n\n        setCoordinates({\n          x: getClampedAxis('x', coordinates.x),\n          y: getClampedAxis('y', coordinates.y)\n        });\n      }\n    }\n  };\n  /**\n   * Clamps an axis to a specified min and max position.\n   *\n   * @param axis A string that represents the axis (x/y).\n   * @param position The position on the axis.\n   */\n\n\n  const getClampedAxis = React.useCallback((axis: keyof _ICoordinates, position: number) => {\n    const {\n      minPosition,\n      maxPosition\n    } = internalState;\n\n    if (keepInBounds && minPosition && maxPosition) {\n      position = Math.max(minPosition[axis], position);\n      position = Math.min(maxPosition[axis], position);\n    }\n\n    return position;\n  }, [keepInBounds, internalState]);\n\n  const handleModalClose = (): void => {\n    internalState.lastSetCoordinates = ZERO;\n    setModalMenuClose();\n    internalState.isInKeyboardMoveMode = false;\n    setIsModalOpen(false);\n    setCoordinates(ZERO);\n    internalState.disposeOnKeyUp?.();\n    onDismissed?.();\n  };\n\n  const handleDragStart = React.useCallback((): void => {\n    setModalMenuClose();\n    internalState.isInKeyboardMoveMode = false;\n  }, [internalState, setModalMenuClose]);\n  const handleDrag = React.useCallback( // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  (ev: React.MouseEvent<HTMLElement> & React.TouchEvent<HTMLElement>, dragData: any): void => {\n    setCoordinates(prevValue => ({\n      x: getClampedAxis('x', prevValue.x + dragData.delta.x),\n      y: getClampedAxis('y', prevValue.y + dragData.delta.y)\n    }));\n  }, [getClampedAxis]);\n  const handleDragStop = React.useCallback((): void => {\n    if (focusTrapZone.current) {\n      focusTrapZone.current.focus();\n    }\n  }, []);\n\n  const handleEnterKeyboardMoveMode = () => {\n    // We need a global handleKeyDown event when we are in the move mode so that we can\n    // handle the key presses and the components inside the modal do not get the events\n    const handleKeyDown = (ev: React.KeyboardEvent<HTMLElement>): void => {\n      if (ev.altKey && ev.ctrlKey && ev.keyCode === KeyCodes.space) {\n        // CTRL + ALT + SPACE is handled during keyUp\n        ev.preventDefault();\n        ev.stopPropagation();\n        return;\n      }\n\n      const newLocal = ev.altKey || ev.keyCode === KeyCodes.escape;\n\n      if (isModalMenuOpen && newLocal) {\n        setModalMenuClose();\n      }\n\n      if (internalState.isInKeyboardMoveMode && (ev.keyCode === KeyCodes.escape || ev.keyCode === KeyCodes.enter)) {\n        internalState.isInKeyboardMoveMode = false;\n        ev.preventDefault();\n        ev.stopPropagation();\n      }\n\n      if (internalState.isInKeyboardMoveMode) {\n        let handledEvent = true;\n        const delta = getMoveDelta(ev);\n\n        switch (ev.keyCode) {\n          /* eslint-disable no-fallthrough */\n          case KeyCodes.escape:\n            setCoordinates(internalState.lastSetCoordinates);\n\n          case KeyCodes.enter:\n            {\n              // TODO: determine if fallthrough was intentional\n\n              /* eslint-enable no-fallthrough */\n              internalState.lastSetCoordinates = ZERO; // setIsInKeyboardMoveMode(false);\n\n              break;\n            }\n\n          case KeyCodes.up:\n            {\n              setCoordinates(prevValue => ({\n                x: prevValue.x,\n                y: getClampedAxis('y', prevValue.y - delta)\n              }));\n              break;\n            }\n\n          case KeyCodes.down:\n            {\n              setCoordinates(prevValue => ({\n                x: prevValue.x,\n                y: getClampedAxis('y', prevValue.y + delta)\n              }));\n              break;\n            }\n\n          case KeyCodes.left:\n            {\n              setCoordinates(prevValue => ({\n                x: getClampedAxis('x', prevValue.x - delta),\n                y: prevValue.y\n              }));\n              break;\n            }\n\n          case KeyCodes.right:\n            {\n              setCoordinates(prevValue => ({\n                x: getClampedAxis('x', prevValue.x + delta),\n                y: prevValue.y\n              }));\n              break;\n            }\n\n          default:\n            {\n              handledEvent = false;\n            }\n        }\n\n        if (handledEvent) {\n          ev.preventDefault();\n          ev.stopPropagation();\n        }\n      }\n    };\n\n    internalState.lastSetCoordinates = coordinates;\n    setModalMenuClose();\n    internalState.isInKeyboardMoveMode = true;\n    internalState.events.on(win, 'keydown', handleKeyDown, true\n    /* useCapture */\n    );\n\n    internalState.disposeOnKeyDown = () => {\n      internalState.events.off(win, 'keydown', handleKeyDown, true\n      /* useCapture */\n      );\n      internalState.disposeOnKeyDown = undefined;\n    };\n  };\n\n  const handleExitKeyboardMoveMode = () => {\n    internalState.lastSetCoordinates = ZERO;\n    internalState.isInKeyboardMoveMode = false;\n    internalState.disposeOnKeyDown?.();\n  };\n\n  const registerForKeyUp = (): void => {\n    const handleKeyUp = (ev: React.KeyboardEvent<HTMLElement>): void => {\n      // Needs to handle the CTRL + ALT + SPACE key during keyup due to FireFox bug:\n      // https://bugzilla.mozilla.org/show_bug.cgi?id=1220143\n      if (ev.altKey && ev.ctrlKey && ev.keyCode === KeyCodes.space) {\n        if (elementContains(internalState.scrollableContent, (ev.target as HTMLElement))) {\n          toggleModalMenuOpen();\n          ev.preventDefault();\n          ev.stopPropagation();\n        }\n      }\n    };\n\n    if (!internalState.disposeOnKeyUp) {\n      internalState.events.on(win, 'keyup', handleKeyUp, true\n      /* useCapture */\n      );\n\n      internalState.disposeOnKeyUp = () => {\n        internalState.events.off(win, 'keyup', handleKeyUp, true\n        /* useCapture */\n        );\n        internalState.disposeOnKeyUp = undefined;\n      };\n    }\n  };\n\n  React.useEffect(() => {\n    clearTimeout(internalState.onModalCloseTimer); // Opening the dialog\n\n    if (isOpen) {\n      // This must be done after the modal content has rendered\n      requestAnimationFrame(() => setTimeout(registerInitialModalPosition, 0));\n      setIsModalOpen(true); // Add a keyUp handler for all key up events once the dialog is open.\n\n      if (dragOptions) {\n        registerForKeyUp();\n      }\n\n      internalState.hasBeenOpened = true;\n      setIsVisible(true);\n    } // Closing the dialog\n\n\n    if (!isOpen && isModalOpen) {\n      internalState.onModalCloseTimer = setTimeout(handleModalClose, parseFloat(animationDuration) * 1000);\n      setIsVisible(false);\n    } // eslint-disable-next-line react-hooks/exhaustive-deps -- should only run if isModalOpen or isOpen mutates or if min/max drag bounds are updated.\n\n  }, [isModalOpen, isOpen, minDragPosition, maxDragPosition]);\n  useUnmount(() => {\n    internalState.events.dispose();\n  });\n  useComponentRef(props, focusTrapZone);\n  const modalContent = <FocusTrapZone disabled={true} id={focusTrapZoneId} ref={focusTrapZoneElm} componentRef={focusTrapZone} className={classNames.main} elementToFocusOnDismiss={elementToFocusOnDismiss} isClickableOutsideFocusTrap={isModeless || isClickableOutsideFocusTrap || !isBlocking} ignoreExternalFocusing={ignoreExternalFocusing} forceFocusInsideTrap={forceFocusInsideTrap && !isModeless} firstFocusableSelector={firstFocusableSelector} focusPreviouslyFocusedInnerElement onBlur={internalState.isInKeyboardMoveMode ? handleExitKeyboardMoveMode : undefined} // enableAriaHiddenSiblings is handled by the Popup\n  >\n        {dragOptions && internalState.isInKeyboardMoveMode && <div className={classNames.keyboardMoveIconContainer}>\n            {dragOptions.keyboardMoveIconProps ? <Icon {...dragOptions.keyboardMoveIconProps} /> : <Icon iconName=\"move\" className={classNames.keyboardMoveIcon} />}\n          </div>}\n        <div ref={allowScrollOnModal} className={classNames.scrollableContent} data-is-scrollable>\n          {dragOptions && isModalMenuOpen && <dragOptions.menu items={[{\n        key: 'move',\n        text: dragOptions.moveMenuItemText,\n        onClick: handleEnterKeyboardMoveMode\n      }, {\n        key: 'close',\n        text: dragOptions.closeMenuItemText,\n        onClick: handleModalClose\n      }]} onDismiss={setModalMenuClose} alignTargetEdge coverTarget directionalHint={DirectionalHint.topLeftEdge} directionalHintFixed shouldFocusOnMount target={internalState.scrollableContent} />}\n          {children}\n        </div>\n      </FocusTrapZone>;\n  return (// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    isModalOpen && modalResponsiveMode! >= (responsiveMode || ResponsiveMode.small) && <Layer ref={mergedRef} {...mergedLayerProps}>\n          <Popup role={isAlertRole ? 'alertdialog' : 'dialog'} ariaLabelledBy={titleAriaId} ariaDescribedBy={subtitleAriaId} // onDismiss={onDismiss}\n      shouldRestoreFocus={!ignoreExternalFocusing} // Modeless modals shouldn't hide siblings.\n      // Popup will automatically handle this based on the aria-modal setting.\n      // enableAriaHiddenSiblings={enableAriaHiddenSiblings}\n      aria-modal={!isModeless}>\n            <div className={classNames.root} role={!isModeless ? 'document' : undefined}>\n              {!isModeless && <Overlay aria-hidden={true} isDarkThemed={isDarkOverlay} onClick={isBlocking ? undefined : onDismiss} allowTouchBodyScroll={allowTouchBodyScroll} {...overlay} />}\n              {dragOptions ? <DraggableZone handleSelector={dragOptions.dragHandleSelector || `#${focusTrapZoneId}`} preventDragSelector=\"button\" onStart={handleDragStart} onDragChange={handleDrag} onStop={handleDragStop} position={coordinates}>\n                  {modalContent}\n                </DraggableZone> : modalContent}\n            </div>\n          </Popup>\n        </Layer> || null\n  );\n});\nModalBase.displayName = 'ModalBase';\ninterface IDraggableZoneStyles {\n  root: string;\n}\nconst getDraggableZoneClassNames = memoizeFunction((className: string, isDragging: boolean): IDraggableZoneStyles => {\n  return {\n    root: mergeStyles(className, isDragging && {\n      touchAction: 'none',\n      selectors: {\n        '& *': {\n          userSelect: 'none'\n        }\n      }\n    })\n  };\n});\ninterface IDragData {\n  position: _ICoordinates;\n  lastPosition?: _ICoordinates;\n  delta: _ICoordinates;\n}\ninterface IDraggableZoneProps extends React.HTMLAttributes<HTMLDivElement> {\n  /**\n   * Specifies a selector to be used as the handle that initiates drag\n   */\n  handleSelector?: string;\n  /**\n   * Specifies a selector to be used to prevent drag initialization.\n   * For example, if you do not want buttons inside of your handleSelector\n   * to have the cursor change to move or to allow users to select from buttons,\n   * you could pass button here (the close button in the header of a dialog is a concrete example)\n   */\n\n  preventDragSelector?: string;\n  /**\n   * the X and Y coordinates to use as an offest to position the draggable content\n   */\n\n  position?: _ICoordinates;\n  /**\n   * Callback for when dragging starts\n   */\n\n  onStart?: (event: React.MouseEvent<HTMLElement> & React.TouchEvent<HTMLElement>, dragData: IDragData) => void;\n  /**\n   * Callback for when the drag changes, while dragging\n   */\n\n  onDragChange?: (event: React.MouseEvent<HTMLElement> & React.TouchEvent<HTMLElement>, dragData: IDragData) => void;\n  /**\n   * Callback for when dragging stops\n   */\n\n  onStop?: (event: React.MouseEvent<HTMLElement> & React.TouchEvent<HTMLElement>, dragData: IDragData) => void;\n}\ninterface IDraggableZoneState {\n  isDragging: boolean;\n  position: _ICoordinates;\n  lastPosition?: _ICoordinates;\n}\nconst eventMapping = {\n  touch: {\n    start: 'touchstart',\n    move: 'touchmove',\n    stop: 'touchend'\n  },\n  mouse: {\n    start: 'mousedown',\n    move: 'mousemove',\n    stop: 'mouseup'\n  }\n}; // These are needed so that we can generalize the events\n// and so we have access to clientX and clientY in the touch events\n\ntype MouseTouchEvent<T> = React.MouseEvent<T> & React.TouchEvent<T> & Event;\n\nclass DraggableZone extends React.Component<IDraggableZoneProps, IDraggableZoneState> {\n  private _touchId?: number;\n  private _currentEventType = eventMapping.mouse;\n  private _events: (() => void)[] = [];\n\n  constructor(props: IDraggableZoneProps) {\n    super(props);\n    this.state = {\n      isDragging: false,\n      position: this.props.position || {\n        x: 0,\n        y: 0\n      },\n      lastPosition: undefined\n    };\n  }\n\n  public componentDidUpdate(prevProps: IDraggableZoneProps) {\n    if (this.props.position && (!prevProps.position || this.props.position !== prevProps.position)) {\n      this.setState({\n        position: this.props.position\n      });\n    }\n  }\n\n  public componentWillUnmount() {\n    this._events.forEach(dispose => dispose());\n  }\n\n  public render() {\n    const child: any = React.Children.only(this.props.children);\n    const {\n      props\n    } = child;\n    const {\n      position\n    } = this.props;\n    const {\n      position: statePosition,\n      isDragging\n    } = this.state;\n    let x = statePosition.x;\n    let y = statePosition.y;\n\n    if (position && !isDragging) {\n      x = position.x;\n      y = position.y;\n    }\n\n    return React.cloneElement(child, {\n      style: { ...props.style,\n        transform: `translate(${x}px, ${y}px)`\n      },\n      className: getDraggableZoneClassNames(props.className, this.state.isDragging).root,\n      onMouseDown: this._onMouseDown,\n      onMouseUp: this._onMouseUp,\n      onTouchStart: this._onTouchStart,\n      onTouchEnd: this._onTouchEnd\n    });\n  }\n\n  private _onMouseDown = (event: MouseTouchEvent<HTMLElement>) => {\n    const onMouseDown = (React.Children.only(this.props.children) as any).props.onMouseDown;\n\n    if (onMouseDown) {\n      onMouseDown(event);\n    }\n\n    this._currentEventType = eventMapping.mouse;\n    return this._onDragStart(event);\n  };\n  private _onMouseUp = (event: MouseTouchEvent<HTMLElement>) => {\n    const onMouseUp = (React.Children.only(this.props.children) as any).props.onMouseUp;\n\n    if (onMouseUp) {\n      onMouseUp(event);\n    }\n\n    this._currentEventType = eventMapping.mouse;\n    return this._onDragStop(event);\n  };\n  private _onTouchStart = (event: MouseTouchEvent<HTMLElement>) => {\n    const onTouchStart = (React.Children.only(this.props.children) as any).props.onTouchStart;\n\n    if (onTouchStart) {\n      onTouchStart(event);\n    }\n\n    this._currentEventType = eventMapping.touch;\n    return this._onDragStart(event);\n  };\n  private _onTouchEnd = (event: MouseTouchEvent<HTMLElement>) => {\n    const onTouchEnd = (React.Children.only(this.props.children) as any).props.onTouchEnd;\n\n    if (onTouchEnd) {\n      onTouchEnd(event);\n    }\n\n    this._currentEventType = eventMapping.touch;\n\n    this._onDragStop(event);\n  };\n  private _onDragStart = (event: MouseTouchEvent<HTMLElement>) => {\n    // Only handle left click for dragging\n    if (typeof event.button === 'number' && event.button !== 0) {\n      return false;\n    } // If the target doesn't match the handleSelector OR\n    // if the target does match the preventDragSelector, bail out\n\n\n    if (this.props.handleSelector && !this._matchesSelector((event.target as HTMLElement), this.props.handleSelector) || this.props.preventDragSelector && this._matchesSelector((event.target as HTMLElement), this.props.preventDragSelector)) {\n      return;\n    } // Remember the touch identifier if this is a touch event so we can\n    // distinguish between individual touches in multitouch scenarios\n    // by remembering which touch point we were given\n\n\n    this._touchId = this._getTouchId(event);\n\n    const position = this._getControlPosition(event);\n\n    if (position === undefined) {\n      return;\n    }\n\n    const dragData = this._createDragDataFromPosition(position);\n\n    this.props.onStart && this.props.onStart(event, dragData);\n    this.setState({\n      isDragging: true,\n      lastPosition: position\n    }); // hook up the appropriate mouse/touch events to the body to ensure\n    // smooth dragging\n\n    this._events = [on(document.body, this._currentEventType.move, this._onDrag, true\n    /* use capture phase */\n    ), on(document.body, this._currentEventType.stop, this._onDragStop, true\n    /* use capture phase */\n    )];\n    return;\n  };\n  private _onDrag = (event: any) => {\n    // Prevent scrolling on mobile devices\n    if (event.type === 'touchmove') {\n      event.preventDefault();\n    }\n\n    const position = this._getControlPosition(event);\n\n    if (!position) {\n      return;\n    } // create the updated drag data from the position data\n\n\n    const updatedData = this._createUpdatedDragData(this._createDragDataFromPosition(position));\n\n    const updatedPosition = updatedData.position;\n    this.props.onDragChange && this.props.onDragChange(event, updatedData);\n    this.setState({\n      position: updatedPosition,\n      lastPosition: position\n    });\n  };\n  private _onDragStop = (event: any) => {\n    if (!this.state.isDragging) {\n      return;\n    }\n\n    const position = this._getControlPosition(event);\n\n    if (!position) {\n      return;\n    }\n\n    const baseDragData = this._createDragDataFromPosition(position); // Set dragging to false and reset the lastPosition\n\n\n    this.setState({\n      isDragging: false,\n      lastPosition: undefined\n    });\n    this.props.onStop && this.props.onStop(event, baseDragData);\n\n    if (this.props.position) {\n      this.setState({\n        position: this.props.position\n      });\n    } // Remove event handlers\n\n\n    this._events.forEach(dispose => dispose());\n  };\n  /**\n   * Get the control position based off the event that fired\n   * @param event - The event to get offsets from\n   */\n\n  private _getControlPosition(event: MouseTouchEvent<HTMLElement>): _ICoordinates | undefined {\n    const touchObj = this._getActiveTouch(event); // did we get the right touch?\n\n\n    if (this._touchId !== undefined && !touchObj) {\n      return undefined;\n    }\n\n    const eventToGetOffset = touchObj || event;\n    return {\n      x: eventToGetOffset.clientX,\n      y: eventToGetOffset.clientY\n    };\n  }\n  /**\n   * Get the active touch point that we have saved from the event's TouchList\n   * @param event - The event used to get the TouchList for the active touch point\n   */\n\n\n  private _getActiveTouch(event: MouseTouchEvent<HTMLElement>): React.Touch | undefined {\n    return event.targetTouches && this._findTouchInTouchList(event.targetTouches) || event.changedTouches && this._findTouchInTouchList(event.changedTouches);\n  }\n  /**\n   * Get the initial touch identifier associated with the given event\n   * @param event - The event that contains the TouchList\n   */\n\n\n  private _getTouchId(event: MouseTouchEvent<HTMLElement>): number | undefined {\n    const touch: React.Touch | undefined = event.targetTouches && event.targetTouches[0] || event.changedTouches && event.changedTouches[0];\n\n    if (touch) {\n      return touch.identifier;\n    }\n\n    return;\n  }\n  /**\n   * Returns if an element (or any of the element's parents) match the given selector\n   */\n\n\n  private _matchesSelector(element: HTMLElement | null, selector: string): boolean {\n    if (!element || element === document.body) {\n      return false;\n    } // eslint-disable-next-line @typescript-eslint/ban-types\n\n\n    const matchesSelectorFn: Function = element.matches || element.webkitMatchesSelector || (element as any).msMatchesSelector;\n    /* for IE */\n\n    if (!matchesSelectorFn) {\n      return false;\n    }\n\n    return matchesSelectorFn.call(element, selector) || this._matchesSelector(element.parentElement, selector);\n  }\n  /**\n   * Attempts to find the Touch that matches the identifier  we stored in dragStart\n   * @param touchList The TouchList to look for the stored identifier from dragStart\n   */\n\n\n  private _findTouchInTouchList(touchList: React.TouchList): React.Touch | undefined {\n    if (this._touchId === undefined) {\n      return;\n    }\n\n    for (let i = 0; i < touchList.length; i++) {\n      if (touchList[i].identifier === this._touchId) {\n        return touchList[i];\n      }\n    }\n\n    return undefined;\n  }\n  /**\n   * Create DragData based off of the last known position and the new position passed in\n   * @param position The new position as part of the drag\n   */\n\n\n  private _createDragDataFromPosition(position: _ICoordinates): IDragData {\n    const {\n      lastPosition\n    } = this.state; // If we have no lastPosition, use the given position\n    // for last position\n\n    if (lastPosition === undefined) {\n      return {\n        delta: {\n          x: 0,\n          y: 0\n        },\n        lastPosition: position,\n        position\n      };\n    }\n\n    return {\n      delta: {\n        x: position.x - lastPosition.x,\n        y: position.y - lastPosition.y\n      },\n      lastPosition,\n      position\n    };\n  }\n  /**\n   * Creates an updated DragData based off the current position and given baseDragData\n   * @param baseDragData The base DragData (from _createDragDataFromPosition) used to calculate the updated positions\n   */\n\n\n  private _createUpdatedDragData(baseDragData: IDragData): IDragData {\n    const {\n      position\n    } = this.state;\n    return {\n      position: {\n        x: position.x + baseDragData.delta.x,\n        y: position.y + baseDragData.delta.y\n      },\n      delta: baseDragData.delta,\n      lastPosition: position\n    };\n  }\n\n}\n\nconst globalClassNames = {\n  root: 'ms-Modal',\n  main: 'ms-Dialog-main',\n  scrollableContent: 'ms-Modal-scrollableContent',\n  isOpen: 'is-open',\n  layer: 'ms-Modal-Layer'\n};\n\nconst getStyles = (props: IModalStyleProps): IModalStyles => {\n  const {\n    className,\n    containerClassName,\n    scrollableContentClassName,\n    isOpen,\n    isVisible,\n    hasBeenOpened,\n    modalRectangleTop,\n    theme,\n    topOffsetFixed,\n    isModeless,\n    layerClassName,\n    isDefaultDragHandle,\n    windowInnerHeight\n  } = props;\n  const {\n    palette,\n    effects,\n    fonts\n  } = theme;\n  const classNames = getGlobalClassNames(globalClassNames, theme);\n  return {\n    root: [classNames.root, fonts.medium, {\n      backgroundColor: 'transparent',\n      position: isModeless ? 'absolute' : 'fixed',\n      height: '100%',\n      width: '100%',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      opacity: 0,\n      pointerEvents: 'none',\n      transition: `opacity ${animationDuration}`\n    }, topOffsetFixed && typeof modalRectangleTop === 'number' && hasBeenOpened && {\n      alignItems: 'flex-start'\n    }, isOpen && classNames.isOpen, isVisible && {\n      opacity: 1,\n      pointerEvents: 'auto'\n    }, className],\n    main: [classNames.main, {\n      boxShadow: effects.elevation64,\n      borderRadius: effects.roundedCorner2,\n      backgroundColor: palette.white,\n      boxSizing: 'border-box',\n      position: 'relative',\n      textAlign: 'left',\n      outline: '3px solid transparent',\n      maxHeight: 'calc(100% - 32px)',\n      maxWidth: 'calc(100% - 32px)',\n      minHeight: '176px',\n      minWidth: '288px',\n      overflowY: 'auto',\n      zIndex: isModeless ? ZIndexes.Layer : undefined\n    }, topOffsetFixed && typeof modalRectangleTop === 'number' && hasBeenOpened && {\n      top: modalRectangleTop\n    }, isDefaultDragHandle && {\n      cursor: 'move'\n    }, containerClassName],\n    scrollableContent: [classNames.scrollableContent, {\n      overflowY: 'auto',\n      flexGrow: 1,\n      maxHeight: '100vh',\n      selectors: {\n        ['@supports (-webkit-overflow-scrolling: touch)']: {\n          maxHeight: windowInnerHeight\n        }\n      }\n    }, scrollableContentClassName],\n    layer: isModeless && [layerClassName, classNames.layer, {\n      position: 'static',\n      width: 'unset',\n      height: 'unset'\n    }],\n    keyboardMoveIconContainer: {\n      position: 'absolute',\n      display: 'flex',\n      justifyContent: 'center',\n      width: '100%',\n      padding: '3px 0px'\n    },\n    keyboardMoveIcon: {\n      fontSize: fonts.xLargePlus.fontSize,\n      width: '24px'\n    }\n  };\n};\n/** @internal */\n\n\nexport const _ModalClone: React.FunctionComponent<_ExtendedIModalProps> = styled<_ExtendedIModalProps, IModalStyleProps, IModalStyles>(ModalBase, getStyles, undefined, {\n  scope: 'Modal',\n  fields: ['theme', 'styles', 'enableAriaHiddenSiblings']\n});\n_ModalClone.displayName = 'Modal';","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IconButton, useTheme } from '@fluentui/react';\nimport React from 'react';\nimport { OptionsDevice } from './DevicesButton';\nimport { localVideoCameraCycleButtonStyles } from './styles/VideoGallery.styles';\n/**\n * @public\n */\n\nexport interface LocalVideoCameraCycleButtonProps {\n  /** Array of cameras available to the user. */\n  cameras?: OptionsDevice[];\n  /** Currently selected camera in the local video stream. */\n\n  selectedCamera?: OptionsDevice;\n  /** callback function to change video feed. */\n\n  onSelectCamera?: (device: OptionsDevice) => Promise<void>;\n  /** label for local video camera switcher */\n\n  label?: string;\n  /** description for local video camera switcher */\n\n  ariaDescription?: string;\n}\n/**\n * local video tile camera cycle button - for use on mobile screens only.\n * @internal\n */\n\nexport const LocalVideoCameraCycleButton = (props: LocalVideoCameraCycleButtonProps): JSX.Element => {\n  const {\n    cameras,\n    selectedCamera,\n    onSelectCamera,\n    label,\n    ariaDescription\n  } = props;\n  const theme = useTheme();\n  return <IconButton data-ui-id={'local-camera-switcher-button'} styles={localVideoCameraCycleButtonStyles(theme)} iconProps={{\n    iconName: 'LocalCameraSwitch'\n  }} ariaLabel={label} ariaDescription={ariaDescription} aria-live={'polite'} onClick={() => {\n    if (cameras && cameras.length > 1 && selectedCamera !== undefined) {\n      const index = cameras.findIndex(camera => selectedCamera.id === camera.id);\n      const newCamera = cameras[(index + 1) % cameras.length];\n\n      if (onSelectCamera !== undefined) {\n        onSelectCamera(newCamera);\n      }\n    }\n  }} />;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Stack } from '@fluentui/react';\nimport { _formatString } from '@internal/acs-ui-common';\nimport React, { useMemo } from 'react';\nimport { OnRenderAvatarCallback, VideoStreamOptions, CreateVideoStreamViewResult } from '../types';\nimport { LocalVideoCameraCycleButton, LocalVideoCameraCycleButtonProps } from './LocalVideoCameraButton';\nimport { StreamMedia } from './StreamMedia';\nimport { useLocalVideoStreamLifecycleMaintainer, LocalVideoStreamLifecycleMaintainerProps } from './VideoGallery/useVideoStreamLifecycleMaintainer';\nimport { VideoTile, VideoTileStylesProps } from './VideoTile';\n/**\n * A memoized version of VideoTile for rendering local participant.\n *\n * @internal\n */\n\nexport const _LocalVideoTile = React.memo((props: {\n  userId?: string;\n  onCreateLocalStreamView?: (options?: VideoStreamOptions) => Promise<void | CreateVideoStreamViewResult>;\n  onDisposeLocalStreamView?: () => void;\n  isAvailable?: boolean;\n  isMuted?: boolean;\n  renderElement?: HTMLElement;\n  displayName?: string;\n  initialsName?: string;\n  localVideoViewOptions?: VideoStreamOptions;\n  onRenderAvatar?: OnRenderAvatarCallback;\n  showLabel: boolean;\n  showMuteIndicator?: boolean;\n  showCameraSwitcherInLocalPreview?: boolean;\n  localVideoCameraCycleButtonProps?: LocalVideoCameraCycleButtonProps;\n  localVideoCameraSwitcherLabel?: string;\n  localVideoSelectedDescription?: string;\n  styles?: VideoTileStylesProps;\n  personaMinSize?: number;\n}) => {\n  const {\n    isAvailable,\n    isMuted,\n    onCreateLocalStreamView,\n    onDisposeLocalStreamView,\n    localVideoViewOptions,\n    renderElement,\n    userId,\n    showLabel,\n    displayName,\n    initialsName,\n    onRenderAvatar,\n    showMuteIndicator,\n    styles,\n    showCameraSwitcherInLocalPreview,\n    localVideoCameraCycleButtonProps,\n    localVideoCameraSwitcherLabel,\n    localVideoSelectedDescription\n  } = props;\n  const localVideoStreamProps: LocalVideoStreamLifecycleMaintainerProps = useMemo(() => ({\n    isMirrored: localVideoViewOptions?.isMirrored,\n    isStreamAvailable: isAvailable,\n    onCreateLocalStreamView,\n    onDisposeLocalStreamView,\n    renderElementExists: !!renderElement,\n    scalingMode: localVideoViewOptions?.scalingMode\n  }), [isAvailable, localVideoViewOptions?.isMirrored, localVideoViewOptions?.scalingMode, onCreateLocalStreamView, onDisposeLocalStreamView, renderElement]); // Handle creating, destroying and updating the video stream as necessary\n\n  useLocalVideoStreamLifecycleMaintainer(localVideoStreamProps);\n  const renderVideoStreamElement = useMemo(() => {\n    // Checking if renderElement is well defined or not as calling SDK has a number of video streams limitation which\n    // implies that, after their threshold, all streams have no child (blank video)\n    if (!renderElement || !renderElement.childElementCount) {\n      // Returning `undefined` results in the placeholder with avatar being shown\n      return undefined;\n    }\n\n    return <>\n          <FloatingLocalCameraCycleButton showCameraSwitcherInLocalPreview={showCameraSwitcherInLocalPreview ?? false} localVideoCameraCycleButtonProps={localVideoCameraCycleButtonProps} localVideoCameraSwitcherLabel={localVideoCameraSwitcherLabel} localVideoSelectedDescription={localVideoSelectedDescription} />\n          <StreamMedia videoStreamElement={renderElement} isMirrored={true} />\n        </>;\n  }, [localVideoCameraCycleButtonProps, localVideoCameraSwitcherLabel, localVideoSelectedDescription, renderElement, showCameraSwitcherInLocalPreview]);\n  return <VideoTile key={userId ?? 'local-video-tile'} userId={userId} renderElement={renderVideoStreamElement} showLabel={showLabel} displayName={displayName} initialsName={initialsName} styles={styles} onRenderPlaceholder={onRenderAvatar} isMuted={isMuted} showMuteIndicator={showMuteIndicator} personaMinSize={props.personaMinSize} />;\n});\n\nconst FloatingLocalCameraCycleButton = (props: {\n  showCameraSwitcherInLocalPreview: boolean;\n  localVideoCameraCycleButtonProps?: LocalVideoCameraCycleButtonProps;\n  localVideoCameraSwitcherLabel?: string;\n  localVideoSelectedDescription?: string;\n}): JSX.Element => {\n  const {\n    showCameraSwitcherInLocalPreview,\n    localVideoCameraCycleButtonProps,\n    localVideoCameraSwitcherLabel,\n    localVideoSelectedDescription\n  } = props;\n\n  const ariaDescription = localVideoCameraCycleButtonProps?.selectedCamera && localVideoSelectedDescription && _formatString(localVideoSelectedDescription, {\n    cameraName: localVideoCameraCycleButtonProps.selectedCamera.name\n  });\n\n  return <Stack horizontalAlign=\"end\">\n      {showCameraSwitcherInLocalPreview && localVideoCameraCycleButtonProps?.cameras !== undefined && localVideoCameraCycleButtonProps?.selectedCamera !== undefined && localVideoCameraCycleButtonProps?.onSelectCamera !== undefined && <LocalVideoCameraCycleButton cameras={localVideoCameraCycleButtonProps.cameras} selectedCamera={localVideoCameraCycleButtonProps.selectedCamera} onSelectCamera={localVideoCameraCycleButtonProps.onSelectCamera} label={localVideoCameraSwitcherLabel} ariaDescription={ariaDescription} />}\n    </Stack>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { concatStyleSets, ContextualMenu, IDragOptions, IStyle, LayerHost, mergeStyles, Stack } from '@fluentui/react';\nimport React, { useCallback, useMemo, useRef } from 'react';\nimport { GridLayoutStyles } from '.';\nimport { smartDominantSpeakerParticipants } from '../gallery';\nimport { useIdentifiers } from '../identifiers/IdentifierProvider';\nimport { useLocale } from '../localization';\nimport { useTheme } from '../theming';\nimport { BaseCustomStyles, OnRenderAvatarCallback, VideoGalleryLocalParticipant, VideoGalleryRemoteParticipant, VideoStreamOptions, CreateVideoStreamViewResult } from '../types';\nimport { GridLayout } from './GridLayout';\nimport { HorizontalGalleryStyles } from './HorizontalGallery';\nimport { _RemoteVideoTile } from './RemoteVideoTile';\nimport { ResponsiveHorizontalGallery } from './ResponsiveHorizontalGallery';\nimport { HORIZONTAL_GALLERY_BUTTON_WIDTH, HORIZONTAL_GALLERY_GAP } from './styles/HorizontalGallery.styles';\nimport { LARGE_HORIZONTAL_GALLERY_TILE_SIZE_REM, SMALL_HORIZONTAL_GALLERY_TILE_SIZE_REM, floatingLocalVideoModalStyle, floatingLocalVideoTileStyle, horizontalGalleryContainerStyle, horizontalGalleryStyle, layerHostStyle, localVideoTileContainerStyle, videoGalleryContainerStyle, videoGalleryOuterDivStyle, localVideoTileOuterPaddingPX, SMALL_FLOATING_MODAL_SIZE_PX, LARGE_FLOATING_MODAL_SIZE_PX } from './styles/VideoGallery.styles';\nimport { isNarrowWidth, _useContainerHeight, _useContainerWidth } from './utils/responsive';\nimport { LocalScreenShare } from './VideoGallery/LocalScreenShare';\nimport { RemoteScreenShare } from './VideoGallery/RemoteScreenShare';\nimport { useId } from '@fluentui/react-hooks';\nimport { LocalVideoCameraCycleButtonProps } from './LocalVideoCameraButton';\nimport { localVideoTileWithControlsContainerStyle, LOCAL_VIDEO_TILE_ZINDEX } from './styles/VideoGallery.styles';\nimport { _ICoordinates, _ModalClone } from './ModalClone/ModalClone';\nimport { _formatString } from '@internal/acs-ui-common';\nimport { _LocalVideoTile } from './LocalVideoTile';\n// Currently the Calling JS SDK supports up to 4 remote video streams\nconst DEFAULT_MAX_REMOTE_VIDEO_STREAMS = 4; // Set aside only 6 dominant speakers for remaining audio participants\n\nconst MAX_AUDIO_DOMINANT_SPEAKERS = 6;\n/**\n * All strings that may be shown on the UI in the {@link VideoGallery}.\n *\n * @public\n */\n\nexport interface VideoGalleryStrings {\n  /** String to notify that local user is sharing their screen */\n  screenIsBeingSharedMessage: string;\n  /** String to show when remote screen share stream is loading */\n\n  screenShareLoadingMessage: string;\n  /** String for local video label. Default is \"You\" */\n\n  localVideoLabel: string;\n  /** String for local video camera switcher */\n\n  localVideoCameraSwitcherLabel: string;\n  /** String for announcing the local video tile can be moved by keyboard controls */\n\n  localVideoMovementLabel: string;\n  /** String for announcing the selected camera */\n\n  localVideoSelectedDescription: string;\n  /** placeholder text for participants who does not have a display name*/\n\n  displayNamePlaceholder: string;\n}\n/**\n * @public\n */\n\nexport type VideoGalleryLayout = 'default' | 'floatingLocalVideo';\n/**\n * {@link VideoGallery} Component Styles.\n * @public\n */\n\nexport interface VideoGalleryStyles extends BaseCustomStyles {\n  /** Styles for the grid layout */\n  gridLayout?: GridLayoutStyles;\n  /** Styles for the horizontal gallery  */\n\n  horizontalGallery?: HorizontalGalleryStyles;\n  /** Styles for the local video  */\n\n  localVideo?: IStyle;\n}\n/**\n * Props for {@link VideoGallery}.\n *\n * @public\n */\n\nexport interface VideoGalleryProps {\n  /**\n   * Allows users to pass an object containing custom CSS styles for the gallery container.\n   *\n   * @Example\n   * ```\n   * <VideoGallery styles={{ root: { border: 'solid 1px red' } }} />\n   * ```\n   */\n  styles?: VideoGalleryStyles;\n  /** Layout of the video tiles. */\n\n  layout?: VideoGalleryLayout;\n  /** Local video particpant */\n\n  localParticipant: VideoGalleryLocalParticipant;\n  /** List of remote video particpants */\n\n  remoteParticipants?: VideoGalleryRemoteParticipant[];\n  /** List of dominant speaker userIds in the order of their dominance. 0th index is the most dominant. */\n\n  dominantSpeakers?: string[];\n  /** Local video view options */\n\n  localVideoViewOptions?: VideoStreamOptions;\n  /** Remote videos view options */\n\n  remoteVideoViewOptions?: VideoStreamOptions;\n  /** Callback to create the local video stream view */\n\n  onCreateLocalStreamView?: (options?: VideoStreamOptions) => Promise<void | CreateVideoStreamViewResult>;\n  /** Callback to dispose of the local video stream view */\n\n  onDisposeLocalStreamView?: () => void;\n  /** Callback to render the local video tile*/\n\n  onRenderLocalVideoTile?: (localParticipant: VideoGalleryLocalParticipant) => JSX.Element;\n  /** Callback to create a remote video stream view */\n\n  onCreateRemoteStreamView?: (userId: string, options?: VideoStreamOptions) => Promise<void | CreateVideoStreamViewResult>;\n  /** Callback to render a remote video tile */\n\n  onRenderRemoteVideoTile?: (remoteParticipant: VideoGalleryRemoteParticipant) => JSX.Element;\n  /** Callback to dispose a remote video stream view */\n\n  onDisposeRemoteStreamView?: (userId: string) => Promise<void>;\n  /** Callback to render a particpant avatar */\n\n  onRenderAvatar?: OnRenderAvatarCallback;\n  /**\n   * Whether to display the local video camera switcher button\n   */\n\n  showCameraSwitcherInLocalPreview?: boolean;\n  /**\n   * Whether to display a mute icon beside the user's display name.\n   * @defaultValue `true`\n   */\n\n  showMuteIndicator?: boolean;\n  /** Optional strings to override in component  */\n\n  strings?: Partial<VideoGalleryStrings>;\n  /**\n   * Maximum number of participant remote video streams that is rendered.\n   * @defaultValue 4\n   */\n\n  maxRemoteVideoStreams?: number;\n  /**\n   * Camera control information for button to switch cameras.\n   */\n\n  localVideoCameraCycleButtonProps?: LocalVideoCameraCycleButtonProps;\n}\nconst DRAG_OPTIONS: IDragOptions = {\n  moveMenuItemText: 'Move',\n  closeMenuItemText: 'Close',\n  menu: ContextualMenu,\n  keepInBounds: true\n}; // Manually override the max position used to keep the modal in the bounds of its container.\n// This is a workaround for: https://github.com/microsoft/fluentui/issues/20122\n// Because our modal starts in the bottom right corner, we can say that this is the max (i.e. rightmost and bottomost)\n// position the modal can be dragged to.\n\nconst modalMaxDragPosition = {\n  x: localVideoTileOuterPaddingPX,\n  y: localVideoTileOuterPaddingPX\n};\n/**\n * VideoGallery represents a layout of video tiles for a specific call.\n * It displays a {@link VideoTile} for the local user as well as for each remote participant who has joined the call.\n *\n * @public\n */\n\nexport const VideoGallery = (props: VideoGalleryProps): JSX.Element => {\n  const {\n    localParticipant,\n    remoteParticipants = [],\n    localVideoViewOptions,\n    remoteVideoViewOptions,\n    dominantSpeakers,\n    onRenderLocalVideoTile,\n    onRenderRemoteVideoTile,\n    onCreateLocalStreamView,\n    onDisposeLocalStreamView,\n    onCreateRemoteStreamView,\n    onDisposeRemoteStreamView,\n    styles,\n    layout,\n    onRenderAvatar,\n    showMuteIndicator,\n    maxRemoteVideoStreams = DEFAULT_MAX_REMOTE_VIDEO_STREAMS,\n    showCameraSwitcherInLocalPreview,\n    localVideoCameraCycleButtonProps\n  } = props;\n  const ids = useIdentifiers();\n  const theme = useTheme();\n  const localeStrings = useLocale().strings.videoGallery;\n  const strings = { ...localeStrings,\n    ...props.strings\n  };\n  const shouldFloatLocalVideo = !!(layout === 'floatingLocalVideo' && remoteParticipants.length > 0);\n  const shouldFloatNonDraggableLocalVideo = !!(showCameraSwitcherInLocalPreview && shouldFloatLocalVideo);\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const containerWidth = _useContainerWidth(containerRef);\n\n  const containerHeight = _useContainerHeight(containerRef);\n\n  const isNarrow = containerWidth ? isNarrowWidth(containerWidth) : false;\n  const visibleVideoParticipants = useRef<VideoGalleryRemoteParticipant[]>([]);\n  const visibleAudioParticipants = useRef<VideoGalleryRemoteParticipant[]>([]);\n  const modalWidth = isNarrow ? SMALL_FLOATING_MODAL_SIZE_PX.width : LARGE_FLOATING_MODAL_SIZE_PX.width;\n  const modalHeight = isNarrow ? SMALL_FLOATING_MODAL_SIZE_PX.height : LARGE_FLOATING_MODAL_SIZE_PX.height; // The minimum drag position is the top left of the video gallery. i.e. the modal (PiP) should not be able\n  // to be dragged offscreen and these are the top and left bounds of that calculation.\n\n  const modalMinDragPosition: _ICoordinates | undefined = useMemo(() => containerWidth && containerHeight ? {\n    // We use -containerWidth/Height because our modal is positioned to start in the bottom right,\n    // hence (0,0) is the bottom right of the video gallery.\n    x: -containerWidth + modalWidth + localVideoTileOuterPaddingPX,\n    y: -containerHeight + modalHeight + localVideoTileOuterPaddingPX\n  } : undefined, [containerHeight, containerWidth, modalHeight, modalWidth]);\n  visibleVideoParticipants.current = smartDominantSpeakerParticipants({\n    participants: remoteParticipants?.filter(p => p.videoStream?.isAvailable) ?? [],\n    dominantSpeakers,\n    lastVisibleParticipants: visibleVideoParticipants.current,\n    maxDominantSpeakers: maxRemoteVideoStreams\n  }).slice(0, maxRemoteVideoStreams);\n  // This set will be used to filter out participants already in visibleVideoParticipants\n  const visibleVideoParticipantsSet = new Set(visibleVideoParticipants.current.map(p => p.userId));\n  visibleAudioParticipants.current = smartDominantSpeakerParticipants({\n    participants: remoteParticipants?.filter(p => !visibleVideoParticipantsSet.has(p.userId)) ?? [],\n    dominantSpeakers,\n    lastVisibleParticipants: visibleAudioParticipants.current,\n    maxDominantSpeakers: MAX_AUDIO_DOMINANT_SPEAKERS\n  });\n\n  /**\n   * Utility function for memoized rendering of LocalParticipant.\n   */\n  const localVideoTile = useMemo((): JSX.Element\n  /* @conditional-compile-remove(rooms) */\n  | undefined => {\n    if (onRenderLocalVideoTile) {\n      return onRenderLocalVideoTile(localParticipant);\n    }\n\n    const localVideoTileStyles = concatStyleSets(shouldFloatLocalVideo ? floatingLocalVideoTileStyle : {}, {\n      root: {\n        borderRadius: theme.effects.roundedCorner4\n      }\n    }, styles?.localVideo);\n    const initialsName = !localParticipant.displayName ? strings.displayNamePlaceholder : localParticipant.displayName;\n    return <Stack key=\"local-video-tile-key\" tabIndex={0} aria-label={strings.localVideoMovementLabel} role={'dialog'}>\n        <_LocalVideoTile userId={localParticipant.userId} onCreateLocalStreamView={onCreateLocalStreamView} onDisposeLocalStreamView={onDisposeLocalStreamView} isAvailable={localParticipant?.videoStream?.isAvailable} isMuted={localParticipant.isMuted} renderElement={localParticipant?.videoStream?.renderElement} displayName={isNarrow ? '' : strings.localVideoLabel} initialsName={initialsName} localVideoViewOptions={localVideoViewOptions} onRenderAvatar={onRenderAvatar} showLabel={!(shouldFloatLocalVideo && isNarrow)} showMuteIndicator={showMuteIndicator} showCameraSwitcherInLocalPreview={showCameraSwitcherInLocalPreview} localVideoCameraCycleButtonProps={localVideoCameraCycleButtonProps} localVideoCameraSwitcherLabel={strings.localVideoCameraSwitcherLabel} localVideoSelectedDescription={strings.localVideoSelectedDescription} styles={localVideoTileStyles} />\n      </Stack>;\n  }, [isNarrow, localParticipant, localVideoCameraCycleButtonProps, localVideoViewOptions, onCreateLocalStreamView, onDisposeLocalStreamView, onRenderAvatar, onRenderLocalVideoTile, shouldFloatLocalVideo, showCameraSwitcherInLocalPreview, showMuteIndicator, strings.localVideoCameraSwitcherLabel, strings.localVideoLabel, strings.localVideoMovementLabel, strings.localVideoSelectedDescription, strings.displayNamePlaceholder, styles?.localVideo, theme.effects.roundedCorner4]);\n  const defaultOnRenderVideoTile = useCallback((participant: VideoGalleryRemoteParticipant, isVideoParticipant?: boolean) => {\n    const remoteVideoStream = participant.videoStream;\n    return <_RemoteVideoTile key={participant.userId} {...participant} onCreateRemoteStreamView={isVideoParticipant ? onCreateRemoteStreamView : undefined} onDisposeRemoteStreamView={isVideoParticipant ? onDisposeRemoteStreamView : undefined} isAvailable={isVideoParticipant ? remoteVideoStream?.isAvailable : false} isReceiving={isVideoParticipant ? remoteVideoStream?.isReceiving : false} renderElement={isVideoParticipant ? remoteVideoStream?.renderElement : undefined} remoteVideoViewOptions={isVideoParticipant ? remoteVideoViewOptions : undefined} onRenderAvatar={onRenderAvatar} showMuteIndicator={showMuteIndicator} />;\n  }, [onCreateRemoteStreamView, onDisposeRemoteStreamView, remoteVideoViewOptions, onRenderAvatar, showMuteIndicator]);\n  const videoTiles = onRenderRemoteVideoTile ? visibleVideoParticipants.current.map(participant => onRenderRemoteVideoTile(participant)) : visibleVideoParticipants.current.map((participant): JSX.Element => {\n    return defaultOnRenderVideoTile(participant, true);\n  });\n  const audioTiles = onRenderRemoteVideoTile ? visibleAudioParticipants.current.map(participant => onRenderRemoteVideoTile(participant)) : visibleAudioParticipants.current.map((participant): JSX.Element => {\n    return defaultOnRenderVideoTile(participant, false);\n  });\n  const screenShareParticipant = remoteParticipants.find(participant => participant.screenShareStream?.isAvailable);\n  const screenShareActive = screenShareParticipant || localParticipant?.isScreenSharingOn;\n\n  const createGridTiles = (): JSX.Element[] => {\n    return videoTiles.length > 0 ? videoTiles : audioTiles;\n  };\n\n  const gridTiles = createGridTiles();\n\n  const createHorizontalGalleryTiles = (): JSX.Element[] => {\n    if (screenShareActive) {\n      // If screen sharing is active, assign video and audio participants as horizontal gallery participants\n      return videoTiles.concat(audioTiles);\n    } else {\n      // If screen sharing is not active, then assign all video tiles as grid tiles.\n      // If there are no video tiles, then assign audio tiles as grid tiles.\n      return videoTiles.length > 0 ? audioTiles : [];\n    }\n  };\n\n  const horizontalGalleryTiles = createHorizontalGalleryTiles();\n\n  if (!shouldFloatLocalVideo && localVideoTile) {\n    gridTiles.push(localVideoTile);\n  }\n\n  const localScreenShareStreamComponent = <LocalScreenShare localParticipant={localParticipant} />;\n  const remoteScreenShareComponent = screenShareParticipant && <RemoteScreenShare {...screenShareParticipant} renderElement={screenShareParticipant.screenShareStream?.renderElement} onCreateRemoteStreamView={onCreateRemoteStreamView} onDisposeRemoteStreamView={onDisposeRemoteStreamView} isReceiving={screenShareParticipant.screenShareStream?.isReceiving} />;\n  const horizontalGalleryPresent = horizontalGalleryTiles && horizontalGalleryTiles.length > 0;\n  const layerHostId = useId('layerhost');\n  return <div data-ui-id={ids.videoGallery} ref={containerRef} className={mergeStyles(videoGalleryOuterDivStyle, styles?.root)}>\n      {shouldFloatLocalVideo && !shouldFloatNonDraggableLocalVideo && localVideoTile && (horizontalGalleryPresent ? <Stack className={mergeStyles(localVideoTileContainerStyle(theme, isNarrow))}>{localVideoTile}</Stack> : <_ModalClone isOpen={true} isModeless={true} dragOptions={DRAG_OPTIONS} styles={floatingLocalVideoModalStyle(theme, isNarrow)} layerProps={{\n      hostId: layerHostId\n    }} maxDragPosition={modalMaxDragPosition} minDragPosition={modalMinDragPosition}>\n            {localVideoTile}\n          </_ModalClone>)}\n      {// When we use showCameraSwitcherInLocalPreview it disables dragging to allow keyboard navigation.\n    shouldFloatNonDraggableLocalVideo && localVideoTile && remoteParticipants.length > 0 && <Stack className={mergeStyles(localVideoTileWithControlsContainerStyle(theme, isNarrow), {\n      boxShadow: theme.effects.elevation8,\n      zIndex: LOCAL_VIDEO_TILE_ZINDEX\n    })}>\n            {localVideoTile}\n          </Stack>}\n      <Stack horizontal={false} styles={videoGalleryContainerStyle}>\n        {screenShareParticipant ? remoteScreenShareComponent : localParticipant?.isScreenSharingOn ? localScreenShareStreamComponent : <GridLayout key=\"grid-layout\" styles={styles?.gridLayout}>\n            {gridTiles}\n          </GridLayout>}\n        {horizontalGalleryPresent && <div style={{\n        paddingTop: '0.5rem'\n      }}>\n            <ResponsiveHorizontalGallery key=\"responsive-horizontal-gallery\" containerStyles={horizontalGalleryContainerStyle(shouldFloatLocalVideo, isNarrow)} horizontalGalleryStyles={concatStyleSets(horizontalGalleryStyle(isNarrow), styles?.horizontalGallery)} childWidthRem={isNarrow ? SMALL_HORIZONTAL_GALLERY_TILE_SIZE_REM.width : LARGE_HORIZONTAL_GALLERY_TILE_SIZE_REM.width} buttonWidthRem={HORIZONTAL_GALLERY_BUTTON_WIDTH} gapWidthRem={HORIZONTAL_GALLERY_GAP}>\n              {horizontalGalleryTiles}\n            </ResponsiveHorizontalGallery>\n          </div>}\n\n        <LayerHost id={layerHostId} className={mergeStyles(layerHostStyle)} />\n      </Stack>\n    </div>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStyle, IButtonStyles, IContextualMenuStyles, IContextualMenuItemStyles } from '@fluentui/react';\ninterface IControlBarStyles {\n  horizontal: IStyle;\n  vertical: IStyle;\n  dockedTop: IStyle;\n  dockedBottom: IStyle;\n  dockedLeft: IStyle;\n  dockedRight: IStyle;\n  floatingTop: IStyle;\n  floatingBottom: IStyle;\n  floatingLeft: IStyle;\n  floatingRight: IStyle;\n}\n/**\n * @private\n */\n\nexport const controlBarStyles: IControlBarStyles = {\n  horizontal: {\n    flexFlow: 'row nowrap'\n  },\n  vertical: {\n    flexFlow: 'column nowrap',\n    width: 'fit-content',\n    maxWidth: '8rem'\n  },\n  dockedTop: {\n    flexFlow: 'row nowrap',\n    justifyContent: 'center',\n    overflow: 'hidden',\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    width: '100%',\n    minWidth: 'fit-content'\n  },\n  dockedBottom: {\n    flexFlow: 'row nowrap',\n    justifyContent: 'center',\n    overflow: 'hidden',\n    position: 'absolute',\n    bottom: 0,\n    left: 0,\n    width: '100%',\n    minWidth: 'fit-content'\n  },\n  dockedLeft: {\n    justifyContent: 'center',\n    overflow: 'hidden',\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    height: '100%'\n  },\n  dockedRight: {\n    justifyContent: 'center',\n    overflow: 'hidden',\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    height: '100%'\n  },\n  floatingTop: {\n    flexFlow: 'row nowrap',\n    justifyContent: 'center',\n    overflow: 'hidden',\n    position: 'absolute',\n    top: '1rem',\n    left: '50%',\n    transform: 'translateX(-50%)',\n    minWidth: 'fit-content',\n    zIndex: 10\n  },\n  floatingBottom: {\n    flexFlow: 'row nowrap',\n    justifyContent: 'center',\n    overflow: 'hidden',\n    position: 'absolute',\n    bottom: '1rem',\n    left: '50%',\n    transform: 'translateX(-50%)',\n    minWidth: 'fit-content',\n    zIndex: 10\n  },\n  floatingLeft: {\n    flexFlow: 'column nowrap',\n    justifyContent: 'center',\n    overflow: 'hidden',\n    position: 'absolute',\n    top: '50%',\n    left: '1rem',\n    transform: 'translateY(-50%)',\n    zIndex: 10\n  },\n  floatingRight: {\n    flexFlow: 'column nowrap',\n    justifyContent: 'center',\n    overflow: 'hidden',\n    position: 'absolute',\n    top: '50%',\n    right: '1rem',\n    transform: 'translateY(-50%)',\n    zIndex: 10\n  }\n};\n/**\n * @private\n */\n\nexport const controlButtonStyles: IButtonStyles = {\n  root: {\n    background: 'none',\n    border: 'none',\n    borderRadius: 0,\n    minHeight: '3.5rem',\n    minWidth: '3.5rem',\n    width: '100%',\n    maxWidth: '8rem',\n    svg: {\n      verticalAlign: 'text-top'\n    }\n  },\n  splitButtonMenuButton: {\n    border: 'none'\n  },\n  flexContainer: {\n    flexFlow: 'column',\n    display: 'contents'\n  },\n  label: {\n    fontSize: '0.625rem',\n    fontWeight: '400',\n    lineHeight: '1rem',\n    cursor: 'pointer',\n    display: 'block',\n    margin: '0rem 0.25rem',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap'\n  }\n};\n/**\n * making it Partial as IContextualMenuStyles has all its props non-optional and we only need title to be defined here.\n *\n * @private\n */\n\nexport const participantsButtonMenuPropsStyle: Partial<IContextualMenuStyles> = {\n  title: {\n    background: 'initial',\n    paddingLeft: '.5rem',\n    fontWeight: 600,\n    fontSize: '.75rem'\n  }\n};\n/**\n * Default styles for button flyout items\n *\n * @private\n */\n\nexport const buttonFlyoutItemStyles: IContextualMenuItemStyles = {\n  icon: {\n    lineHeight: 0\n  },\n  checkmarkIcon: {\n    lineHeight: 0\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React from 'react';\nimport { TooltipHost, ITooltipHostStyles, ITooltipHostProps, ICalloutContentStyles, mergeStyleSets, useTheme } from '@fluentui/react';\nimport { isDarkThemed } from '../theming/themeUtils'; // The TooltipHost root uses display: inline by default.\n// To prevent sizing issues or tooltip positioning issues, we override to inline-block.\n// For more details see \"Icon Button with Tooltip\" on https://developer.microsoft.com/en-us/fluentui#/controls/web/button\n\nconst hostStyles: Partial<ITooltipHostStyles> = {\n  root: {\n    display: 'inline-block'\n  }\n};\n/**\n * Tooltip that should wrap control bar buttons.\n *\n * @private\n */\n\nexport const ControlButtonTooltip = (props: ITooltipHostProps): JSX.Element => {\n  const theme = useTheme();\n  const calloutStyle: Partial<ICalloutContentStyles> = {\n    root: {\n      padding: 0\n    },\n    calloutMain: {\n      padding: '0.5rem'\n    }\n  }; // Place callout with no gap between it and the button.\n\n  const calloutProps = {\n    gapSpace: 0,\n    styles: calloutStyle,\n    backgroundColor: isDarkThemed(theme) ? theme.palette.neutralLighter : ''\n  };\n  return <TooltipHost {...props} data-ui-id={props.id} calloutProps={{ ...calloutProps,\n    ...props.calloutProps\n  }} styles={mergeStyleSets(hostStyles, props.styles)}>\n      {props.children}\n    </TooltipHost>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React from 'react';\nimport { DefaultButton, IButtonProps, IRenderFunction, concatStyleSets, IButtonStyles, KeyCodes } from '@fluentui/react';\nimport { controlButtonStyles } from './styles/ControlBar.styles';\nimport { ControlButtonTooltip } from './ControlButtonTooltip';\n/**\n * Strings of {@link ControlBarButton} that can be overridden.\n *\n * @public\n */\n\nexport interface ControlBarButtonStrings {\n  /**\n   * Label of the button. This supersedes onLabel or offLabel if used.\n   */\n  label?: string;\n  /**\n   * Label of the button shown when the button is checked.\n   */\n\n  onLabel?: string;\n  /**\n   * Label of the button shown when the button is not checked.\n   */\n\n  offLabel?: string;\n  /**\n   * Tooltip content of the button. This supersedes tooltipDisabledContent, tooltipOnContent and tooltipOffContent if used.\n   */\n\n  tooltipContent?: string;\n  /**\n   * Tooltip content when the button is disabled.\n   */\n\n  tooltipDisabledContent?: string;\n  /**\n   * Tooltip content when the button is in the checked state.\n   */\n\n  tooltipOnContent?: string;\n  /**\n   * Tooltip content when the button is in the unchecked state.\n   */\n\n  tooltipOffContent?: string;\n}\n/**\n * Styles for all {@link ControlBarButton} implementations.\n *\n * @public\n */\n\nexport type ControlBarButtonStyles = IButtonStyles;\n/**\n * Props for {@link ControlBarButton}.\n *\n * @public\n */\n\nexport interface ControlBarButtonProps extends IButtonProps {\n  /**\n   * Whether the label is displayed or not.\n   *\n   * @defaultValue `false`\n   */\n  showLabel?: boolean;\n  /**\n   * Key to use for the Label component\n   */\n\n  labelKey?: string;\n  /**\n   * Id to use for the tooltip host.\n   *\n   * @defaultValue This uses the labelKey and appends -tooltip by default\n   */\n\n  tooltipId?: string;\n  /**\n   * Optional strings to override in component.\n   */\n\n  strings?: ControlBarButtonStrings;\n  /**\n   * Icon to render when the button is checked.\n   */\n\n  onRenderOnIcon?: IRenderFunction<IButtonProps>;\n  /**\n   * Icon to render when the button is not checked.\n   */\n\n  onRenderOffIcon?: IRenderFunction<IButtonProps>;\n  /**\n   * Fluent styles, including extensions common to all {@link ControlBarButton}s.\n   */\n\n  styles?: ControlBarButtonStyles;\n}\n\nconst DefaultRenderIcon = (props?: ControlBarButtonProps): JSX.Element | null => {\n  return props?.checked ? props?.onRenderOnIcon ? props?.onRenderOnIcon() : null : props?.onRenderOffIcon ? props?.onRenderOffIcon() : null;\n};\n/**\n * Default button styled for the {@link ControlBar}.\n *\n * Use this component create custom buttons that are styled the same as other buttons provided by the UI Library.\n *\n * @public\n */\n\n\nexport const ControlBarButton = (props: ControlBarButtonProps): JSX.Element => {\n  const componentStyles = concatStyleSets(controlButtonStyles, props.styles ?? {});\n  const labelText = props?.text ?? props?.strings?.label ?? (props?.checked ? props?.strings?.onLabel : props?.strings?.offLabel);\n  const tooltipContent = props?.strings?.tooltipContent ?? (props?.disabled ? props?.strings?.tooltipDisabledContent : props?.checked ? props?.strings?.tooltipOnContent : props?.strings?.tooltipOffContent);\n  const tooltipId = props.tooltipId ?? props.labelKey ? props.labelKey + '-tooltip' : undefined;\n  return <ControlButtonTooltip content={tooltipContent} id={tooltipId}>\n      <DefaultButton {...props} styles={componentStyles} onRenderText={props.showLabel && props.onRenderText ? props.onRenderText : undefined} onRenderIcon={props.onRenderIcon ?? DefaultRenderIcon} ariaLabel={props.splitButtonAriaLabel ?? props.ariaLabel ?? tooltipContent ?? labelText} allowDisabledFocus={props.allowDisabledFocus ?? true} menuTriggerKeyCode={KeyCodes.down} // explicitly sets the keypress to activiate the split button drop down.\n    >\n        {props.showLabel ? labelText : <></>}\n      </DefaultButton>\n    </ControlButtonTooltip>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Icon, mergeStyles } from '@fluentui/react';\nimport React from 'react';\nimport { useTheme } from '../theming';\n/**\n * @internal\n */\n\nexport interface _HighContrastAwareIconProps {\n  /** Icon name */\n  iconName: string;\n  /** Whether button is disabled */\n\n  disabled?: boolean | undefined;\n}\n/**\n * This is a helper component to define and unify icon colors\n *\n * @internal\n */\n\nexport const _HighContrastAwareIcon = (props: _HighContrastAwareIconProps): JSX.Element => {\n  const {\n    iconName,\n    disabled\n  } = props;\n  const theme = useTheme(); // setting colors for the icons using color from theme, so in dark mode or other accessibility modes, they have pre-defined contrast colors\n  // the media query is for when in specific window accessibility mode, change the svg colors\n\n  return <Icon iconName={iconName} className={mergeStyles({\n    svg: {\n      fill: disabled ? theme.palette.neutralTertiary : theme.palette.neutralPrimaryAlt,\n      '@media (forced-colors: active) and (prefers-color-scheme: dark)': {\n        fill: disabled ? theme.palette.neutralPrimaryAlt : theme.palette.neutralTertiary\n      }\n    }\n  })} />;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ContextualMenuItemType, IContextualMenuItem, IContextualMenuItemStyles, IContextualMenuProps, IContextualMenuStyles, merge } from '@fluentui/react';\nimport React from 'react';\nimport { useLocale } from '../localization';\nimport { ControlBarButton, ControlBarButtonProps, ControlBarButtonStyles } from './ControlBarButton';\nimport { _HighContrastAwareIcon } from './HighContrastAwareIcon';\nimport { buttonFlyoutItemStyles } from './styles/ControlBar.styles';\nimport { _preventDismissOnEvent as preventDismissOnEvent } from '@internal/acs-ui-common';\n/**\n * Styles for the {@link DevicesButton} menu.\n *\n * @public\n */\n\nexport interface DevicesButtonContextualMenuStyles extends IContextualMenuStyles {\n  /**\n   * Styles for the items inside the {@link DevicesButton} button menu.\n   */\n  menuItemStyles?: IContextualMenuItemStyles;\n}\n/**\n * Styles for the Devices button menu items.\n *\n * @public\n */\n\nexport interface DevicesButtonStyles extends ControlBarButtonStyles {\n  /**\n   * Styles for the {@link DevicesButton} menu.\n   */\n  menuStyles?: Partial<DevicesButtonContextualMenuStyles>;\n}\n/**\n * A device, e.g. camera, microphone, or speaker, in the {@link DevicesButton} flyout.\n *\n * @public\n */\n\nexport interface OptionsDevice {\n  /**\n   * Device unique identifier\n   */\n  id: string;\n  /**\n   * Device name\n   */\n\n  name: string;\n}\n/**\n * Strings of {@link DevicesButton} that can be overridden.\n *\n * @public\n */\n\nexport interface DevicesButtonStrings {\n  /**\n   * Label of button\n   */\n  label: string;\n  /**\n   * Button tooltip content.\n   */\n\n  tooltipContent?: string;\n  /**\n   * Title of camera menu\n   */\n\n  cameraMenuTitle: string;\n  /**\n   * Title of microphone menu\n   */\n\n  microphoneMenuTitle: string;\n  /**\n   * Title of speaker menu\n   */\n\n  speakerMenuTitle: string;\n  /**\n   * Tooltip of camera menu\n   */\n\n  cameraMenuTooltip: string;\n  /**\n   * Tooltip of microphone menu\n   */\n\n  microphoneMenuTooltip: string;\n  /**\n   * Tooltip of speaker menu\n   */\n\n  speakerMenuTooltip: string;\n}\n/**\n * Props for {@link DevicesButton}.\n *\n * @public\n */\n\nexport interface DevicesButtonProps extends ControlBarButtonProps {\n  /**\n   * Available microphones for selection\n   */\n  microphones?: OptionsDevice[];\n  /**\n   * Available speakers for selection\n   */\n\n  speakers?: OptionsDevice[];\n  /**\n   * Available cameras for selection\n   */\n\n  cameras?: OptionsDevice[];\n  /**\n   * Microphone that is shown as currently selected\n   */\n\n  selectedMicrophone?: OptionsDevice;\n  /**\n   * Speaker that is shown as currently selected\n   */\n\n  selectedSpeaker?: OptionsDevice;\n  /**\n   * Camera that is shown as currently selected\n   */\n\n  selectedCamera?: OptionsDevice;\n  /**\n   * Callback when a camera is selected\n   */\n\n  onSelectCamera?: (device: OptionsDevice) => Promise<void>;\n  /**\n   * Callback when a microphone is selected\n   */\n\n  onSelectMicrophone?: (device: OptionsDevice) => Promise<void>;\n  /**\n   * Speaker when a speaker is selected\n   */\n\n  onSelectSpeaker?: (device: OptionsDevice) => Promise<void>;\n  /**\n   * Optional strings to override in component\n   */\n\n  strings?: Partial<DevicesButtonStrings>;\n  /**\n   * Option to increase the touch targets of the button flyout menu items from 36px to 48px.\n   * Recommended for mobile devices.\n   */\n\n  styles?: DevicesButtonStyles;\n}\n/**\n * Subset props for various buttons that show device selection menus.\n *\n * @private\n */\n\nexport interface DeviceMenuProps {\n  microphones?: OptionsDevice[];\n  speakers?: OptionsDevice[];\n  cameras?: OptionsDevice[];\n  selectedMicrophone?: OptionsDevice;\n  selectedSpeaker?: OptionsDevice;\n  selectedCamera?: OptionsDevice;\n  onSelectCamera?: (device: OptionsDevice) => Promise<void>;\n  onSelectMicrophone?: (device: OptionsDevice) => Promise<void>;\n  onSelectSpeaker?: (device: OptionsDevice) => Promise<void>;\n  styles?: Partial<DeviceMenuStyles>;\n}\n/**\n * Subset of strings for various buttons that show device selection menus.\n *\n * @private\n */\n\nexport interface DeviceMenuStrings {\n  /**\n   * Title for Camera section in the contextual menu\n   */\n  cameraMenuTitle?: string;\n  /**\n   * Title for Audio Device section in the contextual menu\n   *\n   * @remark Used in place of microphoneMenuTitle when speakers can be enumerated\n   */\n\n  audioDeviceMenuTitle?: string;\n  /**\n   * Title for Microphone section in the contextual menu\n   *\n   * @remark Used when speakers can be enumerated\n   */\n\n  microphoneMenuTitle?: string;\n  /**\n   * Title for Speaker section in the contextual menu\n   */\n\n  speakerMenuTitle?: string;\n  /**\n   * Tooltip label for Camera section in the contextual menu\n   */\n\n  cameraMenuTooltip?: string;\n  /**\n   * Tooltip label for Audio Device section in the contextual menu\n   *\n   * @remark Used in place of microphoneMenuTooltip when speakers can be enumerated\n   */\n\n  audioDeviceMenuTooltip?: string;\n  /**\n   * Tooltip label for Microphone section in the contextual menu\n   *\n   * @remark Used when speakers can be enumerated\n   */\n\n  microphoneMenuTooltip?: string;\n  /**\n   * Tooltip label for Speaker section in the contextual menu\n   */\n\n  speakerMenuTooltip?: string;\n}\n/**\n * Styles for flyouts used by various buttons for device selection flyouts.\n *\n * @private\n */\n\nexport interface DeviceMenuStyles extends IContextualMenuStyles {\n  menuItemStyles?: IContextualMenuItemStyles;\n}\n/**\n * Generates default {@link IContextualMenuProps} for buttons that\n * show a drop-down to select devices to use.\n *\n * @private\n */\n\nexport const generateDefaultDeviceMenuProps = (props: DeviceMenuProps, strings: DeviceMenuStrings, isSelectCamAllowed = true, isSelectMicAllowed = true): {\n  items: IContextualMenuItem[];\n} | undefined => {\n  const {\n    microphones,\n    speakers,\n    cameras,\n    selectedMicrophone,\n    selectedSpeaker,\n    selectedCamera,\n    onSelectCamera,\n    onSelectMicrophone,\n    onSelectSpeaker\n  } = props;\n  const defaultMenuProps: IContextualMenuProps = {\n    items: [],\n    styles: props.styles,\n    calloutProps: {\n      styles: {\n        root: {\n          // Confine the menu to the parents bounds.\n          // More info: https://github.com/microsoft/fluentui/issues/18835\n          // NB: 95% to keep some space for margin, drop shadow etc around the Callout.\n          maxWidth: '95%'\n        }\n      },\n      preventDismissOnEvent\n    }\n  };\n  const menuItemStyles = merge(buttonFlyoutItemStyles, props.styles?.menuItemStyles ?? {});\n\n  if (cameras && selectedCamera && onSelectCamera && isSelectCamAllowed) {\n    defaultMenuProps.items.push({\n      key: 'sectionCamera',\n      title: strings.cameraMenuTooltip,\n      itemType: ContextualMenuItemType.Section,\n      sectionProps: {\n        title: strings.cameraMenuTitle,\n        items: cameras.map(camera => ({\n          key: camera.id,\n          text: camera.name,\n          title: camera.name,\n          iconProps: {\n            iconName: 'OptionsCamera',\n            styles: {\n              root: {\n                lineHeight: 0\n              }\n            }\n          },\n          itemProps: {\n            styles: menuItemStyles\n          },\n          canCheck: true,\n          isChecked: camera.id === selectedCamera?.id,\n          onClick: () => {\n            if (camera.id !== selectedCamera?.id) {\n              onSelectCamera(camera);\n            }\n          }\n        }))\n      }\n    });\n  }\n\n  if (microphones && selectedMicrophone && onSelectMicrophone && isSelectMicAllowed) {\n    // Set props as Microphone if speakers can be enumerated else set as Audio Device\n    const speakersAvailable = speakers && speakers.length > 0;\n    const key = speakersAvailable ? 'sectionMicrophone' : 'sectionAudioDevice';\n    const title = speakersAvailable ? strings.microphoneMenuTooltip : strings.audioDeviceMenuTooltip;\n    const sectionPropsTitle = speakersAvailable ? strings.microphoneMenuTitle : strings.audioDeviceMenuTitle;\n    const iconName = speakersAvailable ? 'OptionsMic' : 'OptionsSpeaker';\n    defaultMenuProps.items.push({\n      key: key,\n      title: title,\n      itemType: ContextualMenuItemType.Section,\n      sectionProps: {\n        title: sectionPropsTitle,\n        items: microphones.map(microphone => ({\n          key: microphone.id,\n          text: microphone.name,\n          title: microphone.name,\n          iconProps: {\n            iconName: iconName,\n            styles: {\n              root: {\n                lineHeight: 0\n              }\n            }\n          },\n          itemProps: {\n            styles: menuItemStyles\n          },\n          canCheck: true,\n          isChecked: microphone.id === selectedMicrophone?.id,\n          onClick: () => {\n            if (microphone.id !== selectedMicrophone?.id) {\n              onSelectMicrophone(microphone);\n            }\n          }\n        }))\n      }\n    });\n  }\n\n  if (speakers && selectedSpeaker && onSelectSpeaker) {\n    defaultMenuProps.items.push({\n      key: 'sectionSpeaker',\n      title: strings.speakerMenuTooltip,\n      itemType: ContextualMenuItemType.Section,\n      sectionProps: {\n        title: strings.speakerMenuTitle,\n        items: speakers.map(speaker => ({\n          key: speaker.id,\n          text: speaker.name,\n          title: speaker.name,\n          iconProps: {\n            iconName: 'OptionsSpeaker',\n            styles: {\n              root: {\n                lineHeight: 0\n              }\n            }\n          },\n          itemProps: {\n            styles: menuItemStyles\n          },\n          canCheck: true,\n          isChecked: speaker.id === selectedSpeaker?.id,\n          onClick: () => {\n            if (speaker.id !== selectedSpeaker?.id) {\n              onSelectSpeaker(speaker);\n            }\n          }\n        }))\n      }\n    });\n  }\n\n  if (defaultMenuProps.items.length === 0) {\n    // Avoids creating an empty context menu.\n    return undefined;\n  }\n\n  return defaultMenuProps;\n};\n/**\n * A button to open a menu that controls device options.\n *\n * Can be used with {@link ControlBar}.\n *\n * @public\n */\n\nexport const DevicesButton = (props: DevicesButtonProps): JSX.Element => {\n  const {\n    onRenderIcon\n  } = props;\n  const localeStrings = useLocale().strings.devicesButton;\n  const strings = { ...localeStrings,\n    ...props.strings\n  };\n  const devicesButtonMenu = props.menuProps ?? generateDefaultDeviceMenuProps({ ...props,\n    styles: props.styles?.menuStyles\n  }, strings);\n\n  const onRenderOptionsIcon = (): JSX.Element => {\n    return <_HighContrastAwareIcon disabled={props.disabled} iconName=\"ControlButtonOptions\" />;\n  };\n\n  return <ControlBarButton {...props} menuProps={devicesButtonMenu} menuIconProps={{\n    hidden: true\n  }} onRenderIcon={onRenderIcon ?? onRenderOptionsIcon} strings={strings} labelKey={props.labelKey ?? 'devicesButtonLabel'} />;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { useCallback, useState } from 'react';\nimport { useLocale } from '../localization';\nimport { VideoStreamOptions } from '../types';\nimport { ControlBarButton, ControlBarButtonProps } from './ControlBarButton';\nimport { _HighContrastAwareIcon } from './HighContrastAwareIcon';\nimport { IContextualMenuItemStyles, IContextualMenuStyles } from '@fluentui/react';\nimport { ControlBarButtonStyles } from './ControlBarButton';\nimport { OptionsDevice, generateDefaultDeviceMenuProps } from './DevicesButton';\nimport { Announcer } from './Announcer';\nconst defaultLocalVideoViewOptions = ({\n  scalingMode: 'Crop',\n  isMirrored: true\n} as VideoStreamOptions);\n/**\n * Strings of CameraButton that can be overridden.\n *\n * @public\n */\n\nexport interface CameraButtonStrings {\n  /** Label when button is on. */\n  onLabel: string;\n  /** Label when button is off. */\n\n  offLabel: string;\n  /** Tooltip content when the button is disabled. */\n\n  tooltipDisabledContent?: string;\n  /** Tooltip content when the button is on. */\n\n  tooltipOnContent?: string;\n  /** Tooltip content when the button is off. */\n\n  tooltipOffContent?: string;\n  /** Tooltip content when the button is disabled due to video loading. */\n\n  tooltipVideoLoadingContent?: string;\n  /**\n   * Title of camera menu\n   */\n\n  cameraMenuTitle: string;\n  /**\n   * Tooltip of camera menu\n   */\n\n  cameraMenuTooltip: string;\n  /**\n   * description of camera button split button role\n   */\n\n  cameraButtonSplitRoleDescription?: string;\n  /**\n   * Camera split button aria label for when button is enabled.\n   */\n\n  onSplitButtonAriaLabel?: string;\n  /**\n   * Camera split button aria label for when button is disabled.\n   */\n\n  offSplitButtonAriaLabel?: string;\n  /**\n   * Camera action turned on string for announcer\n   */\n\n  cameraActionTurnedOnAnnouncement?: string;\n  /**\n   * Camera action turned off string for announcer\n   */\n\n  cameraActionTurnedOffAnnouncement?: string;\n}\n/**\n * Styles for {@link CameraButton}\n *\n * @public\n */\n\nexport interface CameraButtonStyles extends ControlBarButtonStyles {\n  /**\n   * Styles for the {@link CameraButton} menu.\n   */\n  menuStyles?: Partial<CameraButtonContextualMenuStyles>;\n}\n/**\n * Styles for the {@link CameraButton} menu.\n *\n * @public\n */\n\nexport interface CameraButtonContextualMenuStyles extends IContextualMenuStyles {\n  /**\n   * Styles for the items inside the {@link CameraButton} button menu.\n   */\n  menuItemStyles?: IContextualMenuItemStyles;\n}\n/**\n * Props for {@link CameraButton} component.\n *\n * @public\n */\n\nexport interface CameraButtonProps extends ControlBarButtonProps {\n  /**\n   * Utility property for using this component with `communication react eventHandlers`.\n   * Maps directly to the `onClick` property.\n   */\n  onToggleCamera?: (options?: VideoStreamOptions) => Promise<void>;\n  /**\n   * Options for rendering local video view.\n   */\n\n  localVideoViewOptions?: VideoStreamOptions;\n  /**\n   * Available cameras for selection\n   */\n\n  cameras?: OptionsDevice[];\n  /**\n   * Camera that is shown as currently selected\n   */\n\n  selectedCamera?: OptionsDevice;\n  /**\n   * Callback when a camera is selected\n   */\n\n  onSelectCamera?: (device: OptionsDevice) => Promise<void>;\n  /**\n   * Whether to use a {@link SplitButton} with a {@link IContextualMenu} for device selection.\n   *\n   * default: false\n   */\n\n  enableDeviceSelectionMenu?: boolean;\n  /**\n   * Optional strings to override in component\n   */\n\n  strings?: Partial<CameraButtonStrings>;\n  /**\n   * Styles for {@link CameraButton} and the device selection flyout.\n   */\n\n  styles?: Partial<CameraButtonStyles>;\n}\n/**\n * A button to turn camera on / off.\n *\n * Can be used with {@link ControlBar}.\n *\n * @public\n */\n\nexport const CameraButton = (props: CameraButtonProps): JSX.Element => {\n  const {\n    localVideoViewOptions,\n    onToggleCamera\n  } = props;\n  const [waitForCamera, setWaitForCamera] = useState(false);\n  const localeStrings = useLocale().strings.cameraButton;\n  const strings = { ...localeStrings,\n    ...props.strings\n  };\n  const [announcerString, setAnnouncerString] = useState<string | undefined>(undefined);\n  const disabled = props.disabled || waitForCamera;\n\n  const onRenderCameraOnIcon = (): JSX.Element => <_HighContrastAwareIcon disabled={disabled} iconName=\"ControlButtonCameraOn\" />;\n\n  const onRenderCameraOffIcon = (): JSX.Element => <_HighContrastAwareIcon disabled={disabled} iconName=\"ControlButtonCameraOff\" />;\n\n  if (waitForCamera && strings.tooltipVideoLoadingContent) {\n    strings.tooltipDisabledContent = strings.tooltipVideoLoadingContent;\n  }\n\n  const cameraOn = props.checked;\n  const splitButtonAriaString = cameraOn ? strings.onSplitButtonAriaLabel : strings.offSplitButtonAriaLabel;\n  const toggleAnnouncerString = useCallback((isCameraOn: boolean) => {\n    setAnnouncerString(!isCameraOn ? strings.cameraActionTurnedOffAnnouncement : strings.cameraActionTurnedOnAnnouncement);\n  }, [strings.cameraActionTurnedOffAnnouncement, strings.cameraActionTurnedOnAnnouncement]);\n  const onToggleClick = useCallback(async () => {\n    // Throttle click on camera, need to await onToggleCamera then allow another click\n    if (onToggleCamera) {\n      setWaitForCamera(true);\n\n      try {\n        await onToggleCamera(localVideoViewOptions ?? defaultLocalVideoViewOptions); // allows for the setting of narrator strings triggering the announcer when camera is turned on or off.\n\n        toggleAnnouncerString(!cameraOn);\n      } finally {\n        setWaitForCamera(false);\n      }\n    }\n  }, [cameraOn, localVideoViewOptions, onToggleCamera, toggleAnnouncerString]);\n  return <>\n      <Announcer announcementString={announcerString} ariaLive={'polite'} />\n      <ControlBarButton {...props} disabled={disabled} onClick={onToggleCamera ? onToggleClick : props.onClick} onRenderOnIcon={props.onRenderOnIcon ?? onRenderCameraOnIcon} onRenderOffIcon={props.onRenderOffIcon ?? onRenderCameraOffIcon} strings={strings} labelKey={props.labelKey ?? 'cameraButtonLabel'} menuProps={props.menuProps ?? (props.enableDeviceSelectionMenu ? generateDefaultDeviceMenuProps({ ...props,\n      styles: props.styles?.menuStyles\n    }, strings) : undefined)} menuIconProps={props.menuIconProps ?? !props.enableDeviceSelectionMenu ? {\n      hidden: true\n    } : undefined} split={props.split ?? props.enableDeviceSelectionMenu} aria-roledescription={props.enableDeviceSelectionMenu ? strings.cameraButtonSplitRoleDescription : undefined} splitButtonAriaLabel={props.enableDeviceSelectionMenu ? splitButtonAriaString : undefined} />\n    </>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStyle, mergeStyles, Stack } from '@fluentui/react';\nimport React, { useMemo } from 'react';\nimport { BaseCustomStyles } from '../types';\nimport { controlBarStyles } from './styles/ControlBar.styles';\nimport { useTheme } from '../theming';\nimport { isDarkThemed } from '../theming/themeUtils';\nconst mainDivStyle: IStyle = {\n  position: 'relative',\n  height: '100%',\n  width: '100%'\n};\n/**\n * Present layouts for the {@link ControlBar}.\n *\n * @public\n */\n\nexport type ControlBarLayout = 'horizontal' | 'vertical' | 'dockedTop' | 'dockedBottom' | 'dockedLeft' | 'dockedRight' | 'floatingTop' | 'floatingBottom' | 'floatingLeft' | 'floatingRight';\n/**\n * Props for {@link ControlBar}.\n *\n * @public\n */\n\nexport interface ControlBarProps {\n  /** React Child components. */\n  children?: React.ReactNode;\n  /**\n   * Allows users to pass an object containing custom CSS styles.\n   * @Example\n   * ```\n   * <ControlBar styles={{ root: { background: 'blue' } }} />\n   * ```\n   */\n\n  styles?: BaseCustomStyles;\n  /**\n   * Changes the layout of the control bar.\n   * Available layouts are `horizontal`, `vertical`, `dockedTop`, `dockedBottom`,\n   * `dockedLeft`, `dockedRight`, `floatingTop`, `floatingBottom`, `floatingLeft`,\n   * `floatingRight`\n   * Defaults to a `horizontal` layout.\n   */\n\n  layout?: ControlBarLayout;\n}\n/**\n * A container for various buttons for call controls.\n *\n * Use with various call control buttons in this library, e.g., {@link CameraButton}, or your own instances of\n * {@link ControlBarButton} directly.\n *\n * @public\n */\n\nexport const ControlBar = (props: ControlBarProps): JSX.Element => {\n  const {\n    styles,\n    layout\n  } = props;\n  const theme = useTheme();\n  const controlBarClassName = useMemo(() => {\n    const controlBarStyle = controlBarStyles[layout ?? 'horizontal']; // if theme is dark and layout is floating then use palette.neutralQuaternaryAlt as background, otherwise use theme.palette.white\n\n    const backgroundStyle = {\n      background: isDarkThemed(theme) && layout?.startsWith('floating') ? theme.palette.neutralQuaternaryAlt : theme.palette.white\n    };\n    const borderAndBoxShadowStyle = layout?.startsWith('floating') ? {\n      boxShadow: theme.effects.elevation16,\n      borderRadius: theme.effects.roundedCorner6\n    } : {}; // if rtl is true and layout is either floatingTop or floatingBottom then we need to override the transform-style property\n    // to translate 50% to right instead of the left\n\n    const transformOverrideStyle = theme.rtl && (layout === 'floatingTop' || layout === 'floatingBottom') ? {\n      transform: 'translateX(50%)'\n    } : {};\n    return mergeStyles(controlBarStyle, backgroundStyle, borderAndBoxShadowStyle, transformOverrideStyle, styles?.root);\n  }, [layout, styles?.root, theme]);\n  return <div className={mergeStyles(mainDivStyle)}>\n      <Stack className={controlBarClassName}>{props.children}</Stack>\n    </div>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { concatStyleSets, Icon } from '@fluentui/react';\nimport React from 'react';\nimport { useLocale } from '../localization';\nimport { useTheme } from '../theming';\nimport { darkTheme, lightTheme } from '../theming/themes';\nimport { isDarkThemed } from '../theming/themeUtils';\nimport { ControlBarButton, ControlBarButtonProps } from './ControlBarButton';\n/**\n * Strings of {@link EndCallButton} that can be overridden.\n *\n * @public\n */\n\nexport interface EndCallButtonStrings {\n  /**\n   * Label of button\n   */\n  label: string;\n  /** Tooltip content. */\n\n  tooltipContent?: string;\n}\n/**\n * Props for {@link EndCallButton}.\n *\n * @public\n */\n\nexport interface EndCallButtonProps extends ControlBarButtonProps {\n  /**\n   * Utility property for using this component with `communication react eventHandlers`.\n   * Maps directly to the `onClick` property.\n   */\n  onHangUp?: () => Promise<void>;\n  /**\n   * Optional strings to override in component\n   */\n\n  strings?: EndCallButtonStrings;\n}\n\nconst onRenderEndCallIcon = (): JSX.Element => <Icon iconName=\"ControlButtonEndCall\" />;\n/**\n * A button to end an ongoing call.\n *\n * Can be used with {@link ControlBar}.\n *\n * @public\n */\n\n\nexport const EndCallButton = (props: EndCallButtonProps): JSX.Element => {\n  const {\n    styles\n  } = props;\n  const localeStrings = useLocale().strings.endCallButton;\n  const strings = { ...localeStrings,\n    ...props.strings\n  };\n  const theme = useTheme();\n  const isDarkTheme = isDarkThemed(theme);\n  const componentStyles = concatStyleSets(isDarkTheme ? darkThemeCallButtonStyles : lightThemeCallButtonStyles, styles ?? {});\n  return <ControlBarButton {...props} onClick={props.onHangUp ?? props.onClick} styles={componentStyles} onRenderIcon={props.onRenderIcon ?? onRenderEndCallIcon} strings={strings} labelKey={props.labelKey ?? 'endCallButtonLabel'} />;\n}; // using media query to prevent windows from overwriting the button color\n\nconst darkThemeCallButtonStyles = {\n  root: {\n    color: darkTheme.callingPalette.iconWhite,\n    background: darkTheme.callingPalette.callRed,\n    '@media (forced-colors: active)': {\n      forcedColorAdjust: 'none'\n    },\n    ':focus::after': {\n      outlineColor: `${darkTheme.callingPalette.iconWhite} !important`\n    } // added !important to avoid override by FluentUI button styles\n\n  },\n  rootHovered: {\n    color: darkTheme.callingPalette.iconWhite,\n    background: darkTheme.callingPalette.callRed,\n    '@media (forced-colors: active)': {\n      forcedColorAdjust: 'none'\n    }\n  },\n  rootPressed: {\n    color: darkTheme.callingPalette.iconWhite,\n    background: darkTheme.callingPalette.callRed,\n    '@media (forced-colors: active)': {\n      forcedColorAdjust: 'none'\n    }\n  },\n  label: {\n    color: darkTheme.callingPalette.iconWhite\n  }\n};\nconst lightThemeCallButtonStyles = {\n  root: {\n    color: lightTheme.callingPalette.iconWhite,\n    background: lightTheme.callingPalette.callRed,\n    '@media (forced-colors: active)': {\n      forcedColorAdjust: 'none'\n    },\n    ':focus::after': {\n      outlineColor: `${lightTheme.callingPalette.iconWhite} !important`\n    } // added !important to avoid override by FluentUI button styles\n\n  },\n  rootHovered: {\n    color: lightTheme.callingPalette.iconWhite,\n    background: lightTheme.callingPalette.callRed,\n    '@media (forced-colors: active)': {\n      forcedColorAdjust: 'none'\n    }\n  },\n  rootPressed: {\n    color: lightTheme.callingPalette.iconWhite,\n    background: lightTheme.callingPalette.callRed,\n    '@media (forced-colors: active)': {\n      forcedColorAdjust: 'none'\n    }\n  },\n  label: {\n    color: lightTheme.callingPalette.iconWhite\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { useState, useCallback } from 'react';\nimport { useLocale } from '../localization';\nimport { ControlBarButton, ControlBarButtonProps } from './ControlBarButton';\nimport { _HighContrastAwareIcon } from './HighContrastAwareIcon';\nimport { IContextualMenuItemStyles, IContextualMenuStyles } from '@fluentui/react';\nimport { ControlBarButtonStyles } from './ControlBarButton';\nimport { OptionsDevice, generateDefaultDeviceMenuProps } from './DevicesButton';\nimport { Announcer } from './Announcer';\n/**\n * Strings of {@link MicrophoneButton} that can be overridden.\n *\n * @public\n */\n\nexport interface MicrophoneButtonStrings {\n  /** Label when button is on. */\n  onLabel: string;\n  /** Label when button is off. */\n\n  offLabel: string;\n  /** * Tooltip content when the button is disabled. */\n\n  tooltipDisabledContent?: string;\n  /** Tooltip content when the button is on. */\n\n  tooltipOnContent?: string;\n  /** Tooltip content when the button is off. */\n\n  tooltipOffContent?: string;\n  /**\n   * Title of microphone menu\n   */\n\n  microphoneMenuTitle?: string;\n  /**\n   * Title of speaker menu\n   */\n\n  speakerMenuTitle?: string;\n  /**\n   * Tooltip of microphone menu\n   */\n\n  microphoneMenuTooltip?: string;\n  /**\n   * Tooltip of speaker menu\n   */\n\n  speakerMenuTooltip?: string;\n  /**\n   * Description of microphone button split button role\n   */\n\n  microphoneButtonSplitRoleDescription?: string;\n  /**\n   * Microphone split button aria label when mic is enabled.\n   */\n\n  onSplitButtonAriaLabel?: string;\n  /**\n   * Microphone split button aria label when mic is disabled.\n   */\n\n  offSplitButtonAriaLabel?: string;\n  /**\n   * Microphone action turned on string for announcer\n   */\n\n  microphoneActionTurnedOnAnnouncement?: string;\n  /**\n   * Microphone action turned off string for announcer\n   */\n\n  microphoneActionTurnedOffAnnouncement?: string;\n}\n/**\n * Styles for {@link MicrophoneButton}\n *\n * @public\n */\n\nexport interface MicrophoneButtonStyles extends ControlBarButtonStyles {\n  /**\n   * Styles for the {@link MicrophoneButton} menu.\n   */\n  menuStyles?: Partial<MicrophoneButtonContextualMenuStyles>;\n}\n/**\n * Styles for the {@link MicrophoneButton} menu.\n *\n * @public\n */\n\nexport interface MicrophoneButtonContextualMenuStyles extends IContextualMenuStyles {\n  /**\n   * Styles for the items inside the {@link MicrophoneButton} button menu.\n   */\n  menuItemStyles?: IContextualMenuItemStyles;\n}\n/**\n * Props for {@link MicrophoneButton}.\n *\n * @public\n */\n\nexport interface MicrophoneButtonProps extends ControlBarButtonProps {\n  /**\n   * Utility property for using this component with `communication react eventHandlers`.\n   * Maps directly to the `onClick` property.\n   */\n  onToggleMicrophone?: () => Promise<void>;\n  /**\n   * Available microphones for selection\n   */\n\n  microphones?: OptionsDevice[];\n  /**\n   * Available speakers for selection\n   */\n\n  speakers?: OptionsDevice[];\n  /**\n   * Microphone that is shown as currently selected\n   */\n\n  selectedMicrophone?: OptionsDevice;\n  /**\n   * Speaker that is shown as currently selected\n   */\n\n  selectedSpeaker?: OptionsDevice;\n  /**\n   * Callback when a microphone is selected\n   */\n\n  onSelectMicrophone?: (device: OptionsDevice) => Promise<void>;\n  /**\n   * Speaker when a speaker is selected\n   */\n\n  onSelectSpeaker?: (device: OptionsDevice) => Promise<void>;\n  /**\n   * Whether to use a {@link SplitButton} with a {@link IContextualMenu} for device selection.\n   *\n   * default: false\n   */\n\n  enableDeviceSelectionMenu?: boolean;\n  /**\n   * Optional strings to override in component\n   */\n\n  strings?: Partial<MicrophoneButtonStrings>;\n  /**\n   * Styles for {@link MicrophoneButton} and the device selection flyout.\n   */\n\n  styles?: Partial<MicrophoneButtonStyles>;\n}\n/**\n * A button to turn microphone on / off.\n *\n * Can be used with {@link ControlBar}.\n *\n * @public\n */\n\nexport const MicrophoneButton = (props: MicrophoneButtonProps): JSX.Element => {\n  const {\n    onToggleMicrophone\n  } = props;\n  const localeStrings = useLocale().strings.microphoneButton;\n  const strings = { ...localeStrings,\n    ...props.strings\n  };\n  const [announcerString, setAnnouncerString] = useState<string | undefined>(undefined);\n  const isSplit = props.split ?? props.enableDeviceSelectionMenu; // The button should be disabled when there are no mics. However if the button is a split button, if there are\n  // no mics but there are speakers, then only the primary part of the button should be disabled to allow for\n  // speaker change.\n\n  const primaryDisabled = props.primaryDisabled || (isSplit && !props.microphones?.length ? true : undefined);\n  const disabled = props.disabled || isSplit && !props.microphones?.length && !props.speakers?.length || !isSplit && props.microphones && props.microphones?.length === 0;\n\n  const onRenderMicOnIcon = (): JSX.Element => {\n    return <_HighContrastAwareIcon disabled={disabled} iconName=\"ControlButtonMicOn\" />;\n  };\n\n  const onRenderMicOffIcon = (): JSX.Element => {\n    return <_HighContrastAwareIcon disabled={disabled} iconName=\"ControlButtonMicOff\" />;\n  };\n\n  const isMicOn = props.checked;\n  const splitButtonAriaString = isMicOn ? strings.onSplitButtonAriaLabel : strings.offSplitButtonAriaLabel;\n  const toggleAnnouncerString = useCallback((isMicOn: boolean) => {\n    setAnnouncerString(!isMicOn ? strings.microphoneActionTurnedOffAnnouncement : strings.microphoneActionTurnedOnAnnouncement);\n  }, [strings.microphoneActionTurnedOffAnnouncement, strings.microphoneActionTurnedOnAnnouncement]);\n  const onToggleClick = useCallback(async () => {\n    if (onToggleMicrophone) {\n      try {\n        await onToggleMicrophone(); // allows for the setting of narrator strings triggering the announcer when microphone is turned on or off.\n\n        toggleAnnouncerString(!isMicOn); // eslint-disable-next-line no-empty\n      } finally {}\n    }\n  }, [isMicOn, onToggleMicrophone, toggleAnnouncerString]);\n  return <>\n      <Announcer announcementString={announcerString} ariaLive={'polite'} />\n      <ControlBarButton {...props} onClick={props.onToggleMicrophone ? onToggleClick : props.onClick} onRenderOnIcon={props.onRenderOnIcon ?? onRenderMicOnIcon} onRenderOffIcon={props.onRenderOffIcon ?? onRenderMicOffIcon} strings={strings} labelKey={props.labelKey ?? 'microphoneButtonLabel'} menuProps={props.menuProps ?? (props.enableDeviceSelectionMenu ? generateDefaultDeviceMenuProps({ ...props,\n      styles: props.styles?.menuStyles\n    }, strings) : undefined)} menuIconProps={props.menuIconProps ?? !props.enableDeviceSelectionMenu ? {\n      hidden: true\n    } : undefined} split={props.split ?? props.enableDeviceSelectionMenu} aria-roledescription={props.enableDeviceSelectionMenu ? strings.microphoneButtonSplitRoleDescription : undefined} splitButtonAriaLabel={props.enableDeviceSelectionMenu ? splitButtonAriaString : undefined} disabled={disabled} primaryDisabled={primaryDisabled} />\n    </>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ContextualMenuItemType, IContextualMenuItem, IContextualMenuProps, IContextualMenuStyles, IContextualMenuItemStyles, merge } from '@fluentui/react';\nimport { _formatString } from '@internal/acs-ui-common';\nimport copy from 'copy-to-clipboard';\nimport React, { useCallback, useMemo } from 'react';\nimport { ParticipantList, ParticipantListProps, ParticipantListStyles, ParticipantMenuItemsCallback } from './ParticipantList';\nimport { participantsButtonMenuPropsStyle } from './styles/ControlBar.styles';\nimport { useLocale } from '../localization';\nimport { ControlBarButton, ControlBarButtonProps, ControlBarButtonStyles } from './ControlBarButton';\nimport { useIdentifiers } from '../identifiers';\nimport { CommunicationParticipant } from '../types/CommunicationParticipant';\nimport { OnRenderAvatarCallback } from '../types/OnRender';\nimport { ParticipantListParticipant } from '../types';\nimport { _HighContrastAwareIcon } from './HighContrastAwareIcon';\nimport { _preventDismissOnEvent as preventDismissOnEvent } from '@internal/acs-ui-common';\n\n/**\n * Styles for the {@link ParticipantsButton} menu.\n *\n * @public\n */\nexport interface ParticipantsButtonContextualMenuStyles extends IContextualMenuStyles {\n  /** Styles for the {@link ParticipantsButton} menu items. */\n  menuItemStyles?: IContextualMenuItemStyles;\n  /** Styles for the {@link ParticipantList} menu item inside the {@link ParticipantsButton} menu. */\n\n  participantListStyles?: ParticipantListStyles;\n}\n/**\n * Styles Props for {@link ParticipantsButton}.\n *\n * @public\n */\n\nexport interface ParticipantsButtonStyles extends ControlBarButtonStyles {\n  /** Styles of the {@link ParticipantsButton} menu flyout */\n  menuStyles?: Partial<ParticipantsButtonContextualMenuStyles>;\n}\n/**\n * Strings of {@link ParticipantsButton} that can be overridden.\n *\n * @public\n */\n\nexport interface ParticipantsButtonStrings {\n  /**\n   * Label of button\n   */\n  label: string;\n  /**\n   * Button tooltip content.\n   */\n\n  tooltipContent?: string;\n  /**\n   * Header of menu pop up\n   */\n\n  menuHeader: string;\n  /**\n   * Label of menu button to show list of participants. Placeholders: [numParticipants]\n   */\n\n  participantsListButtonLabel: string;\n  /**\n   * Label of menu button to copy invite link\n   */\n\n  copyInviteLinkButtonLabel: string;\n  /**\n   * Label of menu button to mute all participants\n   */\n\n  muteAllButtonLabel: string;\n}\n/**\n * Props for {@link ParticipantsButton}.\n *\n * @public\n */\n\nexport interface ParticipantsButtonProps extends ControlBarButtonProps {\n  /**\n   * Participants in user call or chat\n   */\n  participants: ParticipantListParticipant[];\n  /**\n   * User ID of user\n   */\n\n  myUserId?: string;\n  /**\n   * If set to `true`, excludes the local participant from the participant list with use of `myUserId` props (required in this case).\n   *\n   * @defaultValue `false`\n   */\n\n  excludeMe?: boolean;\n  /**\n   * Callback to render each participant. If no callback is provided, each participant will be rendered with `ParticipantItem`\n   */\n\n  onRenderParticipant?: (participant: CommunicationParticipant) => JSX.Element | null;\n  /**\n   * Callback to render the avatar for each participant. This property will have no effect if `onRenderParticipant` is assigned.\n   */\n\n  onRenderAvatar?: OnRenderAvatarCallback;\n  /**\n   * Callback to render the context menu for each participant\n   */\n\n  onRemoveParticipant?: (userId: string) => void;\n  /**\n   * Callback to render custom menu items for each participant.\n   */\n\n  onFetchParticipantMenuItems?: ParticipantMenuItemsCallback;\n  /**\n   * Optional callback to render a custom participant list.\n   */\n\n  onRenderParticipantList?: (props: ParticipantListProps) => JSX.Element | null;\n  /**\n   * Allows users to pass an object containing custom CSS styles.\n   * @Example\n   * ```\n   * <ParticipantsButton styles={{ root: { background: 'blue' } }} />\n   * ```\n   */\n\n  styles?: ParticipantsButtonStyles;\n  /**\n   * URL to invite new participants to the current call\n   */\n\n  callInvitationURL?: string;\n  /**\n   * CallBack to mute all remote participants\n   */\n\n  onMuteAll?: () => void;\n  /**\n   * Optional strings to override in component\n   */\n\n  strings?: Partial<ParticipantsButtonStrings>;\n  /** prop to determine if we should show tooltip for participants or not */\n\n  showParticipantOverflowTooltip?: boolean;\n}\n/**\n * A button to show a menu with calling or chat participants.\n *\n * Can be used with {@link ControlBar}.\n *\n * This button contains dropdown menu items defined through its property `menuProps`. By default, it can display the number of remote participants with the full list\n * as sub-menu and an option to mute all participants, as well as a copy-to-clipboard button to copy the call invitation URL.\n * This `menuProps` can be fully redefined and its property is of type [IContextualMenuProps](https://developer.microsoft.com/fluentui#/controls/web/contextualmenu#IContextualMenuProps).\n *\n * @public\n */\n\nexport const ParticipantsButton = (props: ParticipantsButtonProps): JSX.Element => {\n  const {\n    callInvitationURL,\n    styles,\n    onMuteAll,\n    onRenderIcon,\n    onRenderParticipantList,\n    participants,\n    myUserId,\n    excludeMe,\n    onRenderParticipant,\n    onRenderAvatar,\n    onRemoveParticipant,\n    onFetchParticipantMenuItems,\n    showParticipantOverflowTooltip\n  } = props;\n  const disabled = props.disabled;\n\n  const onRenderPeopleIcon = (): JSX.Element => <_HighContrastAwareIcon disabled={disabled} iconName=\"ControlButtonParticipants\" />;\n\n  const ids = useIdentifiers();\n  const onMuteAllCallback = useCallback(() => {\n    if (onMuteAll) {\n      onMuteAll();\n    }\n  }, [onMuteAll]);\n  const defaultParticipantList = useCallback(() => {\n    return <ParticipantList participants={participants} myUserId={myUserId} excludeMe={excludeMe} onRenderParticipant={onRenderParticipant} onRenderAvatar={onRenderAvatar} onRemoveParticipant={onRemoveParticipant} onFetchParticipantMenuItems={onFetchParticipantMenuItems} styles={styles?.menuStyles?.participantListStyles} showParticipantOverflowTooltip={showParticipantOverflowTooltip} />;\n  }, [excludeMe, myUserId, onRemoveParticipant, onRenderAvatar, onRenderParticipant, participants, styles?.menuStyles?.participantListStyles, onFetchParticipantMenuItems, showParticipantOverflowTooltip]);\n  const onCopyCallback = useCallback(() => {\n    if (callInvitationURL) {\n      return copy(callInvitationURL);\n    }\n\n    return false;\n  }, [callInvitationURL]);\n  const localeStrings = useLocale().strings.participantsButton;\n  const strings = useMemo(() => ({ ...localeStrings,\n    ...props.strings\n  }), [localeStrings, props.strings]);\n  const participantCount = participants.length;\n  const generateDefaultParticipantsSubMenuProps = useCallback((): IContextualMenuItem[] => {\n    const items: IContextualMenuItem[] = [];\n\n    if (participantCount > 0) {\n      items.push({\n        key: 'participantListMenuItemKey',\n        onRender: onRenderParticipantList ?? defaultParticipantList\n      });\n      items.push({\n        key: 'participantsDivider1',\n        itemType: ContextualMenuItemType.Divider\n      });\n\n      if (onMuteAll) {\n        items.push({\n          key: 'muteAllKey',\n          text: strings.muteAllButtonLabel,\n          title: strings.muteAllButtonLabel,\n          styles: styles?.menuStyles?.menuItemStyles,\n          iconProps: {\n            iconName: 'MicOff2'\n          },\n          onClick: onMuteAllCallback\n        });\n      }\n    }\n\n    return items;\n  }, [participantCount, onRenderParticipantList, defaultParticipantList, onMuteAll, strings.muteAllButtonLabel, styles?.menuStyles?.menuItemStyles, onMuteAllCallback]);\n  const defaultMenuProps = useMemo((): IContextualMenuProps => {\n    const menuProps: IContextualMenuProps = {\n      title: strings.menuHeader,\n      styles: merge(participantsButtonMenuPropsStyle, styles?.menuStyles),\n      items: [],\n      calloutProps: {\n        preventDismissOnEvent\n      }\n    };\n\n    if (participantCount > 0) {\n      const participantIds = participants.map(p => p.userId);\n      let participantCountWithoutMe = participantIds.length;\n\n      if (excludeMe) {\n        participantCountWithoutMe -= 1;\n      }\n\n      menuProps.items.push({\n        key: 'participantCountKey',\n        name: _formatString(strings.participantsListButtonLabel, {\n          numParticipants: `${participantCountWithoutMe}`\n        }),\n        itemProps: {\n          styles: styles?.menuStyles?.menuItemStyles\n        },\n        iconProps: {\n          iconName: 'People'\n        },\n        subMenuProps: {\n          items: generateDefaultParticipantsSubMenuProps(),\n          calloutProps: {\n            styles: {\n              root: {\n                // Confine the menu to the parents bounds.\n                // More info: https://github.com/microsoft/fluentui/issues/18835\n                maxWidth: '100%'\n              }\n            },\n            style: {\n              maxHeight: '20rem'\n            },\n            // Disable dismiss on resize to work around a couple Fluent UI bugs\n            // See reasoning in the props for the parent menu.\n            preventDismissOnEvent\n          }\n        },\n        'data-ui-id': ids.participantButtonPeopleMenuItem\n      });\n    }\n\n    if (callInvitationURL) {\n      menuProps.items.push({\n        key: 'InviteLinkKey',\n        name: strings.copyInviteLinkButtonLabel,\n        title: strings.copyInviteLinkButtonLabel,\n        itemProps: {\n          styles: styles?.menuStyles?.menuItemStyles\n        },\n        iconProps: {\n          iconName: 'Link'\n        },\n        onClick: onCopyCallback\n      });\n    }\n\n    return menuProps;\n  }, [strings.menuHeader, strings.participantsListButtonLabel, strings.copyInviteLinkButtonLabel, styles?.menuStyles, participantCount, callInvitationURL, participants, excludeMe, ids.participantButtonPeopleMenuItem, generateDefaultParticipantsSubMenuProps, onCopyCallback]);\n  return <ControlBarButton {...props} disabled={disabled} menuProps={props.menuProps ?? defaultMenuProps} menuIconProps={{\n    hidden: true\n  }} onRenderIcon={onRenderIcon ?? onRenderPeopleIcon} strings={strings} labelKey={props.labelKey ?? 'participantsButtonLabel'} />;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React from 'react';\nimport { useLocale } from '../localization';\nimport { ControlBarButton, ControlBarButtonProps } from './ControlBarButton';\nimport { DefaultPalette, IButtonStyles, mergeStyles, Theme, useTheme } from '@fluentui/react';\nimport { _HighContrastAwareIcon } from './HighContrastAwareIcon';\n/**\n * Strings of {@link ScreenShareButton} that can be overridden.\n *\n * @public\n */\n\nexport interface ScreenShareButtonStrings {\n  /** Label when button is on. */\n  onLabel: string;\n  /** Label when button is off. */\n\n  offLabel: string;\n  /** * Tooltip content when the button is disabled. */\n\n  tooltipDisabledContent?: string;\n  /** Tooltip content when the button is on. */\n\n  tooltipOnContent?: string;\n  /** Tooltip content when the button is off. */\n\n  tooltipOffContent?: string;\n}\n/**\n * Props for {@link ScreenShareButton}.\n *\n * @public\n */\n\nexport interface ScreenShareButtonProps extends ControlBarButtonProps {\n  /**\n   * Utility property for using this component with `communication react eventHandlers`.\n   * Maps directly to the `onClick` property.\n   */\n  onToggleScreenShare?: () => Promise<void>;\n  /**\n   * Optional strings to override in component\n   */\n\n  strings?: Partial<ScreenShareButtonStrings>;\n}\n/**\n * A button to start / stop screen sharing.\n *\n * Can be used with {@link ControlBar}.\n *\n * @public\n */\n\nexport const ScreenShareButton = (props: ScreenShareButtonProps): JSX.Element => {\n  const localeStrings = useLocale().strings.screenShareButton;\n  const strings = { ...localeStrings,\n    ...props.strings\n  };\n  const theme = useTheme();\n  const styles = screenshareButtonStyles(theme);\n\n  const onRenderScreenShareOnIcon = (): JSX.Element => <_HighContrastAwareIcon disabled={props.disabled} iconName=\"ControlButtonScreenShareStop\" />;\n\n  const onRenderScreenShareOffIcon = (): JSX.Element => <_HighContrastAwareIcon disabled={props.disabled} iconName=\"ControlButtonScreenShareStart\" />;\n\n  return <ControlBarButton {...props} className={mergeStyles(styles, props.styles)} onClick={props.onToggleScreenShare ?? props.onClick} onRenderOnIcon={props.onRenderOnIcon ?? onRenderScreenShareOnIcon} onRenderOffIcon={props.onRenderOffIcon ?? onRenderScreenShareOffIcon} strings={strings} labelKey={props.labelKey ?? 'screenShareButtonLabel'} disabled={props.disabled} />;\n};\n\nconst screenshareButtonStyles = (theme: Theme): IButtonStyles => ({\n  rootChecked: {\n    background: theme.palette.themePrimary,\n    color: DefaultPalette.white,\n    ':focus::after': {\n      outlineColor: `${DefaultPalette.white} !important`\n    } // added !important to avoid override by FluentUI button styles\n\n  },\n  rootCheckedHovered: {\n    background: theme.palette.themePrimary,\n    color: DefaultPalette.white,\n    ':focus::after': {\n      outlineColor: `${DefaultPalette.white} !important`\n    } // added !important to avoid override by FluentUI button styles\n\n  },\n  labelChecked: {\n    color: DefaultPalette.white\n  }\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/**\n * For keyboard navigation - when this component has active focus, enter key and space keys should have the same behavior as mouse click.\n *\n * @private\n */\nexport const submitWithKeyboard = (e: React.KeyboardEvent<HTMLElement>, onSubmit: (e?: React.MouseEvent<HTMLElement> | React.KeyboardEvent<HTMLElement>) => void): void => {\n  if (e.key === 'Enter' || e.key === ' ') {\n    onSubmit(e);\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStackStyles, memoizeFunction, Stack } from '@fluentui/react';\nimport React, { ReactElement, PropsWithChildren } from 'react';\nimport { useTheme } from '../../theming/FluentThemeProvider';\n/** @internal */\n\nexport type _TileOrientation = 'portrait' | 'landscape';\n/** @internal */\n\nexport type _PictureInPictureInPictureTileProps = PropsWithChildren<{\n  orientation: _TileOrientation;\n}>;\n/** @private */\n\nexport const PictureInPictureInPicturePrimaryTile = (props: _PictureInPictureInPictureTileProps): ReactElement => {\n  const boxShadow = useTheme().effects.elevation8;\n  return <PictureInPictureInPictureTile styles={primaryTileStyles(props.orientation, boxShadow)}>\n      {props.children}\n    </PictureInPictureInPictureTile>;\n};\n/** @private */\n\nexport const PictureInPictureInPictureSecondaryTile = (props: _PictureInPictureInPictureTileProps): ReactElement => <PictureInPictureInPictureTile styles={secondaryTileStyles(props.orientation)}>\n    {props.children}\n  </PictureInPictureInPictureTile>;\n\nconst PictureInPictureInPictureTile = (props: PropsWithChildren<{\n  styles: IStackStyles;\n}>): ReactElement => <Stack styles={props.styles}>{props.children}</Stack>;\n\nconst primaryTileStyles = memoizeFunction((orientation: _TileOrientation, themeElevation: string): IStackStyles => ({\n  root: {\n    borderRadius: '0.25rem',\n    height: orientation === 'landscape' ? '5.5rem' : '8rem',\n    width: orientation === 'landscape' ? '8rem' : '5.5rem',\n    boxShadow: themeElevation,\n    // PiPiP tiles were not designed to host scrollable content. If removed check no scrollbar is showing in e2e tests\n    overflow: 'hidden'\n  }\n}));\nconst secondaryTileStyles = memoizeFunction((orientation: _TileOrientation): IStackStyles => ({\n  root: {\n    borderRadius: '0.25rem',\n    height: orientation === 'landscape' ? '1.625rem' : '2rem',\n    width: orientation === 'landscape' ? '2rem' : '1.625rem',\n    // PiPiP tiles were not designed to host scrollable content. If removed check no scrollbar is showing in e2e tests\n    overflow: 'hidden'\n  }\n}));","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { ReactChild } from 'react';\nimport { submitWithKeyboard } from '../utils/keyboardNavigation';\nimport { PictureInPictureInPicturePrimaryTile, PictureInPictureInPictureSecondaryTile, _PictureInPictureInPictureTileProps } from './PictureInPictureInPictureTile';\n/**\n * Strings of {@link _PictureInPictureInPicture} that can be overridden.\n *\n * @internal\n */\n\nexport interface _PictureInPictureInPictureStrings {\n  /** Aria-label for the focusable root of the PictureInPictureInPicture component. */\n  rootAriaLabel: string;\n}\n/**\n * Props for {@link _PictureInPictureInPicture} component.\n *\n * @internal\n */\n\nexport interface _PictureInPictureInPictureProps {\n  /**\n   * Callback when the {@link _PictureInPictureInPicture} is clicked.\n   */\n  onClick?: () => void;\n  primaryTile: _PictureInPictureInPictureTileProps;\n  secondaryTile?: _PictureInPictureInPictureTileProps;\n  strings: _PictureInPictureInPictureStrings;\n}\n/**\n * Component that displays a video feed for use as a Picture-in-Picture style component.\n * It contains a secondary video feed resulting in an inner Picture-in-Picture style feed.\n *\n * @remarks\n * The double nature of the Picture-in-Picture styles is where this component gets its name; Picture-in-Picture-in-Picture.\n *\n * @internal\n */\n\nexport const _PictureInPictureInPicture = (props: _PictureInPictureInPictureProps): JSX.Element => {\n  return <PictureInPictureInPictureContainer onClick={props.onClick} primaryView={<PictureInPictureInPicturePrimaryTile {...props.primaryTile} />} secondaryView={props.secondaryTile && <PictureInPictureInPictureSecondaryTile {...props.secondaryTile} />} ariaLabel={props.strings.rootAriaLabel} />;\n};\n/**\n * Container for the picture in picture in picture component.\n * This governs positioning and floating of the secondary PiP.\n */\n\nconst PictureInPictureInPictureContainer = (props: {\n  primaryView: ReactChild;\n  secondaryView?: ReactChild;\n  onClick?: () => void;\n  ariaLabel: string;\n}): JSX.Element => {\n  const onKeyPress = (e: React.KeyboardEvent<HTMLElement>): void => props.onClick && submitWithKeyboard(e, props.onClick);\n\n  return <aside style={tileContainerStyles} onClick={props.onClick} onKeyPress={onKeyPress} aria-label={props.ariaLabel} tabIndex={props.onClick ? 0 : -1} // Only allow focus to be set if there is a click handler\n  data-ui-id=\"picture-in-picture-in-picture-root\">\n      {props.primaryView}\n      <div style={secondaryTileFloatingStyles}>{props.secondaryView}</div>\n    </aside>;\n};\n\nconst tileContainerStyles: React.CSSProperties = {\n  display: 'flex',\n  width: 'min-content',\n  position: 'relative',\n  cursor: 'pointer'\n};\nconst secondaryTileFloatingStyles: React.CSSProperties = {\n  // The secondary tile should float above the primary tile, aligned to the bottom right.\n  position: 'absolute',\n  bottom: '0.125rem',\n  right: '0.125rem'\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { FontIcon, IFontIconProps, IIconProps, IRawStyle, IStackStyles, IStyle, mergeStyles, Stack, Text } from '@fluentui/react';\nimport React from 'react';\nimport { useTheme } from '../../theming/FluentThemeProvider';\nimport { BaseCustomStyles } from '../../types';\nimport { submitWithKeyboard } from '../utils/keyboardNavigation';\n/**\n * Props for the DrawerMenuItem\n *\n * @internal\n */\n\nexport interface _DrawerMenuItemProps {\n  onItemClick?: (ev?: React.MouseEvent<HTMLElement> | React.KeyboardEvent<HTMLElement>, itemKey?: string) => void;\n  itemKey: string;\n  /** Text that shows at the start of the menu item after any icon supplied */\n\n  text?: string;\n  /** Text that shows at the end of the menu item before any secondaryIcon is supplied */\n\n  secondaryText?: string;\n  /** Icon shown at the start of the menu item (before the menu item text) */\n\n  iconProps?: IIconProps;\n  /**\n   * Icon shown at the end of the menu item.\n   * By default if this component has subMenuProps, this icon is the RightChevron.\n   */\n\n  secondaryIconProps?: IIconProps;\n  styles?: BaseCustomStyles;\n  subMenuProps?: _DrawerMenuItemProps[];\n  /**\n   * Whether the menu item is disabled\n   * @defaultvalue false\n   */\n\n  disabled?: boolean;\n  /**\n   * A unique id set for the standard HTML id attibute\n   */\n\n  id?: string;\n}\n/**\n * Maps the individual item in menuProps.items passed in the {@link DrawerMenu} into a UI component.\n *\n * @private\n */\n\nexport const DrawerMenuItem = (props: _DrawerMenuItemProps): JSX.Element => {\n  const theme = useTheme();\n\n  const onClick = (ev?: React.MouseEvent<HTMLElement> | React.KeyboardEvent<HTMLElement>): void => props.onItemClick && props.onItemClick(ev, props.itemKey);\n\n  const onKeyPress = (ev: React.KeyboardEvent<HTMLElement>): void => onClick && submitWithKeyboard(ev, onClick);\n\n  const secondaryIcon = props.secondaryIconProps ? <MenuItemIcon {...props.secondaryIconProps} /> : props.subMenuProps ? <MenuItemIcon iconName=\"ChevronRight\" /> : undefined;\n  return <Stack tabIndex={0} role=\"menuitem\" horizontal className={mergeStyles(drawerMenuItemRootStyles(theme.palette.neutralLight, theme.fonts.small), props.disabled ? disabledDrawerMenuItemRootStyles(theme.palette.neutralQuaternaryAlt) : undefined, props.styles?.root)} onKeyPress={props.disabled ? undefined : onKeyPress} onClick={props.disabled ? undefined : onClick} tokens={menuItemChildrenGap} id={props.id}>\n      {props.iconProps && <Stack.Item role=\"presentation\" styles={props.disabled ? {\n      root: {\n        color: theme.palette.neutralTertiaryAlt\n      }\n    } : undefined}>\n          <MenuItemIcon {...props.iconProps} />\n        </Stack.Item>}\n      <Stack.Item styles={drawerMenuItemTextStyles} grow>\n        <Text styles={props.disabled ? {\n        root: {\n          color: theme.palette.neutralTertiaryAlt\n        }\n      } : undefined}>\n          {props.text}\n        </Text>\n      </Stack.Item>\n      {props.secondaryText && <Stack.Item styles={drawerMenuItemTextStyles} className={mergeStyles(secondaryTextStyles)}>\n          <Text styles={{\n        root: {\n          color: props.disabled ? theme.palette.neutralTertiaryAlt : theme.palette.neutralSecondary\n        }\n      }}>\n            {props.secondaryText}\n          </Text>\n        </Stack.Item>}\n      {secondaryIcon && <Stack.Item>{secondaryIcon}</Stack.Item>}\n    </Stack>;\n};\n\nconst MenuItemIcon = (props: IFontIconProps): JSX.Element => <FontIcon className={mergeStyles(iconStyles)} {...props} />;\n\nconst menuItemChildrenGap = {\n  childrenGap: '0.5rem'\n};\n\nconst drawerMenuItemRootStyles = (hoverBackground: string, fontSize: IRawStyle): IStyle => ({ ...fontSize,\n  height: '3rem',\n  lineHeight: '3rem',\n  padding: '0rem 0.75rem',\n  cursor: 'pointer',\n  ':hover, :focus': {\n    background: hoverBackground\n  }\n});\n\nconst disabledDrawerMenuItemRootStyles = (background: string): IStyle => ({\n  pointerEvents: 'none',\n  background: background,\n  ':hover, :focus': {\n    background: background\n  }\n});\n/** Ensure long text entries appropriately show ellipsis instead of wrapping to a new line or showing a scrollbar */\n\n\nconst drawerMenuItemTextStyles: IStackStyles = {\n  root: {\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap'\n  }\n};\nconst iconStyles: IStyle = {\n  // Vertically center icons in the menu item. Using line-height does not work for centering fluent SVG icons.\n  display: 'flex',\n  alignItems: 'center',\n  height: '100%',\n  // This can be removed when we upgrade to fluent-react-icons v2 (that removes the inner span element)\n  ' span': {\n    display: 'flex',\n    alignItems: 'center',\n    height: '100%'\n  }\n};\nconst secondaryTextStyles: IStyle = {\n  // limit width for secondaryText in the menu item so it does not overlap with text on left.\n  maxWidth: '50%'\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { AnimationStyles, IStyle, mergeStyles, Stack, useTheme } from '@fluentui/react';\nimport React from 'react';\nimport { BaseCustomStyles } from '../../types';\n/**\n * Container that holds the content of the drawer\n *\n * @private\n */\n\nexport const DrawerContentContainer = (props: {\n  children: React.ReactNode;\n  styles?: BaseCustomStyles;\n}): JSX.Element => {\n  const theme = useTheme();\n  const backgroundColor = theme.palette.white;\n  const borderRadius = theme.effects.roundedCorner4;\n  const rootStyles = mergeStyles(containerStyles(backgroundColor, borderRadius), props.styles?.root);\n  return <Stack className={rootStyles}>{props.children}</Stack>;\n};\n\nconst containerStyles = (backgroundColor: string, borderRadius: string): IStyle => ({\n  background: backgroundColor,\n  borderTopRightRadius: borderRadius,\n  borderTopLeftRadius: borderRadius,\n  ...AnimationStyles.slideUpIn10\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStackStyles, mergeStyles, Stack } from '@fluentui/react';\nimport React from 'react';\nimport { BaseCustomStyles } from '../../types';\n/**\n * An element that fills the space the DrawerContentContainer does not take up.\n * This is the element that enables the light dismiss feature.\n *\n * @private\n */\n\nexport const DrawerLightDismiss = (props: {\n  onDismiss: () => void;\n  styles?: BaseCustomStyles;\n}): JSX.Element => {\n  return <Stack className={mergeStyles(lightDismissContainerStyles, props.styles)} grow onClick={() => props.onDismiss()} />;\n};\nconst lightDismissContainerStyles: IStackStyles = {\n  root: {\n    height: '100%'\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { FocusTrapZone, IStyle, mergeStyles, Stack } from '@fluentui/react';\nimport React from 'react';\nimport { BaseCustomStyles } from '../../types';\nimport { DrawerContentContainer } from './DrawerContentContainer';\nimport { DrawerLightDismiss } from './DrawerLightDismiss';\n/**\n * Styles for the {@link _DrawerSurface}.\n *\n * @internal\n */\n\nexport interface _DrawerSurfaceStyles extends BaseCustomStyles {\n  /** Styles for the root of the container of the {@link DrawerSurface} content. */\n  drawerContentRoot?: BaseCustomStyles;\n  /** Styles for the container of the {@link DrawerSurface} content. */\n\n  drawerContentContainer?: BaseCustomStyles;\n  /** Styles for the light dismiss element of the {@link DrawerSurface}. */\n\n  lightDismissRoot?: BaseCustomStyles;\n}\n/**\n * Props for {@link DrawerSurface} component.\n *\n * @internal\n */\n\nexport interface _DrawerSurfaceProps {\n  /** Content of the Drawer */\n  children: React.ReactNode;\n  /**\n   * Callback when the drawer's light-dismissal is triggered.\n   */\n\n  onLightDismiss: () => void;\n  /** Styles for the {@link DrawerSurface} */\n\n  styles?: _DrawerSurfaceStyles;\n}\n/**\n * A `Drawer` can be used to reveal lightweight views inside your application.\n * They appear from the bottom of the screen upwards and are light-dismissed.\n *\n * @internal\n */\n\nexport const _DrawerSurface = (props: _DrawerSurfaceProps): JSX.Element => {\n  const rootStyles = mergeStyles(drawerSurfaceStyles, props.styles?.root);\n  return <Stack className={rootStyles}>\n      <DrawerLightDismiss styles={props.styles?.lightDismissRoot} onDismiss={props.onLightDismiss} />\n      <FocusTrapZone onKeyDown={e => {\n      if (e.key === 'Escape' || e.key === 'Esc') {\n        props.onLightDismiss && props.onLightDismiss();\n      }\n    }} // Ensure when the focus trap has focus, the light dismiss area can still be clicked with mouse to dismiss.\n    // Note: this still correctly captures keyboard focus, this just allows mouse click outside of the focus trap.\n    isClickableOutsideFocusTrap={true}>\n        <DrawerContentContainer styles={props.styles?.drawerContentContainer}>{props.children}</DrawerContentContainer>\n      </FocusTrapZone>\n    </Stack>;\n};\nconst drawerSurfaceStyles: IStyle = {\n  width: '100%',\n  height: '100%',\n  background: 'rgba(0,0,0,0.4)'\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { merge, Stack } from '@fluentui/react';\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { _DrawerSurfaceProps } from '.';\nimport { useTheme } from '../../theming/FluentThemeProvider';\nimport { BaseCustomStyles } from '../../types';\nimport { DrawerMenuItem, _DrawerMenuItemProps } from './DrawerMenuItem';\nimport { _DrawerSurface, _DrawerSurfaceStyles } from './DrawerSurface';\n/**\n * Styles for the {@link _DrawerMenu}.\n *\n * @internal\n */\n\nexport interface _DrawerMenuStyles extends BaseCustomStyles {\n  /** Styles for the {@link DrawerSurface} container. */\n  drawerSurfaceStyles?: _DrawerSurfaceStyles;\n}\n/**\n * Props for the {@link _DrawerMenu}\n *\n * @internal\n */\n\nexport interface _DrawerMenuProps {\n  items: _DrawerMenuItemProps[];\n  /**\n   * Callback when the drawer's light-dismissal is triggered.\n   */\n\n  onLightDismiss: () => void;\n  styles?: _DrawerMenuStyles;\n}\n/**\n * Takes a set of menu items and returns a created menu inside a {@link _DrawerSurface}.\n *\n * @internal\n */\n\nexport const _DrawerMenu = (props: _DrawerMenuProps): JSX.Element => {\n  // This component breaks from a pure component pattern in order to internally support sub menus.\n  // When a sub menu item is clicked the menu items displayed is updated to be that of the submenu.\n  // To track this state we store a list of the keys clicked up until this point.\n  const [selectedKeyPath, setSelectedKeyPath] = useState<string[]>([]); // Get the menu items that should be rendered\n\n  const menuItemsToRender = useMemo(() => {\n    let items: _DrawerMenuItemProps[] | undefined = props.items;\n\n    for (const subMenuKey of selectedKeyPath) {\n      items = items?.find(item => item.itemKey === subMenuKey)?.subMenuProps;\n    }\n\n    return items;\n  }, [props.items, selectedKeyPath]); // When an item is clicked and it contains a submenu, push the key for the submenu. This will ensure\n  // a new render is triggered, menuItemsToRender will be re-calculated and the submenu will render.\n\n  const onItemClick = useCallback((item: _DrawerMenuItemProps, ev?: React.MouseEvent<HTMLElement, MouseEvent> | React.KeyboardEvent<HTMLElement> | undefined, itemKey?: string | undefined): void => {\n    if (item.subMenuProps) {\n      setSelectedKeyPath([...selectedKeyPath, item.itemKey]);\n    }\n\n    item.onItemClick?.(ev, itemKey);\n  }, [selectedKeyPath]); // Ensure the first item has a border radius that matches the DrawerSurface\n\n  const borderRadius = useTheme().effects.roundedCorner4;\n  const firstItemStyle = menuItemsToRender && menuItemsToRender[0]?.styles;\n  const modifiedFirstItemStyle = useMemo(() => merge(firstItemStyle ?? {}, {\n    root: {\n      borderTopRightRadius: borderRadius,\n      borderTopLeftRadius: borderRadius\n    }\n  }), [firstItemStyle, borderRadius]);\n  return <_DrawerSurface styles={props.styles?.drawerSurfaceStyles} onLightDismiss={props.onLightDismiss}>\n      <Stack styles={props.styles} role=\"menu\" data-ui-id=\"drawer-menu\">\n        {menuItemsToRender?.slice(0, 1).map(item => <DrawerMenuItem {...item} key={'0'} styles={modifiedFirstItemStyle} onItemClick={(ev, itemKey) => {\n        onItemClick(item, ev, itemKey);\n      }} />)}\n        {menuItemsToRender?.slice(1).map((item, i) => <DrawerMenuItem {...item} key={`${i + 1}`} onItemClick={(ev, itemKey) => {\n        onItemClick(item, ev, itemKey);\n      }} />)}\n      </Stack>\n    </_DrawerSurface>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/**\n * @private\n */\nexport type ComplianceState = 'on' | 'off' | 'stopped';\n/**\n * Return different conditions based on the current and previous state of recording and transcribing\n *\n * @param callRecordState - The current call record state: on, off, stopped\n * @param callTranscribeState - The current call transcribe state: on, off, stopped\n *\n * @remarks - The stopped state means: previously on but currently off\n *\n * @private\n */\n\nexport const computeVariant = (callRecordState: ComplianceState, callTranscribeState: ComplianceState): ComplianceBannerVariant => {\n  if (callRecordState === 'on' && callTranscribeState === 'on') {\n    return 'RECORDING_AND_TRANSCRIPTION_STARTED';\n  } else if (callRecordState === 'on' && callTranscribeState === 'off') {\n    return 'RECORDING_STARTED';\n  } else if (callRecordState === 'off' && callTranscribeState === 'on') {\n    return 'TRANSCRIPTION_STARTED';\n  } else if (callRecordState === 'on' && callTranscribeState === 'stopped') {\n    return 'TRANSCRIPTION_STOPPED_STILL_RECORDING';\n  } else if (callRecordState === 'stopped' && callTranscribeState === 'on') {\n    return 'RECORDING_STOPPED_STILL_TRANSCRIBING';\n  } else if (callRecordState === 'off' && callTranscribeState === 'stopped') {\n    return 'TRANSCRIPTION_STOPPED';\n  } else if (callRecordState === 'stopped' && callTranscribeState === 'off') {\n    return 'RECORDING_STOPPED';\n  } else if (callRecordState === 'stopped' && callTranscribeState === 'stopped') {\n    return 'RECORDING_AND_TRANSCRIPTION_STOPPED';\n  } else {\n    return 'NO_STATE';\n  }\n};\n/**\n * @private\n */\n\nexport type ComplianceBannerVariant = 'NO_STATE' | 'TRANSCRIPTION_STOPPED_STILL_RECORDING' | 'RECORDING_STOPPED_STILL_TRANSCRIBING' | 'RECORDING_AND_TRANSCRIPTION_STOPPED' | 'RECORDING_AND_TRANSCRIPTION_STARTED' | 'TRANSCRIPTION_STARTED' | 'RECORDING_STOPPED' | 'RECORDING_STARTED' | 'TRANSCRIPTION_STOPPED';","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Link } from '@fluentui/react';\nimport React from 'react';\nimport { _ComplianceBannerStrings } from './types';\nimport { ComplianceBannerVariant } from './Utils';\n/** @private */\n\nexport function BannerMessage(props: {\n  variant: ComplianceBannerVariant;\n  strings: _ComplianceBannerStrings;\n}): JSX.Element {\n  const {\n    variant,\n    strings\n  } = props;\n\n  switch (variant) {\n    case 'TRANSCRIPTION_STOPPED_STILL_RECORDING':\n      return <>\n          <b>{strings.complianceBannerTranscriptionStopped}</b>\n          {` ${strings.complianceBannerNowOnlyRecording}`}\n          <PrivacyPolicy linkText={strings.privacyPolicy} />\n        </>;\n\n    case 'RECORDING_STOPPED_STILL_TRANSCRIBING':\n      return <>\n          <b>{strings.complianceBannerRecordingStopped}</b>\n          {` ${strings.complianceBannerNowOnlyTranscription}`}\n          <PrivacyPolicy linkText={strings.privacyPolicy} />\n        </>;\n\n    case 'RECORDING_AND_TRANSCRIPTION_STOPPED':\n      return <>\n          <b>{strings.complianceBannerRecordingAndTranscriptionSaved}</b>\n          {` ${strings.complianceBannerRecordingAndTranscriptionStopped}`}\n          <LearnMore linkText={strings.learnMore} />\n        </>;\n\n    case 'RECORDING_AND_TRANSCRIPTION_STARTED':\n      return <>\n          <b>{strings.complianceBannerRecordingAndTranscriptionStarted}</b>\n          {` ${strings.complianceBannerTranscriptionConsent}`}\n          <PrivacyPolicy linkText={strings.privacyPolicy} />\n        </>;\n\n    case 'TRANSCRIPTION_STARTED':\n      return <>\n          <b>{strings.complianceBannerTranscriptionStarted}</b>\n          {` ${strings.complianceBannerTranscriptionConsent}`}\n          <PrivacyPolicy linkText={strings.privacyPolicy} />\n        </>;\n\n    case 'RECORDING_STOPPED':\n      return <>\n          <b>{strings.complianceBannerRecordingSaving}</b>\n          {` ${strings.complianceBannerRecordingStopped}`}\n          <LearnMore linkText={strings.learnMore} />\n        </>;\n\n    case 'RECORDING_STARTED':\n      return <>\n          <b>{strings.complianceBannerRecordingStarted}</b>\n          {` ${strings.complianceBannerTranscriptionConsent}`}\n          <PrivacyPolicy linkText={strings.privacyPolicy} />\n        </>;\n\n    case 'TRANSCRIPTION_STOPPED':\n      return <>\n          <b>{strings.complianceBannerTranscriptionSaving}</b>\n          {` ${strings.complianceBannerTranscriptionStopped}`}\n          <LearnMore linkText={strings.learnMore} />\n        </>;\n  }\n\n  return <></>;\n}\n\nfunction PrivacyPolicy(props: {\n  linkText: string;\n}): JSX.Element {\n  return <Link href=\"https://privacy.microsoft.com/privacystatement#mainnoticetoendusersmodule\" target=\"_blank\" underline>\n      {props.linkText}\n    </Link>;\n}\n\nfunction LearnMore(props: {\n  linkText: string;\n}): JSX.Element {\n  return <Link href=\"https://support.microsoft.com/office/record-a-meeting-in-teams-34dfbe7f-b07d-4a27-b4c6-de62f1348c24\" target=\"_blank\" underline>\n      {props.linkText}\n    </Link>;\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { MessageBar, MessageBarType } from '@fluentui/react';\nimport React, { useRef, useState } from 'react';\nimport { BannerMessage } from './BannerMessage';\nimport { _ComplianceBannerStrings } from './types';\nimport { ComplianceBannerVariant } from './Utils';\nconst BANNER_OVERWRITE_DELAY_MS = 3000;\n/** @private */\n\nexport interface TimestampedVariant {\n  variant: ComplianceBannerVariant; // Milliseconds since epoch (i.e., return value of Date.now()).\n\n  lastUpdated: number;\n}\n/**\n * Shows a {@link BannerMessage} in a {@link MessageBar} tracking `variant` internally.\n *\n * This component delays and combines frequent updates to `variant` such that:\n * - Updates that happen within {@link BANNER_OVERWRITE_DELAY_MS} are delayed.\n * - Once {@link BANNER_OVERWRITE_DELAY_MS} has passed since the last update, the _latest_ pending update is shown.\n *\n * This ensures that there is enough time for the user to see a banner message before it is overwritten.\n * In case of multiple delayed messages, the user always sees the final message as it reflects the final state\n * of recording and transcription.\n *\n * @private\n */\n\nexport function DelayedUpdateBanner(props: {\n  variant: TimestampedVariant;\n  onDismiss: () => void;\n  strings: _ComplianceBannerStrings;\n}): JSX.Element {\n  const {\n    variant,\n    lastUpdated: variantLastUpdated\n  } = props.variant; // Tracks the variant that is currently visible in the UI.\n\n  const [visible, setVisible] = useState<TimestampedVariant>({\n    variant,\n    lastUpdated: Date.now()\n  });\n  const pendingUpdateHandle = useRef<ReturnType<typeof setTimeout> | null>(null);\n\n  if (variant !== visible.variant && variantLastUpdated > visible.lastUpdated) {\n    // Always clear pending updates.\n    // We'll either update now, or schedule an update for later.\n    if (pendingUpdateHandle.current) {\n      clearTimeout(pendingUpdateHandle.current);\n    }\n\n    const now = Date.now();\n    const timeToNextUpdate = BANNER_OVERWRITE_DELAY_MS - (now - visible.lastUpdated);\n\n    if (variant === 'NO_STATE' || timeToNextUpdate <= 0) {\n      setVisible({\n        variant,\n        lastUpdated: now\n      });\n    } else {\n      pendingUpdateHandle.current = setTimeout(() => {\n        // Set the actual update time, not the computed time when the update should happen.\n        // The actual update might be later than we planned.\n        setVisible({\n          variant,\n          lastUpdated: Date.now()\n        });\n      }, timeToNextUpdate);\n    }\n  }\n\n  if (visible.variant === 'NO_STATE') {\n    return <></>;\n  }\n\n  return <MessageBar messageBarType={MessageBarType.warning} onDismiss={() => {\n    // when closing the banner, change variant to nostate and change stopped state to off state.\n    // Reason: on banner close, going back to the default state.\n    setVisible({\n      variant: 'NO_STATE',\n      lastUpdated: Date.now()\n    });\n    props.onDismiss();\n  }} dismissButtonAriaLabel={props.strings.close}>\n      <BannerMessage variant={visible.variant} strings={props.strings} />\n    </MessageBar>;\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { useRef } from 'react';\nimport { ComplianceState, computeVariant } from './Utils';\nimport { _ComplianceBannerProps } from './types';\nimport { DelayedUpdateBanner } from './DelayedUpdateBanner'; // latestBooleanState so we can compare with props.callRecordState and props.callTranscribeState easily\n// latestStringState is on, off, stopped state generated by function determineStates using previous and current state values, this is used for computeVariants later\n\ntype CachedComplianceBannerProps = {\n  latestBooleanState: {\n    callTranscribeState?: boolean;\n    callRecordState?: boolean;\n  };\n  latestStringState: {\n    callTranscribeState: ComplianceState;\n    callRecordState: ComplianceState;\n  }; // Timestamp for the last time cached state was updated.\n  // Represented as milliseconds since epoch (i.e., the value returned by Date.now()).\n\n  lastUpdated: number;\n};\n/**\n * A component that displays banners to notify the user when call recording and\n * transcription is enabled or disabled in a call.\n *\n * This component implements a state machine that tracks the changes to call\n * recording and transcription state and shows the corresponding message.\n *\n * @internal\n */\n\nexport const _ComplianceBanner = (props: _ComplianceBannerProps): JSX.Element => {\n  const cachedProps = useRef<CachedComplianceBannerProps>({\n    latestBooleanState: {\n      callTranscribeState: false,\n      callRecordState: false\n    },\n    latestStringState: {\n      callTranscribeState: 'off',\n      callRecordState: 'off'\n    },\n    lastUpdated: Date.now()\n  }); // Only update cached props and variant if there is _some_ change in the latest props.\n  // This ensures that state machine is only updated if there is an actual change in the props.\n\n  const shouldUpdateCached = props.callRecordState !== cachedProps.current.latestBooleanState.callRecordState || props.callTranscribeState !== cachedProps.current.latestBooleanState.callTranscribeState; // The following three operations must be performed in this exact order:\n  // [1]: Update cached state to transition the state machine.\n\n  if (shouldUpdateCached) {\n    cachedProps.current = {\n      latestBooleanState: props,\n      latestStringState: {\n        callRecordState: determineStates(cachedProps.current.latestStringState.callRecordState, props.callRecordState),\n        callTranscribeState: determineStates(cachedProps.current.latestStringState.callTranscribeState, props.callTranscribeState)\n      },\n      lastUpdated: Date.now()\n    };\n  } // [2]: Compute the variant, using the transitioned state machine.\n\n\n  const variant = computeVariant(cachedProps.current.latestStringState.callRecordState, cachedProps.current.latestStringState.callTranscribeState); // [3]: Transition the state machine again to deal with some end-states.\n\n  if (shouldUpdateCached && cachedProps.current.latestStringState.callRecordState === 'stopped' && cachedProps.current.latestStringState.callTranscribeState === 'stopped') {\n    // When both states are stopped, after displaying message \"RECORDING_AND_TRANSCRIPTION_STOPPED\", change both states to off (going back to the default state).\n    cachedProps.current.latestStringState.callRecordState = 'off';\n    cachedProps.current.latestStringState.callTranscribeState = 'off';\n  }\n\n  return <DelayedUpdateBanner variant={{\n    variant,\n    lastUpdated: cachedProps.current.lastUpdated\n  }} strings={props.strings} onDismiss={() => {\n    if (cachedProps.current.latestStringState.callRecordState === 'stopped') {\n      cachedProps.current.latestStringState.callRecordState = 'off';\n    }\n\n    if (cachedProps.current.latestStringState.callTranscribeState === 'stopped') {\n      cachedProps.current.latestStringState.callTranscribeState = 'off';\n    }\n  }} />;\n};\n\nfunction determineStates(previous: ComplianceState, current: boolean | undefined): ComplianceState {\n  // if current state is on, then return on\n  if (current) {\n    return 'on';\n  } // if current state is off\n  else {\n    // if previous state is on and current state is off, return stopped (on -> off)\n    if (previous === 'on') {\n      return 'stopped';\n    } // otherwise remain previous state unchanged\n    else {\n      return previous;\n    }\n  }\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { RemoteParticipantState } from '@internal/calling-stateful-client';\n/**\n * @private\n */\n\nexport const checkIsSpeaking = (participant: RemoteParticipantState): boolean => participant.isSpeaking && !participant.isMuted;","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { DominantSpeakersInfo, RemoteParticipantState as RemoteParticipantConnectionState } from '@azure/communication-calling';\nimport { memoizeFnAll, toFlatCommunicationIdentifier } from '@internal/acs-ui-common';\nimport { RemoteParticipantState, RemoteVideoStreamState } from '@internal/calling-stateful-client';\nimport { VideoGalleryRemoteParticipant, VideoGalleryStream } from '@internal/react-components';\nimport { checkIsSpeaking } from './SelectorUtils';\n/** @internal */\n\nexport const _dominantSpeakersWithFlatId = (dominantSpeakers?: DominantSpeakersInfo): undefined | string[] => {\n  return dominantSpeakers?.speakersList?.map(toFlatCommunicationIdentifier);\n};\n/** @internal */\n\nexport const _videoGalleryRemoteParticipantsMemo = (remoteParticipants: RemoteParticipantState[] | undefined): VideoGalleryRemoteParticipant[] => {\n  if (!remoteParticipants) {\n    return [];\n  }\n\n  return memoizedAllConvertRemoteParticipant(memoizedFn => {\n    return Object.values(remoteParticipants).filter((participant: RemoteParticipantState) => {\n      return participant.state !== 'InLobby';\n    }).map((participant: RemoteParticipantState) => {\n      return memoizedFn(toFlatCommunicationIdentifier(participant.identifier), participant.isMuted, checkIsSpeaking(participant), participant.videoStreams, participant.state, participant.displayName);\n    });\n  });\n};\nconst memoizedAllConvertRemoteParticipant = memoizeFnAll((userId: string, isMuted: boolean, isSpeaking: boolean, videoStreams: {\n  [key: number]: RemoteVideoStreamState;\n}, state: RemoteParticipantConnectionState, displayName?: string): VideoGalleryRemoteParticipant => {\n  return convertRemoteParticipantToVideoGalleryRemoteParticipant(userId, isMuted, isSpeaking, videoStreams, state, displayName);\n});\n/** @private */\n\nexport const convertRemoteParticipantToVideoGalleryRemoteParticipant = (userId: string, isMuted: boolean, isSpeaking: boolean, videoStreams: {\n  [key: number]: RemoteVideoStreamState;\n}, state: RemoteParticipantConnectionState, displayName?: string): VideoGalleryRemoteParticipant => {\n  const rawVideoStreamsArray = Object.values(videoStreams);\n  let videoStream: VideoGalleryStream | undefined = undefined;\n  let screenShareStream: VideoGalleryStream | undefined = undefined;\n\n  if (rawVideoStreamsArray[0]) {\n    if (rawVideoStreamsArray[0].mediaStreamType === 'Video') {\n      videoStream = convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[0]);\n    } else {\n      screenShareStream = convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[0]);\n    }\n  }\n\n  if (rawVideoStreamsArray[1]) {\n    if (rawVideoStreamsArray[1].mediaStreamType === 'ScreenSharing') {\n      screenShareStream = convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[1]);\n    } else {\n      videoStream = convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[1]);\n    }\n  }\n\n  return {\n    userId,\n    displayName,\n    isMuted,\n    isSpeaking,\n    videoStream,\n    screenShareStream,\n    isScreenSharingOn: screenShareStream !== undefined && screenShareStream.isAvailable\n  };\n};\n\nconst convertRemoteVideoStreamToVideoGalleryStream = (stream: RemoteVideoStreamState): VideoGalleryStream => {\n  return {\n    id: stream.id,\n    isAvailable: stream.isAvailable,\n    isMirrored: stream.view?.isMirrored,\n    renderElement: stream.view?.target\n  };\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { toFlatCommunicationIdentifier } from '@internal/acs-ui-common';\nimport { CallClientState, RemoteParticipantState } from '@internal/calling-stateful-client';\nimport { VideoGalleryLocalParticipant, VideoGalleryRemoteParticipant } from '@internal/react-components';\nimport { createSelector } from 'reselect';\nimport { CallingBaseSelectorProps, getDisplayName, getDominantSpeakers, getIdentifier, getIsMuted, getIsScreenSharingOn, getLocalVideoStreams, getRemoteParticipants, getScreenShareRemoteParticipant } from './baseSelectors';\nimport { _updateUserDisplayNames } from './utils/callUtils';\nimport { checkIsSpeaking } from './utils/SelectorUtils';\nimport { _videoGalleryRemoteParticipantsMemo, _dominantSpeakersWithFlatId, convertRemoteParticipantToVideoGalleryRemoteParticipant } from './utils/videoGalleryUtils';\n/**\n * Selector type for {@link VideoGallery} component.\n *\n * @public\n */\n\nexport type VideoGallerySelector = (state: CallClientState, props: CallingBaseSelectorProps) => {\n  screenShareParticipant: VideoGalleryRemoteParticipant | undefined;\n  localParticipant: VideoGalleryLocalParticipant;\n  remoteParticipants: VideoGalleryRemoteParticipant[];\n  dominantSpeakers?: string[];\n};\n/**\n * Provides data attributes to {@link VideoGallery} component.\n * @public\n */\n\nexport const videoGallerySelector: VideoGallerySelector = createSelector([getScreenShareRemoteParticipant, getRemoteParticipants, getLocalVideoStreams, getIsMuted, getIsScreenSharingOn, getDisplayName, getIdentifier, getDominantSpeakers], (screenShareRemoteParticipantId, remoteParticipants, localVideoStreams, isMuted, isScreenSharingOn, displayName: string | undefined, identifier: string, dominantSpeakers) => {\n  const screenShareRemoteParticipant = screenShareRemoteParticipantId && remoteParticipants ? remoteParticipants[screenShareRemoteParticipantId] : undefined;\n  const localVideoStream = localVideoStreams?.find(i => i.mediaStreamType === 'Video');\n\n  const dominantSpeakerIds = _dominantSpeakersWithFlatId(dominantSpeakers);\n\n  const dominantSpeakersMap: Record<string, number> = {};\n  dominantSpeakerIds?.forEach((speaker, idx) => dominantSpeakersMap[speaker] = idx);\n  const noRemoteParticipants = [];\n  return {\n    screenShareParticipant: screenShareRemoteParticipant ? convertRemoteParticipantToVideoGalleryRemoteParticipant(toFlatCommunicationIdentifier(screenShareRemoteParticipant.identifier), screenShareRemoteParticipant.isMuted, checkIsSpeaking(screenShareRemoteParticipant), screenShareRemoteParticipant.videoStreams, screenShareRemoteParticipant.state, screenShareRemoteParticipant.displayName) : undefined,\n    localParticipant: {\n      userId: identifier,\n      displayName: displayName ?? '',\n      isMuted: isMuted,\n      isScreenSharingOn: isScreenSharingOn,\n      videoStream: {\n        isAvailable: !!localVideoStream,\n        isMirrored: localVideoStream?.view?.isMirrored,\n        renderElement: localVideoStream?.view?.target\n      }\n    },\n    remoteParticipants: _videoGalleryRemoteParticipantsMemo(updateUserDisplayNamesTrampoline(remoteParticipants ? Object.values(remoteParticipants) : noRemoteParticipants)),\n    dominantSpeakers: dominantSpeakerIds\n  };\n});\n\nconst updateUserDisplayNamesTrampoline = (remoteParticipants: RemoteParticipantState[]): RemoteParticipantState[] => {\n  return remoteParticipants;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { getIdentifierKind } from '@azure/communication-common';\nimport { fromFlatCommunicationIdentifier, memoizeFnAll } from '@internal/acs-ui-common';\nimport { CallParticipantListParticipant } from '@internal/react-components';\n/**\n * @private\n */\n\nexport const memoizedConvertAllremoteParticipants = memoizeFnAll((userId: string, displayName: string | undefined, state: 'Idle' | 'Connecting' | 'Ringing' | 'Connected' | 'Hold' | 'InLobby' | 'EarlyMedia' | 'Disconnected', isMuted: boolean, isScreenSharing: boolean, isSpeaking: boolean): CallParticipantListParticipant => {\n  return convertRemoteParticipantToParticipantListParticipant(userId, displayName, state, isMuted, isScreenSharing, isSpeaking);\n});\n\nconst convertRemoteParticipantToParticipantListParticipant = (userId: string, displayName: string | undefined, state: 'Idle' | 'Connecting' | 'Ringing' | 'Connected' | 'Hold' | 'InLobby' | 'EarlyMedia' | 'Disconnected', isMuted: boolean, isScreenSharing: boolean, isSpeaking: boolean): CallParticipantListParticipant => {\n  const identifier = fromFlatCommunicationIdentifier(userId);\n  return {\n    userId,\n    displayName,\n    state,\n    isMuted,\n    isScreenSharing,\n    isSpeaking,\n    // ACS users can not remove Teams users.\n    // Removing unknown types of users is undefined.\n    isRemovable: getIdentifierKind(identifier).kind === 'communicationUser' || getIdentifierKind(identifier).kind === 'phoneNumber'\n  };\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CallClientState, RemoteParticipantState } from '@internal/calling-stateful-client';\nimport { createSelector } from 'reselect';\nimport { getIdentifier, getDisplayName, getRemoteParticipants, getIsScreenSharingOn, getIsMuted, CallingBaseSelectorProps } from './baseSelectors';\nimport { CallParticipantListParticipant } from '@internal/react-components';\nimport { _updateUserDisplayNames } from './utils/callUtils';\nimport { memoizedConvertAllremoteParticipants } from './utils/participantListSelectorUtils';\nimport { toFlatCommunicationIdentifier } from '@internal/acs-ui-common';\n\nconst convertRemoteParticipantsToParticipantListParticipants = (remoteParticipants: RemoteParticipantState[]): CallParticipantListParticipant[] => {\n  return memoizedConvertAllremoteParticipants(memoizeFn => {\n    return remoteParticipants // temporarily hiding lobby participants in ACS clients till we can admit users through ACS clients\n    .filter((participant: RemoteParticipantState) => {\n      return participant.state !== 'InLobby';\n    }).map((participant: RemoteParticipantState) => {\n      const isScreenSharing = Object.values(participant.videoStreams).some(videoStream => videoStream.mediaStreamType === 'ScreenSharing' && videoStream.isAvailable);\n      return memoizeFn(toFlatCommunicationIdentifier(participant.identifier), participant.displayName, participant.state, participant.isMuted, isScreenSharing, participant.isSpeaking);\n    }).sort((a, b) => {\n      const nameA = a.displayName?.toLowerCase() || '';\n      const nameB = b.displayName?.toLowerCase() || '';\n\n      if (nameA < nameB) {\n        return -1;\n      } else if (nameA > nameB) {\n        return 1;\n      } else {\n        return 0;\n      }\n    });\n  });\n};\n/**\n * Selector type for {@link ParticipantList} component.\n *\n * @public\n */\n\n\nexport type ParticipantListSelector = (state: CallClientState, props: CallingBaseSelectorProps) => {\n  participants: CallParticipantListParticipant[];\n  myUserId: string;\n};\n/**\n * Selects data that drives {@link ParticipantList} component.\n *\n * @public\n */\n\nexport const participantListSelector: ParticipantListSelector = createSelector([getIdentifier, getDisplayName, getRemoteParticipants, getIsScreenSharingOn, getIsMuted], (userId, displayName, remoteParticipants, isScreenSharingOn, isMuted): {\n  participants: CallParticipantListParticipant[];\n  myUserId: string;\n} => {\n  const participants = remoteParticipants ? convertRemoteParticipantsToParticipantListParticipants(updateUserDisplayNamesTrampoline(Object.values(remoteParticipants))) : [];\n  participants.push({\n    userId: userId,\n    displayName: displayName,\n    isScreenSharing: isScreenSharingOn,\n    isMuted: isMuted,\n    state: 'Connected',\n    // Local participant can never remove themselves.\n    isRemovable: false\n  });\n  return {\n    participants: participants,\n    myUserId: userId\n  };\n});\n\nconst updateUserDisplayNamesTrampoline = (remoteParticipants: RemoteParticipantState[]): RemoteParticipantState[] => {\n  return remoteParticipants;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CallParticipantListParticipant } from '@internal/react-components';\nimport { participantListSelector } from './participantListSelector';\nimport { CallClientState } from '@internal/calling-stateful-client';\nimport { CallingBaseSelectorProps } from '.';\nimport { createSelector } from 'reselect';\n/**\n * Selector type for {@link ParticipantsButton} component.\n *\n * @public\n */\n\nexport type ParticipantsButtonSelector = (state: CallClientState, props: CallingBaseSelectorProps) => {\n  participants: CallParticipantListParticipant[];\n  myUserId: string;\n};\n/**\n * Selects data that drives {@link ParticipantsButton} component.\n *\n * @public\n */\n\nexport const participantsButtonSelector: ParticipantsButtonSelector = createSelector([participantListSelector], (participantListProps): {\n  participants: CallParticipantListParticipant[];\n  myUserId: string;\n} => {\n  return participantListProps;\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ReactElement, useContext } from 'react';\nimport { StatefulCallClient } from '@internal/calling-stateful-client';\nimport { createDefaultCallingHandlersForComponent } from '../handlers/createHandlers';\nimport { CallClientContext, useCall, useCallAgent, useDeviceManager } from '../providers';\n/**\n * Hook to obtain a handler for a specified component.\n *\n * Useful when implementing a custom component that utilizes the providers\n * exported from this library.\n *\n * @public\n */\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/explicit-function-return-type\n\nexport const useHandlers = <PropsT,>(component: (props: PropsT) => ReactElement | null) => {\n  const callClient: StatefulCallClient = (useContext(CallClientContext) as any)?.callClient;\n  const callAgent = useCallAgent();\n  const deviceManager = useDeviceManager();\n  const call = useCall();\n\n  if (!callClient) {\n    return undefined;\n  }\n\n  return createDefaultCallingHandlersForComponent(callClient, callAgent, deviceManager, call, component);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CallClientState, StatefulCallClient } from '@internal/calling-stateful-client';\nimport { CallClientContext, useCall } from '../providers';\nimport { useState, useEffect, useRef, useMemo, useContext } from 'react';\n/**\n * Hook to obtain a selector for a specified component.\n *\n * Useful when implementing a custom component that utilizes the providers\n * exported from this library.\n *\n * @public\n */\n\nexport const useSelector = <SelectorT extends (state: CallClientState, props: any) => any, ParamT extends SelectorT | undefined>(selector: ParamT, selectorProps?: Parameters<SelectorT>[1]): ParamT extends SelectorT ? ReturnType<SelectorT> : undefined => {\n  const callClient: StatefulCallClient | undefined = useContext(CallClientContext)?.callClient;\n  const callId = useCall()?.id; // Keeps track of whether the current component is mounted or not. If it has unmounted, make sure we do not modify the\n  // state or it will cause React warnings in the console. https://skype.visualstudio.com/SPOOL/_workitems/edit/2453212\n\n  const mounted = useRef(false);\n  useEffect(() => {\n    mounted.current = true;\n    return () => {\n      mounted.current = false;\n    };\n  });\n  const callIdConfigProps = useMemo(() => ({\n    callId\n  }), [callId]);\n  const [props, setProps] = useState(callClient && selector ? selector(callClient.getState(), selectorProps ?? callIdConfigProps) : undefined);\n  const propRef = useRef(props);\n  propRef.current = props;\n  useEffect(() => {\n    if (!callClient || !selector) {\n      return;\n    }\n\n    const onStateChange = (state: CallClientState): void => {\n      if (!mounted.current) {\n        return;\n      }\n\n      const newProps = selector(state, selectorProps ?? callIdConfigProps);\n\n      if (propRef.current !== newProps) {\n        setProps(newProps);\n      }\n    };\n\n    callClient.onStateChange(onStateChange);\n    return () => {\n      callClient.offStateChange(onStateChange);\n    };\n  }, [callClient, selector, selectorProps, callIdConfigProps, mounted]);\n  return selector ? props : undefined;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CallingBaseSelectorProps, getDeviceManager, getDiagnostics, getLatestErrors } from './baseSelectors';\nimport { ActiveErrorMessage, ErrorType } from '@internal/react-components';\nimport { createSelector } from 'reselect';\nimport { CallClientState, CallErrors, CallErrorTarget } from '@internal/calling-stateful-client';\nimport { DiagnosticQuality } from '@azure/communication-calling';\n/**\n * Selector type for {@link ErrorBar} component.\n *\n * @public\n */\n\nexport type ErrorBarSelector = (state: CallClientState, props: CallingBaseSelectorProps) => {\n  activeErrorMessages: ActiveErrorMessage[];\n};\n/**\n * Select the first 3 active errors from the state for the `ErrorBar` component.\n *\n * In case there are many errors, only the first three errors are returned to avoid\n * filling up the UI with too many errors.\n *\n * Invariants:\n *   - `ErrorType` is never repeated in the returned errors.\n *   - Errors are returned in a fixed order by `ErrorType`.\n *\n * @public\n */\n\nexport const errorBarSelector: ErrorBarSelector = createSelector([getLatestErrors, getDiagnostics, getDeviceManager], (latestErrors: CallErrors, diagnostics, deviceManager): {\n  activeErrorMessages: ActiveErrorMessage[];\n} => {\n  // The order in which the errors are returned is significant: The `ErrorBar` shows errors on the UI in that order.\n  // There are several options for the ordering:\n  //   - Sorted by when the errors happened (latest first / oldest first).\n  //   - Stable sort by error type.\n  //\n  // We chose to stable sort by error type: We intend to show only a small number of errors on the UI and we do not\n  // have timestamps for errors.\n  const activeErrorMessages: ActiveErrorMessage[] = []; // Errors reported via diagnostics are more reliable than from API method failures, so process those first.\n\n  if (diagnostics?.network.latest.networkReceiveQuality?.value === DiagnosticQuality.Bad || diagnostics?.network.latest.networkReceiveQuality?.value === DiagnosticQuality.Poor) {\n    activeErrorMessages.push({\n      type: 'callNetworkQualityLow'\n    });\n  }\n\n  if (diagnostics?.media.latest.noSpeakerDevicesEnumerated?.value === true) {\n    activeErrorMessages.push({\n      type: 'callNoSpeakerFound'\n    });\n  }\n\n  if (diagnostics?.media.latest.noMicrophoneDevicesEnumerated?.value === true) {\n    activeErrorMessages.push({\n      type: 'callNoMicrophoneFound'\n    });\n  }\n\n  if (deviceManager.deviceAccess?.audio === false) {\n    activeErrorMessages.push({\n      type: 'callMicrophoneAccessDenied'\n    });\n  }\n\n  if (diagnostics?.media.latest.microphonePermissionDenied?.value === true) {\n    activeErrorMessages.push({\n      type: 'callMacOsMicrophoneAccessDenied'\n    });\n  }\n\n  const microphoneMuteUnexpectedlyDiagnostic = diagnostics?.media.latest.microphoneMuteUnexpectedly || diagnostics?.media.latest.microphoneNotFunctioning;\n\n  if (microphoneMuteUnexpectedlyDiagnostic) {\n    if (microphoneMuteUnexpectedlyDiagnostic.value === DiagnosticQuality.Bad) {\n      // Inform the user that microphone stopped working and inform them to start microphone again\n      activeErrorMessages.push({\n        type: 'callMicrophoneMutedBySystem'\n      });\n    } else if (microphoneMuteUnexpectedlyDiagnostic.value === DiagnosticQuality.Good) {\n      // Inform the user that microphone recovered\n      activeErrorMessages.push({\n        type: 'callMicrophoneUnmutedBySystem'\n      });\n    }\n  }\n\n  const cameraStoppedUnexpectedlyDiagnostic = diagnostics?.media.latest.cameraStoppedUnexpectedly;\n\n  if (cameraStoppedUnexpectedlyDiagnostic) {\n    if (cameraStoppedUnexpectedlyDiagnostic.value === DiagnosticQuality.Bad) {\n      // Inform the user that camera stopped working and inform them to start video again\n      activeErrorMessages.push({\n        type: 'callVideoStoppedBySystem'\n      });\n    } else if (cameraStoppedUnexpectedlyDiagnostic.value === DiagnosticQuality.Good) {\n      // Inform the user that camera recovered\n      activeErrorMessages.push({\n        type: 'callVideoRecoveredBySystem'\n      });\n    }\n  }\n\n  if (deviceManager.deviceAccess?.video === false) {\n    activeErrorMessages.push({\n      type: 'callCameraAccessDenied'\n    });\n  } else {\n    if (diagnostics?.media.latest.cameraFreeze?.value === true) {\n      activeErrorMessages.push({\n        type: 'callCameraAlreadyInUse'\n      });\n    }\n  }\n\n  if (diagnostics?.media.latest.cameraPermissionDenied?.value === true) {\n    activeErrorMessages.push({\n      type: 'callMacOsCameraAccessDenied'\n    });\n  }\n\n  if (diagnostics?.media.latest.screenshareRecordingDisabled?.value === true) {\n    activeErrorMessages.push({\n      type: 'callMacOsScreenShareAccessDenied'\n    });\n  } // Prefer to show errors with privacy implications.\n\n\n  appendActiveErrorIfDefined(activeErrorMessages, latestErrors, 'Call.stopVideo', 'stopVideoGeneric');\n  appendActiveErrorIfDefined(activeErrorMessages, latestErrors, 'Call.mute', 'muteGeneric');\n  appendActiveErrorIfDefined(activeErrorMessages, latestErrors, 'Call.stopScreenSharing', 'stopScreenShareGeneric');\n  appendActiveErrorIfDefined(activeErrorMessages, latestErrors, 'Call.startVideo', 'startVideoGeneric');\n  appendActiveErrorIfDefined(activeErrorMessages, latestErrors, 'Call.unmute', 'unmuteGeneric');\n\n  if (latestErrors['CallAgent.join']?.message === 'CallAgent.join: Invalid meeting link') {\n    appendActiveErrorIfDefined(activeErrorMessages, latestErrors, 'CallAgent.join', 'failedToJoinCallInvalidMeetingLink');\n  } else {\n    appendActiveErrorIfDefined(activeErrorMessages, latestErrors, 'CallAgent.join', 'failedToJoinCallGeneric');\n  } // We only return the first few errors to avoid filling up the UI with too many `MessageBar`s.\n\n\n  activeErrorMessages.splice(maxErrorCount);\n  return {\n    activeErrorMessages: activeErrorMessages\n  };\n});\n\nconst appendActiveErrorIfDefined = (activeErrorMessages: ActiveErrorMessage[], latestErrors: CallErrors, target: CallErrorTarget, activeErrorType: ErrorType): void => {\n  if (latestErrors[target] === undefined) {\n    return;\n  }\n\n  activeErrorMessages.push({\n    type: activeErrorType,\n    timestamp: latestErrors[target].timestamp\n  });\n};\n\nconst maxErrorCount = 3;","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CameraButton, EndCallButton, ErrorBar, MicrophoneButton, DevicesButton, ParticipantList, ScreenShareButton, VideoGallery } from '@internal/react-components';\nimport { CameraButtonSelector, cameraButtonSelector, MicrophoneButtonSelector, microphoneButtonSelector, DevicesButtonSelector, devicesButtonSelector, ScreenShareButtonSelector, screenShareButtonSelector } from '../callControlSelectors';\nimport { VideoGallerySelector, videoGallerySelector } from '../videoGallerySelector';\nimport { ParticipantListSelector, participantListSelector } from '../participantListSelector';\nimport { ParticipantsButtonSelector, participantsButtonSelector } from '../participantsButtonSelector';\nimport { useHandlers } from './useHandlers';\nimport { useSelector } from './useSelector';\nimport { Common } from '@internal/acs-ui-common';\nimport { AreEqual } from '@internal/acs-ui-common';\nimport { CallingHandlers } from '../handlers/createHandlers';\nimport { ParticipantsButton } from '@internal/react-components';\nimport { ErrorBarSelector, errorBarSelector } from '../errorBarSelector';\n/**\n * Primary hook to get all hooks necessary for a calling Component.\n *\n * Most straightforward usage of calling components looks like:\n *\n * @example\n * ```\n *     import { ParticipantList, usePropsFor } from '@azure/communication-react';\n *\n *     const App = (): JSX.Element => {\n *         // ... code to setup Providers ...\n *\n *         return <ParticipantList {...usePropsFor(ParticipantList)}/>\n *     }\n * ```\n *\n * @public\n */\n\nexport const usePropsFor = <Component extends (props: any) => JSX.Element,>(component: Component): GetSelector<Component> extends (props: any) => any ? ReturnType<GetSelector<Component>> & Common<CallingHandlers, Parameters<Component>[0]> : undefined => {\n  const selector = getSelector(component);\n  const props = useSelector(selector);\n  const handlers = useHandlers<Parameters<Component>[0]>(component);\n\n  if (props !== undefined) {\n    return ({ ...props,\n      ...handlers\n    } as any);\n  }\n\n  return (undefined as any);\n};\n/**\n * A type for trivial selectors that return no data.\n *\n * Used as a default return value if {@link usePropsFor} is called for a component that requires no data.\n *\n * @public\n */\n\nexport type EmptySelector = () => Record<string, never>;\n\nconst emptySelector: EmptySelector = (): Record<string, never> => ({});\n/**\n * Specific type of the selector applicable to a given Component.\n *\n * @public\n */\n\n\nexport type GetSelector<Component extends (props: any) => JSX.Element | undefined> = AreEqual<Component, typeof VideoGallery> extends true ? VideoGallerySelector : AreEqual<Component, typeof DevicesButton> extends true ? DevicesButtonSelector : AreEqual<Component, typeof MicrophoneButton> extends true ? MicrophoneButtonSelector : AreEqual<Component, typeof CameraButton> extends true ? CameraButtonSelector : AreEqual<Component, typeof ScreenShareButton> extends true ? ScreenShareButtonSelector : AreEqual<Component, typeof ParticipantList> extends true ? ParticipantListSelector : AreEqual<Component, typeof ParticipantsButton> extends true ? ParticipantsButtonSelector : AreEqual<Component, typeof EndCallButton> extends true ? EmptySelector : AreEqual<Component, typeof ErrorBar> extends true ? ErrorBarSelector : undefined;\n/**\n * Get the selector for a specified component.\n *\n * Useful when implementing a custom component that utilizes the providers\n * exported from this library.\n *\n * @public\n */\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n\nexport const getSelector = <Component extends (props: any) => JSX.Element | undefined,>(component: Component): GetSelector<Component> => {\n  return findSelector(component);\n};\n\nconst findSelector = (component: (props: any) => JSX.Element | undefined): any => {\n  switch (component) {\n    case VideoGallery:\n      return videoGallerySelector;\n\n    case MicrophoneButton:\n      return microphoneButtonSelector;\n\n    case CameraButton:\n      return cameraButtonSelector;\n\n    case ScreenShareButton:\n      return screenShareButtonSelector;\n\n    case DevicesButton:\n      return devicesButtonSelector;\n\n    case ParticipantList:\n      return participantListSelector;\n\n    case ParticipantsButton:\n      return participantsButtonSelector;\n\n    case EndCallButton:\n      return emptySelector;\n\n    case ErrorBar:\n      return errorBarSelector;\n  }\n\n  return undefined;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { PagedAsyncIterableIterator } from '@azure/core-paging';\nimport { ReactElement } from 'react';\nimport { Common, fromFlatCommunicationIdentifier } from '@internal/acs-ui-common';\nimport { StatefulChatClient } from '@internal/chat-stateful-client';\nimport { ChatMessage, ChatMessageReadReceipt, ChatThreadClient, SendMessageOptions } from '@azure/communication-chat';\nimport memoizeOne from 'memoize-one';\nimport { FileMetadata } from '@internal/react-components';\n/**\n * Object containing all the handlers required for chat components.\n *\n * Chat related components from this package are able to pick out relevant handlers from this object.\n * See {@link useHandlers} and {@link usePropsFor}.\n *\n * @public\n */\n\nexport type ChatHandlers = {\n  onSendMessage: (content: string, options?: SendMessageOptions) => Promise<void>;\n  onMessageSeen: (chatMessageId: string) => Promise<void>;\n  onTyping: () => Promise<void>;\n  onRemoveParticipant: (userId: string) => Promise<void>;\n  updateThreadTopicName: (topicName: string) => Promise<void>;\n  onLoadPreviousChatMessages: (messagesToLoad: number) => Promise<boolean>;\n  onUpdateMessage: (messageId: string, content: string) => Promise<void>;\n  onDeleteMessage: (messageId: string) => Promise<void>;\n};\n/**\n * Create the default implementation of {@link ChatHandlers}.\n *\n * Useful when implementing a custom component that utilizes the providers\n * exported from this library.\n *\n * Returned object is memoized to avoid rerenders when used as props for React Components.\n *\n * @public\n */\n\nexport const createDefaultChatHandlers = memoizeOne((chatClient: StatefulChatClient, chatThreadClient: ChatThreadClient): ChatHandlers => {\n  let messageIterator: PagedAsyncIterableIterator<ChatMessage> | undefined = undefined;\n  let readReceiptIterator: PagedAsyncIterableIterator<ChatMessageReadReceipt> | undefined = undefined;\n  return {\n    onSendMessage: async (content: string, options?: SendMessageOptions) => {\n      const sendMessageRequest = {\n        content,\n        senderDisplayName: chatClient.getState().displayName\n      };\n      await chatThreadClient.sendMessage(sendMessageRequest, options);\n    },\n    onUpdateMessage: async (messageId: string, content: string, metadata?: Record<string, string>, options?: {\n      attachedFilesMetadata?: FileMetadata[];\n    }) => {\n      const updatedMetadata = metadata ? { ...metadata\n      } : {};\n      updatedMetadata['fileSharingMetadata'] = JSON.stringify(options?.attachedFilesMetadata || []);\n      await chatThreadClient.updateMessage(messageId, {\n        content,\n        metadata: updatedMetadata\n      });\n    },\n    onDeleteMessage: async (messageId: string) => {\n      await chatThreadClient.deleteMessage(messageId);\n    },\n    // This handler is designed for chatThread to consume\n    onMessageSeen: async (chatMessageId: string) => {\n      await chatThreadClient.sendReadReceipt({\n        chatMessageId\n      });\n    },\n    onTyping: async () => {\n      await chatThreadClient.sendTypingNotification();\n    },\n    onRemoveParticipant: async (userId: string) => {\n      await chatThreadClient.removeParticipant(fromFlatCommunicationIdentifier(userId));\n    },\n    updateThreadTopicName: async (topicName: string) => {\n      await chatThreadClient.updateTopic(topicName);\n    },\n    onLoadPreviousChatMessages: async (messagesToLoad: number) => {\n      if (messageIterator === undefined) {\n        // Lazy definition so that errors in the method call are reported correctly.\n        // Also allows recovery via retries in case of transient errors.\n        messageIterator = chatThreadClient.listMessages({\n          maxPageSize: 50\n        });\n      }\n\n      if (readReceiptIterator === undefined) {\n        readReceiptIterator = chatThreadClient.listReadReceipts();\n      } // get the earliest message time\n\n\n      let remainingMessagesToGet = messagesToLoad;\n      let isAllChatMessagesLoaded = false;\n      let earliestTime = Number.MAX_SAFE_INTEGER;\n\n      while (remainingMessagesToGet >= 1) {\n        const message = await messageIterator.next();\n\n        if (message?.value?.id) {\n          if (parseInt(message.value.id) < earliestTime) {\n            earliestTime = parseInt(message.value.id);\n          }\n        }\n\n        if (message.value?.type && message.value.type === 'text') {\n          remainingMessagesToGet--;\n        } // We have traversed all messages in this thread\n\n\n        if (message.done) {\n          isAllChatMessagesLoaded = true;\n          break;\n        }\n      } // keep fetching read receipts until read receipt time < earlist message time\n\n\n      let readReceipt = await readReceiptIterator.next();\n\n      while (!readReceipt.done && parseInt(readReceipt?.value?.chatMessageId) >= earliestTime) {\n        readReceipt = await readReceiptIterator.next();\n      }\n\n      return isAllChatMessagesLoaded;\n    }\n  };\n});\n/**\n * Create a set of default handlers for given component.\n *\n * Returned object is memoized (with reference to the arguments) to avoid\n * renders when used as props for React Components.\n *\n * @public\n */\n\nexport const createDefaultChatHandlersForComponent = <Props,>(chatClient: StatefulChatClient, chatThreadClient: ChatThreadClient, _: (props: Props) => ReactElement | null): Common<ChatHandlers, Props> => {\n  return createDefaultChatHandlers(chatClient, chatThreadClient);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { createContext, useContext } from 'react';\nimport { StatefulChatClient } from '@internal/chat-stateful-client';\n/**\n * @private\n */\n\nexport const ChatClientContext = createContext<StatefulChatClient | undefined>(undefined);\n/**\n * Arguments to initialize a {@link ChatClientProvider}.\n *\n * @public\n */\n\nexport type ChatClientProviderProps = {\n  children: React.ReactNode;\n  chatClient: StatefulChatClient;\n};\n/**\n * A {@link React.Context} that stores a {@link StatefulChatClient}.\n *\n * Chat components from this package must be wrapped with a {@link ChatClientProvider}.\n *\n * @public\n */\n\nexport const ChatClientProvider = (props: ChatClientProviderProps): JSX.Element => {\n  return <ChatClientContext.Provider value={props.chatClient}>{props.children}</ChatClientContext.Provider>;\n};\n/**\n * Hook to obtain {@link StatefulChatClient} from the provider.\n *\n * Useful when implementing a custom component that utilizes the providers\n * exported from this library.\n *\n * @public\n */\n\nexport const useChatClient = (): StatefulChatClient => {\n  const chatClient = useContext(ChatClientContext);\n\n  if (!chatClient) {\n    throw 'Please wrap components with ChatClientProvider and initialize a chat client before calling the hook!';\n  }\n\n  return chatClient;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { createContext, useContext } from 'react';\nimport { ChatThreadClient } from '@azure/communication-chat';\n/**\n * @private\n */\n\nexport const ChatThreadClientContext = createContext<ChatThreadClient | undefined>(undefined);\n/**\n * Arguments to initialize a {@link ChatThreadClientProvider}.\n *\n * @public\n */\n\nexport type ChatThreadClientProviderProps = {\n  children: React.ReactNode;\n  chatThreadClient: ChatThreadClient;\n};\n/**\n * A {@link React.Context} that stores a {@link @azure/communication-chat#ChatThreadClient}.\n *\n * Chat components from this package must be wrapped with a {@link ChatThreadClientProvider}.\n *\n * @public\n */\n\nexport const ChatThreadClientProvider = (props: ChatThreadClientProviderProps): JSX.Element => {\n  return <ChatThreadClientContext.Provider value={props.chatThreadClient}>{props.children}</ChatThreadClientContext.Provider>;\n};\n/**\n * Hook to obtain {@link @azure/communication-chat#ChatThreadClient} from the provider.\n *\n * Useful when implementing a custom component that utilizes the providers\n * exported from this library.\n *\n * @public\n */\n\nexport const useChatThreadClient = (): ChatThreadClient => {\n  const chatThreadClient = useContext(ChatThreadClientContext);\n\n  if (!chatThreadClient) {\n    throw 'Please wrap components with ChatThreadClientProvider and initialize a chat thread client before calling the hook.';\n  }\n\n  return chatThreadClient;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { createDefaultChatHandlersForComponent } from '../handlers/createHandlers';\nimport { ChatClientContext } from '../providers/ChatClientProvider';\nimport { ChatThreadClientContext } from '../providers/ChatThreadClientProvider';\nimport { ReactElement, useContext } from 'react';\nimport { Common } from '@internal/acs-ui-common';\nimport { ChatHandlers } from '../handlers/createHandlers';\n/**\n * Hook to obtain a handler for a specified component.\n *\n * Useful when implementing a custom component that utilizes the providers\n * exported from this library.\n *\n * @public\n */\n\nexport const useHandlers = <PropsT,>(component: (props: PropsT) => ReactElement | null): Common<ChatHandlers, PropsT> | undefined => {\n  const chatClient = useContext(ChatClientContext);\n  const chatThreadClient = useContext(ChatThreadClientContext);\n\n  if (!chatThreadClient || !chatClient) {\n    return undefined;\n  }\n\n  return createDefaultChatHandlersForComponent(chatClient, chatThreadClient, component);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ChatClientState, StatefulChatClient } from '@internal/chat-stateful-client';\nimport { ChatClientContext } from '../providers/ChatClientProvider';\nimport { useState, useEffect, useRef, useMemo, useContext } from 'react';\nimport { ChatThreadClientContext } from '../providers/ChatThreadClientProvider';\n/**\n * Hook to obtain a selector for a specified component.\n *\n * Useful when implementing a custom component that utilizes the providers\n * exported from this library.\n *\n * @public\n */\n\nexport const useSelector = <SelectorT extends (state: ChatClientState, props: any) => any, ParamT extends SelectorT | undefined>(selector: ParamT, selectorProps?: Parameters<SelectorT>[1]): ParamT extends SelectorT ? ReturnType<SelectorT> : undefined => {\n  const chatClient: StatefulChatClient | undefined = useContext(ChatClientContext);\n  const threadId = useContext(ChatThreadClientContext)?.threadId; // Keeps track of whether the current component is mounted or not. If it has unmounted, make sure we do not modify the\n  // state or it will cause React warnings in the console. https://skype.visualstudio.com/SPOOL/_workitems/edit/2453212\n\n  const mounted = useRef(false);\n  useEffect(() => {\n    mounted.current = true;\n    return () => {\n      mounted.current = false;\n    };\n  });\n  const threadConfigProps = useMemo(() => ({\n    threadId\n  }), [threadId]);\n  const [props, setProps] = useState(chatClient && selector ? selector(chatClient.getState(), selectorProps ?? threadConfigProps) : undefined);\n  const propRef = useRef(props);\n  propRef.current = props;\n  useEffect(() => {\n    if (!chatClient || !selector) {\n      return;\n    }\n\n    const onStateChange = (state: ChatClientState): void => {\n      const newProps = selector(state, selectorProps ?? threadConfigProps);\n\n      if (propRef.current !== newProps) {\n        setProps(newProps);\n      }\n    };\n\n    chatClient.onStateChange(onStateChange);\n    return () => {\n      chatClient.offStateChange(onStateChange);\n    };\n  }, [chatClient, selector, selectorProps, threadConfigProps]);\n  return selector ? props : undefined;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ChatClientState, ChatErrors, ChatMessageWithStatus } from '@internal/chat-stateful-client';\nimport { ChatMessageReadReceipt, ChatParticipant } from '@azure/communication-chat';\nimport { TypingIndicatorReceivedEvent } from '@azure/communication-chat';\nimport { toFlatCommunicationIdentifier } from '@internal/acs-ui-common';\n/**\n * Common props for selectors for {@link ChatClientState}.\n *\n * @public\n */\n\nexport type ChatBaseSelectorProps = {\n  threadId: string;\n};\n/**\n * @private\n */\n\nexport const getUserId = (state: ChatClientState): string => toFlatCommunicationIdentifier(state.userId);\n/**\n * @private\n */\n\nexport const getDisplayName = (state: ChatClientState): string => state.displayName;\n/**\n * @private\n */\n\nexport const getChatMessages = (state: ChatClientState, props: ChatBaseSelectorProps): {\n  [key: string]: ChatMessageWithStatus;\n} => props.threadId && state.threads[props.threadId]?.chatMessages || {};\n/**\n * @private\n */\n\nexport const getParticipants = (state: ChatClientState, props: ChatBaseSelectorProps): {\n  [key: string]: ChatParticipant;\n} => props.threadId && state.threads[props.threadId]?.participants || {};\n/**\n * @private\n */\n\nexport const getReadReceipts = (state: ChatClientState, props: ChatBaseSelectorProps): ChatMessageReadReceipt[] => {\n  return state.threads[props?.threadId]?.readReceipts;\n};\n/**\n * @private\n */\n\nexport const getIsLargeGroup = (state: ChatClientState, props: ChatBaseSelectorProps): boolean => {\n  const participants = state.threads[props.threadId]?.participants;\n  return !!participants && Object.values(participants).length > 20;\n};\n/**\n * @private\n */\n\nexport const getLatestReadTime = (state: ChatClientState, props: ChatBaseSelectorProps): Date => props.threadId && state.threads[props.threadId]?.latestReadTime || new Date(0);\n/**\n * @private\n */\n\nexport const getTypingIndicators = (state: ChatClientState, props: ChatBaseSelectorProps): TypingIndicatorReceivedEvent[] => {\n  return props.threadId && state.threads[props.threadId]?.typingIndicators || [];\n};\n/**\n * @private\n */\n\nexport const getLatestErrors = (state: ChatClientState): ChatErrors => state.latestErrors;","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ChatClientState } from '@internal/chat-stateful-client';\nimport { createSelector } from 'reselect';\nimport { ChatBaseSelectorProps, getDisplayName, getUserId } from './baseSelectors';\n/**\n * Selector type for {@link SendBox} component.\n *\n * @public\n */\n\nexport type SendBoxSelector = (state: ChatClientState, props: ChatBaseSelectorProps) => {\n  displayName: string;\n  userId: string;\n};\n/**\n * Selector for {@link SendBox} component.\n *\n * @public\n */\n\nexport const sendBoxSelector: SendBoxSelector = createSelector([getUserId, getDisplayName], (userId, displayName) => ({\n  displayName: displayName,\n  userId: userId\n}));","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/**\n * @private\n */\nexport const MINIMUM_TYPING_INTERVAL_IN_MILLISECONDS = 8000;\n/**\n * @private\n */\n\nexport const PARTICIPANTS_THRESHOLD = 20;\n/**\n * @private\n */\n\nexport const MINUTE_IN_MS = 1000 * 60;\n/**\n * @private\n *\n * TODO: Import enum from @azure/communication-chat when ChatMessageType shows up in new release version\n * (or define our type to decouple)\n */\n\nexport const ACSKnownMessageType = {\n  text: ('text' as const),\n  html: ('html' as const),\n  richtextHtml: ('richtext/html' as const),\n  topicUpdated: ('topicUpdated' as const),\n  participantAdded: ('participantAdded' as const),\n  participantRemoved: ('participantRemoved' as const)\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Message } from '@internal/react-components';\n/**\n * @private\n */\n\nexport const compareMessages = (firstMessage: Message, secondMessage: Message): number => {\n  if (firstMessage.createdOn === undefined) {\n    return 1;\n  }\n\n  if (secondMessage.createdOn === undefined) {\n    return -1;\n  }\n\n  const firstDate = new Date(firstMessage.createdOn).getTime();\n  const secondDate = new Date(secondMessage.createdOn).getTime(); // Workaround to get a stable order of message before we can get sequenceId from chat service.\n  // MessageIds are generated by time order the message persist, a good candidate other than time\n\n  const idDelta = firstMessage.messageId && secondMessage.messageId ? Number.parseInt(firstMessage.messageId) - Number.parseInt(secondMessage.messageId) : 0;\n  return firstDate - secondDate === 0 ? idDelta : firstDate - secondDate;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Message, MessageAttachedStatus } from '@internal/react-components';\nimport { compareMessages } from './compareMessages';\nimport { MINUTE_IN_MS } from './constants';\n/**\n * @private\n */\n\nexport const updateMessagesWithAttached = (chatMessagesWithStatus: Message[]): void => {\n  chatMessagesWithStatus.sort(compareMessages);\n  chatMessagesWithStatus.forEach((message, index, messages) => {\n    if (message.messageType !== 'chat') {\n      return;\n    }\n    /**\n     * Attached === true means it is within a group of messages in the current order\n     * Attached === top/bottom means it is on the top/bottom boundary\n     * Attached === false means it is just a single message\n     * A group of messages: continuous messages that belong to the same sender and not intercepted by other senders.\n     */\n\n\n    let attached: boolean | MessageAttachedStatus = false;\n    const previousMessage = index > 0 ? messages[index - 1] : undefined;\n    const nextMessage = index === messages.length - 1 ? undefined : messages[index + 1];\n    const previousSenderId = previousMessage?.messageType === 'chat' ? previousMessage.senderId : undefined;\n    const nextSenderId = nextMessage?.messageType === 'chat' ? nextMessage.senderId : undefined;\n    const timediff = new Date(message?.createdOn ?? '').getTime() - new Date(previousMessage?.createdOn ?? '').getTime();\n    const diffMins = Math.round(timediff / MINUTE_IN_MS); // minutes\n\n    if (previousSenderId !== message.senderId) {\n      attached = message.senderId === nextSenderId ? 'top' : false;\n    } else if (diffMins && diffMins >= 5) {\n      // if there are more than or equal to 5 mins time gap between messages do not attach and show time stamp\n      attached = false;\n    } else {\n      attached = message.senderId === nextSenderId ? true : 'bottom';\n    }\n\n    message.attached = attached;\n  });\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ChatBaseSelectorProps, getChatMessages, getIsLargeGroup, getLatestReadTime, getParticipants, getReadReceipts, getUserId } from './baseSelectors';\nimport { toFlatCommunicationIdentifier } from '@internal/acs-ui-common';\nimport { ChatClientState, ChatMessageWithStatus } from '@internal/chat-stateful-client';\nimport { memoizeFnAll } from '@internal/acs-ui-common';\nimport { ChatMessage, Message, CommunicationParticipant, SystemMessage, MessageContentType, ReadReceiptsBySenderId } from '@internal/react-components';\nimport { createSelector } from 'reselect';\nimport { ACSKnownMessageType } from './utils/constants';\nimport { updateMessagesWithAttached } from './utils/updateMessagesWithAttached';\nconst memoizedAllConvertChatMessage = memoizeFnAll((_key: string, chatMessage: ChatMessageWithStatus, userId: string, isSeen: boolean, isLargeGroup: boolean): Message => {\n  const messageType = chatMessage.type.toLowerCase();\n\n  if (messageType === ACSKnownMessageType.text || messageType === ACSKnownMessageType.richtextHtml || messageType === ACSKnownMessageType.html) {\n    return convertToUiChatMessage(chatMessage, userId, isSeen, isLargeGroup);\n  } else {\n    return convertToUiSystemMessage(chatMessage);\n  }\n});\n\nconst convertToUiChatMessage = (message: ChatMessageWithStatus, userId: string, isSeen: boolean, isLargeGroup: boolean): ChatMessage => {\n  const messageSenderId = message.sender !== undefined ? toFlatCommunicationIdentifier(message.sender) : userId;\n  return {\n    messageType: 'chat',\n    createdOn: message.createdOn,\n    content: message.content?.message,\n    contentType: sanitizedMessageContentType(message.type),\n    status: !isLargeGroup && message.status === 'delivered' && isSeen ? 'seen' : message.status,\n    senderDisplayName: message.senderDisplayName,\n    senderId: messageSenderId,\n    messageId: message.id,\n    clientMessageId: message.clientMessageId,\n    editedOn: message.editedOn,\n    deletedOn: message.deletedOn,\n    mine: messageSenderId === userId,\n    metadata: message.metadata\n  };\n};\n\nconst convertToUiSystemMessage = (message: ChatMessageWithStatus): SystemMessage => {\n  const systemMessageType = message.type;\n\n  if (systemMessageType === 'participantAdded' || systemMessageType === 'participantRemoved') {\n    return {\n      messageType: 'system',\n      systemMessageType,\n      createdOn: message.createdOn,\n      participants: message.content?.participants // TODO: In our moderator logic, we use undefined name as our displayName for moderator, which should be filtered out\n      // Once we have a better solution to identify the moderator, remove this line\n      ?.filter(participant => participant.displayName && participant.displayName !== '').map((participant): CommunicationParticipant => ({\n        userId: toFlatCommunicationIdentifier(participant.id),\n        displayName: participant.displayName\n      })) ?? [],\n      messageId: message.id,\n      iconName: systemMessageType === 'participantAdded' ? 'PeopleAdd' : 'PeopleBlock'\n    };\n  } else {\n    // Only topic updated type left, according to ACSKnown type\n    return {\n      messageType: 'system',\n      systemMessageType: 'topicUpdated',\n      createdOn: message.createdOn,\n      topic: message.content?.topic ?? '',\n      messageId: message.id,\n      iconName: 'Edit'\n    };\n  }\n};\n/**\n * Selector type for {@link MessageThread} component.\n *\n * @public\n */\n\n\nexport type MessageThreadSelector = (state: ChatClientState, props: ChatBaseSelectorProps) => {\n  userId: string;\n  showMessageStatus: boolean;\n  messages: Message[];\n};\n/** Returns `true` if the message has participants and at least one participant has a display name. */\n\nconst hasValidParticipant = (chatMessage: ChatMessageWithStatus): boolean => !!chatMessage.content?.participants && chatMessage.content.participants.some(p => !!p.displayName);\n/**\n * Selector for {@link MessageThread} component.\n *\n * @public\n */\n\n\nexport const messageThreadSelector: MessageThreadSelector = createSelector([getUserId, getChatMessages, getLatestReadTime, getIsLargeGroup, getReadReceipts, getParticipants], (userId, chatMessages, latestReadTime, isLargeGroup, readReceipts, participants) => {\n  // We can't get displayName in teams meeting interop for now, disable rr feature when it is teams interop\n  const isTeamsInterop = Object.values(participants).find(p => 'microsoftTeamsUserId' in p.id) !== undefined; // get number of participants\n  // filter out the non valid participants (no display name)\n  // Read Receipt details will be disabled when participant count is 0\n\n  const participantCount = isTeamsInterop ? undefined : Object.values(participants).filter(p => p.displayName && p.displayName !== '').length; // creating key value pairs of senderID: last read message information\n\n  const readReceiptsBySenderId: ReadReceiptsBySenderId = {}; // readReceiptsBySenderId[senderID] gets updated everytime a new message is read by this sender\n  // in this way we can make sure that we are only saving the latest read message id and read on time for each sender\n\n  readReceipts.filter(r => r.sender && toFlatCommunicationIdentifier(r.sender) !== userId).forEach(r => {\n    readReceiptsBySenderId[toFlatCommunicationIdentifier(r.sender)] = {\n      lastReadMessage: r.chatMessageId,\n      displayName: participants[toFlatCommunicationIdentifier(r.sender)]?.displayName ?? ''\n    };\n  }); // A function takes parameter above and generate return value\n\n  const convertedMessages = memoizedAllConvertChatMessage(memoizedFn => Object.values(chatMessages).filter(message => message.type.toLowerCase() === ACSKnownMessageType.text || message.type.toLowerCase() === ACSKnownMessageType.richtextHtml || message.type.toLowerCase() === ACSKnownMessageType.html || message.type === ACSKnownMessageType.participantAdded && hasValidParticipant(message) || message.type === ACSKnownMessageType.participantRemoved && hasValidParticipant(message) || // TODO: Add support for topicUpdated system messages in MessageThread component.\n  // message.type === ACSKnownMessageType.topicUpdated ||\n  message.clientMessageId !== undefined).filter(messagesWithContentOrFileSharingMetadata).map(message => {\n    return memoizedFn(message.id ?? message.clientMessageId, message, userId, message.createdOn <= latestReadTime, isLargeGroup);\n  }));\n  updateMessagesWithAttached(convertedMessages);\n  return {\n    userId,\n    showMessageStatus: !isLargeGroup,\n    messages: convertedMessages,\n    participantCount,\n    readReceiptsBySenderId\n  };\n});\n\nconst sanitizedMessageContentType = (type: string): MessageContentType => {\n  const lowerCaseType = type.toLowerCase();\n  return lowerCaseType === 'text' || lowerCaseType === 'html' || lowerCaseType === 'richtext/html' ? lowerCaseType : 'unknown';\n};\n\nconst messagesWithContentOrFileSharingMetadata = (message: ChatMessageWithStatus): boolean => {\n  if (message.deletedOn) {\n    return false;\n  }\n\n  if (message.metadata?.['fileSharingMetadata']) {\n    return true;\n  }\n\n  return !!(message.content && message.content?.message !== '');\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { getTypingIndicators, getParticipants, getUserId, ChatBaseSelectorProps } from './baseSelectors';\nimport { createSelector } from 'reselect';\nimport { ChatParticipant } from '@azure/communication-chat';\nimport { TypingIndicatorReceivedEvent } from '@azure/communication-chat';\nimport { toFlatCommunicationIdentifier } from '@internal/acs-ui-common';\nimport { CommunicationParticipant } from '@internal/react-components';\nimport { MINIMUM_TYPING_INTERVAL_IN_MILLISECONDS, PARTICIPANTS_THRESHOLD } from './utils/constants';\nimport { ChatClientState } from '@internal/chat-stateful-client';\n\nconst filterTypingIndicators = (typingIndicators: TypingIndicatorReceivedEvent[], userId: string): TypingIndicatorReceivedEvent[] => {\n  const filteredTypingIndicators: TypingIndicatorReceivedEvent[] = [];\n  const seen = new Set();\n  const date8SecondsAgo = new Date(Date.now() - MINIMUM_TYPING_INTERVAL_IN_MILLISECONDS);\n\n  for (let i = typingIndicators.length - 1; i >= 0; i--) {\n    const typingIndicator = typingIndicators[i];\n\n    if (toFlatCommunicationIdentifier(typingIndicator.sender) === userId) {\n      continue;\n    }\n\n    if (typingIndicator.receivedOn < date8SecondsAgo) {\n      continue;\n    }\n\n    if (seen.has(toFlatCommunicationIdentifier(typingIndicator.sender))) {\n      continue;\n    }\n\n    seen.add(toFlatCommunicationIdentifier(typingIndicator.sender));\n    filteredTypingIndicators.push(typingIndicator);\n  }\n\n  return filteredTypingIndicators;\n};\n\nconst convertSdkTypingIndicatorsToCommunicationParticipants = (typingIndicators: TypingIndicatorReceivedEvent[], participants: {\n  [key: string]: ChatParticipant;\n}): CommunicationParticipant[] => {\n  return typingIndicators.map(typingIndicator => ({\n    userId: toFlatCommunicationIdentifier(typingIndicator.sender),\n    displayName: participants[toFlatCommunicationIdentifier(typingIndicator.sender)]?.displayName\n  }));\n};\n/**\n * Selector type for {@link TypingIndicator} component.\n *\n * @public\n */\n\n\nexport type TypingIndicatorSelector = (state: ChatClientState, props: ChatBaseSelectorProps) => {\n  typingUsers: CommunicationParticipant[];\n};\n/**\n * Selector for {@link TypingIndicator} component.\n *\n * @public\n */\n\nexport const typingIndicatorSelector: TypingIndicatorSelector = createSelector([getTypingIndicators, getParticipants, getUserId], (typingIndicators: TypingIndicatorReceivedEvent[], participants: {\n  [key: string]: ChatParticipant;\n}, userId: string) => {\n  // if the participant size reaches the threshold then return no typing users\n  if (Object.values(participants).length >= PARTICIPANTS_THRESHOLD) {\n    return {\n      typingUsers: []\n    };\n  } // filter typing indicators to remove those that are from the duplicate users or current user as well as those older than a threshold\n\n\n  const filteredTypingIndicators = filterTypingIndicators(typingIndicators, userId);\n  const typingUsers: CommunicationParticipant[] = convertSdkTypingIndicatorsToCommunicationParticipants(filteredTypingIndicators, participants);\n  return {\n    typingUsers\n  };\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { getUserId, getDisplayName, getParticipants, ChatBaseSelectorProps } from './baseSelectors';\nimport * as reselect from 'reselect';\nimport { toFlatCommunicationIdentifier } from '@internal/acs-ui-common';\nimport { ChatParticipant } from '@azure/communication-chat';\nimport { ParticipantListParticipant } from '@internal/react-components';\nimport { ChatClientState } from '@internal/chat-stateful-client';\nimport { getIdentifierKind } from '@azure/communication-common';\n\nconst convertChatParticipantsToCommunicationParticipants = (chatParticipants: ChatParticipant[]): ParticipantListParticipant[] => {\n  return chatParticipants.map((participant: ChatParticipant) => {\n    return {\n      userId: toFlatCommunicationIdentifier(participant.id),\n      displayName: participant.displayName,\n      // ACS users can not remove Teams users.\n      // Removing phone numbers or unknown types of users is undefined.\n      isRemovable: getIdentifierKind(participant.id).kind === 'communicationUser'\n    };\n  });\n};\n/**\n * get the index of moderator to help updating its display name if they are the local user or removing them from list of participants otherwise\n */\n\n\nconst moderatorIndex = (participants: ParticipantListParticipant[]): number => {\n  return participants.map(p => p.displayName).indexOf(undefined);\n};\n/**\n * Selector type for {@link ParticipantList} component.\n *\n * @public\n */\n\n\nexport type ChatParticipantListSelector = (state: ChatClientState, props: ChatBaseSelectorProps) => {\n  myUserId: string;\n  participants: ParticipantListParticipant[];\n};\n/**\n * Selector for {@link ParticipantList} component.\n *\n * @public\n */\n\nexport const chatParticipantListSelector: ChatParticipantListSelector = reselect.createSelector([getUserId, getParticipants, getDisplayName], (userId, chatParticipants: {\n  [key: string]: ChatParticipant;\n}, displayName) => {\n  let participants = convertChatParticipantsToCommunicationParticipants(Object.values(chatParticipants));\n\n  if (0 !== participants.length) {\n    const moderatorIdx = moderatorIndex(participants);\n\n    if (-1 !== moderatorIdx) {\n      const userIndex = participants.map(p => p.userId).indexOf(userId);\n\n      if (moderatorIdx === userIndex) {\n        participants[moderatorIdx].displayName = displayName;\n      } else {\n        participants = participants.filter(p => p.displayName);\n      }\n    }\n  }\n\n  return {\n    myUserId: userId,\n    participants: participants\n  };\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ChatBaseSelectorProps, getLatestErrors } from './baseSelectors';\nimport { ActiveErrorMessage, ErrorType } from '@internal/react-components';\nimport { createSelector } from 'reselect';\nimport { ChatClientState, ChatError, ChatErrors, ChatErrorTarget } from '@internal/chat-stateful-client';\n/**\n * Selector type for {@link ErrorBar} component.\n *\n * @public\n */\n\nexport type ErrorBarSelector = (state: ChatClientState, props: ChatBaseSelectorProps) => {\n  activeErrorMessages: ActiveErrorMessage[];\n};\n/**\n * Select the first fiew active errors from the state for the {@link ErrorBar} component.\n *\n * In case there are many errors, only a few top errors are returned to avoid\n * filling up the UI with too many errors.\n *\n * Invariants:\n *   - {@link ErrorType} is never repeated in the returned errors.\n *   - Errors are returned in a fixed order by {@link ErrorType}.\n *\n * @public\n */\n\nexport const errorBarSelector: ErrorBarSelector = createSelector([getLatestErrors], (latestErrors): {\n  activeErrorMessages: ActiveErrorMessage[];\n} => {\n  // The order in which the errors are returned is significant: The `ErrorBar` shows errors on the UI in that order.\n  // There are several options for the ordering:\n  //   - Sorted by when the errors happened (latest first / oldest first).\n  //   - Stable sort by error type.\n  //\n  // We chose to stable sort by error type: We intend to show only a small number of errors on the UI and we do not\n  // have timestamps for errors.\n  const activeErrorMessages: ActiveErrorMessage[] = [];\n  let specificSendMessageErrorSeen = false;\n  {\n    const error = latestUnableToReachChatServiceError(latestErrors);\n\n    if (error !== undefined) {\n      activeErrorMessages.push(error);\n    }\n  }\n  {\n    const error = latestAccessDeniedError(latestErrors);\n\n    if (error !== undefined) {\n      activeErrorMessages.push(error);\n    }\n  }\n  const sendMessageError = latestErrors['ChatThreadClient.sendMessage'];\n  {\n    const error = latestNotInThisThreadError(latestErrors);\n\n    if (error !== undefined) {\n      if (sendMessageError !== undefined) {\n        activeErrorMessages.push({\n          type: 'sendMessageNotInChatThread',\n          // Set the latest timestamp of all the errors that translated to an active error.\n          timestamp: sendMessageError.timestamp > (error.timestamp ?? 0) ? sendMessageError.timestamp : error.timestamp\n        });\n        specificSendMessageErrorSeen = true;\n      } else {\n        activeErrorMessages.push(error);\n      }\n    }\n  }\n\n  if (!specificSendMessageErrorSeen && sendMessageError !== undefined) {\n    activeErrorMessages.push({\n      type: 'sendMessageGeneric',\n      timestamp: sendMessageError.timestamp\n    });\n  } // We only return the first few errors to avoid filling up the UI with too many `MessageBar`s.\n\n\n  activeErrorMessages.splice(maxErrorCount);\n  return {\n    activeErrorMessages: activeErrorMessages\n  };\n});\nconst maxErrorCount = 3;\nconst accessErrorTargets: ChatErrorTarget[] = ['ChatThreadClient.getProperties', 'ChatThreadClient.listMessages', 'ChatThreadClient.listParticipants', 'ChatThreadClient.sendMessage', 'ChatThreadClient.sendTypingNotification'];\n\nconst latestUnableToReachChatServiceError = (latestErrors: ChatErrors): ActiveErrorMessage | undefined => {\n  return latestActiveErrorSatisfying(latestErrors, 'unableToReachChatService', (error: ChatError): boolean => {\n    return !!error && !!error.innerError && error.innerError['code'] === 'REQUEST_SEND_ERROR';\n  });\n};\n\nconst latestAccessDeniedError = (latestErrors: ChatErrors): ActiveErrorMessage | undefined => {\n  return latestActiveErrorSatisfying(latestErrors, 'accessDenied', (error: ChatError): boolean => {\n    return !!error && !!error.innerError && error.innerError['statusCode'] === 401;\n  });\n};\n\nconst latestNotInThisThreadError = (latestErrors: ChatErrors): ActiveErrorMessage | undefined => {\n  return latestActiveErrorSatisfying(latestErrors, 'userNotInChatThread', (error: ChatError): boolean => {\n    if (!error || !error.innerError) {\n      return false;\n    } // Explicitly ignore 400 REST error when listParticipants() is called and a BotContact MRI is found in the participants.\n    // This check should be removed when the chat SDK has handled this issue. Note: The this does not stop the error being logged to the console.\n    // To the best of our ability we have confirmed this to have no impact on the participantList returned (all valid participants are still returned), nor\n    // does it have an impact on the participant list updating on other participants joining/leaving or on individual participant actions like removeParticipant.\n\n\n    if (isErrorDueToBotContact(error)) {\n      return false;\n    } // Chat service returns 403 if a user has been removed from a thread.\n    // Chat service returns either 400 or 404 if the thread ID is malformed, depending on how the thread ID is malformed.\n\n\n    return [400, 403, 404].some(statusCode => error.innerError['statusCode'] === statusCode);\n  });\n};\n\nconst botContactMRIPrefix = '28:';\n\nconst isErrorDueToBotContact = (error: ChatError): boolean => error.innerError['statusCode'] === 400 && error.innerError.message.includes(`Identifier format is not supported (${botContactMRIPrefix}`);\n\nconst latestActiveErrorSatisfying = (errors: ChatErrors, activeErrorType: ErrorType, predicate: (error: ChatError) => boolean): ActiveErrorMessage | undefined => {\n  const activeErrorMessages: ActiveErrorMessage[] = [];\n\n  for (const target of accessErrorTargets) {\n    const error = errors[target];\n\n    if (predicate(error)) {\n      activeErrorMessages.push({\n        type: activeErrorType,\n        timestamp: error.timestamp\n      });\n    }\n  }\n\n  if (activeErrorMessages.length === 0) {\n    return undefined;\n  } // We're actually sure that both timestamps will always exist, because we set them above.\n\n\n  activeErrorMessages.sort((a: ActiveErrorMessage, b: ActiveErrorMessage) => (a.timestamp?.getTime() ?? 0) - (b.timestamp?.getTime() ?? 0));\n  return activeErrorMessages[activeErrorMessages.length - 1];\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ErrorBar, MessageThread, ParticipantList, SendBox, TypingIndicator } from '@internal/react-components';\nimport { useHandlers } from './useHandlers';\nimport { useSelector } from './useSelector';\nimport { SendBoxSelector, sendBoxSelector } from '../sendBoxSelector';\nimport { MessageThreadSelector, messageThreadSelector } from '../messageThreadSelector';\nimport { TypingIndicatorSelector, typingIndicatorSelector } from '../typingIndicatorSelector';\nimport { Common, AreEqual } from '@internal/acs-ui-common';\nimport { ChatHandlers } from '../handlers/createHandlers';\nimport { ChatParticipantListSelector, chatParticipantListSelector } from '../chatParticipantListSelector';\nimport { ErrorBarSelector, errorBarSelector } from '../errorBarSelector';\n/**\n * Primary hook to get all hooks necessary for a chat Component.\n *\n * Most straightforward usage of chat components looks like:\n *\n * @example\n * ```\n *     import { ParticipantList, usePropsFor } from '@azure/communication-react';\n *\n *     const App = (): JSX.Element => {\n *         // ... code to setup Providers ...\n *\n *         return <ParticipantList {...usePropsFor(ParticipantList)}/>\n *     }\n * ```\n *\n * @public\n */\n\nexport const usePropsFor = <Component extends (props: any) => JSX.Element,>(component: Component): GetSelector<Component> extends (props: any) => any ? ReturnType<GetSelector<Component>> & Common<ChatHandlers, Parameters<Component>[0]> : undefined => {\n  const selector = getSelector(component);\n  const props = useSelector(selector);\n  const handlers = useHandlers<Parameters<Component>[0]>(component);\n\n  if (props !== undefined) {\n    return ({ ...props,\n      ...handlers\n    } as any);\n  }\n\n  return (undefined as any);\n};\n/**\n * Specific type of the selector applicable to a given Component.\n *\n * @public\n */\n\nexport type GetSelector<Component extends (props: any) => JSX.Element | undefined> = AreEqual<Component, typeof SendBox> extends true ? SendBoxSelector : AreEqual<Component, typeof MessageThread> extends true ? MessageThreadSelector : AreEqual<Component, typeof TypingIndicator> extends true ? TypingIndicatorSelector : AreEqual<Component, typeof ParticipantList> extends true ? ChatParticipantListSelector : AreEqual<Component, typeof ErrorBar> extends true ? ErrorBarSelector : undefined;\n/**\n * Get the selector for a specified component.\n *\n * Useful when implementing a custom component that utilizes the providers\n * exported from this library.\n *\n * @public\n */\n\nexport const getSelector = <Component extends (props: any) => JSX.Element | undefined,>(component: Component): GetSelector<Component> => {\n  return findSelector(component);\n};\n\nconst findSelector = (component: (props: any) => JSX.Element | undefined): any => {\n  switch (component) {\n    case SendBox:\n      return sendBoxSelector;\n\n    case MessageThread:\n      return messageThreadSelector;\n\n    case TypingIndicator:\n      return typingIndicatorSelector;\n\n    case ParticipantList:\n      return chatParticipantListSelector;\n\n    case ErrorBar:\n      return errorBarSelector;\n  }\n\n  return undefined;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { AudioDeviceInfo, DeviceAccess, DeviceManager, VideoDeviceInfo } from '@azure/communication-calling';\nimport { CallContext } from './CallContext';\n/**\n * Defines the additional methods added by the stateful on top of {@link @azure/communication-calling#DeviceManager}.\n *\n * @public\n */\n\nexport interface StatefulDeviceManager extends DeviceManager {\n  /**\n   * Sets the selectedCamera in the {@link DeviceManagerState}. This is completely developer driven and is not tied in\n   * any way to {@link @azure/communication-calling#DeviceManager}. It is entirely contained in\n   * {@link StatefulDeviceManager}. See also {@link DeviceManagerState.selectedCamera}.\n   */\n  selectCamera: (VideoDeviceInfo) => void;\n}\n/**\n * ProxyDeviceManager proxies DeviceManager and subscribes to all events that affect device manager state. State updates\n * are set on the provided context. Also any queries for state are proxied and stored in state as well. Only one device\n * manager should exist for a given CallClient so if CallClient.getDeviceManager is called multiple times, either a\n * cached ProxyDeviceManager should be returned or the existing ProxyDeviceManager should be destructed via destructor()\n * and a new ProxyDeviceManager created.\n */\n\nclass ProxyDeviceManager implements ProxyHandler<DeviceManager> {\n  private _deviceManager: DeviceManager;\n  private _context: CallContext;\n\n  constructor(deviceManager: DeviceManager, context: CallContext) {\n    this._deviceManager = deviceManager;\n    this._context = context;\n    this.setDeviceManager();\n    this.subscribe();\n  }\n\n  private setDeviceManager = (): void => {\n    // isSpeakerSelectionAvailable, selectedMicrophone, and selectedSpeaker are properties on DeviceManager. Since they\n    // are not functions we can't proxy them so we'll update whenever we think they may need updating such as at\n    // construction time or when certain events happen.\n    this._context.setDeviceManagerIsSpeakerSelectionAvailable(this._deviceManager.isSpeakerSelectionAvailable);\n\n    this._context.setDeviceManagerSelectedMicrophone(this._deviceManager.selectedMicrophone);\n\n    this._context.setDeviceManagerSelectedSpeaker(this._deviceManager.selectedSpeaker);\n  };\n  private subscribe = (): void => {\n    this._deviceManager.on('videoDevicesUpdated', this.videoDevicesUpdated);\n\n    this._deviceManager.on('audioDevicesUpdated', this.audioDevicesUpdated);\n\n    this._deviceManager.on('selectedMicrophoneChanged', this.selectedMicrophoneChanged);\n\n    this._deviceManager.on('selectedSpeakerChanged', this.selectedSpeakerChanged);\n  };\n  /**\n   * This is used to unsubscribe DeclarativeDeviceManager from the DeviceManager events.\n   */\n\n  public unsubscribe = (): void => {\n    this._deviceManager.off('videoDevicesUpdated', this.videoDevicesUpdated);\n\n    this._deviceManager.off('audioDevicesUpdated', this.audioDevicesUpdated);\n\n    this._deviceManager.off('selectedMicrophoneChanged', this.selectedMicrophoneChanged);\n\n    this._deviceManager.off('selectedSpeakerChanged', this.selectedSpeakerChanged);\n  };\n  /**\n   * Used to set a camera inside the proxy device manager.\n   *\n   * @param videoDeviceInfo VideoDeviceInfo\n   */\n\n  public selectCamera = (videoDeviceInfo: VideoDeviceInfo): void => {\n    this._context.setDeviceManagerSelectedCamera(videoDeviceInfo);\n  };\n  private videoDevicesUpdated = async (): Promise<void> => {\n    this._context.setDeviceManagerCameras(dedupeById(await this._deviceManager.getCameras()));\n  };\n  private audioDevicesUpdated = async (): Promise<void> => {\n    this._context.setDeviceManagerMicrophones(dedupeById(await this._deviceManager.getMicrophones()));\n\n    this._context.setDeviceManagerSpeakers(dedupeById(await this._deviceManager.getSpeakers()));\n  };\n  private selectedMicrophoneChanged = (): void => {\n    this._context.setDeviceManagerSelectedMicrophone(this._deviceManager.selectedMicrophone);\n  };\n  private selectedSpeakerChanged = (): void => {\n    this._context.setDeviceManagerSelectedSpeaker(this._deviceManager.selectedSpeaker);\n  };\n\n  public get<P extends keyof DeviceManager>(target: DeviceManager, prop: P): any {\n    switch (prop) {\n      case 'getCameras':\n        {\n          return this._context.withAsyncErrorTeedToState((): Promise<VideoDeviceInfo[]> => {\n            return target.getCameras().then((cameras: VideoDeviceInfo[]) => {\n              this._context.setDeviceManagerCameras(dedupeById(cameras));\n\n              return cameras;\n            });\n          }, 'DeviceManager.getCameras');\n        }\n\n      case 'getMicrophones':\n        {\n          return this._context.withAsyncErrorTeedToState((): Promise<AudioDeviceInfo[]> => {\n            return target.getMicrophones().then((microphones: AudioDeviceInfo[]) => {\n              this._context.setDeviceManagerMicrophones(dedupeById(microphones));\n\n              return microphones;\n            });\n          }, 'DeviceManager.getMicrophones');\n        }\n\n      case 'getSpeakers':\n        {\n          return this._context.withAsyncErrorTeedToState((): Promise<AudioDeviceInfo[]> => {\n            return target.getSpeakers().then((speakers: AudioDeviceInfo[]) => {\n              this._context.setDeviceManagerSpeakers(dedupeById(speakers));\n\n              return speakers;\n            });\n          }, 'DeviceManager.getSpeakers');\n        }\n\n      case 'selectMicrophone':\n        {\n          return this._context.withAsyncErrorTeedToState((...args: Parameters<DeviceManager['selectMicrophone']>): Promise<void> => {\n            return target.selectMicrophone(...args).then(() => {\n              this._context.setDeviceManagerSelectedMicrophone(target.selectedMicrophone);\n            });\n          }, 'DeviceManager.selectMicrophone');\n        }\n\n      case 'selectSpeaker':\n        {\n          return this._context.withAsyncErrorTeedToState((...args: Parameters<DeviceManager['selectSpeaker']>): Promise<void> => {\n            return target.selectSpeaker(...args).then(() => {\n              this._context.setDeviceManagerSelectedSpeaker(target.selectedSpeaker);\n            });\n          }, 'DeviceManager.selectSpeaker');\n        }\n\n      case 'askDevicePermission':\n        {\n          return this._context.withAsyncErrorTeedToState((...args: Parameters<DeviceManager['askDevicePermission']>): Promise<DeviceAccess> => {\n            return target.askDevicePermission(...args).then((deviceAccess: DeviceAccess) => {\n              this._context.setDeviceManagerDeviceAccess(deviceAccess);\n\n              this.setDeviceManager();\n              return deviceAccess;\n            });\n          }, 'DeviceManager.askDevicePermission');\n        }\n\n      default:\n        return Reflect.get(target, prop);\n    }\n  }\n\n} // TODO: Remove this when SDK no longer returns duplicate audio and video devices\n\n/** Helper function to dedupe duplicate audio and video devices obtained from SDK */\n\n\nconst dedupeById = <T extends {\n  id: string;\n},>(devices: T[]): T[] => {\n  const ids = new Set();\n  const uniqueDevices: T[] = [];\n  devices.forEach((device: T) => {\n    if (!ids.has(device.id)) {\n      uniqueDevices.push(device);\n      ids.add(device.id);\n    }\n  });\n  return uniqueDevices;\n};\n/**\n * Creates a declarative DeviceManager by proxying DeviceManager with ProxyDeviceManager. The declarative DeviceManager\n * will put state updates in the given context.\n *\n * @param deviceManager - DeviceManager from SDK\n * @param context - CallContext from StatefulCallClient\n */\n\n\nexport const deviceManagerDeclaratify = (deviceManager: DeviceManager, context: CallContext): DeviceManager => {\n  const proxyDeviceManager = new ProxyDeviceManager(deviceManager, context);\n  Object.defineProperty(deviceManager, 'unsubscribe', {\n    configurable: false,\n    value: () => proxyDeviceManager.unsubscribe()\n  });\n  Object.defineProperty(deviceManager, 'selectCamera', {\n    configurable: false,\n    value: (videoDeviceInfo: VideoDeviceInfo) => proxyDeviceManager.selectCamera(videoDeviceInfo)\n  });\n  return (new Proxy(deviceManager, proxyDeviceManager) as StatefulDeviceManager);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { AudioDeviceInfo, CallDirection, CallEndReason, CallerInfo, CallState as CallStatus, DeviceAccess, DominantSpeakersInfo, LatestMediaDiagnostics, LatestNetworkDiagnostics, MediaStreamType, RemoteParticipantState as RemoteParticipantStatus, ScalingMode, VideoDeviceInfo } from '@azure/communication-calling';\nimport { CommunicationUserKind, MicrosoftTeamsUserKind, PhoneNumberKind, UnknownIdentifierKind, CommunicationIdentifierKind } from '@azure/communication-common';\n/**\n * State only version of {@link @azure/communication-calling#CallAgent} except calls is moved to be a child directly of\n * {@link CallClientState} and not included here. The reason to have CallAgent's state proxied is to provide access to\n * displayName. We don't flatten CallAgent.displayName and put it in CallClientState because it would be ambiguious that\n * displayName is actually reliant on the creation/existence of CallAgent to be available.\n *\n * @public\n */\n\nexport interface CallAgentState {\n  /**\n   * Proxy of {@link @azure/communication-calling#CallAgent.displayName}.\n   */\n  displayName?: string;\n}\n/**\n * State only version of {@link @azure/communication-calling#TranscriptionCallFeature}. {@link StatefulCallClient} will\n * automatically listen for transcription state of the call and update the state exposed by {@link StatefulCallClient}\n * accordingly.\n *\n * @public\n */\n\nexport interface TranscriptionCallFeatureState {\n  /**\n   * Proxy of {@link @azure/communication-calling#TranscriptionCallFeature.isTranscriptionActive}.\n   */\n  isTranscriptionActive: boolean;\n}\n/**\n * State only version of {@link @azure/communication-calling#RecordingCallFeature}. {@link StatefulCallClient} will\n * automatically listen for recording state of the call and update the state exposed by {@link StatefulCallClient} accordingly.\n *\n * @public\n */\n\nexport interface RecordingCallFeatureState {\n  /**\n   * Proxy of {@link @azure/communication-calling#RecordingCallFeature.isRecordingActive}.\n   */\n  isRecordingActive: boolean;\n}\n/**\n * State only version of {@link @azure/communication-calling#LocalVideoStream}.\n *\n * @public\n */\n\nexport interface LocalVideoStreamState {\n  /**\n   * Proxy of {@link @azure/communication-calling#LocalVideoStream.source}.\n   */\n  source: VideoDeviceInfo;\n  /**\n   * Proxy of {@link @azure/communication-calling#LocalVideoStream.mediaStreamType}.\n   */\n\n  mediaStreamType: MediaStreamType;\n  /**\n   * {@link VideoStreamRendererView} that is managed by createView/disposeView in {@link StatefulCallClient}\n   * API. This can be undefined if the stream has not yet been rendered and defined after createView creates the view.\n   */\n\n  view?: VideoStreamRendererViewState;\n}\n/**\n * State only version of {@link @azure/communication-calling#RemoteVideoStream}.\n *\n * @public\n */\n\nexport interface RemoteVideoStreamState {\n  /**\n   * Proxy of {@link @azure/communication-calling#RemoteVideoStream.id}.\n   */\n  id: number;\n  /**\n   * Proxy of {@link @azure/communication-calling#RemoteVideoStream.mediaStreamType}.\n   */\n\n  mediaStreamType: MediaStreamType;\n  /**\n   * Proxy of {@link @azure/communication-calling#RemoteVideoStream.isAvailable}.\n   */\n\n  isAvailable: boolean;\n  /**\n   * Proxy of {@link @azure/communication-calling#RemoteVideoStream.isReceiving}.\n   * @beta\n   */\n\n  /**\n   * {@link VideoStreamRendererView} that is managed by createView/disposeView in {@link StatefulCallClient}\n   * API. This can be undefined if the stream has not yet been rendered and defined after createView creates the view.\n   */\n  view?: VideoStreamRendererViewState;\n}\n/**\n * State only version of {@link @azure/communication-calling#VideoStreamRendererView}. This property is added to the state exposed\n * by {@link StatefulCallClient} by {@link StatefulCallClient.createView} and removed by {@link StatefulCallClient.disposeView}.\n *\n * @public\n */\n\nexport interface VideoStreamRendererViewState {\n  /**\n   * Proxy of {@link @azure/communication-calling#VideoStreamRendererView.scalingMode}.\n   */\n  scalingMode: ScalingMode;\n  /**\n   * Proxy of {@link @azure/communication-calling#VideoStreamRendererView.isMirrored}.\n   */\n\n  isMirrored: boolean;\n  /**\n   * Proxy of {@link @azure/communication-calling#VideoStreamRendererView.target}.\n   */\n\n  target: HTMLElement;\n}\n/**\n * State only version of {@link @azure/communication-calling#RemoteParticipant}. {@link StatefulCallClient} will\n * automatically retrieve RemoteParticipants and add their state to the state exposed by {@link StatefulCallClient}.\n *\n * @public\n */\n\nexport interface RemoteParticipantState {\n  /**\n   * Proxy of {@link @azure/communication-calling#RemoteParticipant.identifier}.\n   */\n  identifier: CommunicationUserKind | PhoneNumberKind | MicrosoftTeamsUserKind | UnknownIdentifierKind;\n  /**\n   * Proxy of {@link @azure/communication-calling#RemoteParticipant.displayName}.\n   */\n\n  displayName?: string;\n  /**\n   * Proxy of {@link @azure/communication-calling#RemoteParticipant.state}.\n   */\n\n  state: RemoteParticipantStatus;\n  /**\n   * Proxy of {@link @azure/communication-calling#RemoteParticipant.callEndReason}.\n   */\n\n  callEndReason?: CallEndReason;\n  /**\n   * Proxy of {@link @azure/communication-calling#RemoteParticipant.videoStreams} as an object with\n   * {@link RemoteVideoStream} fields keyed by {@link @azure/communication-calling#RemoteVideoStream.id}.\n   */\n\n  videoStreams: {\n    [key: number]: RemoteVideoStreamState;\n  };\n  /**\n   * Proxy of {@link @azure/communication-calling#RemoteParticipant.isMuted}.\n   */\n\n  isMuted: boolean;\n  /**\n   * Proxy of {@link @azure/communication-calling#RemoteParticipant.isSpeaking}.\n   */\n\n  isSpeaking: boolean;\n}\n/**\n * State only version of {@link @azure/communication-calling#Call}. {@link StatefulCallClient} will automatically\n * retrieve Call's state and add it to the state exposed by {@link StatefulCallClient}.\n *\n * @public\n */\n\nexport interface CallState {\n  /**\n   * Proxy of {@link @azure/communication-calling#Call.id}.\n   */\n  id: string;\n  /**\n   * Proxy of {@link @azure/communication-calling#Call.callerInfo}.\n   */\n\n  callerInfo: CallerInfo;\n  /**\n   * Proxy of {@link @azure/communication-calling#Call.state}.\n   */\n\n  state: CallStatus;\n  /**\n   * Proxy of {@link @azure/communication-calling#Call.callEndReason}.\n   */\n\n  callEndReason?: CallEndReason;\n  /**\n   * Proxy of {@link @azure/communication-calling#Call.direction}.\n   */\n\n  direction: CallDirection;\n  /**\n   * Proxy of {@link @azure/communication-calling#Call.isMuted}.\n   */\n\n  isMuted: boolean;\n  /**\n   * Proxy of {@link @azure/communication-calling#Call.isScreenSharingOn}.\n   */\n\n  isScreenSharingOn: boolean;\n  /**\n   * Proxy of {@link @azure/communication-calling#DominantSpeakersInfo }.\n   */\n\n  dominantSpeakers?: DominantSpeakersInfo;\n  /**\n   * Proxy of {@link @azure/communication-calling#Call.localVideoStreams}.\n   */\n\n  localVideoStreams: LocalVideoStreamState[];\n  /**\n   * Proxy of {@link @azure/communication-calling#Call.remoteParticipants}.\n   * Object with {@link RemoteParticipant} fields keyed by flattened {@link RemoteParticipantState.identifier}.\n   * To obtain a flattened {@link RemoteParticipantState.identifier}, use\n   * {@link @azure/communication-react#toFlatCommunicationIdentifier}.\n   */\n\n  remoteParticipants: {\n    [keys: string]: RemoteParticipantState;\n  };\n  /**\n   * Stores remote participants that have left the call so that the callEndReason could be retrieved.\n   * Object with {@link RemoteParticipant} fields keyed by flattened {@link RemoteParticipantState.identifier}.\n   * To obtain a flattened {@link RemoteParticipantState.identifier}, use\n   * {@link @azure/communication-react#toFlatCommunicationIdentifier}.\n   */\n\n  remoteParticipantsEnded: {\n    [keys: string]: RemoteParticipantState;\n  };\n  /**\n   * Proxy of {@link @azure/communication-calling#TranscriptionCallFeature}.\n   */\n\n  transcription: TranscriptionCallFeatureState;\n  /**\n   * Proxy of {@link @azure/communication-calling#RecordingCallFeature}.\n   */\n\n  recording: RecordingCallFeatureState;\n  /**\n   * Stores the currently active screenshare participant's key. If there is no screenshare active, then this will be\n   * undefined. You can use this key to access the remoteParticipant data in {@link CallState.remoteParticipants} object.\n   *\n   * Note this only applies to ScreenShare in RemoteParticipant. A local ScreenShare being active will not affect this\n   * property.\n   *\n   * This property is added by the stateful layer and is not a proxy of SDK state\n   */\n\n  screenShareRemoteParticipant?: string;\n  /**\n   * Stores the local date when the call started on the client. This property is added by the stateful layer and is not\n   * a proxy of SDK state.\n   */\n\n  startTime: Date;\n  /**\n   * Stores the local date when the call ended on the client. This property is added by the stateful layer and is not\n   * a proxy of SDK state.\n   */\n\n  endTime: Date | undefined;\n  /**\n   * Stores the latest call diagnostics.\n   */\n\n  diagnostics: DiagnosticsCallFeatureState;\n}\n/**\n * State only version of {@link @azure/communication-calling#IncomingCall}. {@link StatefulCallClient} will\n * automatically detect incoming calls and add their state to the state exposed by {@link StatefulCallClient}.\n *\n * @public\n */\n\nexport interface IncomingCallState {\n  /**\n   * Proxy of {@link @azure/communication-calling#IncomingCall.id}.\n   */\n  id: string;\n  /**\n   * Proxy of {@link @azure/communication-calling#IncomingCall.callerInfo}.\n   */\n\n  callerInfo: CallerInfo;\n  /**\n   * Set to the state returned by 'callEnded' event on {@link @azure/communication-calling#IncomingCall} when received.\n   * This property is added by the stateful layer and is not a proxy of SDK state.\n   */\n\n  callEndReason?: CallEndReason;\n  /**\n   * Stores the local date when the call started on the client. This property is added by the stateful layer and is not\n   * a proxy of SDK state.\n   */\n\n  startTime: Date;\n  /**\n   * Stores the local date when the call ended on the client. This property is added by the stateful layer and is not a\n   * proxy of SDK state. It is undefined if the call is not ended yet.\n   */\n\n  endTime?: Date;\n}\n/**\n * This type is meant to encapsulate all the state inside {@link @azure/communication-calling#DeviceManager}. For\n * optional parameters they may not be available until permission is granted by the user. The cameras, microphones,\n * speakers, and deviceAccess states will be empty until the corresponding\n * {@link @azure/communication-calling#DeviceManager}'s getCameras, getMicrophones, getSpeakers, and askDevicePermission\n * APIs are called and completed.\n *\n * @public\n */\n\nexport type DeviceManagerState = {\n  /**\n   * Proxy of {@link @azure/communication-calling#DeviceManager.isSpeakerSelectionAvailable}.\n   */\n  isSpeakerSelectionAvailable: boolean;\n  /**\n   * Proxy of {@link @azure/communication-calling#DeviceManager.selectedMicrophone}.\n   */\n\n  selectedMicrophone?: AudioDeviceInfo;\n  /**\n   * Proxy of {@link @azure/communication-calling#DeviceManager.selectedSpeaker}.\n   */\n\n  selectedSpeaker?: AudioDeviceInfo;\n  /**\n   * Stores the selected camera device info. This is added by the stateful layer and does not exist in the Calling SDK.\n   * It is meant as a convenience to the developer. It must be explicitly set before it has any value and does not\n   * persist across instances of the {@link StatefulCallClient}. The developer controls entirely what this value holds\n   * at any time.\n   */\n\n  selectedCamera?: VideoDeviceInfo;\n  /**\n   * Stores any cameras data returned from {@link @azure/communication-calling#DeviceManager.getCameras}.\n   */\n\n  cameras: VideoDeviceInfo[];\n  /**\n   * Stores any microphones data returned from {@link @azure/communication-calling#DeviceManager.getMicrophones}.\n   */\n\n  microphones: AudioDeviceInfo[];\n  /**\n   * Stores any speakers data returned from {@link @azure/communication-calling#DeviceManager.getSpeakers}.\n   */\n\n  speakers: AudioDeviceInfo[];\n  /**\n   * Stores deviceAccess data returned from {@link @azure/communication-calling#DeviceManager.askDevicePermission}.\n   */\n\n  deviceAccess?: DeviceAccess;\n  /**\n   * Stores created views that are not associated with any CallState (when {@link StatefulCallClient.createView} is\n   * called with undefined callId, undefined participantId, and defined LocalVideoStream).\n   *\n   * The values in this array are generated internally when {@link StatefulCallClient.createView} is called and are\n   * considered immutable.\n   */\n\n  unparentedViews: LocalVideoStreamState[];\n};\n/**\n * Container for all of the state data proxied by {@link StatefulCallClient}. The calls, callsEnded, incomingCalls, and\n * incomingCallsEnded states will be automatically provided if a callAgent has been created. The deviceManager will be\n * empty initially until populated see {@link DeviceManagerState}. The userId state is provided as a convenience for the\n * developer and is completely controled and set by the developer.\n *\n * @public\n */\n\nexport interface CallClientState {\n  /**\n   * Proxy of {@link @azure/communication-calling#CallAgent.calls} as an object with CallState {@link CallState} fields.\n   * It is keyed by {@link @azure/communication-calling#Call.id}. Please note that\n   * {@link @azure/communication-calling#Call.id} could change. You should not cache the id itself but the entire\n   * {@link @azure/communication-calling#Call} and then use the id contained to look up data in this map.\n   */\n  calls: {\n    [key: string]: CallState;\n  };\n  /**\n   * Calls that have ended are stored here so the callEndReason could be checked.\n   * It is an object with {@link @azure/communication-calling#Call.id} keys and {@link CallState} values.\n   *\n   * Only {@link MAX_CALL_HISTORY_LENGTH} Calls are kept in the history. Oldest calls are evicted if required.\n   */\n\n  callsEnded: {\n    [key: string]: CallState;\n  };\n  /**\n   * Proxy of {@link @azure/communication-calling#IncomingCall} as an object with {@link IncomingCall} fields.\n   * It is keyed by {@link @azure/communication-calling#IncomingCall.id}.\n   */\n\n  incomingCalls: {\n    [key: string]: IncomingCallState;\n  };\n  /**\n   * Incoming Calls that have ended are stored here so the callEndReason could be checked.\n   * It is an as an object with {@link @azure/communication-calling#Call.id} keys and {@link IncomingCall} values.\n   *\n   * Only {@link MAX_CALL_HISTORY_LENGTH} Calls are kept in the history. Oldest calls are evicted if required.\n   */\n\n  incomingCallsEnded: {\n    [key: string]: IncomingCallState;\n  };\n  /**\n   * Proxy of {@link @azure/communication-calling#DeviceManager}. Please review {@link DeviceManagerState}.\n   */\n\n  deviceManager: DeviceManagerState;\n  /**\n   * Proxy of {@link @azure/communication-calling#CallAgent}. Please review {@link CallAgentState}.\n   */\n\n  callAgent?: CallAgentState;\n  /**\n   * Stores a userId. This is not used by the {@link StatefulCallClient} and is provided here as a convenience for the\n   * developer for easier access to userId. Must be passed in at initialization of the {@link StatefulCallClient}.\n   * Completely controlled by the developer.\n   */\n\n  userId: CommunicationIdentifierKind;\n  /**\n   * Stores the latest error for each API method.\n   *\n   * See documentation of {@Link CallErrors} for details.\n   */\n\n  latestErrors: CallErrors;\n}\n/**\n * Errors teed from API calls to the Calling SDK.\n *\n * Each property in the object stores the latest error for a particular SDK API method.\n *\n * Errors from this object can be cleared using the {@link newClearCallErrorsModifier}.\n * Additionally, errors are automatically cleared when:\n * - The state is cleared.\n * - Subsequent calls to related API methods succeed.\n * See documentation of individual stateful client methods for details on when errors may be automatically cleared.\n *\n * @public\n */\n\nexport type CallErrors = { [target in CallErrorTarget]: CallError };\n/**\n * Error thrown from failed stateful API methods.\n *\n * @public\n */\n\nexport class CallError extends Error {\n  /**\n   * The API method target that failed.\n   */\n  public target: CallErrorTarget;\n  /**\n   * Error thrown by the failed SDK method.\n   */\n\n  public innerError: Error;\n  /**\n   * Timestamp added to the error by the stateful layer.\n   */\n\n  public timestamp: Date;\n\n  constructor(target: CallErrorTarget, innerError: Error, timestamp?: Date) {\n    super();\n    this.target = target;\n    this.innerError = innerError; // Testing note: It is easier to mock Date::now() than the Date() constructor.\n\n    this.timestamp = timestamp ?? new Date(Date.now());\n    this.name = 'CallError';\n    this.message = `${this.target}: ${this.innerError.message}`;\n  }\n\n}\n/**\n * String literal type for all permissible keys in {@Link CallErrors}.\n *\n * @public\n */\n\nexport type CallErrorTarget = 'Call.addParticipant' | 'Call.feature' | 'Call.hangUp' | 'Call.hold' | 'Call.mute' | 'Call.off' | 'Call.on' | 'Call.removeParticipant' | 'Call.resume' | 'Call.sendDtmf' | 'Call.startScreenSharing' | 'Call.startVideo' | 'Call.stopScreenSharing' | 'Call.stopVideo' | 'Call.unmute' | 'CallAgent.dispose' | 'CallAgent.feature' | 'CallAgent.join' | 'CallAgent.off' | 'CallAgent.on' | 'CallAgent.startCall' | 'CallClient.createCallAgent' | 'CallClient.feature' | 'CallClient.getDeviceManager' | 'DeviceManager.askDevicePermission' | 'DeviceManager.getCameras' | 'DeviceManager.getMicrophones' | 'DeviceManager.getSpeakers' | 'DeviceManager.off' | 'DeviceManager.on' | 'DeviceManager.selectMicrophone' | 'DeviceManager.selectSpeaker' | 'IncomingCall.accept' | 'IncomingCall.reject';\n/**\n * State only proxy for {@link @azure/communication-calling#DiagnosticsCallFeature}.\n *\n * @public\n */\n\nexport interface DiagnosticsCallFeatureState {\n  /**\n   * Stores diagnostics related to network conditions.\n   */\n  network: NetworkDiagnosticsState;\n  /**\n   * Stores diagnostics related to media quality.\n   */\n\n  media: MediaDiagnosticsState;\n}\n/**\n * State only proxy for {@link @azure/communication-calling#NetworkDiagnostics}.\n *\n * @public\n */\n\nexport interface NetworkDiagnosticsState {\n  latest: LatestNetworkDiagnostics;\n}\n/**\n * State only proxy for {@link @azure/communication-calling#MediaDiagnostics}.\n *\n * @public\n */\n\nexport interface MediaDiagnosticsState {\n  latest: LatestMediaDiagnostics;\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { createClientLogger } from '@azure/logger';\n/**\n * @private\n */\n\nexport const callingStatefulLogger = createClientLogger('communication-react:calling-stateful');\n/**\n * @private\n */\n\nexport enum EventNames {\n  // Info\n  LOCAL_VIEW_RENDER_SUCCEED = 'LOCAL_VIEW_RENDER_SUCCEED',\n  START_DISPOSE_LOCAL_STREAM = 'START_DISPOSE_LOCAL_STREAM',\n  START_DISPOSE_REMOTE_STREAM = 'START_DISPOSE_REMOTE_STREAM',\n  START_LOCAL_STREAM_RENDERING = 'START_LOCAL_STREAM_RENDERING',\n  DISPOSING_LOCAL_RENDERER = 'DISPOSING_LOCAL_RENDERER',\n  DISPOSING_REMOTE_RENDERER = 'DISPOSING_REMOTE_RENDERER',\n  CREATING_REMOTE_VIEW = 'CREATING_REMOTE_VIEW',\n  REMOTE_VIEW_RENDER_SUCCEED = 'REMOTE_VIEW_RENDER_SUCCEED',\n  // Warning\n  CREATE_STREAM_INVALID_PARAMS = 'CREATE_STREAM_INVALID_PARAMS',\n  DISPOSE_STREAM_INVALID_PARAMS = 'DISPOSE_LOCAL_STREAM_INVALID_PARAMS',\n  LOCAL_STREAM_ALREADY_RENDERED = 'LOCAL_STREAM_ALREADY_RENDERED',\n  LOCAL_STREAM_ALREADY_DISPOSED = 'LOCAL_STREAM_ALREADY_DISPOSED',\n  LOCAL_STREAM_STOPPING = 'LOCAL_STREAM_STOPPING',\n  LOCAL_CREATED_STREAM_STOPPING = 'LOCAL_CREATED_STREAM_STOPPING',\n  LOCAL_STREAM_RENDERING = 'LOCAL_STREAM_RENDERING',\n  REMOTE_STREAM_ALREADY_RENDERED = 'REMOTE_STREAM_ALREADY_RENDERED',\n  REMOTE_STREAM_RENDERING = 'REMOTE_STREAM_RENDERING',\n  REMOTE_STREAM_STOPPING = 'REMOTE_STREAM_STOPPING',\n  // Error\n  LOCAL_STREAM_NOT_FOUND = 'LOCAL_STREAM_NOT_FOUND',\n  LOCAL_RENDER_INFO_NOT_FOUND = 'LOCAL_RENDER_INFO_NOT_FOUND',\n  REMOTE_STREAM_NOT_FOUND = 'REMOTE_STREAM_NOT_FOUND',\n  LOCAL_DISPOSE_INFO_NOT_FOUND = 'LOCAL_DISPOSE_INFO_NOT_FOUND',\n  REMOTE_DISPOSE_INFO_NOT_FOUND = 'REMOTE_DISPOSE_INFO_NOT_FOUND',\n  REMOTE_RENDER_INFO_NOT_FOUND = 'REMOTE_RENDER_INFO_NOT_FOUND',\n  LOCAL_RENDERER_NOT_FOUND = 'LOCAL_RENDERER_NOT_FOUND',\n  REMOTE_RENDERER_NOT_FOUND = 'REMOTE_RENDERER_NOT_FOUND',\n  CREATE_REMOTE_STREAM_FAIL = 'CREATE_REMOTE_STREAM_FAIL',\n  CREATE_LOCAL_STREAM_FAIL = 'CREATE_LOCAL_STREAM_FAIL',\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/**\n * @private\n * Call Id will change during the call for at least 1 time\n * This is to avoid async bug that call id has been changed during an async-await function\n * but the function still uses stale call id to access state\n */\nexport class CallIdHistory {\n  private _callIdHistory = new Map<string, string>();\n\n  public updateCallIdHistory(newCallId: string, oldCallId: string): void {\n    // callId for a call can fluctuate between some set of values.\n    // But if a newCallId already exists, and maps to different call, we're in trouble.\n    // This can only happen if a callId is reused across two distinct calls.\n    const existing = this._callIdHistory.get(newCallId);\n\n    if (existing !== undefined && this.latestCallId(newCallId) !== oldCallId) {\n      console.trace(`${newCallId} alredy exists and maps to ${existing}, which is not the same as ${oldCallId}`);\n    } // The latest callId never maps to another callId.\n\n\n    this._callIdHistory.delete(newCallId);\n\n    this._callIdHistory.set(oldCallId, newCallId);\n  }\n\n  public latestCallId(callId: string): string {\n    let latest = callId;\n    /* eslint no-constant-condition: [\"error\", { \"checkLoops\": false }] */\n\n    while (true) {\n      const newer = this._callIdHistory.get(latest);\n\n      if (newer === undefined) {\n        break;\n      }\n\n      latest = newer;\n    }\n\n    return latest;\n  }\n\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CommunicationIdentifierKind } from '@azure/communication-common';\nimport { AudioDeviceInfo, DeviceAccess, DominantSpeakersInfo, VideoDeviceInfo } from '@azure/communication-calling';\nimport { AzureLogger, createClientLogger, getLogLevel } from '@azure/logger';\nimport EventEmitter from 'events';\nimport { enableMapSet, enablePatches, Patch, produce } from 'immer';\nimport { CallEndReason, CallState as CallStatus, RemoteParticipantState as RemoteParticipantStatus } from '@azure/communication-calling';\nimport { _safeJSONStringify, toFlatCommunicationIdentifier } from '@internal/acs-ui-common';\nimport { CallState, CallClientState, LocalVideoStreamState, RemoteParticipantState, RemoteVideoStreamState, IncomingCallState, VideoStreamRendererViewState, CallAgentState, CallErrors, CallErrorTarget, CallError } from './CallClientState';\nimport { callingStatefulLogger } from './Logger';\nimport { CallIdHistory } from './CallIdHistory';\nenableMapSet(); // Needed to generate state diff for verbose logging.\n\nenablePatches(); // TODO: How can we make this configurable?\n\n/**\n * @private\n */\n\nexport const MAX_CALL_HISTORY_LENGTH = 10;\n/**\n * @private\n */\n\nexport class CallContext {\n  private _logger: AzureLogger;\n  private _state: CallClientState;\n  private _emitter: EventEmitter;\n  private _atomicId: number;\n  private _callIdHistory: CallIdHistory = new CallIdHistory();\n\n  constructor(userId: CommunicationIdentifierKind, maxListeners = 50,\n  /* @conditional-compile-remove(PSTN-calls) */\n  alternateCallerId?: string) {\n    this._logger = createClientLogger('communication-react:calling-context');\n    this._state = {\n      calls: {},\n      callsEnded: {},\n      incomingCalls: {},\n      incomingCallsEnded: {},\n      deviceManager: {\n        isSpeakerSelectionAvailable: false,\n        cameras: [],\n        microphones: [],\n        speakers: [],\n        unparentedViews: []\n      },\n      callAgent: undefined,\n      userId: userId,\n      latestErrors: ({} as CallErrors)\n    };\n    this._emitter = new EventEmitter();\n\n    this._emitter.setMaxListeners(maxListeners);\n\n    this._atomicId = 0;\n  }\n\n  public getState(): CallClientState {\n    return this._state;\n  }\n\n  public modifyState(modifier: (draft: CallClientState) => void): void {\n    const priorState = this._state;\n    this._state = produce(this._state, modifier, (patches: Patch[]) => {\n      if (getLogLevel() === 'verbose') {\n        // Log to `info` because AzureLogger.verbose() doesn't show up in console.\n        this._logger.info(`State change: ${_safeJSONStringify(patches)}`);\n      }\n    });\n\n    if (this._state !== priorState) {\n      this._emitter.emit('stateChanged', this._state);\n    }\n  }\n\n  public onStateChange(handler: (state: CallClientState) => void): void {\n    this._emitter.on('stateChanged', handler);\n  }\n\n  public offStateChange(handler: (state: CallClientState) => void): void {\n    this._emitter.off('stateChanged', handler);\n  } // Disposing of the CallAgentDeclarative will not clear the state. If we create a new CallAgentDeclarative, we should\n  // make sure the state is clean because any left over state (if previous CallAgentDeclarative was disposed) may be\n  // invalid.\n\n\n  public clearCallRelatedState(): void {\n    this.modifyState((draft: CallClientState) => {\n      draft.calls = {};\n      draft.incomingCalls = {};\n      draft.callsEnded = {};\n      draft.incomingCallsEnded = {};\n    });\n  }\n\n  public setCallAgent(callAgent: CallAgentState): void {\n    this.modifyState((draft: CallClientState) => {\n      draft.callAgent = callAgent;\n    });\n  }\n\n  public setCall(call: CallState): void {\n    this.modifyState((draft: CallClientState) => {\n      const latestCallId = this._callIdHistory.latestCallId(call.id);\n\n      const existingCall = draft.calls[latestCallId];\n\n      if (existingCall) {\n        existingCall.callerInfo = call.callerInfo;\n        existingCall.state = call.state;\n        existingCall.callEndReason = call.callEndReason;\n        existingCall.direction = call.direction;\n        existingCall.isMuted = call.isMuted;\n        existingCall.isScreenSharingOn = call.isScreenSharingOn;\n        existingCall.localVideoStreams = call.localVideoStreams;\n        existingCall.remoteParticipants = call.remoteParticipants;\n        existingCall.transcription.isTranscriptionActive = call.transcription.isTranscriptionActive;\n        existingCall.recording.isRecordingActive = call.recording.isRecordingActive; // We don't update the startTime and endTime if we are updating an existing active call\n      } else {\n        draft.calls[latestCallId] = call;\n      }\n    });\n  }\n\n  public removeCall(callId: string): void {\n    this.modifyState((draft: CallClientState) => {\n      delete draft.calls[this._callIdHistory.latestCallId(callId)];\n    });\n  }\n\n  public setCallEnded(callId: string, callEndReason: CallEndReason | undefined): void {\n    const latestCallId = this._callIdHistory.latestCallId(callId);\n\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[latestCallId];\n\n      if (call) {\n        call.endTime = new Date();\n        call.callEndReason = callEndReason;\n        delete draft.calls[latestCallId]; // Performance note: This loop should run only once because the number of entries\n        // is never allowed to exceed MAX_CALL_HISTORY_LENGTH. A loop is used for correctness.\n\n        while (Object.keys(draft.callsEnded).length >= MAX_CALL_HISTORY_LENGTH) {\n          delete draft.callsEnded[findOldestCallEnded(draft.callsEnded)];\n        }\n\n        draft.callsEnded[latestCallId] = call;\n      }\n    });\n  }\n\n  public setCallState(callId: string, state: CallStatus): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[this._callIdHistory.latestCallId(callId)];\n\n      if (call) {\n        call.state = state;\n      }\n    });\n  }\n\n  public setCallId(newCallId: string, oldCallId: string): void {\n    this._callIdHistory.updateCallIdHistory(newCallId, oldCallId);\n\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[oldCallId];\n\n      if (call) {\n        call.id = newCallId;\n        delete draft.calls[oldCallId];\n        draft.calls[newCallId] = call;\n      }\n    });\n  }\n\n  public setCallIsScreenSharingOn(callId: string, isScreenSharingOn: boolean): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[this._callIdHistory.latestCallId(callId)];\n\n      if (call) {\n        call.isScreenSharingOn = isScreenSharingOn;\n      }\n    });\n  }\n\n  public setCallRemoteParticipants(callId: string, addRemoteParticipant: RemoteParticipantState[], removeRemoteParticipant: string[]): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[this._callIdHistory.latestCallId(callId)];\n\n      if (call) {\n        removeRemoteParticipant.forEach((id: string) => {\n          delete call.remoteParticipants[id];\n        });\n        addRemoteParticipant.forEach((participant: RemoteParticipantState) => {\n          call.remoteParticipants[toFlatCommunicationIdentifier(participant.identifier)] = participant;\n        });\n      }\n    });\n  }\n\n  public setCallRemoteParticipantsEnded(callId: string, addRemoteParticipant: RemoteParticipantState[], removeRemoteParticipant: string[]): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[this._callIdHistory.latestCallId(callId)];\n\n      if (call) {\n        removeRemoteParticipant.forEach((id: string) => {\n          delete call.remoteParticipantsEnded[id];\n        });\n        addRemoteParticipant.forEach((participant: RemoteParticipantState) => {\n          call.remoteParticipantsEnded[toFlatCommunicationIdentifier(participant.identifier)] = participant;\n        });\n      }\n    });\n  }\n\n  public setCallLocalVideoStream(callId: string, streams: LocalVideoStreamState[]): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[this._callIdHistory.latestCallId(callId)];\n\n      if (call) {\n        call.localVideoStreams = streams;\n      }\n    });\n  }\n\n  public setCallIsMicrophoneMuted(callId: string, isMicrophoneMuted: boolean): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[this._callIdHistory.latestCallId(callId)];\n\n      if (call) {\n        call.isMuted = isMicrophoneMuted;\n      }\n    });\n  }\n\n  public setCallDominantSpeakers(callId: string, dominantSpeakers: DominantSpeakersInfo): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[this._callIdHistory.latestCallId(callId)];\n\n      if (call) {\n        call.dominantSpeakers = dominantSpeakers;\n      }\n    });\n  }\n\n  public setCallRecordingActive(callId: string, isRecordingActive: boolean): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[this._callIdHistory.latestCallId(callId)];\n\n      if (call) {\n        call.recording.isRecordingActive = isRecordingActive;\n      }\n    });\n  }\n\n  public setCallTranscriptionActive(callId: string, isTranscriptionActive: boolean): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[this._callIdHistory.latestCallId(callId)];\n\n      if (call) {\n        call.transcription.isTranscriptionActive = isTranscriptionActive;\n      }\n    });\n  }\n\n  public setCallScreenShareParticipant(callId: string, participantKey: string | undefined): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[this._callIdHistory.latestCallId(callId)];\n\n      if (call) {\n        call.screenShareRemoteParticipant = participantKey;\n      }\n    });\n  }\n\n  public setLocalVideoStreamRendererView(callId: string, view: VideoStreamRendererViewState | undefined): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[this._callIdHistory.latestCallId(callId)];\n\n      if (call) {\n        if (call.localVideoStreams.length > 0) {\n          call.localVideoStreams[0].view = view;\n        }\n      }\n    });\n  }\n\n  public setParticipantState(callId: string, participantKey: string, state: RemoteParticipantStatus): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[this._callIdHistory.latestCallId(callId)];\n\n      if (call) {\n        const participant = call.remoteParticipants[participantKey];\n\n        if (participant) {\n          participant.state = state;\n        }\n      }\n    });\n  }\n\n  public setParticipantIsMuted(callId: string, participantKey: string, muted: boolean): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[this._callIdHistory.latestCallId(callId)];\n\n      if (call) {\n        const participant = call.remoteParticipants[participantKey];\n\n        if (participant) {\n          participant.isMuted = muted;\n        }\n      }\n    });\n  }\n\n  public setParticipantDisplayName(callId: string, participantKey: string, displayName: string): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[this._callIdHistory.latestCallId(callId)];\n\n      if (call) {\n        const participant = call.remoteParticipants[participantKey];\n\n        if (participant) {\n          participant.displayName = displayName;\n        }\n      }\n    });\n  }\n\n  public setParticipantIsSpeaking(callId: string, participantKey: string, isSpeaking: boolean): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[this._callIdHistory.latestCallId(callId)];\n\n      if (call) {\n        const participant = call.remoteParticipants[participantKey];\n\n        if (participant) {\n          participant.isSpeaking = isSpeaking;\n        }\n      }\n    });\n  }\n\n  public setParticipantVideoStream(callId: string, participantKey: string, stream: RemoteVideoStreamState): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[this._callIdHistory.latestCallId(callId)];\n\n      if (call) {\n        const participant = call.remoteParticipants[participantKey];\n\n        if (participant) {\n          // Set is called by subscriber will not modify any rendered stream so if there is existing stream only\n          // modify the values that subscriber has access to.\n          const existingStream = participant.videoStreams[stream.id];\n\n          if (existingStream) {\n            existingStream.isAvailable = stream.isAvailable;\n            existingStream.mediaStreamType = stream.mediaStreamType;\n          } else {\n            participant.videoStreams[stream.id] = stream;\n          }\n        }\n      }\n    });\n  }\n\n  public setRemoteVideoStreamIsAvailable(callId: string, participantKey: string, streamId: number, isAvailable: boolean): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[this._callIdHistory.latestCallId(callId)];\n\n      if (call) {\n        const participant = call.remoteParticipants[participantKey];\n\n        if (participant) {\n          const stream = participant.videoStreams[streamId];\n\n          if (stream) {\n            stream.isAvailable = isAvailable;\n          }\n        }\n      }\n    });\n  }\n\n  public setRemoteVideoStreams(callId: string, participantKey: string, addRemoteVideoStream: RemoteVideoStreamState[], removeRemoteVideoStream: number[]): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[this._callIdHistory.latestCallId(callId)];\n\n      if (call) {\n        const participant = call.remoteParticipants[participantKey];\n\n        if (participant) {\n          for (const id of removeRemoteVideoStream) {\n            delete participant.videoStreams[id];\n          }\n\n          for (const newStream of addRemoteVideoStream) {\n            // This should only be called by the subscriber and some properties are add by other components so if the\n            // stream already exists, only update the values that subscriber knows about.\n            const stream = participant.videoStreams[newStream.id];\n\n            if (stream) {\n              stream.mediaStreamType = newStream.mediaStreamType;\n              stream.isAvailable = newStream.isAvailable;\n            } else {\n              participant.videoStreams[newStream.id] = newStream;\n            }\n          }\n        }\n      }\n    });\n  }\n\n  public setRemoteVideoStreamRendererView(callId: string, participantKey: string, streamId: number, view: VideoStreamRendererViewState | undefined): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.calls[this._callIdHistory.latestCallId(callId)];\n\n      if (call) {\n        const participant = call.remoteParticipants[participantKey];\n\n        if (participant) {\n          const stream = participant.videoStreams[streamId];\n\n          if (stream) {\n            stream.view = view;\n          }\n        }\n      }\n    });\n  }\n\n  public setIncomingCall(call: IncomingCallState): void {\n    this.modifyState((draft: CallClientState) => {\n      const existingCall = draft.incomingCalls[call.id];\n\n      if (existingCall) {\n        existingCall.callerInfo = call.callerInfo;\n      } else {\n        draft.incomingCalls[call.id] = call;\n      }\n    });\n  }\n\n  public removeIncomingCall(callId: string): void {\n    this.modifyState((draft: CallClientState) => {\n      delete draft.incomingCalls[callId];\n    });\n  }\n\n  public setIncomingCallEnded(callId: string, callEndReason: CallEndReason | undefined): void {\n    this.modifyState((draft: CallClientState) => {\n      const call = draft.incomingCalls[callId];\n\n      if (call) {\n        call.endTime = new Date();\n        call.callEndReason = callEndReason;\n        delete draft.incomingCalls[callId]; // Performance note: This loop should run only once because the number of entries\n        // is never allowed to exceed MAX_CALL_HISTORY_LENGTH. A loop is used for correctness.\n\n        while (Object.keys(draft.incomingCallsEnded).length >= MAX_CALL_HISTORY_LENGTH) {\n          delete draft.incomingCallsEnded[findOldestCallEnded(draft.incomingCallsEnded)];\n        }\n\n        draft.incomingCallsEnded[callId] = call;\n      }\n    });\n  }\n\n  public setDeviceManagerIsSpeakerSelectionAvailable(isSpeakerSelectionAvailable: boolean): void {\n    this.modifyState((draft: CallClientState) => {\n      draft.deviceManager.isSpeakerSelectionAvailable = isSpeakerSelectionAvailable;\n    });\n  }\n\n  public setDeviceManagerSelectedMicrophone(selectedMicrophone?: AudioDeviceInfo): void {\n    this.modifyState((draft: CallClientState) => {\n      draft.deviceManager.selectedMicrophone = selectedMicrophone;\n    });\n  }\n\n  public setDeviceManagerSelectedSpeaker(selectedSpeaker?: AudioDeviceInfo): void {\n    this.modifyState((draft: CallClientState) => {\n      draft.deviceManager.selectedSpeaker = selectedSpeaker;\n    });\n  }\n\n  public setDeviceManagerSelectedCamera(selectedCamera?: VideoDeviceInfo): void {\n    this.modifyState((draft: CallClientState) => {\n      draft.deviceManager.selectedCamera = selectedCamera;\n    });\n  }\n\n  public setDeviceManagerCameras(cameras: VideoDeviceInfo[]): void {\n    this.modifyState((draft: CallClientState) => {\n      /**\n       * SDK initializes cameras with one dummy camera with value { id: 'camera:id', name: '', deviceType: 'USBCamera' } immediately after\n       * camera permissions are granted. So selectedCamera will have this value before the actual cameras are obtained. Therefore we should reset\n       * selectedCamera to the first camera when there are cameras AND when current selectedCamera does not exist in the new array of cameras *\n       */\n      if (cameras.length > 0 && !cameras.some(camera => camera.id === draft.deviceManager.selectedCamera?.id)) {\n        draft.deviceManager.selectedCamera = cameras[0];\n      }\n\n      draft.deviceManager.cameras = cameras;\n    });\n  }\n\n  public setDeviceManagerMicrophones(microphones: AudioDeviceInfo[]): void {\n    this.modifyState((draft: CallClientState) => {\n      draft.deviceManager.microphones = microphones;\n    });\n  }\n\n  public setDeviceManagerSpeakers(speakers: AudioDeviceInfo[]): void {\n    this.modifyState((draft: CallClientState) => {\n      draft.deviceManager.speakers = speakers;\n    });\n  }\n\n  public setDeviceManagerDeviceAccess(deviceAccess: DeviceAccess): void {\n    this.modifyState((draft: CallClientState) => {\n      draft.deviceManager.deviceAccess = deviceAccess;\n    });\n  }\n\n  public setDeviceManagerUnparentedView(localVideoStream: LocalVideoStreamState, view: VideoStreamRendererViewState | undefined): void {\n    this.modifyState((draft: CallClientState) => {\n      draft.deviceManager.unparentedViews.push({\n        source: localVideoStream.source,\n        mediaStreamType: localVideoStream.mediaStreamType,\n        view: view\n      });\n    });\n  }\n\n  public deleteDeviceManagerUnparentedView(localVideoStream: LocalVideoStreamState): void {\n    this.modifyState((draft: CallClientState) => {\n      const foundIndex = draft.deviceManager.unparentedViews.findIndex(stream => stream.source.id === localVideoStream.source.id && stream.mediaStreamType === localVideoStream.mediaStreamType);\n\n      if (foundIndex !== -1) {\n        draft.deviceManager.unparentedViews.splice(foundIndex, 1);\n      }\n    });\n  }\n\n  public getAndIncrementAtomicId(): number {\n    const id = this._atomicId;\n    this._atomicId++;\n    return id;\n  }\n  /**\n   * Tees any errors encountered in an async function to the state.\n   *\n   * @param action Async function to execute.\n   * @param target The error target to tee error to.\n   * @returns Result of calling `f`. Also re-raises any exceptions thrown from `f`.\n   * @throws CallError. Exceptions thrown from `f` are tagged with the failed `target.\n   */\n\n\n  public withAsyncErrorTeedToState<Args extends unknown[], R>(action: (...args: Args) => Promise<R>, target: CallErrorTarget): (...args: Args) => Promise<R> {\n    return async (...args: Args): Promise<R> => {\n      try {\n        return await action(...args);\n      } catch (error) {\n        const callError = toCallError(target, error);\n        this.setLatestError(target, callError);\n        throw callError;\n      }\n    };\n  }\n  /**\n   * Tees any errors encountered in an function to the state.\n   *\n   * @param action Function to execute.\n   * @param target The error target to tee error to.\n   * @returns Result of calling `f`. Also re-raises any exceptions thrown from `f`.\n   * @throws CallError. Exceptions thrown from `f` are tagged with the failed `target.\n   */\n\n\n  public withErrorTeedToState<Args extends unknown[], R>(action: (...args: Args) => R, target: CallErrorTarget): (...args: Args) => R {\n    return (...args: Args): R => {\n      try {\n        callingStatefulLogger.info(`Calling stateful client target function called: ${target}`);\n        return action(...args);\n      } catch (error) {\n        const callError = toCallError(target, error);\n        this.setLatestError(target, callError);\n        throw callError;\n      }\n    };\n  }\n\n  private setLatestError(target: CallErrorTarget, error: CallError): void {\n    this.modifyState((draft: CallClientState) => {\n      draft.latestErrors[target] = error;\n    });\n  }\n\n}\n\nconst toCallError = (target: CallErrorTarget, error: unknown): CallError => {\n  if (error instanceof Error) {\n    return new CallError(target, error);\n  }\n\n  return new CallError(target, new Error((error as string)));\n};\n\nconst findOldestCallEnded = (calls: {\n  [key: string]: {\n    endTime?: Date;\n  };\n}): string => {\n  const callEntries = Object.entries(calls);\n  let [oldestCallId, oldestCall] = callEntries[0];\n\n  if (oldestCall.endTime === undefined) {\n    return oldestCallId;\n  }\n\n  for (const [callId, call] of callEntries.slice(1)) {\n    if (call.endTime === undefined) {\n      return callId;\n    }\n\n    if ((call.endTime?.getTime() ?? 0) < (oldestCall.endTime?.getTime() ?? 0)) {\n      [oldestCallId, oldestCall] = [callId, call];\n    }\n  }\n\n  return oldestCallId;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Call } from '@azure/communication-calling';\nimport { CallContext } from './CallContext';\n/**\n * TODO: This should likely be exported?\n *\n * @private\n */\n\nexport interface DeclarativeCall extends Call {\n  /**\n   * Stop any declarative specific subscriptions and remove declarative subscribers.\n   */\n  unsubscribe(): void;\n}\n\nclass ProxyCall implements ProxyHandler<Call> {\n  private _context: CallContext;\n\n  constructor(context: CallContext) {\n    this._context = context;\n  }\n\n  public unsubscribe(): void {\n    /** No subscriptions yet. But there will be one for transfer feature soon. */\n  }\n\n  public get<P extends keyof Call>(target: Call, prop: P): any {\n    switch (prop) {\n      case 'mute':\n        {\n          return this._context.withAsyncErrorTeedToState(async function (...args: Parameters<Call['mute']>) {\n            return await target.mute(...args);\n          }, 'Call.mute');\n        }\n\n      case 'unmute':\n        {\n          return this._context.withAsyncErrorTeedToState(async function (...args: Parameters<Call['unmute']>) {\n            return await target.unmute(...args);\n          }, 'Call.unmute');\n        }\n\n      case 'startVideo':\n        {\n          return this._context.withAsyncErrorTeedToState(async function (...args: Parameters<Call['startVideo']>) {\n            return await target.startVideo(...args);\n          }, 'Call.startVideo');\n        }\n\n      case 'stopVideo':\n        {\n          return this._context.withAsyncErrorTeedToState(async function (...args: Parameters<Call['stopVideo']>) {\n            return await target.stopVideo(...args);\n          }, 'Call.stopVideo');\n        }\n\n      case 'startScreenSharing':\n        {\n          return this._context.withAsyncErrorTeedToState(async function (...args: Parameters<Call['startScreenSharing']>) {\n            return await target.startScreenSharing(...args);\n          }, 'Call.startScreenSharing');\n        }\n\n      case 'stopScreenSharing':\n        {\n          return this._context.withAsyncErrorTeedToState(async function (...args: Parameters<Call['stopScreenSharing']>) {\n            return await target.stopScreenSharing(...args);\n          }, 'Call.stopScreenSharing');\n        }\n\n      case 'hold':\n        {\n          return this._context.withAsyncErrorTeedToState(async function (...args: Parameters<Call['hold']>) {\n            return await target.hold(...args);\n          }, 'Call.hold');\n        }\n\n      case 'resume':\n        {\n          return this._context.withAsyncErrorTeedToState(async function (...args: Parameters<Call['resume']>) {\n            return await target.resume(...args);\n          }, 'Call.resume');\n        }\n\n      case 'addParticipant':\n        {\n          return this._context.withAsyncErrorTeedToState(async function (...args: Parameters<Call['addParticipant']>) {\n            return await target.addParticipant(...args);\n          }, 'Call.addParticipant');\n        }\n\n      default:\n        return Reflect.get(target, prop);\n    }\n  }\n\n}\n/**\n * Creates a declarative Call by proxying Call with ProxyCall.\n * This should only be used with CallAgentDeclarative as CallAgentDeclarative will add that\n * call to the context properly (need to have the Call in context to update it - CallAgentDeclarative will add Call to\n * context)\n *\n * @param call - Call from SDK\n * @param context - CallContext from StatefulCallClient\n */\n\n\nexport const callDeclaratify = (call: Call, context: CallContext): DeclarativeCall => {\n  const proxyCall = new ProxyCall(context);\n  Object.defineProperty(call, 'unsubscribe', {\n    configurable: false,\n    value: () => proxyCall.unsubscribe()\n  });\n  return (new Proxy(call, proxyCall) as DeclarativeCall);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Call as SdkCall, RemoteParticipant as SdkRemoteParticipant, RemoteVideoStream as SdkRemoteVideoStream, LocalVideoStream as SdkLocalVideoStream, IncomingCall as SdkIncomingCall, VideoStreamRendererView } from '@azure/communication-calling';\nimport { toFlatCommunicationIdentifier } from '@internal/acs-ui-common';\nimport { CallState, RemoteParticipantState as DeclarativeRemoteParticipant, RemoteVideoStreamState as DeclarativeRemoteVideoStream, LocalVideoStreamState as DeclarativeLocalVideoStream, IncomingCallState as DeclarativeIncomingCall, VideoStreamRendererViewState as DeclarativeVideoStreamRendererView } from './CallClientState';\n/**\n * @private\n */\n\nexport function convertSdkLocalStreamToDeclarativeLocalStream(stream: SdkLocalVideoStream): DeclarativeLocalVideoStream {\n  return {\n    source: stream.source,\n    mediaStreamType: stream.mediaStreamType,\n    view: undefined\n  };\n}\n/**\n * @private\n */\n\nexport function convertSdkRemoteStreamToDeclarativeRemoteStream(stream: SdkRemoteVideoStream): DeclarativeRemoteVideoStream {\n  return {\n    id: stream.id,\n    mediaStreamType: stream.mediaStreamType,\n    isAvailable: stream.isAvailable,\n    view: undefined\n  };\n}\n/**\n * @private\n */\n\nexport function convertSdkParticipantToDeclarativeParticipant(participant: SdkRemoteParticipant): DeclarativeRemoteParticipant {\n  const declarativeVideoStreams = {};\n\n  for (const videoStream of participant.videoStreams) {\n    declarativeVideoStreams[videoStream.id] = convertSdkRemoteStreamToDeclarativeRemoteStream(videoStream);\n  }\n\n  return {\n    identifier: participant.identifier,\n    displayName: participant.displayName,\n    state: participant.state,\n    callEndReason: participant.callEndReason,\n    videoStreams: declarativeVideoStreams,\n    isMuted: participant.isMuted,\n    isSpeaking: participant.isSpeaking\n  };\n}\n/**\n * @private\n *\n * Note at the time of writing only one LocalVideoStream is supported by the SDK.\n */\n\nexport function convertSdkCallToDeclarativeCall(call: SdkCall): CallState {\n  const declarativeRemoteParticipants = {};\n  call.remoteParticipants.forEach((participant: SdkRemoteParticipant) => {\n    declarativeRemoteParticipants[toFlatCommunicationIdentifier(participant.identifier)] = convertSdkParticipantToDeclarativeParticipant(participant);\n  });\n  return {\n    id: call.id,\n    callerInfo: call.callerInfo,\n    state: call.state,\n    callEndReason: call.callEndReason,\n    diagnostics: {\n      network: {\n        latest: {}\n      },\n      media: {\n        latest: {}\n      }\n    },\n    direction: call.direction,\n    isMuted: call.isMuted,\n    isScreenSharingOn: call.isScreenSharingOn,\n    localVideoStreams: call.localVideoStreams.map(convertSdkLocalStreamToDeclarativeLocalStream),\n    remoteParticipants: declarativeRemoteParticipants,\n    remoteParticipantsEnded: {},\n    recording: {\n      isRecordingActive: false\n    },\n    transcription: {\n      isTranscriptionActive: false\n    },\n    screenShareRemoteParticipant: undefined,\n    startTime: new Date(),\n    endTime: undefined\n  };\n}\n/**\n * @private\n */\n\nexport function convertSdkIncomingCallToDeclarativeIncomingCall(call: SdkIncomingCall): DeclarativeIncomingCall {\n  return {\n    id: call.id,\n    callerInfo: call.callerInfo,\n    startTime: new Date(),\n    endTime: undefined\n  };\n}\n/**\n * @private\n */\n\nexport function convertFromSDKToDeclarativeVideoStreamRendererView(view: VideoStreamRendererView): DeclarativeVideoStreamRendererView {\n  return {\n    scalingMode: view.scalingMode,\n    isMirrored: view.isMirrored,\n    target: view.target\n  };\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { RemoteVideoStream } from '@azure/communication-calling';\nimport { RemoteVideoStreamState } from './CallClientState';\nimport { CallContext } from './CallContext';\nimport { CallIdRef } from './CallIdRef';\n/**\n * @private\n */\n\nexport class RemoteVideoStreamSubscriber {\n  private _callIdRef: CallIdRef;\n  private _participantKey: string;\n  private _remoteVideoStream: RemoteVideoStream;\n  private _context: CallContext;\n\n  constructor(callIdRef: CallIdRef, participantKey: string, remoteVideoStream: RemoteVideoStream, context: CallContext) {\n    this._callIdRef = callIdRef;\n    this._participantKey = participantKey;\n    this._remoteVideoStream = remoteVideoStream;\n    this._context = context;\n    this.subscribe();\n  }\n\n  private subscribe = (): void => {\n    this._remoteVideoStream.on('isAvailableChanged', this.isAvailableChanged);\n\n    this.checkAndUpdateScreenShareState();\n  };\n  public unsubscribe = (): void => {\n    this._remoteVideoStream.off('isAvailableChanged', this.isAvailableChanged);\n  };\n  private includesActiveScreenShareStream = (streams: {\n    [key: number]: RemoteVideoStreamState;\n  }): boolean => {\n    for (const stream of Object.values(streams)) {\n      if (stream.mediaStreamType === 'ScreenSharing' && stream.isAvailable) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n  /**\n   * Update the state with the active screen share stream. If there is an existing stream will overwrite it if this one\n   * is active (newer stream takes priority). If there is an existing stream and this one is set to unavailable, and the\n   * existing stream is different participant, then don't set the active screen share stream to undefined, else set it\n   * to undefined.\n   */\n\n  private checkAndUpdateScreenShareState = (): void => {\n    if (this._remoteVideoStream.mediaStreamType !== 'ScreenSharing') {\n      return;\n    }\n\n    if (this._remoteVideoStream.isAvailable) {\n      this._context.setCallScreenShareParticipant(this._callIdRef.callId, this._participantKey);\n\n      return;\n    }\n\n    const existingScreenShare = this._context.getState().calls[this._callIdRef.callId]?.screenShareRemoteParticipant; // If somehow we end up with an event where a RemoteParticipant's ScreenShare stream is set to\n    // unavailable but there exists already another different participant actively sharing, and they are still\n    // sharing then this event shouldn't set the screenShareRemoteParticipant to undefined.\n\n    if (!existingScreenShare || existingScreenShare === this._participantKey) {\n      this._context.setCallScreenShareParticipant(this._callIdRef.callId, undefined);\n\n      return;\n    }\n\n    const streams = this._context.getState().calls[this._callIdRef.callId]?.remoteParticipants[existingScreenShare]?.videoStreams;\n\n    if (!streams) {\n      this._context.setCallScreenShareParticipant(this._callIdRef.callId, undefined);\n\n      return;\n    } // If the existing ScreenShare that is not owned by the current RemoteParticipant is still active, don't\n    // overwrite it with undefined. So only overwrite if it is not active.\n\n\n    if (!this.includesActiveScreenShareStream(streams)) {\n      this._context.setCallScreenShareParticipant(this._callIdRef.callId, undefined);\n\n      return;\n    }\n  };\n  private isAvailableChanged = (): void => {\n    this._context.setRemoteVideoStreamIsAvailable(this._callIdRef.callId, this._participantKey, this._remoteVideoStream.id, this._remoteVideoStream.isAvailable);\n\n    this.checkAndUpdateScreenShareState();\n  };\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CreateViewOptions, LocalVideoStream, VideoStreamRenderer, VideoStreamRendererView } from '@azure/communication-calling';\nimport { CommunicationIdentifierKind } from '@azure/communication-common';\nimport { LocalVideoStreamState, RemoteVideoStreamState } from './CallClientState';\nimport { CallContext } from './CallContext';\nimport { convertSdkLocalStreamToDeclarativeLocalStream, convertSdkRemoteStreamToDeclarativeRemoteStream, convertFromSDKToDeclarativeVideoStreamRendererView } from './Converter';\nimport { InternalCallContext } from './InternalCallContext';\nimport { toFlatCommunicationIdentifier, _logEvent } from '@internal/acs-ui-common';\nimport { callingStatefulLogger, EventNames } from './Logger';\n/**\n * Return result from {@link StatefulCallClient.createView}.\n *\n * @public\n */\n\nexport type CreateViewResult = {\n  renderer: VideoStreamRenderer;\n  view: VideoStreamRendererView;\n};\n\nasync function createViewRemoteVideo(context: CallContext, internalContext: InternalCallContext, callId: string, participantId: CommunicationIdentifierKind | string, stream: RemoteVideoStreamState, options?: CreateViewOptions): Promise<CreateViewResult | undefined> {\n  // Render RemoteVideoStream that is part of a Call\n  const streamId = stream.id;\n  let participantKey;\n\n  if (typeof participantId === 'string') {\n    participantKey = participantId;\n  } else {\n    participantKey = toFlatCommunicationIdentifier(participantId);\n  }\n\n  const streamLogInfo = {\n    callId,\n    participantKey,\n    streamId\n  };\n\n  _logEvent(callingStatefulLogger, {\n    name: EventNames.CREATING_REMOTE_VIEW,\n    level: 'info',\n    message: 'Start creating view for remote video.',\n    data: streamLogInfo\n  });\n\n  const renderInfo = internalContext.getRemoteRenderInfoForParticipant(callId, participantKey, streamId);\n\n  if (!renderInfo) {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.REMOTE_STREAM_NOT_FOUND,\n      level: 'error',\n      message: 'RemoteVideoStream not found in state.',\n      data: streamLogInfo\n    });\n\n    console.warn('RemoteVideoStream not found in state');\n    return;\n  }\n\n  if (renderInfo.status === 'Rendered') {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.REMOTE_STREAM_ALREADY_RENDERED,\n      level: 'warning',\n      message: 'RemoteVideoStream is already rendered.',\n      data: streamLogInfo\n    });\n\n    console.warn('RemoteVideoStream is already rendered');\n    return;\n  }\n\n  if (renderInfo.status === 'Rendering') {\n    // Do not log to console here as this is a very common situation due to UI rerenders while\n    // the video rendering is in progress.\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.REMOTE_STREAM_RENDERING,\n      level: 'warning',\n      message: 'RemoteVideoStream is rendering.',\n      data: streamLogInfo\n    });\n\n    return;\n  }\n\n  if (renderInfo.status === 'Stopping') {\n    console.warn('RemoteVideoStream is in the middle of stopping');\n    return;\n  }\n\n  const renderer = new VideoStreamRenderer(renderInfo.stream);\n  internalContext.setRemoteRenderInfo(callId, participantKey, streamId, renderInfo.stream, 'Rendering', undefined);\n  let view;\n\n  try {\n    view = await renderer.createView(options);\n  } catch (e) {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.CREATE_REMOTE_STREAM_FAIL,\n      level: 'error',\n      message: 'Failed to create remote view',\n      data: streamLogInfo\n    });\n\n    internalContext.setRemoteRenderInfo(callId, participantKey, streamId, renderInfo.stream, 'NotRendered', undefined);\n    throw e;\n  }\n\n  const refreshedRenderInfo = internalContext.getRemoteRenderInfoForParticipant(callId, participantKey, streamId);\n\n  if (!refreshedRenderInfo) {\n    // RenderInfo was removed. This should not happen unless stream was removed from the call so dispose the renderer\n    // and clean up state.\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.REMOTE_RENDER_INFO_NOT_FOUND,\n      level: 'error',\n      message: '`Cannot find remote render info after create the view.',\n      data: streamLogInfo\n    });\n\n    renderer.dispose();\n    context.setRemoteVideoStreamRendererView(callId, participantKey, streamId, undefined);\n    return;\n  }\n\n  if (refreshedRenderInfo.status === 'Stopping') {\n    // Stop render was called on this stream after we had started rendering. We will dispose this view and do not\n    // put the view into the state.\n    renderer.dispose();\n    internalContext.setRemoteRenderInfo(callId, participantKey, streamId, refreshedRenderInfo.stream, 'NotRendered', undefined);\n    context.setRemoteVideoStreamRendererView(callId, participantKey, streamId, undefined);\n\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.REMOTE_VIEW_RENDER_SUCCEED,\n      level: 'info',\n      message: 'Successfully render the remote view.',\n      data: streamLogInfo\n    });\n\n    return;\n  } // Else the stream still exists and status is not telling us to stop rendering. Complete the render process by\n  // updating the state.\n\n\n  internalContext.setRemoteRenderInfo(callId, participantKey, streamId, refreshedRenderInfo.stream, 'Rendered', renderer);\n  context.setRemoteVideoStreamRendererView(callId, participantKey, streamId, convertFromSDKToDeclarativeVideoStreamRendererView(view));\n  return {\n    renderer,\n    view\n  };\n}\n\nasync function createViewLocalVideo(context: CallContext, internalContext: InternalCallContext, callId: string, options?: CreateViewOptions): Promise<CreateViewResult | undefined> {\n  _logEvent(callingStatefulLogger, {\n    name: EventNames.START_LOCAL_STREAM_RENDERING,\n    level: 'info',\n    message: 'Start creating view for local video.'\n  }); // Render LocalVideoStream that is part of a Call\n\n\n  const renderInfo = internalContext.getLocalRenderInfo(callId);\n\n  if (!renderInfo) {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.LOCAL_STREAM_NOT_FOUND,\n      level: 'error',\n      message: 'LocalVideoStream not found in state.'\n    });\n\n    console.warn('LocalVideoStream not found in state');\n    return;\n  }\n\n  if (renderInfo.status === 'Rendered') {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.LOCAL_STREAM_ALREADY_RENDERED,\n      level: 'warning',\n      message: 'LocalVideoStream is already rendered.'\n    });\n\n    console.warn('LocalVideoStream is already rendered');\n    return;\n  }\n\n  if (renderInfo.status === 'Rendering') {\n    // Do not log to console here as this is a very common situation due to UI rerenders while\n    // the video rendering is in progress.\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.LOCAL_STREAM_RENDERING,\n      level: 'warning',\n      message: 'LocalVideoStream is rendering.'\n    });\n\n    return;\n  } // \"Stopping\" only happens if the stream was in \"rendering\" but `disposeView` was called.\n  // Now that `createView` has been re-called, we can flip the state back to \"rendering\".\n\n\n  if (renderInfo.status === 'Stopping') {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.LOCAL_STREAM_STOPPING,\n      level: 'warning',\n      message: 'LocalVideoStream was marked as stopping by dispose view. Resetting state to \"Rendering\".'\n    });\n\n    internalContext.setLocalRenderInfo(callId, renderInfo.stream, 'Rendering', renderInfo.renderer);\n    return;\n  }\n\n  const renderer = new VideoStreamRenderer(renderInfo.stream);\n  internalContext.setLocalRenderInfo(callId, renderInfo.stream, 'Rendering', renderer);\n  let view;\n\n  try {\n    view = await renderer.createView(options);\n  } catch (e) {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.CREATE_LOCAL_STREAM_FAIL,\n      level: 'error',\n      message: 'Failed to create view.',\n      data: {\n        error: e\n      }\n    });\n\n    internalContext.setLocalRenderInfo(callId, renderInfo.stream, 'NotRendered', undefined);\n    throw e;\n  } // Since render could take some time, we need to check if the stream is still valid and if we received a signal to\n  // stop rendering.\n\n\n  const refreshedRenderInfo = internalContext.getLocalRenderInfo(callId);\n\n  if (!refreshedRenderInfo) {\n    // RenderInfo was removed. This should not happen unless stream was removed from the call so dispose the renderer\n    // and clean up the state.\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.LOCAL_RENDER_INFO_NOT_FOUND,\n      level: 'error',\n      message: 'Cannot find local render info after create the view. ',\n      data: {\n        callId\n      }\n    });\n\n    renderer.dispose();\n    context.setLocalVideoStreamRendererView(callId, undefined);\n    return;\n  }\n\n  if (refreshedRenderInfo.status === 'Stopping') {\n    // Stop render was called on this stream after we had started rendering. We will dispose this view and do not\n    // put the view into the state.\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.LOCAL_CREATED_STREAM_STOPPING,\n      level: 'warning',\n      message: 'Render info status is stopping, dispose renderer. ',\n      data: {\n        callId\n      }\n    });\n\n    renderer.dispose();\n    internalContext.setLocalRenderInfo(callId, refreshedRenderInfo.stream, 'NotRendered', undefined);\n    context.setLocalVideoStreamRendererView(callId, undefined);\n    return;\n  } // Else The stream still exists and status is not telling us to stop rendering. Complete the render process by\n  // updating the state.\n\n\n  internalContext.setLocalRenderInfo(callId, refreshedRenderInfo.stream, 'Rendered', renderer);\n  context.setLocalVideoStreamRendererView(callId, convertFromSDKToDeclarativeVideoStreamRendererView(view));\n\n  _logEvent(callingStatefulLogger, {\n    name: EventNames.LOCAL_VIEW_RENDER_SUCCEED,\n    level: 'info',\n    message: `Successfully render the local view.`,\n    data: {\n      callId\n    }\n  });\n\n  return {\n    renderer,\n    view\n  };\n}\n\nasync function createViewUnparentedVideo(context: CallContext, internalContext: InternalCallContext, stream: LocalVideoStreamState, options?: CreateViewOptions): Promise<CreateViewResult | undefined> {\n  const renderInfo = internalContext.getUnparentedRenderInfo(stream);\n\n  if (renderInfo && renderInfo.status === 'Rendered') {\n    console.warn('Unparented LocalVideoStream is already rendered');\n    return;\n  }\n\n  if (renderInfo && renderInfo.status === 'Rendering') {\n    // Do not log to console here as this is a very common situation due to UI rerenders while\n    // the video rendering is in progress.\n    return;\n  }\n\n  if (renderInfo && renderInfo.status === 'Stopping') {\n    console.warn('Unparented LocalVideoStream is in the middle of stopping');\n    return;\n  }\n\n  const localVideoStream = new LocalVideoStream(stream.source);\n  const renderer = new VideoStreamRenderer(localVideoStream);\n  internalContext.setUnparentedRenderInfo(stream, localVideoStream, 'Rendering', undefined);\n  let view: VideoStreamRendererView;\n\n  try {\n    view = await renderer.createView(options);\n  } catch (e) {\n    // Special case for unparented views. Since they are not tied to anything and created by us based on the calls to\n    // this function we'll delete it to clean up the data since keeping it around doesn't help us and if developer wants\n    // to create a new view they can check that the view is not rendered and call this function again.\n    internalContext.deleteUnparentedRenderInfo(stream);\n    throw e;\n  } // Since render could take some time, we need to check if the stream is still valid and if we received a signal to\n  // stop rendering.\n\n\n  const refreshedRenderInfo = internalContext.getUnparentedRenderInfo(stream);\n\n  if (!refreshedRenderInfo) {\n    // Unparented stream's RenderInfo was deleted. Currently this shouldn't happen but if it does we'll just dispose the\n    // renderer and clean up state. If developer wanted the stream they could call this function again and that should\n    // generate new working state via this function.\n    renderer.dispose();\n    context.deleteDeviceManagerUnparentedView(stream);\n    return;\n  }\n\n  if (refreshedRenderInfo.status === 'Stopping') {\n    // Stop render was called on this stream after we had started rendering. We will dispose this view and do not\n    // put the view into the state. Special case for unparented views, delete them from state when stopped to free up\n    // the memory since we were the ones generating this and not tied to any Call state.\n    internalContext.deleteUnparentedRenderInfo(stream);\n    context.deleteDeviceManagerUnparentedView(stream);\n    return;\n  } // Else the stream still exists and status is not telling us to stop rendering. Complete the render process by\n  // updating the state.\n\n\n  internalContext.setUnparentedRenderInfo(stream, localVideoStream, 'Rendered', renderer);\n  context.setDeviceManagerUnparentedView(stream, convertFromSDKToDeclarativeVideoStreamRendererView(view));\n  return {\n    renderer,\n    view\n  };\n}\n\nfunction disposeViewRemoteVideo(context: CallContext, internalContext: InternalCallContext, callId: string, participantId: CommunicationIdentifierKind | string, stream: RemoteVideoStreamState): void {\n  const streamId = stream.id;\n  let participantKey;\n\n  if (typeof participantId === 'string') {\n    participantKey = participantId;\n  } else {\n    participantKey = toFlatCommunicationIdentifier(participantId);\n  }\n\n  const streamLogInfo = {\n    callId,\n    participantKey,\n    streamId\n  };\n\n  _logEvent(callingStatefulLogger, {\n    name: EventNames.START_DISPOSE_REMOTE_STREAM,\n    level: 'info',\n    message: 'Start disposing remote stream.',\n    data: streamLogInfo\n  });\n\n  context.setRemoteVideoStreamRendererView(callId, participantKey, streamId, undefined);\n  const renderInfo = internalContext.getRemoteRenderInfoForParticipant(callId, participantKey, streamId);\n\n  if (!renderInfo) {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.REMOTE_DISPOSE_INFO_NOT_FOUND,\n      level: 'error',\n      message: 'Cannot find render info when disposing remote stream.',\n      data: streamLogInfo\n    });\n\n    return;\n  } // Sets the status and also renderer. I think we need to always set renderer to undefined since in all status when\n  // cleaned up should have renderer as undefined. If the status is 'Rendered' and renderer is not defined it should\n  // be cleaned up below so we can set it to undefined here.\n\n\n  if (renderInfo.status === 'Rendering') {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.REMOTE_STREAM_STOPPING,\n      level: 'info',\n      message: 'Remote stream is still rendering. Changing status to stopping.',\n      data: streamLogInfo\n    });\n\n    internalContext.setRemoteRenderInfo(callId, participantKey, streamId, renderInfo.stream, 'Stopping', undefined);\n  } else {\n    internalContext.setRemoteRenderInfo(callId, participantKey, streamId, renderInfo.stream, 'NotRendered', undefined);\n  }\n\n  if (renderInfo.renderer) {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.DISPOSING_REMOTE_RENDERER,\n      level: 'info',\n      message: 'Disposing remote view renderer.',\n      data: streamLogInfo\n    });\n\n    renderInfo.renderer.dispose();\n  } else {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.REMOTE_RENDERER_NOT_FOUND,\n      level: 'error',\n      message: 'Cannot find remote view renderer.',\n      data: streamLogInfo\n    });\n  }\n}\n\nfunction disposeViewLocalVideo(context: CallContext, internalContext: InternalCallContext, callId: string): void {\n  const streamLogInfo = {\n    callId\n  };\n\n  _logEvent(callingStatefulLogger, {\n    name: EventNames.START_DISPOSE_LOCAL_STREAM,\n    level: 'info',\n    message: 'Start disposing local stream.',\n    data: streamLogInfo\n  });\n\n  context.setLocalVideoStreamRendererView(callId, undefined);\n  const renderInfo = internalContext.getLocalRenderInfo(callId);\n\n  if (!renderInfo) {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.LOCAL_DISPOSE_INFO_NOT_FOUND,\n      level: 'error',\n      message: 'Cannot find render info when disposing local stream.',\n      data: streamLogInfo\n    });\n\n    return;\n  } // Nothing to dispose of or clean up -- we can safely exit early here.\n\n\n  if (renderInfo.status === 'NotRendered') {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.LOCAL_STREAM_ALREADY_DISPOSED,\n      level: 'info',\n      message: 'LocalVideoStream is already disposed.'\n    });\n\n    return;\n  } // Status is already marked as \"stopping\" so we can exit early here. This is because stopping only occurs\n  // when the stream is being created in createView but hasn't been completed being created yet. The createView\n  // method will see the \"stopping\" status and perform the cleanup\n\n\n  if (renderInfo.status === 'Stopping') {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.LOCAL_STREAM_STOPPING,\n      level: 'info',\n      message: 'Local stream is already stopping.',\n      data: streamLogInfo\n    });\n\n    return;\n  } // If the stream is in the middle of being rendered (i.e. has state \"Rendering\"), we need the status as\n  // \"stopping\" without performing any cleanup. This will tell the `createView` method that it should stop\n  // rendering and clean up the state once the view has finished being created.\n\n\n  if (renderInfo.status === 'Rendering') {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.REMOTE_STREAM_STOPPING,\n      level: 'info',\n      message: 'Remote stream is still rendering. Changing status to stopping.',\n      data: streamLogInfo\n    });\n\n    internalContext.setLocalRenderInfo(callId, renderInfo.stream, 'Stopping', renderInfo.renderer);\n    return;\n  } // Else the state must be in the \"Rendered\" state, so we can dispose the renderer and clean up the state.\n\n\n  internalContext.setLocalRenderInfo(callId, renderInfo.stream, 'NotRendered', undefined);\n\n  if (renderInfo.renderer) {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.DISPOSING_LOCAL_RENDERER,\n      level: 'info',\n      message: 'Disposing local view renderer.',\n      data: streamLogInfo\n    });\n\n    renderInfo.renderer.dispose();\n  } else {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.LOCAL_RENDERER_NOT_FOUND,\n      level: 'error',\n      message: 'Cannot find renderer when disposing local stream.',\n      data: streamLogInfo\n    });\n  }\n}\n\nfunction disposeViewUnparentedVideo(context: CallContext, internalContext: InternalCallContext, stream: LocalVideoStreamState): void {\n  _logEvent(callingStatefulLogger, {\n    name: EventNames.START_DISPOSE_LOCAL_STREAM,\n    level: 'info',\n    message: 'Start disposing unparented local stream.'\n  });\n\n  context.deleteDeviceManagerUnparentedView(stream);\n  const renderInfo = internalContext.getUnparentedRenderInfo(stream);\n\n  if (!renderInfo) {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.LOCAL_DISPOSE_INFO_NOT_FOUND,\n      level: 'error',\n      message: 'Cannot find render info when disposing unparented local stream.'\n    });\n\n    return;\n  }\n\n  if (renderInfo.status === 'Rendering') {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.LOCAL_STREAM_STOPPING,\n      level: 'info',\n      message: 'Unparented local stream is still rendering. Changing status to stopping.'\n    });\n\n    internalContext.setUnparentedRenderInfo(stream, renderInfo.stream, 'Stopping', undefined);\n  } else {\n    internalContext.deleteUnparentedRenderInfo(stream);\n  }\n\n  if (renderInfo.renderer) {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.DISPOSING_LOCAL_RENDERER,\n      level: 'info',\n      message: 'Disposing unparented local view renderer.'\n    });\n\n    renderInfo.renderer.dispose();\n  } else {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.LOCAL_RENDERER_NOT_FOUND,\n      level: 'error',\n      message: 'Cannot find renderer when disposing unparented local stream.'\n    });\n  }\n}\n/**\n * @private\n */\n\n\nexport function createView(context: CallContext, internalContext: InternalCallContext, callId: string | undefined, participantId: CommunicationIdentifierKind | string | undefined, stream: LocalVideoStreamState | RemoteVideoStreamState, options?: CreateViewOptions): Promise<CreateViewResult | undefined> {\n  if ('id' in stream && callId && participantId) {\n    // Render RemoteVideoStream that is part of a Call\n    return createViewRemoteVideo(context, internalContext, callId, participantId, stream, options);\n  } else if (!('id' in stream) && callId) {\n    // Render LocalVideoStream that is part of a Call\n    return createViewLocalVideo(context, internalContext, callId, options);\n  } else if (!('id' in stream) && !callId) {\n    // Render LocalVideoStream that is not part of a Call\n    return createViewUnparentedVideo(context, internalContext, stream, options);\n  } else {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.CREATE_STREAM_INVALID_PARAMS,\n      level: 'warning',\n      message: 'Create View invalid combination of parameters.'\n    });\n\n    return Promise.resolve(undefined);\n  }\n}\n/**\n * @private\n */\n\nexport function disposeView(context: CallContext, internalContext: InternalCallContext, callId: string | undefined, participantId: CommunicationIdentifierKind | string | undefined, stream: LocalVideoStreamState | RemoteVideoStreamState): void {\n  if ('id' in stream && callId && participantId) {\n    // Stop rendering RemoteVideoStream that is part of a Call\n    disposeViewRemoteVideo(context, internalContext, callId, participantId, stream);\n  } else if (!('id' in stream) && callId) {\n    // Stop rendering LocalVideoStream that is part of a Call\n    disposeViewLocalVideo(context, internalContext, callId);\n  } else if (!('id' in stream) && !callId) {\n    // Stop rendering LocalVideoStream that is not part of a Call\n    disposeViewUnparentedVideo(context, internalContext, stream);\n  } else {\n    _logEvent(callingStatefulLogger, {\n      name: EventNames.DISPOSE_STREAM_INVALID_PARAMS,\n      level: 'warning',\n      message: 'Dispose View invalid combination of parameters.'\n    });\n\n    return;\n  }\n}\n/**\n * @private\n * Only stops videos that are tied to a Call.\n */\n\nexport function disposeAllViewsFromCall(context: CallContext, internalContext: InternalCallContext, callId: string): void {\n  const callStreams = internalContext.getRemoteRenderInfoForCall(callId);\n\n  if (callStreams) {\n    for (const [participantKey, participantStreams] of callStreams.entries()) {\n      for (const [_, remoteStreamAndRenderer] of participantStreams.entries()) {\n        // We don't want to accept SDK stream as parameter but we also don't cache the declarative stream so we have to\n        // convert the SDK stream to declarative stream which is not pretty so this could use some further refactoring.\n        disposeView(context, internalContext, callId, participantKey, convertSdkRemoteStreamToDeclarativeRemoteStream(remoteStreamAndRenderer.stream));\n      }\n    }\n  }\n\n  const localStreamAndRenderer = internalContext.getLocalRenderInfo(callId);\n\n  if (localStreamAndRenderer && localStreamAndRenderer.renderer) {\n    // We don't want to accept SDK stream as parameter but we also don't cache the declarative stream so we have to\n    // convert the SDK stream to declarative stream which is not pretty so this could use some further refactoring.\n    disposeView(context, internalContext, callId, undefined, convertSdkLocalStreamToDeclarativeLocalStream(localStreamAndRenderer.stream));\n  }\n}\n/**\n * @private\n */\n\nexport function disposeAllViews(context: CallContext, internalContext: InternalCallContext): void {\n  const callIds = internalContext.getCallIds();\n\n  for (const callId of callIds) {\n    disposeAllViewsFromCall(context, internalContext, callId);\n  }\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { RemoteParticipant, RemoteVideoStream } from '@azure/communication-calling';\nimport { toFlatCommunicationIdentifier } from '@internal/acs-ui-common';\nimport { CallContext } from './CallContext';\nimport { CallIdRef } from './CallIdRef';\nimport { convertSdkRemoteStreamToDeclarativeRemoteStream } from './Converter';\nimport { InternalCallContext } from './InternalCallContext';\nimport { RemoteVideoStreamSubscriber } from './RemoteVideoStreamSubscriber';\nimport { disposeView } from './StreamUtils';\n/**\n * Keeps track of the listeners assigned to a particular participant because when we get an event from SDK, it doesn't\n * tell us which participant it is for. If we keep track of this then we know which participant in the state that needs\n * an update and also which property of that participant. Also we can use this when unregistering to a participant.\n */\n\nexport class ParticipantSubscriber {\n  private _callIdRef: CallIdRef;\n  private _participant: RemoteParticipant;\n  private _context: CallContext;\n  private _internalContext: InternalCallContext;\n  private _participantKey: string;\n  private _remoteVideoStreamSubscribers: Map<number, RemoteVideoStreamSubscriber>;\n\n  constructor(callIdRef: CallIdRef, participant: RemoteParticipant, context: CallContext, internalContext: InternalCallContext) {\n    this._callIdRef = callIdRef;\n    this._participant = participant;\n    this._context = context;\n    this._internalContext = internalContext;\n    this._participantKey = toFlatCommunicationIdentifier(this._participant.identifier);\n    this._remoteVideoStreamSubscribers = new Map<number, RemoteVideoStreamSubscriber>();\n    this.subscribe();\n  }\n\n  private subscribe = (): void => {\n    this._participant.on('stateChanged', this.stateChanged);\n\n    this._participant.on('isMutedChanged', this.isMutedChanged);\n\n    this._participant.on('displayNameChanged', this.displayNameChanged);\n\n    this._participant.on('isSpeakingChanged', this.isSpeakingChanged);\n\n    this._participant.on('videoStreamsUpdated', this.videoStreamsUpdated);\n\n    if (this._participant.videoStreams.length > 0) {\n      for (const stream of this._participant.videoStreams) {\n        this._internalContext.setRemoteRenderInfo(this._callIdRef.callId, this._participantKey, stream.id, stream, 'NotRendered', undefined);\n\n        this.addRemoteVideoStreamSubscriber(stream);\n      }\n\n      this._context.setRemoteVideoStreams(this._callIdRef.callId, this._participantKey, this._participant.videoStreams.map(convertSdkRemoteStreamToDeclarativeRemoteStream), []);\n    }\n  };\n  public unsubscribe = (): void => {\n    this._participant.off('stateChanged', this.stateChanged);\n\n    this._participant.off('isMutedChanged', this.isMutedChanged);\n\n    this._participant.off('displayNameChanged', this.displayNameChanged);\n\n    this._participant.off('isSpeakingChanged', this.isSpeakingChanged);\n\n    this._participant.off('videoStreamsUpdated', this.videoStreamsUpdated); // If unsubscribing it means the participant left the call. If they have any rendering streams we should stop them\n    // as it doesn't make sense to render for an ended participant.\n\n\n    if (this._participant.videoStreams.length > 0) {\n      for (const stream of this._participant.videoStreams) {\n        disposeView(this._context, this._internalContext, this._callIdRef.callId, this._participantKey, convertSdkRemoteStreamToDeclarativeRemoteStream(stream));\n\n        this._internalContext.deleteRemoteRenderInfo(this._callIdRef.callId, this._participantKey, stream.id);\n      }\n    }\n  };\n  private addRemoteVideoStreamSubscriber = (remoteVideoStream: RemoteVideoStream): void => {\n    this._remoteVideoStreamSubscribers.get(remoteVideoStream.id)?.unsubscribe();\n\n    this._remoteVideoStreamSubscribers.set(remoteVideoStream.id, new RemoteVideoStreamSubscriber(this._callIdRef, this._participantKey, remoteVideoStream, this._context));\n  };\n  private stateChanged = (): void => {\n    this._context.setParticipantState(this._callIdRef.callId, this._participantKey, this._participant.state);\n  };\n  private isMutedChanged = (): void => {\n    this._context.setParticipantIsMuted(this._callIdRef.callId, this._participantKey, this._participant.isMuted);\n  };\n  private displayNameChanged = (): void => {\n    this._context.setParticipantDisplayName(this._callIdRef.callId, this._participantKey, this._participant.displayName || '');\n  };\n  private isSpeakingChanged = (): void => {\n    this._context.setParticipantIsSpeaking(this._callIdRef.callId, this._participantKey, this._participant.isSpeaking);\n  };\n  private videoStreamsUpdated = (event: {\n    added: RemoteVideoStream[];\n    removed: RemoteVideoStream[];\n  }): void => {\n    for (const stream of event.removed) {\n      this._remoteVideoStreamSubscribers.get(stream.id)?.unsubscribe();\n      disposeView(this._context, this._internalContext, this._callIdRef.callId, this._participantKey, convertSdkRemoteStreamToDeclarativeRemoteStream(stream));\n\n      this._internalContext.deleteRemoteRenderInfo(this._callIdRef.callId, this._participantKey, stream.id);\n    }\n\n    for (const stream of event.added) {\n      this._internalContext.setRemoteRenderInfo(this._callIdRef.callId, this._participantKey, stream.id, stream, 'NotRendered', undefined);\n\n      this.addRemoteVideoStreamSubscriber(stream);\n    }\n\n    this._context.setRemoteVideoStreams(this._callIdRef.callId, this._participantKey, event.added.map(convertSdkRemoteStreamToDeclarativeRemoteStream), event.removed.map((stream: RemoteVideoStream) => stream.id));\n  };\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { RecordingCallFeature } from '@azure/communication-calling';\nimport { CallContext } from './CallContext';\nimport { CallIdRef } from './CallIdRef';\n/**\n * @private\n */\n\nexport class RecordingSubscriber {\n  private _callIdRef: CallIdRef;\n  private _context: CallContext;\n  private _recording: RecordingCallFeature;\n\n  constructor(callIdRef: CallIdRef, context: CallContext, recording: RecordingCallFeature) {\n    this._callIdRef = callIdRef;\n    this._context = context;\n    this._recording = recording; // If recording as already started when we joined the call, make sure it is reflected in state as there may not\n    // be an event for it.\n\n    if (this._recording.isRecordingActive) {\n      this._context.setCallRecordingActive(this._callIdRef.callId, this._recording.isRecordingActive);\n    }\n\n    this.subscribe();\n  }\n\n  private subscribe = (): void => {\n    this._recording.on('isRecordingActiveChanged', this.isAvailableChanged);\n  };\n  public unsubscribe = (): void => {\n    this._recording.off('isRecordingActiveChanged', this.isAvailableChanged);\n  };\n  private isAvailableChanged = (): void => {\n    this._context.setCallRecordingActive(this._callIdRef.callId, this._recording.isRecordingActive);\n  };\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { TranscriptionCallFeature } from '@azure/communication-calling';\nimport { CallContext } from './CallContext';\nimport { CallIdRef } from './CallIdRef';\n/**\n * @private\n */\n\nexport class TranscriptionSubscriber {\n  private _callIdRef: CallIdRef;\n  private _context: CallContext;\n  private _transcription: TranscriptionCallFeature;\n\n  constructor(callIdRef: CallIdRef, context: CallContext, transcription: TranscriptionCallFeature) {\n    this._callIdRef = callIdRef;\n    this._context = context;\n    this._transcription = transcription; // If transcription as already started when we joined the call, make sure it is reflected in state as there may not\n    // be an event for it.\n\n    if (this._transcription.isTranscriptionActive) {\n      this._context.setCallTranscriptionActive(this._callIdRef.callId, this._transcription.isTranscriptionActive);\n    }\n\n    this.subscribe();\n  }\n\n  private subscribe = (): void => {\n    this._transcription.on('isTranscriptionActiveChanged', this.isTranscriptionActiveChanged);\n  };\n  public unsubscribe = (): void => {\n    this._transcription.off('isTranscriptionActiveChanged', this.isTranscriptionActiveChanged);\n  };\n  private isTranscriptionActiveChanged = (): void => {\n    this._context.setCallTranscriptionActive(this._callIdRef.callId, this._transcription.isTranscriptionActive);\n  };\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { UserFacingDiagnosticsFeature, DiagnosticChangedEventArgs, LatestDiagnosticValue, MediaDiagnosticChangedEventArgs, NetworkDiagnosticChangedEventArgs } from '@azure/communication-calling';\nimport { CallContext } from './CallContext';\nimport { CallIdRef } from './CallIdRef';\n/**\n * @private\n */\n\nexport class UserFacingDiagnosticsSubscriber {\n  private _callIdRef: CallIdRef;\n  private _context: CallContext;\n  private _diagnostics: UserFacingDiagnosticsFeature;\n\n  constructor(callIdRef: CallIdRef, context: CallContext, diagnostics: UserFacingDiagnosticsFeature) {\n    this._callIdRef = callIdRef;\n    this._context = context;\n    this._diagnostics = diagnostics;\n    this.setInitialDiagnostics();\n    this.subscribe();\n  }\n\n  public unsubscribe = (): void => {\n    this._diagnostics.network.off('diagnosticChanged', this.networkDiagnosticsChanged.bind(this));\n\n    this._diagnostics.media.off('diagnosticChanged', this.mediaDiagnosticsChanged.bind(this));\n  };\n\n  private setInitialDiagnostics(): void {\n    const network = this._diagnostics.network.getLatest();\n\n    const media = this._diagnostics.media.getLatest();\n\n    if (Object.entries(network).length === 0 && Object.entries(media).length === 0) {\n      return;\n    }\n\n    this._context.modifyState(state => {\n      const call = state.calls[this._callIdRef.callId];\n\n      if (call === undefined) {\n        return;\n      }\n\n      call.diagnostics = {\n        network: {\n          latest: network\n        },\n        media: {\n          latest: media\n        }\n      };\n    });\n  }\n\n  private subscribe(): void {\n    this._diagnostics.network.on('diagnosticChanged', this.networkDiagnosticsChanged.bind(this));\n\n    this._diagnostics.media.on('diagnosticChanged', this.mediaDiagnosticsChanged.bind(this));\n  }\n\n  private networkDiagnosticsChanged(args: NetworkDiagnosticChangedEventArgs): void {\n    this._context.modifyState(state => {\n      const call = state.calls[this._callIdRef.callId];\n\n      if (call === undefined) {\n        return;\n      }\n\n      const network = call.diagnostics?.network.latest;\n\n      if (network) {\n        network[args.diagnostic] = latestFromEvent(args);\n      }\n    });\n  }\n\n  private mediaDiagnosticsChanged(args: MediaDiagnosticChangedEventArgs): void {\n    this._context.modifyState(state => {\n      const call = state.calls[this._callIdRef.callId];\n\n      if (call === undefined) {\n        return;\n      }\n\n      const media = call.diagnostics?.media.latest;\n\n      if (media) {\n        media[args.diagnostic] = latestFromEvent(args);\n      }\n    });\n  }\n\n}\n\nconst latestFromEvent = (args: DiagnosticChangedEventArgs): LatestDiagnosticValue => ({\n  value: args.value,\n  valueType: args.valueType\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Call, Features, LocalVideoStream, RemoteParticipant } from '@azure/communication-calling';\nimport { toFlatCommunicationIdentifier } from '@internal/acs-ui-common';\nimport { CallContext } from './CallContext';\nimport { CallIdRef } from './CallIdRef';\nimport { convertSdkLocalStreamToDeclarativeLocalStream, convertSdkParticipantToDeclarativeParticipant } from './Converter';\nimport { InternalCallContext } from './InternalCallContext';\nimport { ParticipantSubscriber } from './ParticipantSubscriber';\nimport { RecordingSubscriber } from './RecordingSubscriber';\nimport { disposeView } from './StreamUtils';\nimport { TranscriptionSubscriber } from './TranscriptionSubscriber';\nimport { UserFacingDiagnosticsSubscriber } from './UserFacingDiagnosticsSubscriber';\n/**\n * Keeps track of the listeners assigned to a particular call because when we get an event from SDK, it doesn't tell us\n * which call it is for. If we keep track of this then we know which call in the state that needs an update and also\n * which property of that call. Also we can use this when unregistering to a call.\n */\n\nexport class CallSubscriber {\n  private _call: Call;\n  private _callIdRef: CallIdRef;\n  private _context: CallContext;\n  private _internalContext: InternalCallContext;\n  private _diagnosticsSubscriber: UserFacingDiagnosticsSubscriber;\n  private _participantSubscribers: Map<string, ParticipantSubscriber>;\n  private _recordingSubscriber: RecordingSubscriber;\n  private _transcriptionSubscriber: TranscriptionSubscriber;\n\n  constructor(call: Call, context: CallContext, internalContext: InternalCallContext) {\n    this._call = call;\n    this._callIdRef = {\n      callId: call.id\n    };\n    this._context = context;\n    this._internalContext = internalContext;\n    this._diagnosticsSubscriber = new UserFacingDiagnosticsSubscriber(this._callIdRef, this._context, this._call.feature(Features.UserFacingDiagnostics));\n    this._participantSubscribers = new Map<string, ParticipantSubscriber>();\n    this._recordingSubscriber = new RecordingSubscriber(this._callIdRef, this._context, this._call.feature(Features.Recording));\n    this._transcriptionSubscriber = new TranscriptionSubscriber(this._callIdRef, this._context, this._call.feature(Features.Transcription));\n    this.subscribe();\n  }\n\n  private subscribe = (): void => {\n    this._call.on('stateChanged', this.stateChanged);\n\n    this._call.on('idChanged', this.idChanged);\n\n    this._call.on('isScreenSharingOnChanged', this.isScreenSharingOnChanged);\n\n    this._call.on('remoteParticipantsUpdated', this.remoteParticipantsUpdated);\n\n    this._call.on('localVideoStreamsUpdated', this.localVideoStreamsUpdated);\n\n    this._call.on('isMutedChanged', this.isMuteChanged);\n\n    this._call.feature(Features.DominantSpeakers).on('dominantSpeakersChanged', this.dominantSpeakersChanged); // At time of writing only one LocalVideoStream is supported by SDK.\n\n\n    if (this._call.localVideoStreams.length > 0) {\n      this._internalContext.setLocalRenderInfo(this._callIdRef.callId, this._call.localVideoStreams[0], 'NotRendered', undefined);\n    }\n\n    if (this._call.remoteParticipants.length > 0) {\n      this._call.remoteParticipants.forEach((participant: RemoteParticipant) => {\n        this.addParticipantListener(participant);\n      });\n\n      this._context.setCallRemoteParticipants(this._callIdRef.callId, this._call.remoteParticipants.map(convertSdkParticipantToDeclarativeParticipant), []);\n    }\n  };\n  public unsubscribe = (): void => {\n    this._call.off('stateChanged', this.stateChanged);\n\n    this._call.off('idChanged', this.idChanged);\n\n    this._call.off('isScreenSharingOnChanged', this.isScreenSharingOnChanged);\n\n    this._call.off('remoteParticipantsUpdated', this.remoteParticipantsUpdated);\n\n    this._call.off('localVideoStreamsUpdated', this.localVideoStreamsUpdated);\n\n    this._call.off('isMutedChanged', this.isMuteChanged);\n\n    this._participantSubscribers.forEach((participantSubscriber: ParticipantSubscriber) => {\n      participantSubscriber.unsubscribe();\n    });\n\n    this._participantSubscribers.clear(); // If we are unsubscribing that means we no longer want to display any video for this call (callEnded or callAgent\n    // disposed) and we should not be updating it any more. So if video is rendering we stop rendering.\n\n\n    if (this._call.localVideoStreams && this._call.localVideoStreams[0]) {\n      disposeView(this._context, this._internalContext, this._callIdRef.callId, undefined, convertSdkLocalStreamToDeclarativeLocalStream(this._call.localVideoStreams[0]));\n    }\n\n    this._internalContext.deleteLocalRenderInfo(this._callIdRef.callId);\n\n    this._diagnosticsSubscriber.unsubscribe();\n\n    this._recordingSubscriber.unsubscribe();\n\n    this._transcriptionSubscriber.unsubscribe();\n  };\n\n  private addParticipantListener(participant: RemoteParticipant): void {\n    const participantKey = toFlatCommunicationIdentifier(participant.identifier);\n    this._participantSubscribers.get(participantKey)?.unsubscribe();\n\n    this._participantSubscribers.set(participantKey, new ParticipantSubscriber(this._callIdRef, participant, this._context, this._internalContext));\n  }\n\n  private removeParticipantListener(participant: RemoteParticipant): void {\n    const participantKey = toFlatCommunicationIdentifier(participant.identifier);\n\n    const participantSubscriber = this._participantSubscribers.get(participantKey);\n\n    if (participantSubscriber) {\n      participantSubscriber.unsubscribe();\n\n      this._participantSubscribers.delete(participantKey);\n    }\n  }\n\n  private stateChanged = (): void => {\n    this._context.setCallState(this._callIdRef.callId, this._call.state);\n  };\n  private idChanged = (): void => {\n    this._internalContext.setCallId(this._call.id, this._callIdRef.callId);\n\n    this._context.setCallId(this._call.id, this._callIdRef.callId);\n\n    this._callIdRef.callId = this._call.id;\n  };\n  private isScreenSharingOnChanged = (): void => {\n    this._context.setCallIsScreenSharingOn(this._callIdRef.callId, this._call.isScreenSharingOn);\n  };\n  private isMuteChanged = (): void => {\n    this._context.setCallIsMicrophoneMuted(this._callIdRef.callId, this._call.isMuted);\n  };\n  private remoteParticipantsUpdated = (event: {\n    added: RemoteParticipant[];\n    removed: RemoteParticipant[];\n  }): void => {\n    event.added.forEach((participant: RemoteParticipant) => {\n      this.addParticipantListener(participant);\n    });\n    event.removed.forEach((participant: RemoteParticipant) => {\n      this.removeParticipantListener(participant);\n    }); // Remove any added participants from remoteParticipantsEnded if they are there and add any removed participants to\n    // remoteParticipantsEnded.\n\n    this._context.setCallRemoteParticipantsEnded(this._callIdRef.callId, event.removed.map(convertSdkParticipantToDeclarativeParticipant), event.added.map((participant: RemoteParticipant) => {\n      return toFlatCommunicationIdentifier(participant.identifier);\n    })); // Add added participants to remoteParticipants and remove removed participants from remoteParticipants.\n\n\n    this._context.setCallRemoteParticipants(this._callIdRef.callId, event.added.map(convertSdkParticipantToDeclarativeParticipant), event.removed.map((participant: RemoteParticipant) => {\n      return toFlatCommunicationIdentifier(participant.identifier);\n    }));\n  };\n  private localVideoStreamsUpdated = (event: {\n    added: LocalVideoStream[];\n    removed: LocalVideoStream[];\n  }): void => {\n    // At time of writing only one LocalVideoStream is supported by SDK.\n    if (event.added.length > 0) {\n      const localVideoStreams = [convertSdkLocalStreamToDeclarativeLocalStream(this._call.localVideoStreams[0])]; // IMPORTANT: The internalContext should be set before context. This is done to ensure that the internal context\n      // has the required data when component re-renders due to external state changes.\n\n      this._internalContext.setLocalRenderInfo(this._callIdRef.callId, this._call.localVideoStreams[0], 'NotRendered', undefined);\n\n      this._context.setCallLocalVideoStream(this._callIdRef.callId, [...localVideoStreams]);\n    }\n\n    if (event.removed.length > 0) {\n      disposeView(this._context, this._internalContext, this._callIdRef.callId, undefined, convertSdkLocalStreamToDeclarativeLocalStream(event.removed[0]));\n\n      this._internalContext.deleteLocalRenderInfo(this._callIdRef.callId);\n\n      this._context.setCallLocalVideoStream(this._callIdRef.callId, []);\n    }\n  };\n  private dominantSpeakersChanged = (): void => {\n    const dominantSpeakers = this._call.feature(Features.DominantSpeakers).dominantSpeakers;\n\n    this._context.setCallDominantSpeakers(this._callIdRef.callId, dominantSpeakers);\n  };\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IncomingCall } from '@azure/communication-calling';\nimport { CallContext } from './CallContext';\n/**\n * @beta\n * Proxies the {@link @azure/communication-calling#IncomingCall} interface.\n */\n\nexport type DeclarativeIncomingCall = IncomingCall;\n/**\n * @private\n */\n\nexport class ProxyIncomingCall implements ProxyHandler<DeclarativeIncomingCall> {\n  private _context: CallContext;\n\n  constructor(context: CallContext) {\n    this._context = context;\n  }\n\n  public get<P extends keyof IncomingCall>(target: IncomingCall, prop: P): any {\n    switch (prop) {\n      case 'accept':\n        {\n          return this._context.withAsyncErrorTeedToState(async function (...args: Parameters<IncomingCall['accept']>) {\n            return await target.accept(...args);\n          }, 'IncomingCall.accept');\n        }\n\n      case 'reject':\n        {\n          return this._context.withAsyncErrorTeedToState(async function (...args: Parameters<IncomingCall['reject']>) {\n            return await target.reject(...args);\n          }, 'IncomingCall.reject');\n        }\n\n      default:\n        return Reflect.get(target, prop);\n    }\n  }\n\n}\n/**\n * Creates a declarative Incoming Call by proxying IncomingCall using ProxyIncomingCall.\n * @param incomingCall - IncomingCall from SDK\n * @returns proxied IncomingCall\n */\n\nexport const incomingCallDeclaratify = (incomingCall: IncomingCall, context: CallContext): DeclarativeIncomingCall => {\n  const proxyIncomingCall = new ProxyIncomingCall(context);\n  return (new Proxy(incomingCall, proxyIncomingCall) as DeclarativeIncomingCall);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CallEndReason, IncomingCall } from '@azure/communication-calling';\n/**\n * Keeps track of the listeners assigned to a particular incoming call because when we get an event from SDK, it doesn't\n * tell us which incoming call it is for. If we keep track of this then we know which incoming call in the state that\n * needs an update and also which property of that incoming call. Also we can use this when unregistering to a incoming\n * call.\n */\n\nexport class IncomingCallSubscriber {\n  private _incomingCall: IncomingCall;\n  private _setIncomingCallEnded: (incomingCallId: string, callEndReason: CallEndReason) => void;\n\n  constructor(incomingCall: IncomingCall, // setIncomingCallEnded callback is used so parent can clean up IncomingCallSubscriber.\n  setIncomingCallEnded: (incomingCallId: string, callEndReason: CallEndReason) => void) {\n    this._incomingCall = incomingCall;\n    this._setIncomingCallEnded = setIncomingCallEnded;\n    this.subscribe();\n  }\n\n  private subscribe = (): void => {\n    this._incomingCall.on('callEnded', this.callEnded);\n  };\n  public unsubscribe = (): void => {\n    this._incomingCall.off('callEnded', this.callEnded);\n  };\n  private callEnded = (event: {\n    callEndReason: CallEndReason;\n  }): void => {\n    this._setIncomingCallEnded(this._incomingCall.id, event.callEndReason);\n  };\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Call, CallAgent, CallEndReason, CollectionUpdatedEvent, IncomingCallEvent } from '@azure/communication-calling';\nimport { CallContext } from './CallContext';\nimport { callDeclaratify, DeclarativeCall } from './CallDeclarative';\nimport { CallSubscriber } from './CallSubscriber';\nimport { convertSdkCallToDeclarativeCall, convertSdkIncomingCallToDeclarativeIncomingCall } from './Converter';\nimport { DeclarativeIncomingCall, incomingCallDeclaratify } from './IncomingCallDeclarative';\nimport { IncomingCallSubscriber } from './IncomingCallSubscriber';\nimport { InternalCallContext } from './InternalCallContext';\nimport { disposeAllViews, disposeAllViewsFromCall } from './StreamUtils';\n/**\n * @public\n * `DeclarativeCallAgent` extends and proxies the {@link @azure/communication-calling#CallAgent}\n */\n\nexport type DeclarativeCallAgent = CallAgent;\n/**\n * ProxyCallAgent proxies CallAgent and saves any returned state in the given context. It will subscribe to all state\n * updates in the CallAgent and in the contained Calls and RemoteParticipants. When dispose is called it will\n * unsubscribe from all state updates.\n */\n\nclass ProxyCallAgent implements ProxyHandler<DeclarativeCallAgent> {\n  private _callAgent: CallAgent;\n  private _context: CallContext;\n  private _internalContext: InternalCallContext;\n  private _callSubscribers: Map<Call, CallSubscriber>;\n  private _incomingCallSubscribers: Map<string, IncomingCallSubscriber>;\n  private _declarativeIncomingCalls: Map<string, DeclarativeIncomingCall>;\n  private _declarativeCalls: Map<Call, DeclarativeCall>;\n  private _externalCallsUpdatedListeners: Set<CollectionUpdatedEvent<Call>>;\n\n  constructor(callAgent: CallAgent, context: CallContext, internalContext: InternalCallContext) {\n    this._callAgent = callAgent;\n    this._context = context;\n    this._internalContext = internalContext;\n    this._callSubscribers = new Map<Call, CallSubscriber>();\n    this._incomingCallSubscribers = new Map<string, IncomingCallSubscriber>();\n    this._declarativeIncomingCalls = new Map<string, DeclarativeIncomingCall>();\n    this._declarativeCalls = new Map<Call, DeclarativeCall>();\n    this._externalCallsUpdatedListeners = new Set<CollectionUpdatedEvent<Call>>();\n    this.subscribe();\n  }\n\n  private subscribe = (): void => {\n    this._callAgent.on('callsUpdated', this.callsUpdated);\n\n    this._callAgent.on('incomingCall', this.incomingCall); // There could be scenario that when ProxyCallAgent is created that the given CallAgent already has Calls. In this\n    // case we need to make sure to subscribe to those already existing Calls.\n\n\n    for (const call of this._callAgent.calls) {\n      this.addCall(call);\n    }\n  };\n  private unsubscribe = (): void => {\n    this._callAgent.off('callsUpdated', this.callsUpdated);\n\n    this._callAgent.off('incomingCall', this.incomingCall); // Unsubscribe is called when CallAgent is disposed. This should mean no more updating of existing call but we don't\n    // remove any existing state.\n\n\n    for (const [_, callSubscriber] of this._callSubscribers.entries()) {\n      callSubscriber.unsubscribe();\n    }\n\n    this._callSubscribers.clear();\n\n    for (const [_, incomingCallSubscriber] of this._incomingCallSubscribers.entries()) {\n      incomingCallSubscriber.unsubscribe();\n    }\n\n    this._incomingCallSubscribers.clear();\n\n    this._declarativeIncomingCalls.clear();\n\n    for (const [_, declarativeCall] of this._declarativeCalls.entries()) {\n      declarativeCall.unsubscribe();\n    }\n\n    this._declarativeCalls.clear();\n  };\n  private callsUpdated = (event: {\n    added: Call[];\n    removed: Call[];\n  }): void => {\n    const addedStatefulCall: DeclarativeCall[] = [];\n\n    for (const call of event.added) {\n      const statefulCall = this.addCall(call);\n      addedStatefulCall.push(statefulCall);\n    }\n\n    const removedStatefulCall: DeclarativeCall[] = [];\n\n    for (const call of event.removed) {\n      disposeAllViewsFromCall(this._context, this._internalContext, call.id);\n\n      const callSubscriber = this._callSubscribers.get(call);\n\n      if (callSubscriber) {\n        callSubscriber.unsubscribe();\n\n        this._callSubscribers.delete(call);\n      }\n\n      this._context.setCallEnded(call.id, call.callEndReason);\n\n      const declarativeCall = this._declarativeCalls.get(call);\n\n      if (declarativeCall) {\n        declarativeCall.unsubscribe();\n        removedStatefulCall.push(declarativeCall);\n\n        this._declarativeCalls.delete(call);\n      } else {\n        removedStatefulCall.push(callDeclaratify(call, this._context));\n      }\n    }\n\n    for (const externalCallsUpdatedListener of this._externalCallsUpdatedListeners) {\n      externalCallsUpdatedListener({\n        added: addedStatefulCall,\n        removed: removedStatefulCall\n      });\n    }\n  };\n  private setIncomingCallEnded = (incomingCallId: string, callEndReason: CallEndReason): void => {\n    const incomingCallSubscriber = this._incomingCallSubscribers.get(incomingCallId);\n\n    if (incomingCallSubscriber) {\n      incomingCallSubscriber.unsubscribe();\n\n      this._incomingCallSubscribers.delete(incomingCallId);\n    }\n\n    this._declarativeIncomingCalls.delete(incomingCallId);\n\n    this._context.setIncomingCallEnded(incomingCallId, callEndReason);\n  };\n  private incomingCall: IncomingCallEvent = ({\n    incomingCall\n  }): void => {\n    // Make sure to not subscribe to the incoming call if we are already subscribed to it.\n    if (!this._incomingCallSubscribers.has(incomingCall.id)) {\n      this._incomingCallSubscribers.set(incomingCall.id, new IncomingCallSubscriber(incomingCall, this.setIncomingCallEnded));\n    }\n\n    this._declarativeIncomingCalls.set(incomingCall.id, incomingCallDeclaratify(incomingCall, this._context));\n\n    this._context.setIncomingCall(convertSdkIncomingCallToDeclarativeIncomingCall(incomingCall));\n  };\n  private addCall = (call: Call): DeclarativeCall => {\n    this._callSubscribers.get(call)?.unsubscribe(); // For API extentions we need to have the call in the state when we are subscribing as we may want to update the\n    // state during the subscription process in the subscriber so we add the call to state before subscribing.\n\n    this._context.setCall(convertSdkCallToDeclarativeCall(call));\n\n    this._callSubscribers.set(call, new CallSubscriber(call, this._context, this._internalContext));\n\n    return this.getOrCreateDeclarativeCall(call);\n  };\n  private getOrCreateDeclarativeCall = (call: Call): DeclarativeCall => {\n    const declarativeCall = this._declarativeCalls.get(call);\n\n    if (declarativeCall) {\n      return declarativeCall;\n    }\n\n    const newDeclarativeCall = callDeclaratify(call, this._context);\n\n    this._declarativeCalls.set(call, (newDeclarativeCall as DeclarativeCall));\n\n    return newDeclarativeCall;\n  };\n\n  public get<P extends keyof CallAgent>(target: CallAgent, prop: P): any {\n    switch (prop) {\n      case 'startCall':\n        {\n          return this._context.withErrorTeedToState((...args: Parameters<CallAgent['startCall']>): Call => {\n            const call = target.startCall(...args);\n            this.addCall(call);\n            return this.getOrCreateDeclarativeCall(call);\n          }, 'CallAgent.startCall');\n        }\n\n      case 'join':\n        {\n          return this._context.withErrorTeedToState((...args: Parameters<CallAgent['join']>): Call => {\n            const call = target.join(...args);\n            this.addCall(call);\n            return this.getOrCreateDeclarativeCall(call);\n          }, 'CallAgent.join');\n        }\n\n      case 'calls':\n        {\n          return Array.from(this._declarativeCalls.values());\n        }\n\n      case 'on':\n        {\n          return (...args: Parameters<CallAgent['on']>): void => {\n            const isCallsUpdated = args[0] === 'callsUpdated';\n\n            if (isCallsUpdated) {\n              const listener = args[1];\n\n              this._externalCallsUpdatedListeners.add(listener);\n            } else {\n              target.on(...args);\n            }\n          };\n        }\n\n      case 'off':\n        {\n          return (...args: Parameters<CallAgent['off']>): void => {\n            const isCallsUpdated = args[0] === 'callsUpdated';\n\n            if (isCallsUpdated) {\n              const listener = args[1];\n\n              this._externalCallsUpdatedListeners.delete(listener);\n            } else {\n              target.off(...args);\n            }\n          };\n        }\n\n      case 'dispose':\n        {\n          // Wrapping CallAgent.dispose in a callback type (): Promise<void> to accomodate the change of CallAgent.dispose\n          // in calling beta version 1.8.0-beta.1 from callback type (): Promise<void> to (): void\n          const callAgentDisposeAsyncCallbackWrapper = async (): Promise<void> => {\n            await target.dispose();\n            return Promise.resolve();\n          };\n\n          return (): Promise<void> => {\n            return callAgentDisposeAsyncCallbackWrapper().then(() => {\n              this.unsubscribe();\n            });\n          };\n        }\n\n      /**\n       * This attribute is a special case and doesn't exist on the CallAgent interface.\n       * We need this to be able to return a declarative incoming call object using the call agent.\n       * In a standard headless SDK usage, the right way to get an incoming call is to use the `incomingCall` event.\n       * However, using the declarative layer, the ideal usage would be to:\n       * 1. subscribe to the `onStateChange` event\n       * 2. Get the incoming call from the new state and it's ID\n       * 3. Use `callAgent.incomingCalls` and filter an incoming call ID to get a declarative incoming call object\n       */\n\n      case 'incomingCalls':\n        {\n          return Array.from(this._declarativeIncomingCalls.values());\n        }\n\n      default:\n        return Reflect.get(target, prop);\n    }\n  }\n\n}\n/**\n * Creates a declarative CallAgent by proxying CallAgent with ProxyCallAgent which will track state updates by updating\n * the given context.\n *\n * @param callAgent - CallAgent from SDK\n * @param context - CallContext from StatefulCallClient\n * @param internalContext- InternalCallContext from StatefulCallClient\n */\n\n\nexport const callAgentDeclaratify = (callAgent: CallAgent, context: CallContext, internalContext: InternalCallContext): DeclarativeCallAgent => {\n  // Make sure there are no existing call data if creating a new CallAgentDeclarative (if creating a new\n  // CallAgentDeclarative after disposing of the hold one will mean context have old call state). TODO: should we stop\n  // rendering when the previous callAgent is disposed?\n  disposeAllViews(context, internalContext);\n  context.clearCallRelatedState();\n  internalContext.clearCallRelatedState();\n  return (new Proxy(callAgent, new ProxyCallAgent(callAgent, context, internalContext)) as DeclarativeCallAgent);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { LocalVideoStream, RemoteVideoStream, VideoStreamRenderer } from '@azure/communication-calling';\nimport { LocalVideoStreamState } from './CallClientState';\nimport { CallIdHistory } from './CallIdHistory';\n/**\n * Internally tracked render status. Stores the status of a video render of a stream as rendering could take a long\n * time.\n *\n * 'NotRendered' - the stream has not yet been rendered\n * 'Rendering' - the stream is currently rendering\n * 'Rendered' - the stream has been rendered\n * 'Stopping' - the stream is currently rendering but has been signaled to stop\n */\n\nexport type RenderStatus = 'NotRendered' | 'Rendering' | 'Rendered' | 'Stopping';\n/**\n * Internal container to hold common state needed to keep track of renders.\n */\n\nexport interface RenderInfo {\n  status: RenderStatus;\n  renderer: VideoStreamRenderer | undefined;\n}\n/**\n * Internally used to keep track of the status, renderer, and awaiting promise, associated with a LocalVideoStream.\n */\n\nexport interface LocalRenderInfo extends RenderInfo {\n  stream: LocalVideoStream;\n}\n/**\n * Internally used to keep track of the status, renderer, and awaiting promise, associated with a RemoteVideoStream.\n */\n\nexport interface RemoteRenderInfo extends RenderInfo {\n  stream: RemoteVideoStream;\n}\n/**\n * Contains internal data used between different Declarative components to share data.\n */\n\nexport class InternalCallContext {\n  // <CallId, <ParticipantKey, <StreamId, RemoteRenderInfo>>\n  private _remoteRenderInfos = new Map<string, Map<string, Map<number, RemoteRenderInfo>>>(); // <CallId, LocalRenderInfo>.\n\n  private _localRenderInfos = new Map<string, LocalRenderInfo>(); // Used for keeping track of rendered LocalVideoStreams that are not part of a Call.\n  // The key is the stream ID. We assume each stream ID to only have one owning render info\n\n  private _unparentedRenderInfos = new Map<string, LocalRenderInfo>();\n  private _callIdHistory = new CallIdHistory();\n\n  public setCallId(newCallId: string, oldCallId: string): void {\n    this._callIdHistory.updateCallIdHistory(newCallId, oldCallId);\n\n    const remoteRenderInfos = this._remoteRenderInfos.get(oldCallId);\n\n    if (remoteRenderInfos) {\n      this._remoteRenderInfos.delete(oldCallId);\n\n      this._remoteRenderInfos.set(newCallId, remoteRenderInfos);\n    }\n\n    const localRenderInfos = this._localRenderInfos.get(oldCallId);\n\n    if (localRenderInfos) {\n      this._localRenderInfos.delete(oldCallId);\n\n      this._localRenderInfos.set(newCallId, localRenderInfos);\n    }\n  }\n\n  public getCallIds(): IterableIterator<string> {\n    return this._remoteRenderInfos.keys();\n  }\n\n  public getRemoteRenderInfoForCall(callId: string): Map<string, Map<number, RemoteRenderInfo>> | undefined {\n    return this._remoteRenderInfos.get(this._callIdHistory.latestCallId(callId));\n  }\n\n  public getRemoteRenderInfoForParticipant(callId: string, participantKey: string, streamId: number): RemoteRenderInfo | undefined {\n    const callRenderInfos = this._remoteRenderInfos.get(this._callIdHistory.latestCallId(callId));\n\n    if (!callRenderInfos) {\n      return undefined;\n    }\n\n    const participantRenderInfos = callRenderInfos.get(participantKey);\n\n    if (!participantRenderInfos) {\n      return undefined;\n    }\n\n    return participantRenderInfos.get(streamId);\n  }\n\n  public setRemoteRenderInfo(callId: string, participantKey: string, streamId: number, stream: RemoteVideoStream, status: RenderStatus, renderer: VideoStreamRenderer | undefined): void {\n    let callRenderInfos = this._remoteRenderInfos.get(this._callIdHistory.latestCallId(callId));\n\n    if (!callRenderInfos) {\n      callRenderInfos = new Map<string, Map<number, RemoteRenderInfo>>();\n\n      this._remoteRenderInfos.set(this._callIdHistory.latestCallId(callId), callRenderInfos);\n    }\n\n    let participantRenderInfos = callRenderInfos.get(participantKey);\n\n    if (!participantRenderInfos) {\n      participantRenderInfos = new Map<number, RemoteRenderInfo>();\n      callRenderInfos.set(participantKey, participantRenderInfos);\n    }\n\n    participantRenderInfos.set(streamId, {\n      stream,\n      status,\n      renderer\n    });\n  }\n\n  public deleteRemoteRenderInfo(callId: string, participantKey: string, streamId: number): void {\n    const callRenderInfos = this._remoteRenderInfos.get(this._callIdHistory.latestCallId(callId));\n\n    if (!callRenderInfos) {\n      return;\n    }\n\n    const participantRenderInfos = callRenderInfos.get(participantKey);\n\n    if (!participantRenderInfos) {\n      return;\n    }\n\n    participantRenderInfos.delete(streamId);\n  }\n\n  public setLocalRenderInfo(callId: string, stream: LocalVideoStream, status: RenderStatus, renderer: VideoStreamRenderer | undefined): void {\n    this._localRenderInfos.set(this._callIdHistory.latestCallId(callId), {\n      stream,\n      status,\n      renderer\n    });\n  }\n\n  public getLocalRenderInfo(callId: string): LocalRenderInfo | undefined {\n    return this._localRenderInfos.get(this._callIdHistory.latestCallId(callId));\n  }\n\n  public deleteLocalRenderInfo(callId: string): void {\n    this._localRenderInfos.delete(this._callIdHistory.latestCallId(callId));\n  }\n\n  public getUnparentedRenderInfo(localVideoStream: LocalVideoStreamState): LocalRenderInfo | undefined {\n    return this._unparentedRenderInfos.get(localVideoStream.source.id);\n  }\n\n  public setUnparentedRenderInfo(statefulStream: LocalVideoStreamState, stream: LocalVideoStream, status: RenderStatus, renderer: VideoStreamRenderer | undefined): void {\n    this._unparentedRenderInfos.set(statefulStream.source.id, {\n      stream,\n      status,\n      renderer\n    });\n  }\n\n  public deleteUnparentedRenderInfo(localVideoStream: LocalVideoStreamState): void {\n    this._unparentedRenderInfos.delete(localVideoStream.source.id);\n  } // UnparentedRenderInfos are not cleared as they are not part of the Call state.\n\n\n  public clearCallRelatedState(): void {\n    this._remoteRenderInfos.clear();\n\n    this._localRenderInfos.clear();\n  }\n\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { deviceManagerDeclaratify } from './DeviceManagerDeclarative';\nimport { CallClient, CallClientOptions, CreateViewOptions, DeviceManager } from '@azure/communication-calling';\nimport { CallClientState, LocalVideoStreamState, RemoteVideoStreamState } from './CallClientState';\nimport { CallContext } from './CallContext';\nimport { callAgentDeclaratify, DeclarativeCallAgent } from './CallAgentDeclarative';\nimport { InternalCallContext } from './InternalCallContext';\nimport { createView, disposeView, CreateViewResult } from './StreamUtils';\nimport { CommunicationIdentifier, CommunicationUserIdentifier, getIdentifierKind } from '@azure/communication-common';\nimport { _getApplicationId } from '@internal/acs-ui-common';\nimport { callingStatefulLogger } from './Logger';\n/**\n * Defines the methods that allow CallClient {@link @azure/communication-calling#CallClient} to be used statefully.\n * The interface provides access to proxied state and also allows registering a handler for state change events. For\n * state definition see {@link CallClientState}.\n *\n * State change events are driven by:\n * - Returned data from {@link @azure/communication-calling#DeviceManager} APIs.\n * - Returned data from {@link @azure/communication-calling#CallAgent} APIs.\n * - Listeners automatically attached to various azure communication-calling objects:\n *   - CallAgent 'incomingCall'\n *   - CallAgent 'callsUpdated'\n *   - DeviceManager 'videoDevicesUpdated'\n *   - DeviceManager 'audioDevicesUpdated\n *   - DeviceManager 'selectedMicrophoneChanged'\n *   - DeviceManager 'selectedSpeakerChanged'\n *   - Call 'stateChanged'\n *   - Call 'idChanged'\n *   - Call 'isMutedChanged'\n *   - Call 'isScreenSharingOnChanged'\n *   - Call 'remoteParticipantsUpdated'\n *   - Call 'localVideoStreamsUpdated'\n *   - IncomingCall 'callEnded'\n *   - RemoteParticipant 'stateChanged'\n *   - RemoteParticipant 'isMutedChanged'\n *   - RemoteParticipant 'displayNameChanged'\n *   - RemoteParticipant 'isSpeakingChanged'\n *   - RemoteParticipant 'videoStreamsUpdated'\n *   - RemoteVideoStream 'isAvailableChanged'\n *   - TranscriptionCallFeature 'isTranscriptionActiveChanged'\n *   - RecordingCallFeature 'isRecordingActiveChanged'\n *\n * @public\n */\n\nexport interface StatefulCallClient extends CallClient {\n  /**\n   * Holds all the state that we could proxy from CallClient {@link @azure/communication-calling#CallClient} as\n   * CallClientState {@link CallClientState}.\n   */\n  getState(): CallClientState;\n  /**\n   * Allows a handler to be registered for 'stateChanged' events.\n   *\n   * @param handler - Callback to receive the state.\n   */\n\n  onStateChange(handler: (state: CallClientState) => void): void;\n  /**\n   * Allows unregistering for 'stateChanged' events.\n   *\n   * @param handler - Original callback to be unsubscribed.\n   */\n\n  offStateChange(handler: (state: CallClientState) => void): void;\n  /**\n   * Renders a {@link RemoteVideoStreamState} or {@link LocalVideoStreamState} and stores the resulting\n   * {@link VideoStreamRendererViewState} under the relevant {@link RemoteVideoStreamState} or\n   * {@link LocalVideoStreamState} or as unparented view in the state. Under the hood calls\n   * {@link @azure/communication-calling#VideoStreamRenderer.createView}.\n   *\n   * Scenario 1: Render RemoteVideoStreamState\n   * - CallId is required, participantId is required, and stream of type RemoteVideoStreamState is required\n   * - Resulting {@link VideoStreamRendererViewState} is stored in the given callId and participantId in\n   * {@link CallClientState}\n   *\n   * Scenario 2: Render LocalVideoStreamState for a call\n   * - CallId is required, participantId must be undefined, and stream of type LocalVideoStreamState is required.\n   * - The {@link @azure/communication-calling#Call.localVideoStreams} must already be started using\n   *   {@link @azure/communication-calling#Call.startVideo}.\n   * - Resulting {@link VideoStreamRendererViewState} is stored in the given callId {@link CallState.localVideoStreams}\n   *   in {@link CallClientState}.\n   *\n   * - Scenario 2: Render LocalVideoStreamState not part of a call (example rendering camera for local preview)\n   * - CallId must be undefined, participantId must be undefined, and stream of type LocalVideoStreamState is required.\n   * - Resulting {@link VideoStreamRendererViewState} is stored in under the given LocalVideoStreamState in\n   *   {@link CallClientState.deviceManager.unparentedViews}\n   *\n   * @param callId - CallId for the given stream. Can be undefined if the stream is not part of any call.\n   * @param participantId - {@link RemoteParticipant.identifier} associated with the given RemoteVideoStreamState. Could\n   *   be undefined if rendering LocalVideoStreamState.\n   * @param stream - The LocalVideoStreamState or RemoteVideoStreamState to start rendering.\n   * @param options - Options that are passed to the {@link @azure/communication-calling#VideoStreamRenderer}.\n   */\n\n  createView(callId: string | undefined, participantId: CommunicationIdentifier | undefined, stream: LocalVideoStreamState | RemoteVideoStreamState, options?: CreateViewOptions): Promise<CreateViewResult | undefined>;\n  /**\n   * Stops rendering a {@link RemoteVideoStreamState} or {@link LocalVideoStreamState} and removes the\n   * {@link VideoStreamRendererView} from the relevant {@link RemoteVideoStreamState} in {@link CallClientState} or\n   * {@link LocalVideoStream} in {@link CallClientState} or appropriate\n   * {@link CallClientState.deviceManager.unparentedViews} Under the hood calls\n   * {@link @azure/communication-calling#VideoStreamRenderer.dispose}.\n   *\n   * Its important to disposeView to clean up resources properly.\n   *\n   * Scenario 1: Dispose RemoteVideoStreamState\n   * - CallId is required, participantId is required, and stream of type RemoteVideoStreamState is required\n   *\n   * Scenario 2: Dispose LocalVideoStreamState for a call\n   * - CallId is required, participantId must be undefined, and stream of type LocalVideoStreamState is required.\n   *\n   * - Scenario 2: Dispose LocalVideoStreamState not part of a call\n   * - CallId must be undefined, participantId must be undefined, and stream of type LocalVideoStreamState is required.\n   * - LocalVideoStreamState must be the original one passed to createView.\n   *\n   * @param callId - CallId for the given stream. Can be undefined if the stream is not part of any call.\n   * @param participantId - {@link RemoteParticipant.identifier} associated with the given RemoteVideoStreamState. Could\n   *   be undefined if disposing LocalVideoStreamState.\n   * @param stream - The LocalVideoStreamState or RemoteVideoStreamState to dispose.\n   */\n\n  disposeView(callId: string | undefined, participantId: CommunicationIdentifier | undefined, stream: LocalVideoStreamState | RemoteVideoStreamState): void;\n}\n/**\n * A function to modify the state of the StatefulCallClient.\n *\n * Provided as a callback to the {@link StatefulCallClient.modifyState} method.\n *\n * The function must modify the provided state in place as much as possible.\n * Making large modifications can lead to bad performance by causing spurious rerendering of the UI.\n *\n * Consider using commonly used modifier functions exported from this package.\n */\n\nexport type CallStateModifier = (state: CallClientState) => void;\n/**\n * ProxyCallClient proxies CallClient {@link @azure/communication-calling#CallClient} and subscribes to all events that\n * affect state. ProxyCallClient keeps its own copy of the call state and when state is updated, ProxyCallClient emits\n * the event 'stateChanged'.\n */\n\nclass ProxyCallClient implements ProxyHandler<CallClient> {\n  private _context: CallContext;\n  private _internalContext: InternalCallContext;\n  private _callAgent: DeclarativeCallAgent | undefined;\n  private _deviceManager: DeviceManager | undefined;\n  private _sdkDeviceManager: DeviceManager | undefined;\n\n  constructor(context: CallContext, internalContext: InternalCallContext) {\n    this._context = context;\n    this._internalContext = internalContext;\n  }\n\n  public get<P extends keyof CallClient>(target: CallClient, prop: P): any {\n    switch (prop) {\n      case 'createCallAgent':\n        {\n          return this._context.withAsyncErrorTeedToState(async (...args: Parameters<CallClient['createCallAgent']>): Promise<DeclarativeCallAgent> => {\n            // createCallAgent will throw an exception if the previous callAgent was not disposed. If the previous\n            // callAgent was disposed then it would have unsubscribed to events so we can just create a new declarative\n            // callAgent if the createCallAgent succeeds.\n            const callAgent = await target.createCallAgent(...args);\n            this._callAgent = callAgentDeclaratify(callAgent, this._context, this._internalContext);\n\n            this._context.setCallAgent({\n              displayName: this._callAgent.displayName\n            });\n\n            return this._callAgent;\n          }, 'CallClient.createCallAgent');\n        }\n\n      case 'getDeviceManager':\n        {\n          return this._context.withAsyncErrorTeedToState(async () => {\n            // As of writing, the SDK always returns the same instance of DeviceManager so we keep a reference of\n            // DeviceManager and if it does not change we return the cached DeclarativeDeviceManager. If it does not we'll\n            // throw an error that indicate we need to fix this issue as our implementation has diverged from the SDK.\n            const deviceManager = await target.getDeviceManager();\n\n            if (this._sdkDeviceManager) {\n              if (this._sdkDeviceManager === deviceManager) {\n                return this._deviceManager;\n              } else {\n                throw new Error('Multiple DeviceManager not supported. This means a incompatible version of communication-calling is ' + 'used OR calling declarative was not properly updated to communication-calling version.');\n              }\n            } else {\n              this._sdkDeviceManager = deviceManager;\n            }\n\n            this._deviceManager = deviceManagerDeclaratify(deviceManager, this._context);\n            return this._deviceManager;\n          }, 'CallClient.getDeviceManager');\n        }\n\n      default:\n        return Reflect.get(target, prop);\n    }\n  }\n\n}\n/**\n * Arguments to construct the StatefulCallClient.\n *\n * @public\n */\n\n\nexport type StatefulCallClientArgs = {\n  /**\n   * UserId from SDK. This is provided for developer convenience to easily access the userId from the\n   * state. It is not used by StatefulCallClient.\n   */\n  userId: CommunicationUserIdentifier;\n};\n/**\n * Options to construct the StatefulCallClient with.\n *\n * @public\n */\n\nexport type StatefulCallClientOptions = {\n  /**\n   * Options to construct the {@link @axure/communication-calling#CallClient} with.\n   */\n  callClientOptions: CallClientOptions;\n  /**\n   * Sets the max listeners limit of the 'stateChange' event. Defaults to the node.js EventEmitter.defaultMaxListeners\n   * if not specified.\n   */\n\n  maxStateChangeListeners?: number;\n};\n/**\n * Creates a StatefulCallClient {@link StatefulCallClient} by proxying CallClient\n * {@link @azure/communication-calling#CallClient} with ProxyCallClient {@link ProxyCallClient} which then allows access\n * to state in a declarative way.\n *\n * It is important to use the {@link @azure/communication-calling#DeviceManager} and\n * {@link @azure/communication-calling#CallAgent} and {@link @azure/communication-calling#Call} (and etc.) that are\n * obtained from the StatefulCallClient in order for their state changes to be proxied properly.\n *\n * @param args - {@link StatefulCallClientArgs}\n * @param options - {@link StatefulCallClientOptions}\n *\n * @public\n */\n\nexport const createStatefulCallClient = (args: StatefulCallClientArgs, options?: StatefulCallClientOptions): StatefulCallClient => {\n  callingStatefulLogger.info(`Creating calling stateful client using library version: ${_getApplicationId()}`);\n  return createStatefulCallClientWithDeps(new CallClient(withTelemetryTag(options?.callClientOptions)), new CallContext(getIdentifierKind(args.userId), options?.maxStateChangeListeners), new InternalCallContext());\n};\n/**\n * Package-internal version of createStatefulCallClient that allows dependency injection.\n *\n * This function should not be exported from the package.\n */\n\nexport const createStatefulCallClientWithDeps = (callClient: CallClient, context: CallContext, internalContext: InternalCallContext): StatefulCallClient => {\n  Object.defineProperty(callClient, 'getState', {\n    configurable: false,\n    value: () => context.getState()\n  });\n  Object.defineProperty(callClient, 'onStateChange', {\n    configurable: false,\n    value: (handler: (state: CallClientState) => void) => context.onStateChange(handler)\n  });\n  Object.defineProperty(callClient, 'offStateChange', {\n    configurable: false,\n    value: (handler: (state: CallClientState) => void) => context.offStateChange(handler)\n  });\n  Object.defineProperty(callClient, 'createView', {\n    configurable: false,\n    value: (callId: string | undefined, participantId: CommunicationIdentifier | undefined, stream: LocalVideoStreamState | RemoteVideoStreamState, options?: CreateViewOptions): Promise<CreateViewResult | undefined> => {\n      const participantIdKind = participantId ? getIdentifierKind(participantId) : undefined;\n      return createView(context, internalContext, callId, participantIdKind, stream, options);\n    }\n  });\n  Object.defineProperty(callClient, 'disposeView', {\n    configurable: false,\n    value: (callId: string | undefined, participantId: CommunicationIdentifier | undefined, stream: LocalVideoStreamState | RemoteVideoStreamState): void => {\n      const participantIdKind = participantId ? getIdentifierKind(participantId) : undefined;\n      disposeView(context, internalContext, callId, participantIdKind, stream);\n    }\n  });\n  return (new Proxy(callClient, new ProxyCallClient(context, internalContext)) as StatefulCallClient);\n};\n\nconst withTelemetryTag = (options?: CallClientOptions): CallClientOptions => {\n  const tags = options?.diagnostics?.tags ?? [];\n  tags.push(_getApplicationId());\n  return { ...options,\n    diagnostics: { ...options?.diagnostics,\n      tags\n    }\n  };\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ChatMessageReadReceipt, ChatParticipant } from '@azure/communication-chat';\nimport { CommunicationIdentifierKind } from '@azure/communication-common';\nimport { ChatMessageWithStatus } from './types/ChatMessageWithStatus';\nimport { TypingIndicatorReceivedEvent } from '@azure/communication-chat';\n/**\n * Centralized state for {@link @azure/communication-chat#ChatClient}.\n *\n * @public\n */\n\nexport type ChatClientState = {\n  /**\n   * Identifier of the current user.\n   */\n  userId: CommunicationIdentifierKind;\n  /**\n   * DisplayName of the current user.\n   * The same value as what others see in {@link @azure/communication-chat#ChatParticipant.displayName}\n   */\n\n  displayName: string;\n  /**\n   * Chat threads joined by the current user.\n   * Object with {@link ChatThreadClientState} fields, keyed by {@link ChatThreadClientState.threadId}.\n   */\n\n  threads: {\n    [key: string]: ChatThreadClientState;\n  };\n  /**\n   * Stores the latest error for each API method.\n   *\n   * See documentation of {@link ChatErrors} for details.\n   */\n\n  latestErrors: ChatErrors;\n};\n/**\n * Centralized state for {@link @azure/communication-chat#ChatThreadClient}.\n *\n * @public\n */\n\nexport type ChatThreadClientState = {\n  /**\n   * Messages in this thread.\n   * Object with {@link ChatMessageWithStatus} entries\n   * Local messages are keyed by keyed by {@link ChatMessageWithStatus.clientMessageId}.\n   * Remote messages are keyed by {@link @azure/communication-chat#ChatMessage.id}.\n   */\n  chatMessages: {\n    [key: string]: ChatMessageWithStatus;\n  };\n  /**\n   * Participants of this chat thread.\n   *\n   * Object with {@link @azure/communication-chat#ChatParticipant} fields,\n   * keyed by {@link @azure/communication-chat#ChatParticipant.id}.\n   */\n\n  participants: {\n    [key: string]: ChatParticipant;\n  };\n  /**\n   * Id of this chat thread. Returned from {@link @azure/communication-chat#ChatThreadClient.threadId}\n   */\n\n  threadId: string;\n  /**\n   * An object containing properties of this chat thread.\n   */\n\n  properties?: ChatThreadProperties;\n  /**\n   * An array of ReadReceipts of this chat thread. Returned from {@link @azure/communication-chat#ChatThreadClient.listReadReceipts}\n   */\n\n  readReceipts: ChatMessageReadReceipt[];\n  /**\n   * An array of typingIndicators of this chat thread. Captured from event listener of {@link @azure/communication-chat#ChatClient}\n   * Stateful client only stores recent 8000ms real-time typing indicators data.\n   */\n\n  typingIndicators: TypingIndicatorReceivedEvent[];\n  /**\n   * Latest timestamp when other users read messages sent by current user.\n   */\n\n  latestReadTime: Date;\n};\n/**\n * Properties of a chat thread.\n *\n * We define a minimal one that helps us hide the different types used by underlying API.\n *\n * @public\n */\n\nexport type ChatThreadProperties = {\n  topic?: string;\n};\n/**\n * Errors teed from API calls to the Chat SDK.\n *\n * Each property in the object stores the latest error for a particular SDK API method.\n *\n * @public\n */\n\nexport type ChatErrors = { [target in ChatErrorTarget]: ChatError };\n/**\n * Error thrown from failed {@link StatefulChatClient} methods.\n *\n * @public\n */\n\nexport class ChatError extends Error {\n  /**\n   * The API method target that failed.\n   */\n  public target: ChatErrorTarget;\n  /**\n   * Error thrown by the failed SDK method.\n   */\n\n  public innerError: Error;\n  /**\n   * Timestamp added to the error by the stateful layer.\n   */\n\n  public timestamp: Date;\n\n  constructor(target: ChatErrorTarget, innerError: Error, timestamp?: Date) {\n    super();\n    this.target = target;\n    this.innerError = innerError; // Testing note: It is easier to mock Date::now() than the Date() constructor.\n\n    this.timestamp = timestamp ?? new Date(Date.now());\n    this.name = 'ChatError';\n    this.message = `${this.target}: ${this.innerError.message}`;\n  }\n\n}\n/**\n * String literal type for all permissible keys in {@link ChatErrors}.\n *\n * @public\n */\n\nexport type ChatErrorTarget = 'ChatClient.createChatThread' | 'ChatClient.deleteChatThread' | 'ChatClient.getChatThreadClient' | 'ChatClient.listChatThreads' | 'ChatClient.off' | 'ChatClient.on' | 'ChatClient.startRealtimeNotifications' | 'ChatClient.stopRealtimeNotifications' | 'ChatThreadClient.addParticipants' | 'ChatThreadClient.deleteMessage' | 'ChatThreadClient.getMessage' | 'ChatThreadClient.getProperties' | 'ChatThreadClient.listMessages' | 'ChatThreadClient.listParticipants' | 'ChatThreadClient.listReadReceipts' | 'ChatThreadClient.removeParticipant' | 'ChatThreadClient.sendMessage' | 'ChatThreadClient.sendReadReceipt' | 'ChatThreadClient.sendTypingNotification' | 'ChatThreadClient.updateMessage' | 'ChatThreadClient.updateTopic';","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/**\n * @private\n */\nexport const Constants = {\n  TYPING_INDICATOR_MAINTAIN_TIME: 8 * 1000,\n  DUMMY_DATE: new Date(0)\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { createClientLogger } from '@azure/logger';\n/**\n * @private\n */\n\nexport const chatStatefulLogger = createClientLogger('communication-react:chat-stateful');","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport EventEmitter from 'events';\nimport produce, { enableMapSet, enablePatches, Patch } from 'immer';\nimport { ChatClientState, ChatErrors, ChatThreadClientState, ChatThreadProperties, ChatErrorTarget, ChatError } from './ChatClientState';\nimport { ChatMessageWithStatus } from './types/ChatMessageWithStatus';\nimport { ChatMessageReadReceipt, ChatParticipant } from '@azure/communication-chat';\nimport { CommunicationIdentifierKind, UnknownIdentifierKind } from '@azure/communication-common';\nimport { AzureLogger, createClientLogger, getLogLevel } from '@azure/logger';\nimport { _safeJSONStringify, toFlatCommunicationIdentifier } from '@internal/acs-ui-common';\nimport { Constants } from './Constants';\nimport { TypingIndicatorReceivedEvent } from '@azure/communication-chat';\nimport { chatStatefulLogger } from './Logger';\nenableMapSet(); // Needed to generate state diff for verbose logging.\n\nenablePatches();\n/**\n * @private\n */\n\nexport class ChatContext {\n  private _state: ChatClientState = {\n    userId: ({\n      id: ''\n    } as UnknownIdentifierKind),\n    displayName: '',\n    threads: {},\n    latestErrors: ({} as ChatErrors)\n  };\n  private _batchMode = false;\n  private _logger: AzureLogger;\n  private _emitter: EventEmitter;\n  private typingIndicatorInterval: number | undefined = undefined;\n\n  constructor(maxListeners?: number) {\n    this._logger = createClientLogger('communication-react:chat-context');\n    this._emitter = new EventEmitter();\n\n    if (maxListeners) {\n      this._emitter.setMaxListeners(maxListeners);\n    }\n  }\n\n  public getState(): ChatClientState {\n    return this._state;\n  }\n\n  public modifyState(modifier: (draft: ChatClientState) => void): void {\n    const priorState = this._state;\n    this._state = produce(this._state, modifier, (patches: Patch[]) => {\n      if (getLogLevel() === 'verbose') {\n        // Log to `info` because AzureLogger.verbose() doesn't show up in console.\n        this._logger.info(`State change: ${_safeJSONStringify(patches)}`);\n      }\n    });\n\n    if (!this._batchMode && this._state !== priorState) {\n      this._emitter.emit('stateChanged', this._state);\n    }\n  }\n\n  public setThread(threadId: string, threadState: ChatThreadClientState): void {\n    this.modifyState((draft: ChatClientState) => {\n      draft.threads[threadId] = threadState;\n    });\n  }\n\n  public createThread(threadId: string, properties?: ChatThreadProperties): void {\n    this.modifyState((draft: ChatClientState) => {\n      draft.threads[threadId] = {\n        chatMessages: {},\n        threadId: threadId,\n        properties: properties,\n        participants: {},\n        readReceipts: [],\n        typingIndicators: [],\n        latestReadTime: new Date(0)\n      };\n    });\n  }\n\n  public updateChatConfig(userId: CommunicationIdentifierKind, displayName: string): void {\n    this.modifyState((draft: ChatClientState) => {\n      draft.displayName = displayName;\n      draft.userId = userId;\n    });\n  }\n\n  public createThreadIfNotExist(threadId: string, properties?: ChatThreadProperties): boolean {\n    const exists = Object.prototype.hasOwnProperty.call(this.getState().threads, threadId);\n\n    if (!exists) {\n      this.createThread(threadId, properties);\n      return true;\n    }\n\n    return false;\n  }\n\n  public updateThread(threadId: string, properties?: ChatThreadProperties): void {\n    this.modifyState((draft: ChatClientState) => {\n      const thread = draft.threads[threadId];\n\n      if (thread) {\n        thread.properties = properties;\n      }\n    });\n  }\n\n  public updateThreadTopic(threadId: string, topic?: string): void {\n    this.modifyState((draft: ChatClientState) => {\n      if (topic === undefined) {\n        return;\n      }\n\n      const thread = draft.threads[threadId];\n\n      if (thread && !thread.properties) {\n        thread.properties = {\n          topic: topic\n        };\n      } else if (thread && thread.properties) {\n        thread.properties.topic = topic;\n      }\n    });\n  }\n\n  public deleteThread(threadId: string): void {\n    this.modifyState((draft: ChatClientState) => {\n      const thread = draft.threads[threadId];\n\n      if (thread) {\n        delete draft.threads[threadId];\n      }\n    });\n  }\n\n  public setChatMessages(threadId: string, messages: {\n    [key: string]: ChatMessageWithStatus;\n  }): void {\n    this.modifyState((draft: ChatClientState) => {\n      const threadState = draft.threads[threadId];\n\n      if (threadState) {\n        threadState.chatMessages = messages;\n      } // remove typing indicator when receive messages\n\n\n      const thread = draft.threads[threadId];\n\n      if (thread) {\n        for (const message of Object.values(messages)) {\n          this.filterTypingIndicatorForUser(thread, message.sender);\n        }\n      }\n    });\n  }\n\n  public updateChatMessageContent(threadId: string, messagesId: string, content: string | undefined): void {\n    this.modifyState((draft: ChatClientState) => {\n      const chatMessage = draft.threads[threadId]?.chatMessages[messagesId];\n\n      if (chatMessage) {\n        if (!chatMessage.content) {\n          chatMessage.content = {};\n        }\n\n        chatMessage.content.message = content;\n      }\n    });\n  }\n\n  public deleteLocalMessage(threadId: string, localId: string): boolean {\n    let localMessageDeleted = false;\n    this.modifyState((draft: ChatClientState) => {\n      const chatMessages = draft.threads[threadId]?.chatMessages;\n      const message: ChatMessageWithStatus | undefined = chatMessages ? chatMessages[localId] : undefined;\n\n      if (chatMessages && message && message.clientMessageId) {\n        delete chatMessages[message.clientMessageId];\n        localMessageDeleted = true;\n      }\n    });\n    return localMessageDeleted;\n  }\n\n  public deleteMessage(threadId: string, id: string): void {\n    this.modifyState((draft: ChatClientState) => {\n      const chatMessages = draft.threads[threadId]?.chatMessages;\n\n      if (chatMessages) {\n        delete chatMessages[id];\n      }\n    });\n  }\n\n  public setParticipant(threadId: string, participant: ChatParticipant): void {\n    this.modifyState((draft: ChatClientState) => {\n      const participants = draft.threads[threadId]?.participants;\n\n      if (participants) {\n        participants[toFlatCommunicationIdentifier(participant.id)] = participant;\n      }\n    });\n  }\n\n  public setParticipants(threadId: string, participants: ChatParticipant[]): void {\n    this.modifyState((draft: ChatClientState) => {\n      const participantsMap = draft.threads[threadId]?.participants;\n\n      if (participantsMap) {\n        for (const participant of participants) {\n          participantsMap[toFlatCommunicationIdentifier(participant.id)] = participant;\n        }\n      }\n    });\n  }\n\n  public deleteParticipants(threadId: string, participantIds: CommunicationIdentifierKind[]): void {\n    this.modifyState((draft: ChatClientState) => {\n      const participants = draft.threads[threadId]?.participants;\n\n      if (participants) {\n        participantIds.forEach(id => {\n          delete participants[toFlatCommunicationIdentifier(id)];\n        });\n      }\n    });\n  }\n\n  public deleteParticipant(threadId: string, participantId: CommunicationIdentifierKind): void {\n    this.modifyState((draft: ChatClientState) => {\n      const participants = draft.threads[threadId]?.participants;\n\n      if (participants) {\n        delete participants[toFlatCommunicationIdentifier(participantId)];\n      }\n    });\n  }\n\n  public addReadReceipt(threadId: string, readReceipt: ChatMessageReadReceipt): void {\n    this.modifyState((draft: ChatClientState) => {\n      const thread = draft.threads[threadId];\n      const readReceipts = thread?.readReceipts;\n\n      if (thread && readReceipts) {\n        // TODO(prprabhu): Replace `this.getState()` with `draft`?\n        if (readReceipt.sender !== this.getState().userId && thread.latestReadTime < readReceipt.readOn) {\n          thread.latestReadTime = readReceipt.readOn;\n        }\n\n        readReceipts.push(readReceipt);\n      }\n    });\n  }\n\n  private startTypingIndicatorCleanUp(): void {\n    if (this.typingIndicatorInterval) {\n      return;\n    }\n\n    this.typingIndicatorInterval = window.setInterval(() => {\n      let isTypingActive = false;\n      this.modifyState((draft: ChatClientState) => {\n        for (const thread of Object.values(draft.threads)) {\n          const filteredTypingIndicators = thread.typingIndicators.filter(typingIndicator => {\n            const timeGap = Date.now() - typingIndicator.receivedOn.getTime();\n            return timeGap < Constants.TYPING_INDICATOR_MAINTAIN_TIME;\n          });\n\n          if (thread.typingIndicators.length !== filteredTypingIndicators.length) {\n            thread.typingIndicators = filteredTypingIndicators;\n          }\n\n          if (thread.typingIndicators.length > 0) {\n            isTypingActive = true;\n          }\n        }\n      });\n\n      if (!isTypingActive && this.typingIndicatorInterval) {\n        window.clearInterval(this.typingIndicatorInterval);\n        this.typingIndicatorInterval = undefined;\n      }\n    }, 1000);\n  }\n\n  public addTypingIndicator(threadId: string, typingIndicator: TypingIndicatorReceivedEvent): void {\n    this.modifyState((draft: ChatClientState) => {\n      const thread = draft.threads[threadId];\n\n      if (thread) {\n        const typingIndicators = thread.typingIndicators;\n        typingIndicators.push(typingIndicator);\n      }\n    }); // Make sure we only maintain a period of typing indicator for perf purposes\n\n    this.startTypingIndicatorCleanUp();\n  }\n\n  public setChatMessage(threadId: string, message: ChatMessageWithStatus): void {\n    const {\n      id: messageId,\n      clientMessageId\n    } = message;\n\n    if (messageId || clientMessageId) {\n      this.modifyState((draft: ChatClientState) => {\n        const threadMessages = draft.threads[threadId]?.chatMessages;\n        const isLocalIdInMap = threadMessages && clientMessageId && threadMessages[clientMessageId];\n        const messageKey = !messageId || isLocalIdInMap ? clientMessageId : messageId;\n\n        if (threadMessages && messageKey) {\n          threadMessages[messageKey] = message;\n        } // remove typing indicator when receive a message from a user\n\n\n        const thread = draft.threads[threadId];\n\n        if (thread) {\n          this.filterTypingIndicatorForUser(thread, message.sender);\n        }\n      });\n    }\n  }\n  /**\n   * Tees any errors encountered in an async function to the state.\n   *\n   * @param f Async function to execute.\n   * @param target The error target to tee error to.\n   * @returns Result of calling `f`. Also re-raises any exceptions thrown from `f`.\n   * @throws ChatError. Exceptions thrown from `f` are tagged with the failed `target.\n   */\n\n\n  public withAsyncErrorTeedToState<Args extends unknown[], R>(f: (...args: Args) => Promise<R>, target: ChatErrorTarget): (...args: Args) => Promise<R> {\n    return async (...args: Args): Promise<R> => {\n      try {\n        return await f(...args);\n      } catch (error) {\n        const chatError = toChatError(target, error);\n        this.setLatestError(target, chatError);\n        throw chatError;\n      }\n    };\n  }\n  /**\n   * Tees any errors encountered in an function to the state.\n   *\n   * @param f Function to execute.\n   * @param target The error target to tee error to.\n   * @returns Result of calling `f`. Also re-raises any exceptions thrown from `f`.\n   * @throws ChatError. Exceptions thrown from `f` are tagged with the failed `target.\n   */\n\n\n  public withErrorTeedToState<Args extends unknown[], R>(f: (...args: Args) => R, target: ChatErrorTarget): (...args: Args) => R {\n    return (...args: Args): R => {\n      try {\n        chatStatefulLogger.info(`Chat stateful client target function called: ${target}`);\n        return f(...args);\n      } catch (error) {\n        const chatError = toChatError(target, error);\n        this.setLatestError(target, chatError);\n        throw chatError;\n      }\n    };\n  }\n\n  private setLatestError(target: ChatErrorTarget, error: ChatError): void {\n    this.modifyState((draft: ChatClientState) => {\n      draft.latestErrors[target] = error;\n    });\n  } // This is a mutating function, only use it inside of a produce() function\n\n\n  private filterTypingIndicatorForUser(thread: ChatThreadClientState, userId?: CommunicationIdentifierKind): void {\n    if (!userId) {\n      return;\n    }\n\n    const typingIndicators = thread.typingIndicators;\n    const userIdAsKey = toFlatCommunicationIdentifier(userId);\n    const filteredTypingIndicators = typingIndicators.filter(typingIndicator => toFlatCommunicationIdentifier(typingIndicator.sender) !== userIdAsKey);\n\n    if (filteredTypingIndicators.length !== typingIndicators.length) {\n      thread.typingIndicators = filteredTypingIndicators;\n    }\n  }\n  /**\n   * Batch updates to minimize `stateChanged` events across related operations.\n   *\n   * - A maximum of one `stateChanged` event is emitted, at the end of the operations.\n   * - No `stateChanged` event is emitted if the state did not change through the operations.\n   * - In case of an exception, state is reset to the prior value and no `stateChanged` event is emitted.\n   *\n   * All operations finished in this batch should be synchronous.\n   * This function is not reentrant -- do not call batch() from within another batch().\n   */\n\n\n  public batch(operations: () => void): void {\n    if (this._batchMode) {\n      throw new Error('batch() called from within another batch()');\n    }\n\n    this._batchMode = true;\n    const priorState = this._state;\n\n    try {\n      operations();\n\n      if (this._state !== priorState) {\n        this._emitter.emit('stateChanged', this._state);\n      }\n    } catch (e) {\n      this._state = priorState;\n\n      if (getLogLevel() === 'verbose') {\n        this._logger.warning(`State rollback to: ${_safeJSONStringify(priorState)}`);\n      }\n\n      throw e;\n    } finally {\n      this._batchMode = false;\n    }\n  }\n\n  public onStateChange(handler: (state: ChatClientState) => void): void {\n    this._emitter.on('stateChanged', handler);\n  }\n\n  public offStateChange(handler: (state: ChatClientState) => void): void {\n    this._emitter.off('stateChanged', handler);\n  }\n\n}\n\nconst toChatError = (target: ChatErrorTarget, error: unknown): ChatError => {\n  if (error instanceof Error) {\n    return new ChatError(target, error);\n  }\n\n  return new ChatError(target, new Error(`${error}`));\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ChatMessage } from '@azure/communication-chat';\nimport { MessageStatus } from '@internal/acs-ui-common';\nimport { ChatMessageWithStatus } from './types/ChatMessageWithStatus';\n/**\n * @private\n */\n\nexport const convertChatMessage = (message: ChatMessage, status: MessageStatus = 'delivered', clientMessageId?: string): ChatMessageWithStatus => {\n  return { ...message,\n    clientMessageId: clientMessageId,\n    status\n  };\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ChatClient, ChatMessageReadReceipt, ChatMessageType } from '@azure/communication-chat';\nimport { ChatMessageDeletedEvent, ChatMessageEditedEvent, ChatMessageReceivedEvent, ChatThreadCreatedEvent, ChatThreadDeletedEvent, ChatThreadPropertiesUpdatedEvent, ParticipantsAddedEvent, ParticipantsRemovedEvent, ReadReceiptReceivedEvent, TypingIndicatorReceivedEvent } from '@azure/communication-chat';\nimport { ChatContext } from './ChatContext';\nimport { convertChatMessage } from './convertChatMessage';\nimport { ChatMessageWithStatus } from './types/ChatMessageWithStatus'; // TODO: When we can get messageId of event from SDK, remove this\n// Maximum time to look back message list when we receive a system event\n\nconst maxSyncTimeInMs = 10 * 1000;\n/**\n * @private\n */\n\nexport class EventSubscriber {\n  private chatClient: ChatClient;\n  private chatContext: ChatContext;\n\n  constructor(chatClient: ChatClient, chatContext: ChatContext) {\n    this.chatClient = chatClient;\n    this.chatContext = chatContext;\n    this.subscribe();\n  }\n\n  private convertEventToChatMessage = (event: ChatMessageReceivedEvent | ChatMessageEditedEvent): ChatMessageWithStatus => {\n    return convertChatMessage({\n      id: event.id,\n      version: event.version,\n      content: {\n        message: event.message\n      },\n      type: this.convertEventType(event.type),\n      sender: event.sender,\n      senderDisplayName: event.senderDisplayName,\n      sequenceId: '',\n      // Note: there is a bug in chatMessageReceived event that it is missing sequenceId\n      createdOn: new Date(event.createdOn),\n      editedOn: 'editedOn' in event ? event.editedOn : undefined,\n      metadata: event.metadata\n    });\n  }; // convert event type to chatMessage type, only possible type is 'html' and 'text' in chat event\n\n  private convertEventType = (type: string): ChatMessageType => {\n    const lowerCaseType = type.toLowerCase();\n\n    if (lowerCaseType === 'richtext/html' || lowerCaseType === 'html') {\n      return 'html';\n    } else {\n      return 'text';\n    }\n  };\n  private onChatMessageReceived = (event: ChatMessageReceivedEvent): void => {\n    // Today we are avoiding how to render these messages. In the future we can\n    // remove this condition and handle this message appropriately.\n    const messageEventType = event.type.toLowerCase();\n\n    if (messageEventType !== 'text' && messageEventType !== 'richtext/html' && messageEventType !== 'html') {\n      return;\n    }\n\n    const newMessage = this.convertEventToChatMessage(event); // Because of bug in chatMessageReceived event, if we already have that particular message in context, we want to\n    // make sure to not overwrite the sequenceId when calling setChatMessage.\n\n    const existingMessage = this.chatContext.getState().threads[event.threadId]?.chatMessages[event.id];\n\n    if (existingMessage) {\n      newMessage.sequenceId = existingMessage.sequenceId;\n    }\n\n    this.chatContext.batch(() => {\n      this.chatContext.createThreadIfNotExist(event.threadId);\n      this.chatContext.setChatMessage(event.threadId, newMessage);\n    });\n  };\n  private onChatMessageDeleted = (event: ChatMessageDeletedEvent): void => {\n    this.chatContext.deleteMessage(event.threadId, event.id);\n  };\n  private onChatMessageEdited = (event: ChatMessageEditedEvent): void => {\n    const editedMessage = this.convertEventToChatMessage(event);\n    this.chatContext.setChatMessage(event.threadId, convertChatMessage(editedMessage));\n  };\n  private onParticipantsAdded = (event: ParticipantsAddedEvent): void => {\n    const participantsToAdd = event.participantsAdded.map(participant => ({ ...participant,\n      shareHistoryTime: participant.shareHistoryTime ? new Date(participant.shareHistoryTime) : undefined\n    }));\n    this.chatContext.batch(() => {\n      this.chatContext.createThreadIfNotExist(event.threadId);\n      this.chatContext.setParticipants(event.threadId, participantsToAdd);\n    });\n    this.fetchLastParticipantMessage(event.threadId, 'participantAdded');\n  }; // This is a hot fix that no participant message is received for onChatMessageReceived event, which should be handled by JS SDK\n\n  private fetchLastParticipantMessage = async (threadId: string, actionType: 'participantAdded' | 'participantRemoved'): Promise<void> => {\n    for await (const message of this.chatClient.getChatThreadClient(threadId).listMessages({\n      startTime: new Date(Date.now() - maxSyncTimeInMs)\n    })) {\n      if (message.type === actionType) {\n        this.chatContext.setChatMessage(threadId, { ...message,\n          status: 'delivered'\n        });\n      }\n    }\n  };\n  private onParticipantsRemoved = (event: ParticipantsRemovedEvent): void => {\n    const participantIds = event.participantsRemoved.map(participant => {\n      return participant.id;\n    });\n    this.chatContext.deleteParticipants(event.threadId, participantIds);\n    this.fetchLastParticipantMessage(event.threadId, 'participantRemoved');\n  };\n  private onReadReceiptReceived = (event: ReadReceiptReceivedEvent): void => {\n    const readReceipt: ChatMessageReadReceipt = { ...event,\n      sender: event.sender,\n      readOn: new Date(event.readOn)\n    };\n    this.chatContext.batch(() => {\n      this.chatContext.createThreadIfNotExist(event.threadId);\n      this.chatContext.addReadReceipt(event.threadId, readReceipt);\n    });\n  };\n  private onTypingIndicatorReceived = (typingIndicator: TypingIndicatorReceivedEvent): void => {\n    this.chatContext.batch(() => {\n      this.chatContext.createThreadIfNotExist(typingIndicator.threadId);\n      this.chatContext.addTypingIndicator(typingIndicator.threadId, typingIndicator);\n    });\n  };\n  private onChatThreadCreated = (event: ChatThreadCreatedEvent): void => {\n    const properties = {\n      topic: event.properties.topic\n    };\n\n    if (!this.chatContext.createThreadIfNotExist(event.threadId, properties)) {\n      this.chatContext.updateThread(event.threadId, properties);\n    }\n  };\n  private onChatThreadDeleted = (event: ChatThreadDeletedEvent): void => {\n    this.chatContext.deleteThread(event.threadId);\n  };\n  private onChatThreadPropertiesUpdated = (event: ChatThreadPropertiesUpdatedEvent): void => {\n    this.chatContext.updateThread(event.threadId, {\n      topic: event.properties.topic\n    });\n  };\n  public subscribe = (): void => {\n    this.chatClient.on('chatMessageReceived', this.onChatMessageReceived);\n    this.chatClient.on('chatMessageDeleted', this.onChatMessageDeleted);\n    this.chatClient.on('chatMessageEdited', this.onChatMessageEdited);\n    this.chatClient.on('participantsAdded', this.onParticipantsAdded);\n    this.chatClient.on('participantsRemoved', this.onParticipantsRemoved);\n    this.chatClient.on('readReceiptReceived', this.onReadReceiptReceived);\n    this.chatClient.on('typingIndicatorReceived', this.onTypingIndicatorReceived);\n    this.chatClient.on('chatThreadCreated', this.onChatThreadCreated);\n    this.chatClient.on('chatThreadDeleted', this.onChatThreadDeleted);\n    this.chatClient.on('chatThreadPropertiesUpdated', this.onChatThreadPropertiesUpdated);\n  };\n  public unsubscribe = (): void => {\n    this.chatClient.off('chatMessageReceived', this.onChatMessageReceived);\n    this.chatClient.off('chatMessageDeleted', this.onChatMessageDeleted);\n    this.chatClient.off('chatMessageEdited', this.onChatMessageEdited);\n    this.chatClient.off('participantsAdded', this.onParticipantsAdded);\n    this.chatClient.off('participantsRemoved', this.onParticipantsRemoved);\n    this.chatClient.off('readReceiptReceived', this.onReadReceiptReceived);\n    this.chatClient.off('typingIndicatorReceived', this.onTypingIndicatorReceived);\n    this.chatClient.off('chatThreadCreated', this.onChatThreadCreated);\n    this.chatClient.off('chatThreadDeleted', this.onChatThreadDeleted);\n    this.chatClient.off('chatThreadPropertiesUpdated', this.onChatThreadPropertiesUpdated);\n  };\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ListPageSettings } from '@azure/communication-chat';\nimport { ChatContext } from '../ChatContext';\nimport { PagedAsyncIterableIterator } from '@azure/core-paging';\nimport { ChatErrorTarget } from '../ChatClientState';\ntype IteratorCreatorFn<T, OptionsType, PageT = T[]> = (options?: OptionsType) => PagedAsyncIterableIterator<T, PageT>;\n/**\n * Create a decorated iterator\n * returned iterators.\n *\n * @param iteratorCreator the function to create the original iterator\n * @param context chatContext\n * @param decorateFn the function for the decorating behavior\n */\n\nexport const createDecoratedIterator = <ItemType, OptionsType>(iteratorCreator: IteratorCreatorFn<ItemType, OptionsType>, context: ChatContext, decorateFn: (item: ItemType, context: ChatContext) => void) => {\n  return (...args: Parameters<IteratorCreatorFn<ItemType, OptionsType>>): PagedAsyncIterableIterator<ItemType> => {\n    const threadsIterator = iteratorCreator(...args);\n    return {\n      async next() {\n        const result = await threadsIterator.next();\n\n        if (!result.done && result.value) {\n          decorateFn(result.value, context);\n        }\n\n        return result;\n      },\n\n      [Symbol.asyncIterator]() {\n        return this;\n      },\n\n      byPage: (settings: ListPageSettings = {}): AsyncIterableIterator<ItemType[]> => {\n        const pages = threadsIterator.byPage(settings);\n        return {\n          async next() {\n            const result = await pages.next();\n            const page = result.value;\n\n            if (!result.done && result.value) {\n              context.batch(() => {\n                for (const item of page) {\n                  decorateFn(item, context);\n                }\n              });\n            }\n\n            return result;\n          },\n\n          [Symbol.asyncIterator]() {\n            return this;\n          }\n\n        };\n      }\n    };\n  };\n};\n/**\n *\n * @param iteratorCreator Function that creates the base iteartor\n * @param context The ChatContext that stores all internal state.\n * @param target See {@link ChatContext.asyncTeeErrorToState}.\n * @returns A function to create an iterator that handles errors when iterting over the iterator from `iteratorCreator`.\n */\n\nexport const createErrorHandlingIterator = <ItemType, OptionsType>(iteratorCreator: IteratorCreatorFn<ItemType, OptionsType>, context: ChatContext, target: ChatErrorTarget): IteratorCreatorFn<ItemType, OptionsType> => {\n  return (...args: Parameters<IteratorCreatorFn<ItemType, OptionsType>>): PagedAsyncIterableIterator<ItemType> => {\n    const innerIter = iteratorCreator(...args);\n    return {\n      next: context.withAsyncErrorTeedToState(innerIter.next.bind(innerIter), target),\n\n      [Symbol.asyncIterator]() {\n        return this;\n      },\n\n      byPage: (settings: ListPageSettings = {}): AsyncIterableIterator<ItemType[]> => {\n        const pages = innerIter.byPage(settings);\n        return {\n          next: context.withAsyncErrorTeedToState(pages.next.bind(pages), target),\n\n          [Symbol.asyncIterator]() {\n            return this;\n          }\n\n        };\n      }\n    };\n  };\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ChatMessage, ChatThreadClient, RestListMessagesOptions } from '@azure/communication-chat';\nimport { ChatContext } from '../ChatContext';\nimport { convertChatMessage } from '../convertChatMessage';\nimport { createDecoratedIterator, createErrorHandlingIterator } from './createDecoratedIterator';\nimport { PagedAsyncIterableIterator } from '@azure/core-paging';\n/**\n * @private\n */\n\nexport const createDecoratedListMessages = (chatThreadClient: ChatThreadClient, context: ChatContext): ((options?: RestListMessagesOptions) => PagedAsyncIterableIterator<ChatMessage>) => {\n  const setMessage = (message: ChatMessage, context: ChatContext): void => {\n    context.setChatMessage(chatThreadClient.threadId, convertChatMessage(message));\n  };\n\n  return createDecoratedIterator(createErrorHandlingIterator(context.withErrorTeedToState(chatThreadClient.listMessages.bind(chatThreadClient), 'ChatThreadClient.listMessages'), context, 'ChatThreadClient.listMessages'), context, setMessage);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ChatThreadClient, ChatMessageReadReceipt, RestListReadReceiptsOptions } from '@azure/communication-chat';\nimport { ChatContext } from '../ChatContext';\nimport { createDecoratedIterator, createErrorHandlingIterator } from './createDecoratedIterator';\nimport { PagedAsyncIterableIterator } from '@azure/core-paging';\n/**\n * @private\n */\n\nexport const createDecoratedListReadReceipts = (chatThreadClient: ChatThreadClient, context: ChatContext): ((options?: RestListReadReceiptsOptions | undefined) => PagedAsyncIterableIterator<ChatMessageReadReceipt>) => {\n  const setReadReceipt = (readReceipt: ChatMessageReadReceipt, context: ChatContext): void => {\n    context.addReadReceipt(chatThreadClient.threadId, { ...readReceipt\n    });\n  };\n\n  return createDecoratedIterator(createErrorHandlingIterator(context.withErrorTeedToState(chatThreadClient.listReadReceipts.bind(chatThreadClient), 'ChatThreadClient.listReadReceipts'), context, 'ChatThreadClient.listReadReceipts'), context, setReadReceipt);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ChatParticipant, ChatThreadClient, RestListParticipantsOptions } from '@azure/communication-chat';\nimport { ChatContext } from '../ChatContext';\nimport { createDecoratedIterator, createErrorHandlingIterator } from './createDecoratedIterator';\nimport { PagedAsyncIterableIterator } from '@azure/core-paging';\n/**\n * @private\n */\n\nexport const createDecoratedListParticipants = (chatThreadClient: ChatThreadClient, context: ChatContext): ((options?: RestListParticipantsOptions) => PagedAsyncIterableIterator<ChatParticipant>) => {\n  const setParticipant = (participant: ChatParticipant, context: ChatContext): void => {\n    context.setParticipant(chatThreadClient.threadId, participant);\n  };\n\n  return createDecoratedIterator(createErrorHandlingIterator(context.withErrorTeedToState(chatThreadClient.listParticipants.bind(chatThreadClient), 'ChatThreadClient.listParticipants'), context, 'ChatThreadClient.listParticipants'), context, setParticipant);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ChatThreadClient, SendChatMessageResult } from '@azure/communication-chat';\nimport { getIdentifierKind } from '@azure/communication-common';\nimport { ChatMessageWithStatus } from './types/ChatMessageWithStatus';\nimport { ChatContext } from './ChatContext';\nimport { nanoid } from 'nanoid';\nimport { createDecoratedListMessages } from './iterators/createDecoratedListMessages';\nimport { createDecoratedListReadReceipts } from './iterators/createDecoratedListReadReceipts';\nimport { createDecoratedListParticipants } from './iterators/createDecoratedListParticipants';\nimport { convertChatMessage } from './convertChatMessage';\n\nclass ProxyChatThreadClient implements ProxyHandler<ChatThreadClient> {\n  private _context: ChatContext;\n\n  constructor(context: ChatContext) {\n    this._context = context;\n  }\n\n  public get<P extends keyof ChatThreadClient>(chatThreadClient: ChatThreadClient, prop: P): any {\n    switch (prop) {\n      case 'listMessages':\n        {\n          return createDecoratedListMessages(chatThreadClient, this._context);\n        }\n\n      case 'getMessage':\n        {\n          return this._context.withAsyncErrorTeedToState(async (...args: Parameters<ChatThreadClient['getMessage']>) => {\n            const message = await chatThreadClient.getMessage(...args);\n\n            this._context.setChatMessage(chatThreadClient.threadId, convertChatMessage(message));\n\n            return message;\n          }, 'ChatThreadClient.getMessage');\n        }\n\n      case 'sendMessage':\n        {\n          return this._context.withAsyncErrorTeedToState(async (...args: Parameters<ChatThreadClient['sendMessage']>) => {\n            // Retry logic?\n            const [request, options] = args;\n            const {\n              content\n            } = request;\n            const clientMessageId = nanoid(); // Generate a local short uuid for message\n\n            const newMessage: ChatMessageWithStatus = {\n              content: {\n                message: content\n              },\n              clientMessageId,\n              id: '',\n              type: 'text',\n              sequenceId: '',\n              version: '',\n              createdOn: new Date(),\n              status: 'sending',\n              senderDisplayName: this._context.getState().displayName,\n              sender: this._context.getState().userId,\n              metadata: options?.metadata\n            };\n\n            this._context.setChatMessage(chatThreadClient.threadId, newMessage);\n\n            let result: SendChatMessageResult | undefined = undefined;\n\n            try {\n              result = await chatThreadClient.sendMessage(...args);\n            } catch (e) {\n              this._context.setChatMessage(chatThreadClient.threadId, { ...newMessage,\n                status: 'failed'\n              });\n\n              throw e;\n            }\n\n            if (result?.id) {\n              this._context.batch(() => {\n                if (!result) {\n                  return;\n                }\n\n                this._context.setChatMessage(chatThreadClient.threadId, { ...newMessage,\n                  clientMessageId: undefined,\n                  status: 'delivered',\n                  id: result.id\n                });\n\n                this._context.deleteLocalMessage(chatThreadClient.threadId, clientMessageId);\n              });\n            }\n\n            return result;\n          }, 'ChatThreadClient.sendMessage');\n        }\n\n      case 'addParticipants':\n        {\n          return this._context.withAsyncErrorTeedToState(async (...args: Parameters<ChatThreadClient['addParticipants']>) => {\n            const result = await chatThreadClient.addParticipants(...args);\n            const [addRequest] = args;\n            const participantsToAdd = addRequest.participants;\n\n            this._context.setParticipants(chatThreadClient.threadId, participantsToAdd);\n\n            return result;\n          }, 'ChatThreadClient.addParticipants');\n        }\n\n      case 'deleteMessage':\n        {\n          return this._context.withAsyncErrorTeedToState(async (...args: Parameters<ChatThreadClient['deleteMessage']>) => {\n            // DeleteMessage is able to either delete local one(for failed message) or synced message\n            const [messageId] = args;\n\n            if (this._context.deleteLocalMessage(chatThreadClient.threadId, messageId)) {\n              return {};\n            }\n\n            const result = await chatThreadClient.deleteMessage(...args);\n\n            this._context.deleteMessage(chatThreadClient.threadId, messageId);\n\n            return result;\n          }, 'ChatThreadClient.deleteMessage');\n        }\n\n      case 'listParticipants':\n        {\n          return createDecoratedListParticipants(chatThreadClient, this._context);\n        }\n\n      case 'listReadReceipts':\n        {\n          return createDecoratedListReadReceipts(chatThreadClient, this._context);\n        }\n\n      case 'removeParticipant':\n        {\n          return this._context.withAsyncErrorTeedToState(async (...args: Parameters<ChatThreadClient['removeParticipant']>) => {\n            const result = await chatThreadClient.removeParticipant(...args);\n            const [removeIdentifier] = args;\n\n            this._context.deleteParticipant(chatThreadClient.threadId, getIdentifierKind(removeIdentifier));\n\n            return result;\n          }, 'ChatThreadClient.removeParticipant');\n        }\n\n      case 'updateMessage':\n        {\n          return this._context.withAsyncErrorTeedToState(async (...args: Parameters<ChatThreadClient['updateMessage']>) => {\n            const result = await chatThreadClient.updateMessage(...args);\n            const [messageId, updateOption] = args;\n\n            this._context.updateChatMessageContent(chatThreadClient.threadId, messageId, updateOption?.content);\n\n            return result;\n          }, 'ChatThreadClient.updateMessage');\n        }\n\n      case 'updateTopic':\n        {\n          return this._context.withAsyncErrorTeedToState(async (...args: Parameters<ChatThreadClient['updateTopic']>) => {\n            const result = await chatThreadClient.updateTopic(...args);\n            const [topic] = args;\n\n            this._context.updateThreadTopic(chatThreadClient.threadId, topic);\n\n            return result;\n          }, 'ChatThreadClient.updateTopic');\n        }\n\n      case 'getProperties':\n        {\n          return this._context.withAsyncErrorTeedToState(async (...args: Parameters<ChatThreadClient['getProperties']>) => {\n            const result = await chatThreadClient.getProperties(...args);\n\n            this._context.updateThread(chatThreadClient.threadId, result);\n\n            return result;\n          }, 'ChatThreadClient.getProperties');\n        }\n\n      default:\n        return Reflect.get(chatThreadClient, prop);\n    }\n  }\n\n}\n/**\n * @private\n */\n\n\nexport const chatThreadClientDeclaratify = (chatThreadClient: ChatThreadClient, context: ChatContext): ChatThreadClient => {\n  context.createThreadIfNotExist(chatThreadClient.threadId);\n  return (new Proxy(chatThreadClient, new ProxyChatThreadClient(context)) as ChatThreadClient);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ChatThreadItem, ChatClient, RestListChatThreadsOptions } from '@azure/communication-chat';\nimport { ChatContext } from '../ChatContext';\nimport { createDecoratedIterator, createErrorHandlingIterator } from './createDecoratedIterator';\nimport { PagedAsyncIterableIterator } from '@azure/core-paging';\n/**\n * @private\n */\n\nexport const createDecoratedListThreads = (chatClient: ChatClient, context: ChatContext): ((options?: RestListChatThreadsOptions) => PagedAsyncIterableIterator<ChatThreadItem>) => {\n  const setThreadProperties = (chatThreadItem: ChatThreadItem, context: ChatContext): void => {\n    const properties = {\n      topic: chatThreadItem.topic\n    };\n\n    if (!context.createThreadIfNotExist(chatThreadItem.id, properties)) {\n      context.updateThread(chatThreadItem.id, properties);\n    }\n  };\n\n  return createDecoratedIterator(createErrorHandlingIterator(context.withErrorTeedToState(chatClient.listChatThreads.bind(chatClient), 'ChatClient.listChatThreads'), context, 'ChatClient.listChatThreads'), context, setThreadProperties);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ChatClient, ChatClientOptions } from '@azure/communication-chat';\nimport { _getApplicationId } from '@internal/acs-ui-common';\nimport { ChatContext } from './ChatContext';\nimport { ChatClientState } from './ChatClientState';\nimport { EventSubscriber } from './EventSubscriber';\nimport { chatThreadClientDeclaratify } from './StatefulChatThreadClient';\nimport { createDecoratedListThreads } from './iterators/createDecoratedListThreads';\nimport { CommunicationTokenCredential, CommunicationUserIdentifier, getIdentifierKind } from '@azure/communication-common';\nimport { chatStatefulLogger } from './Logger';\n/**\n * Defines the methods that allow {@Link @azure/communication-chat#ChatClient} to be used with a centralized generated state.\n *\n * The interface provides access to proxied state and also allows registering a handler for state change events.\n *\n * @public\n */\n\nexport interface StatefulChatClient extends ChatClient {\n  /**\n   * Holds all the state that we could proxy from ChatClient {@Link @azure/communication-chat#ChatClient} as\n   * ChatClientState {@Link ChatClientState}.\n   */\n  getState(): ChatClientState;\n  /**\n   * Allows a handler to be registered for 'stateChanged' events.\n   *\n   * @param handler - Callback to receive the state.\n   */\n\n  onStateChange(handler: (state: ChatClientState) => void): void;\n  /**\n   * Allows unregistering for 'stateChanged' events.\n   *\n   * @param handler - Original callback to be unsubscribed.\n   */\n\n  offStateChange(handler: (state: ChatClientState) => void): void;\n}\ninterface StatefulChatClientWithPrivateProps extends StatefulChatClient {\n  context: ChatContext;\n  eventSubscriber: EventSubscriber | undefined;\n}\nconst proxyChatClient: ProxyHandler<ChatClient> = {\n  get: function <P extends keyof StatefulChatClientWithPrivateProps>(chatClient: ChatClient, prop: P, receiver: StatefulChatClientWithPrivateProps) {\n    // skip receiver.context call to avoid recursive bugs\n    if (prop === 'context') {\n      return Reflect.get(chatClient, prop);\n    }\n\n    const context = receiver.context;\n\n    switch (prop) {\n      case 'createChatThread':\n        {\n          return context.withAsyncErrorTeedToState(async function (...args: Parameters<ChatClient['createChatThread']>) {\n            const result = await chatClient.createChatThread(...args);\n            const thread = result.chatThread;\n\n            if (thread) {\n              const [request] = args;\n              context.createThread(thread.id, {\n                topic: request.topic\n              });\n            }\n\n            return result;\n          }, 'ChatClient.createChatThread');\n        }\n\n      case 'deleteChatThread':\n        {\n          return context.withAsyncErrorTeedToState(async function (...args: Parameters<ChatClient['deleteChatThread']>) {\n            const result = await chatClient.deleteChatThread(...args);\n            context.deleteThread(args[0]);\n            return result;\n          }, 'ChatClient.deleteChatThread');\n        }\n\n      case 'listChatThreads':\n        {\n          return createDecoratedListThreads(chatClient, context);\n        }\n\n      case 'getChatThreadClient':\n        {\n          return function (...args: Parameters<ChatClient['getChatThreadClient']>) {\n            const chatThreadClient = chatClient.getChatThreadClient(...args); // TODO(prprabhu): Ensure that thread properties are fetched into the ChatContext at this point.\n            // A new thread might be created here, but the properties will never be fetched.\n\n            return chatThreadClientDeclaratify(chatThreadClient, context);\n          };\n        }\n\n      case 'startRealtimeNotifications':\n        {\n          return context.withAsyncErrorTeedToState(async function (...args: Parameters<ChatClient['startRealtimeNotifications']>) {\n            const ret = await chatClient.startRealtimeNotifications(...args);\n\n            if (!receiver.eventSubscriber) {\n              receiver.eventSubscriber = new EventSubscriber(chatClient, context);\n            }\n\n            return ret;\n          }, 'ChatClient.startRealtimeNotifications');\n        }\n\n      case 'stopRealtimeNotifications':\n        {\n          return context.withAsyncErrorTeedToState(async function (...args: Parameters<ChatClient['stopRealtimeNotifications']>) {\n            const ret = await chatClient.stopRealtimeNotifications(...args);\n\n            if (receiver.eventSubscriber) {\n              receiver.eventSubscriber.unsubscribe();\n              receiver.eventSubscriber = undefined;\n            }\n\n            return ret;\n          }, 'ChatClient.stopRealtimeNotifications');\n        }\n\n      default:\n        return Reflect.get(chatClient, prop);\n    }\n  }\n};\n/**\n * Arguments to construct the {@link StatefulChatClient}.\n *\n * @public\n */\n\nexport type StatefulChatClientArgs = {\n  userId: CommunicationUserIdentifier;\n  displayName: string;\n  endpoint: string;\n  credential: CommunicationTokenCredential;\n};\n/**\n * Options to construct the {@link StatefulChatClient}.\n *\n * @public\n */\n\nexport type StatefulChatClientOptions = {\n  /**\n   * Options to construct the {@link @azure/communication-chat#ChatClient} with.\n   */\n  chatClientOptions: ChatClientOptions;\n  /**\n   * Sets the max listeners limit of the 'stateChange' event. Defaults to the node.js EventEmitter.defaultMaxListeners\n   * if not specified.\n   */\n\n  maxStateChangeListeners?: number;\n};\n/**\n * Creates a stateful ChatClient {@link StatefulChatClient} by proxying ChatClient\n * {@link @azure/communication-chat#ChatClient} with ProxyChatClient {@link ProxyChatClient} which then allows access\n * to state in a declarative way.\n *\n * @public\n */\n\nexport const createStatefulChatClient = (args: StatefulChatClientArgs, options?: StatefulChatClientOptions): StatefulChatClient => {\n  chatStatefulLogger.info(`Creating chat stateful client using library version: ${_getApplicationId()}`);\n  const tweakedOptions = { ...options,\n    chatClientOptions: { ...options?.chatClientOptions,\n      userAgentOptions: {\n        userAgentPrefix: _getApplicationId()\n      }\n    }\n  };\n  return _createStatefulChatClientWithDeps(new ChatClient(args.endpoint, args.credential, tweakedOptions.chatClientOptions), args, tweakedOptions);\n};\n/**\n * A function to modify the state of the StatefulChatClient.\n *\n * Provided as a callback to the {@link StatefulChatClient.modifyState} method.\n *\n * The function must modify the provided state in place as much as possible.\n * Making large modifications can lead to bad performance by causing spurious rerendering of the UI.\n *\n * Consider using commonly used modifier functions exported from this package.\n */\n\nexport type ChatStateModifier = (state: ChatClientState) => void;\n/**\n * Internal implementation of {@link createStatefulChatClient} for dependency injection.\n *\n * Used by tests. Should not be exported out of this package.\n * @internal\n */\n\nexport const _createStatefulChatClientWithDeps = (chatClient: ChatClient, args: StatefulChatClientArgs, options?: StatefulChatClientOptions): StatefulChatClient => {\n  const context = new ChatContext(options?.maxStateChangeListeners);\n  let eventSubscriber: EventSubscriber;\n  context.updateChatConfig(getIdentifierKind(args.userId), args.displayName);\n  const proxy = new Proxy(chatClient, proxyChatClient);\n  Object.defineProperty(proxy, 'context', {\n    configurable: false,\n    get: () => context\n  });\n  Object.defineProperty(proxy, 'eventSubscriber', {\n    configurable: false,\n    get: () => eventSubscriber,\n    set: (val: EventSubscriber) => {\n      eventSubscriber = val;\n    }\n  });\n  Object.defineProperty(proxy, 'getState', {\n    configurable: false,\n    value: () => context?.getState()\n  });\n  Object.defineProperty(proxy, 'onStateChange', {\n    configurable: false,\n    value: (handler: (state: ChatClientState) => void) => context?.onStateChange(handler)\n  });\n  Object.defineProperty(proxy, 'offStateChange', {\n    configurable: false,\n    value: (handler: (state: ChatClientState) => void) => context?.offStateChange(handler)\n  });\n  return (proxy as StatefulChatClient);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { createStatefulChatClient, ChatClientState, ChatError, StatefulChatClient } from '@internal/chat-stateful-client';\nimport { ChatHandlers, createDefaultChatHandlers } from '@internal/chat-component-bindings';\nimport { ChatMessage, ChatMessageType, ChatThreadClient, SendMessageOptions } from '@azure/communication-chat';\nimport { CommunicationTokenCredential, CommunicationUserIdentifier } from '@azure/communication-common';\nimport type { ChatMessageReceivedEvent, ChatThreadPropertiesUpdatedEvent, ParticipantsAddedEvent, ParticipantsRemovedEvent, ReadReceiptReceivedEvent } from '@azure/communication-chat';\nimport { toFlatCommunicationIdentifier } from '@internal/acs-ui-common';\nimport EventEmitter from 'events';\nimport { ChatAdapter, ChatAdapterState, MessageReadListener, MessageReceivedListener, ParticipantsAddedListener, ParticipantsRemovedListener, TopicChangedListener } from './ChatAdapter';\nimport { AdapterError } from '../../common/adapters';\nimport { useEffect, useRef, useState } from 'react';\nimport { FileMetadata } from '@internal/react-components';\n\n/**\n * Context of Chat, which is a centralized context for all state updates\n * @private\n */\nexport class ChatContext {\n  private emitter: EventEmitter = new EventEmitter();\n  private state: ChatAdapterState;\n  private threadId: string;\n\n  constructor(clientState: ChatClientState, threadId: string) {\n    const thread = clientState.threads[threadId];\n    this.threadId = threadId;\n\n    if (!thread) {\n      throw 'Cannot find threadId, please initialize thread before use!';\n    }\n\n    this.state = {\n      userId: clientState.userId,\n      displayName: clientState.displayName,\n      thread,\n      latestErrors: clientState.latestErrors\n    };\n  }\n\n  public onStateChange(handler: (_uiState: ChatAdapterState) => void): void {\n    this.emitter.on('stateChanged', handler);\n  }\n\n  public offStateChange(handler: (_uiState: ChatAdapterState) => void): void {\n    this.emitter.off('stateChanged', handler);\n  }\n\n  public setState(state: ChatAdapterState): void {\n    this.state = state;\n    this.emitter.emit('stateChanged', this.state);\n  }\n\n  public getState(): ChatAdapterState {\n    return this.state;\n  }\n\n  public setError(error: Error): void {\n    this.setState({ ...this.state,\n      error\n    });\n  }\n\n  public updateClientState(clientState: ChatClientState): void {\n    const thread = clientState.threads[this.threadId];\n\n    if (!thread) {\n      throw 'Cannot find threadId, please make sure thread state is still in Stateful ChatClient.';\n    }\n\n    let updatedState: ChatAdapterState = {\n      userId: clientState.userId,\n      displayName: clientState.displayName,\n      thread,\n      latestErrors: clientState.latestErrors\n    };\n    this.setState(updatedState);\n  }\n\n}\n/**\n * @private\n */\n\nexport class AzureCommunicationChatAdapter implements ChatAdapter {\n  private chatClient: StatefulChatClient;\n  private chatThreadClient: ChatThreadClient;\n  private context: ChatContext;\n  private handlers: ChatHandlers;\n  private emitter: EventEmitter = new EventEmitter();\n\n  constructor(chatClient: StatefulChatClient, chatThreadClient: ChatThreadClient) {\n    this.bindAllPublicMethods();\n    this.chatClient = chatClient;\n    this.chatThreadClient = chatThreadClient;\n    this.context = new ChatContext(chatClient.getState(), chatThreadClient.threadId);\n\n    const onStateChange = (clientState: ChatClientState): void => {\n      // unsubscribe when the instance gets disposed\n      if (!this) {\n        chatClient.offStateChange(onStateChange);\n        return;\n      }\n\n      this.context.updateClientState(clientState);\n    };\n\n    this.handlers = createDefaultChatHandlers(chatClient, chatThreadClient);\n    this.chatClient.onStateChange(onStateChange);\n    this.subscribeAllEvents();\n  }\n\n  private bindAllPublicMethods(): void {\n    this.onStateChange = this.onStateChange.bind(this);\n    this.offStateChange = this.offStateChange.bind(this);\n    this.getState = this.getState.bind(this);\n    this.dispose = this.dispose.bind(this);\n    this.fetchInitialData = this.fetchInitialData.bind(this);\n    this.sendMessage = this.sendMessage.bind(this);\n    this.sendReadReceipt = this.sendReadReceipt.bind(this);\n    this.sendTypingIndicator = this.sendTypingIndicator.bind(this);\n    this.updateMessage = this.updateMessage.bind(this);\n    this.deleteMessage = this.deleteMessage.bind(this);\n    this.removeParticipant = this.removeParticipant.bind(this);\n    this.setTopic = this.setTopic.bind(this);\n    this.loadPreviousChatMessages = this.loadPreviousChatMessages.bind(this);\n    this.on = this.on.bind(this);\n    this.off = this.off.bind(this);\n  }\n\n  dispose(): void {\n    this.unsubscribeAllEvents();\n  }\n\n  async fetchInitialData(): Promise<void> {\n    // If get properties fails we dont want to try to get the participants after.\n    await this.asyncTeeErrorToEventEmitter(async () => {\n      await this.chatThreadClient.getProperties(); // Fetch all participants who joined before the local user.\n\n      for await (const _page of this.chatThreadClient.listParticipants().byPage({\n        // Fetch 100 participants per page by default.\n        maxPageSize: 100 // eslint-disable-next-line curly\n\n      }));\n    });\n  }\n\n  getState(): ChatAdapterState {\n    return this.context.getState();\n  }\n\n  onStateChange(handler: (state: ChatAdapterState) => void): void {\n    this.context.onStateChange(handler);\n  }\n\n  offStateChange(handler: (state: ChatAdapterState) => void): void {\n    this.context.offStateChange(handler);\n  }\n\n  async sendMessage(content: string, options: SendMessageOptions = {}): Promise<void> {\n    await this.asyncTeeErrorToEventEmitter(async () => {\n      await this.handlers.onSendMessage(content, options);\n    });\n  }\n\n  async sendReadReceipt(chatMessageId: string): Promise<void> {\n    await this.asyncTeeErrorToEventEmitter(async () => {\n      await this.handlers.onMessageSeen(chatMessageId);\n    });\n  }\n\n  async sendTypingIndicator(): Promise<void> {\n    await this.handlers.onTyping();\n  }\n\n  async removeParticipant(userId: string): Promise<void> {\n    await this.asyncTeeErrorToEventEmitter(async () => {\n      await this.handlers.onRemoveParticipant(userId);\n    });\n  }\n\n  async setTopic(topicName: string): Promise<void> {\n    await this.asyncTeeErrorToEventEmitter(async () => {\n      await this.handlers.updateThreadTopicName(topicName);\n    });\n  }\n\n  async loadPreviousChatMessages(messagesToLoad: number): Promise<boolean> {\n    return await this.asyncTeeErrorToEventEmitter(async () => {\n      return await this.handlers.onLoadPreviousChatMessages(messagesToLoad);\n    });\n  }\n\n  async updateMessage(messageId: string, content: string, metadata?: Record<string, string>, options?: {\n    attachedFilesMetadata?: FileMetadata[];\n  }): Promise<void> {\n    return await this.asyncTeeErrorToEventEmitter(async () => {\n      return await this.handlers.onUpdateMessage(messageId, content);\n    });\n  }\n\n  async deleteMessage(messageId: string): Promise<void> {\n    return await this.asyncTeeErrorToEventEmitter(async () => {\n      return await this.handlers.onDeleteMessage(messageId);\n    });\n  }\n\n  private messageReceivedListener(event: ChatMessageReceivedEvent): void {\n    const message = convertEventToChatMessage(event);\n    this.emitter.emit('messageReceived', {\n      message\n    });\n    const currentUserId = toFlatCommunicationIdentifier(this.chatClient.getState().userId);\n\n    if (message?.sender && toFlatCommunicationIdentifier(message.sender) === currentUserId) {\n      this.emitter.emit('messageSent', {\n        message\n      });\n    }\n  }\n\n  private messageReadListener({\n    chatMessageId,\n    recipient\n  }: ReadReceiptReceivedEvent): void {\n    const message = this.getState().thread.chatMessages[chatMessageId];\n\n    if (message) {\n      this.emitter.emit('messageRead', {\n        message,\n        readBy: recipient\n      });\n    }\n  }\n\n  private participantsAddedListener({\n    addedBy,\n    participantsAdded\n  }: ParticipantsAddedEvent): void {\n    this.emitter.emit('participantsAdded', {\n      addedBy,\n      participantsAdded\n    });\n  }\n\n  private participantsRemovedListener({\n    removedBy,\n    participantsRemoved\n  }: ParticipantsRemovedEvent): void {\n    this.emitter.emit('participantsRemoved', {\n      removedBy,\n      participantsRemoved\n    });\n  }\n\n  private chatThreadPropertiesUpdatedListener(event: ChatThreadPropertiesUpdatedEvent): void {\n    this.emitter.emit('topicChanged', {\n      topic: event.properties.topic\n    });\n  }\n\n  private subscribeAllEvents(): void {\n    this.chatClient.on('chatThreadPropertiesUpdated', this.chatThreadPropertiesUpdatedListener.bind(this));\n    this.chatClient.on('participantsAdded', this.participantsAddedListener.bind(this));\n    this.chatClient.on('participantsRemoved', this.participantsRemovedListener.bind(this));\n    this.chatClient.on('chatMessageReceived', this.messageReceivedListener.bind(this));\n    this.chatClient.on('readReceiptReceived', this.messageReadListener.bind(this));\n    this.chatClient.on('participantsRemoved', this.participantsRemovedListener.bind(this));\n  }\n\n  private unsubscribeAllEvents(): void {\n    this.chatClient.off('chatThreadPropertiesUpdated', this.chatThreadPropertiesUpdatedListener.bind(this));\n    this.chatClient.off('participantsAdded', this.participantsAddedListener.bind(this));\n    this.chatClient.off('participantsRemoved', this.participantsRemovedListener.bind(this));\n    this.chatClient.off('chatMessageReceived', this.messageReceivedListener.bind(this));\n    this.chatClient.off('readReceiptReceived', this.messageReadListener.bind(this));\n    this.chatClient.off('participantsRemoved', this.participantsRemovedListener.bind(this));\n  }\n\n  on(event: 'messageReceived', listener: MessageReceivedListener): void;\n  on(event: 'messageSent', listener: MessageReceivedListener): void;\n  on(event: 'messageRead', listener: MessageReadListener): void;\n  on(event: 'participantsAdded', listener: ParticipantsAddedListener): void;\n  on(event: 'participantsRemoved', listener: ParticipantsRemovedListener): void;\n  on(event: 'topicChanged', listener: TopicChangedListener): void;\n  on(event: 'error', listener: (e: AdapterError) => void): void; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n  on(event: string, listener: (e: any) => void): void {\n    this.emitter.on(event, listener);\n  }\n\n  off(event: 'messageReceived', listener: MessageReceivedListener): void;\n  off(event: 'messageSent', listener: MessageReceivedListener): void;\n  off(event: 'messageRead', listener: MessageReadListener): void;\n  off(event: 'participantsAdded', listener: ParticipantsAddedListener): void;\n  off(event: 'participantsRemoved', listener: ParticipantsRemovedListener): void;\n  off(event: 'topicChanged', listener: TopicChangedListener): void;\n  off(event: 'error', listener: (e: AdapterError) => void): void; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n  off(event: string, listener: (e: any) => void): void {\n    this.emitter.off(event, listener);\n  }\n\n  private async asyncTeeErrorToEventEmitter<T>(f: () => Promise<T>): Promise<T> {\n    try {\n      return await f();\n    } catch (error) {\n      if (isChatError(error)) {\n        this.emitter.emit('error', (error as AdapterError));\n      }\n\n      throw error;\n    }\n  }\n\n}\n\nconst convertEventToChatMessage = (event: ChatMessageReceivedEvent): ChatMessage => {\n  return {\n    id: event.id,\n    version: event.version,\n    content: {\n      message: event.message\n    },\n    type: convertEventType(event.type),\n    sender: event.sender,\n    senderDisplayName: event.senderDisplayName,\n    sequenceId: '',\n    createdOn: new Date(event.createdOn)\n  };\n}; // only text/html message type will be received from event\n\n\nconst convertEventType = (type: string): ChatMessageType => {\n  const lowerCaseType = type.toLowerCase();\n\n  if (lowerCaseType === 'richtext/html' || lowerCaseType === 'html') {\n    return 'html';\n  } else {\n    return 'text';\n  }\n};\n/**\n * Arguments for creating the Azure Communication Services implementation of {@link ChatAdapter}.\n *\n * @public\n */\n\n\nexport type AzureCommunicationChatAdapterArgs = {\n  endpoint: string;\n  userId: CommunicationUserIdentifier;\n  displayName: string;\n  credential: CommunicationTokenCredential;\n  threadId: string;\n};\n/**\n * Create a {@link ChatAdapter} backed by Azure Communication Services.\n *\n * This is the default implementation of {@link ChatAdapter} provided by this library.\n *\n * @public\n */\n\nexport const createAzureCommunicationChatAdapter = async ({\n  endpoint: endpointUrl,\n  userId,\n  displayName,\n  credential,\n  threadId\n}: AzureCommunicationChatAdapterArgs): Promise<ChatAdapter> => {\n  const chatClient = createStatefulChatClient({\n    userId,\n    displayName,\n    endpoint: endpointUrl,\n    credential: credential\n  });\n  const chatThreadClient = await chatClient.getChatThreadClient(threadId);\n  await chatClient.startRealtimeNotifications();\n  const adapter = await createAzureCommunicationChatAdapterFromClient(chatClient, chatThreadClient);\n  return adapter;\n};\n/**\n * A custom React hook to simplify the creation of {@link ChatAdapter}.\n *\n * Similar to {@link createAzureCommunicationChatAdapter}, but takes care of asynchronous\n * creation of the adapter internally.\n *\n * Allows arguments to be undefined so that you can respect the rule-of-hooks and pass in arguments\n * as they are created. The adapter is only created when all arguments are defined.\n *\n * Note that you must memoize the arguments to avoid recreating adapter on each render.\n * See storybook for typical usage examples.\n *\n * @public\n */\n\nexport const useAzureCommunicationChatAdapter = (args: Partial<AzureCommunicationChatAdapterArgs>, afterCreate?: (adapter: ChatAdapter) => Promise<ChatAdapter>, beforeDispose?: (adapter: ChatAdapter) => Promise<void>): ChatAdapter | undefined => {\n  const {\n    credential,\n    displayName,\n    endpoint,\n    threadId,\n    userId\n  } = args; // State update needed to rerender the parent component when a new adapter is created.\n\n  const [adapter, setAdapter] = useState<ChatAdapter | undefined>(undefined); // Ref needed for cleanup to access the old adapter created asynchronously.\n\n  const adapterRef = useRef<ChatAdapter | undefined>(undefined);\n  const afterCreateRef = useRef<((adapter: ChatAdapter) => Promise<ChatAdapter>) | undefined>(undefined);\n  const beforeDisposeRef = useRef<((adapter: ChatAdapter) => Promise<void>) | undefined>(undefined); // These refs are updated on *each* render, so that the latest values\n  // are used in the `useEffect` closures below.\n  // Using a Ref ensures that new values for the callbacks do not trigger the\n  // useEffect blocks, and a new adapter creation / distruction is not triggered.\n\n  afterCreateRef.current = afterCreate;\n  beforeDisposeRef.current = beforeDispose;\n  useEffect(() => {\n    if (!credential || !displayName || !endpoint || !threadId || !userId) {\n      return;\n    }\n\n    (async () => {\n      if (adapterRef.current) {\n        // Dispose the old adapter when a new one is created.\n        //\n        // This clean up function uses `adapterRef` because `adapter` can not be added to the dependency array of\n        // this `useEffect` -- we do not want to trigger a new adapter creation because of the first adapter\n        // creation.\n        if (beforeDisposeRef.current) {\n          await beforeDisposeRef.current(adapterRef.current);\n        }\n\n        adapterRef.current.dispose();\n        adapterRef.current = undefined;\n      }\n\n      let newAdapter = await createAzureCommunicationChatAdapter({\n        credential,\n        displayName,\n        endpoint,\n        threadId,\n        userId\n      });\n\n      if (afterCreateRef.current) {\n        newAdapter = await afterCreateRef.current(newAdapter);\n      }\n\n      adapterRef.current = newAdapter;\n      setAdapter(newAdapter);\n    })();\n  }, // Explicitly list all arguments so that caller doesn't have to memoize the `args` object.\n  [adapterRef, afterCreateRef, beforeDisposeRef, credential, displayName, endpoint, threadId, userId]); // Dispose any existing adapter when the component unmounts.\n\n  useEffect(() => {\n    return () => {\n      (async () => {\n        if (adapterRef.current) {\n          if (beforeDisposeRef.current) {\n            await beforeDisposeRef.current(adapterRef.current);\n          }\n\n          adapterRef.current.dispose();\n          adapterRef.current = undefined;\n        }\n      })();\n    };\n  }, []);\n  return adapter;\n};\n/**\n * Create a {@link ChatAdapter} using the provided {@link StatefulChatClient}.\n *\n * Useful if you want to keep a reference to {@link StatefulChatClient}.\n * Consider using {@link createAzureCommunicationChatAdapter} for a simpler API.\n *\n * @public\n */\n\nexport const createAzureCommunicationChatAdapterFromClient = async (chatClient: StatefulChatClient, chatThreadClient: ChatThreadClient): Promise<ChatAdapter> => {\n  return new AzureCommunicationChatAdapter(chatClient, chatThreadClient);\n};\n\nconst isChatError = (e: Error): e is ChatError => {\n  return e['target'] !== undefined && e['innerError'] !== undefined;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { PartialDeep } from 'type-fest';\nimport { COMPONENT_LOCALE_EN_US, COMPONENT_LOCALE_EN_GB, COMPONENT_LOCALE_DE_DE, COMPONENT_LOCALE_ES_ES, COMPONENT_LOCALE_FR_FR, COMPONENT_LOCALE_IT_IT, COMPONENT_LOCALE_JA_JP, COMPONENT_LOCALE_KO_KR, COMPONENT_LOCALE_NL_NL, COMPONENT_LOCALE_PT_BR, COMPONENT_LOCALE_RU_RU, COMPONENT_LOCALE_TR_TR, COMPONENT_LOCALE_ZH_CN, COMPONENT_LOCALE_ZH_TW } from '@internal/react-components';\nimport { CompositeLocale, CompositeStrings } from '../LocalizationProvider';\nimport en_US from './en-US/strings.json';\nimport en_GB from './en-GB/strings.json';\nimport de_DE from './de-DE/strings.json';\nimport es_ES from './es-ES/strings.json';\nimport fr_FR from './fr-FR/strings.json';\nimport it_IT from './it-IT/strings.json';\nimport ja_JP from './ja-JP/strings.json';\nimport ko_KR from './ko-KR/strings.json';\nimport nl_NL from './nl-NL/strings.json';\nimport pt_BR from './pt-BR/strings.json';\nimport ru_RU from './ru-RU/strings.json';\nimport tr_TR from './tr-TR/strings.json';\nimport zh_CN from './zh-CN/strings.json';\nimport zh_TW from './zh-TW/strings.json';\n\nconst createCompositeStrings = (localizedStrings: PartialDeep<CompositeStrings>): CompositeStrings => {\n  const strings: CompositeStrings = { ...en_US\n  };\n  Object.keys(localizedStrings).forEach((key: string) => {\n    strings[key] = { ...strings[key],\n      ...localizedStrings[key]\n    };\n  });\n  return strings;\n};\n/**\r\n * Locale for English (US)\r\n *\r\n * @public\r\n */\n\n\nexport const COMPOSITE_LOCALE_EN_US: CompositeLocale = {\n  component: COMPONENT_LOCALE_EN_US,\n  strings: en_US\n};\n/**\r\n * Locale for English (British)\r\n *\r\n * @public\r\n */\n\nexport const COMPOSITE_LOCALE_EN_GB: CompositeLocale = {\n  component: COMPONENT_LOCALE_EN_GB,\n  strings: createCompositeStrings(en_GB)\n};\n/**\r\n * Locale for German (Germany)\r\n *\r\n * @public\r\n */\n\nexport const COMPOSITE_LOCALE_DE_DE: CompositeLocale = {\n  component: COMPONENT_LOCALE_DE_DE,\n  strings: createCompositeStrings(de_DE)\n};\n/**\r\n * Locale for Spanish (Spain)\r\n *\r\n * @public\r\n */\n\nexport const COMPOSITE_LOCALE_ES_ES: CompositeLocale = {\n  component: COMPONENT_LOCALE_ES_ES,\n  strings: createCompositeStrings(es_ES)\n};\n/**\r\n * Locale for French (France)\r\n *\r\n * @public\r\n */\n\nexport const COMPOSITE_LOCALE_FR_FR: CompositeLocale = {\n  component: COMPONENT_LOCALE_FR_FR,\n  strings: createCompositeStrings(fr_FR)\n};\n/**\r\n * Locale for Italian (Italy)\r\n *\r\n * @public\r\n */\n\nexport const COMPOSITE_LOCALE_IT_IT: CompositeLocale = {\n  component: COMPONENT_LOCALE_IT_IT,\n  strings: createCompositeStrings(it_IT)\n};\n/**\r\n * Locale for Japanese (Japan)\r\n *\r\n * @public\r\n */\n\nexport const COMPOSITE_LOCALE_JA_JP: CompositeLocale = {\n  component: COMPONENT_LOCALE_JA_JP,\n  strings: createCompositeStrings(ja_JP)\n};\n/**\r\n * Locale for Korean (South Korea)\r\n *\r\n * @public\r\n */\n\nexport const COMPOSITE_LOCALE_KO_KR: CompositeLocale = {\n  component: COMPONENT_LOCALE_KO_KR,\n  strings: createCompositeStrings(ko_KR)\n};\n/**\r\n * Locale for Dutch (Netherlands)\r\n *\r\n * @public\r\n */\n\nexport const COMPOSITE_LOCALE_NL_NL: CompositeLocale = {\n  component: COMPONENT_LOCALE_NL_NL,\n  strings: createCompositeStrings(nl_NL)\n};\n/**\r\n * Locale for Portuguese (Brazil)\r\n *\r\n * @public\r\n */\n\nexport const COMPOSITE_LOCALE_PT_BR: CompositeLocale = {\n  component: COMPONENT_LOCALE_PT_BR,\n  strings: createCompositeStrings(pt_BR)\n};\n/**\r\n * Locale for Russian (Russia)\r\n *\r\n * @public\r\n */\n\nexport const COMPOSITE_LOCALE_RU_RU: CompositeLocale = {\n  component: COMPONENT_LOCALE_RU_RU,\n  strings: createCompositeStrings(ru_RU)\n};\n/**\r\n * Locale for Turkish (Turkey)\r\n *\r\n * @public\r\n */\n\nexport const COMPOSITE_LOCALE_TR_TR: CompositeLocale = {\n  component: COMPONENT_LOCALE_TR_TR,\n  strings: createCompositeStrings(tr_TR)\n};\n/**\r\n * Locale for Chinese (Mainland China)\r\n *\r\n * @public\r\n */\n\nexport const COMPOSITE_LOCALE_ZH_CN: CompositeLocale = {\n  component: COMPONENT_LOCALE_ZH_CN,\n  strings: createCompositeStrings(zh_CN)\n};\n/**\r\n * Locale for Chinese (Taiwan)\r\n *\r\n * @public\r\n */\n\nexport const COMPOSITE_LOCALE_ZH_TW: CompositeLocale = {\n  component: COMPONENT_LOCALE_ZH_TW,\n  strings: createCompositeStrings(zh_TW)\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { createContext, useContext } from 'react';\nimport { ComponentLocale, LocalizationProvider as ComponentLocalizationProvider } from '@internal/react-components';\nimport { COMPOSITE_LOCALE_EN_US } from './locales';\nimport { CallCompositeStrings } from '../CallComposite';\nimport { CallWithChatCompositeStrings } from '../CallWithChatComposite';\nimport { ChatCompositeStrings } from '../ChatComposite';\n/**\n * Locale information for all composites exported from this library.\n *\n * @public\n */\n\nexport interface CompositeLocale {\n  /** Strings used in composites directly\n   *\n   * Contrast with {@link CompositeLocale.component}, which contains strings used via the component library.\n   */\n  strings: CompositeStrings;\n  /** Locale information for the pure Components used by Composites. See {@link communication-react#ComponentLocale}. */\n\n  component: ComponentLocale;\n}\n/**\n * Strings used in the composites directly.\n *\n * These strings are used by the composites directly, instead of by the contained components.\n *\n * @public\n */\n\nexport interface CompositeStrings {\n  /**\n   * Strings used by {@link CallComposite}.\n   */\n  call: CallCompositeStrings;\n  /**\n   * Strings used by {@link ChatComposite}.\n   */\n\n  chat: ChatCompositeStrings;\n  /**\n   * Strings used by {@link CallWithChatComposite}.\n   */\n\n  callWithChat: CallWithChatCompositeStrings;\n}\n/**\n * Context for providing localized strings to components\n *\n * @private\n */\n\nexport const LocaleContext = createContext<CompositeLocale>(COMPOSITE_LOCALE_EN_US);\n/**\n * Props to LocalizationProvider\n *\n * @private\n */\n\nexport type LocalizationProviderProps = {\n  /** Locale context to provide components */\n  locale: CompositeLocale;\n  /** Children to provide locale context. */\n\n  children: React.ReactNode;\n};\n/**\n * Provider to provide localized strings for this library's composites.\n *\n * @private\n */\n\nexport const LocalizationProvider = (props: LocalizationProviderProps): JSX.Element => {\n  const {\n    locale,\n    children\n  } = props;\n  return <LocaleContext.Provider value={locale}>\n      <ComponentLocalizationProvider locale={locale.component}>{children}</ComponentLocalizationProvider>\n    </LocaleContext.Provider>;\n};\n/**\n * @private\n */\n\nexport const useLocale = (): CompositeLocale => useContext(LocaleContext);","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CallEnd20Filled, CallMissed20Filled, CameraSwitch24Regular, Chat20Filled, Chat20Regular, Info20Filled, MicOff20Filled, MicOn20Filled, MicOn20Regular, People20Regular, PersonDelete20Filled, Speaker220Filled, Speaker220Regular, Video20Filled, VideoOff20Filled, WifiWarning20Filled } from '@fluentui/react-icons';\nimport { DEFAULT_COMPONENT_ICONS } from '@internal/react-components';\nimport React from 'react'; // eslint-disable-next-line no-restricted-imports\n\nimport { FontIcon, IIconProps, mergeStyles, Text } from '@fluentui/react';\n\nconst CoffeeIcon = (): JSX.Element => <Text className={mergeStyles(coffeeIconStyle)} aria-hidden={true}>\n    \n  </Text>;\n\nconst coffeeIconStyle = {\n  // Fluent wraps all icons with <i> so we must force the fontStyle back to normal.\n  fontStyle: 'normal',\n  // By default our icons are 20px x 20px (for 1rem = 16px), make this a bit bigger for lobby.\n  fontSize: '2rem'\n};\n/**\n * The default set of icons used by the composites directly (i.e. not via the components defined in this library).\n *\n * @public\n */\n\nexport const COMPOSITE_ONLY_ICONS: CompositeIcons = {\n  ChevronLeft: <FontIcon iconName=\"ChevronLeft\" />,\n  Link: <FontIcon iconName=\"Link\" />,\n  LobbyScreenConnectingToCall: <CoffeeIcon />,\n  LobbyScreenWaitingToBeAdmitted: <CoffeeIcon />,\n  LocalDeviceSettingsCamera: <Video20Filled />,\n  LocalDeviceSettingsMic: <MicOn20Filled />,\n  LocalDeviceSettingsSpeaker: <Speaker220Filled />,\n  LocalPreviewPlaceholder: <VideoOff20Filled />,\n  LocalCameraSwitch: <CameraSwitch24Regular />,\n  ControlBarChatButtonActive: <Chat20Filled />,\n  ControlBarChatButtonInactive: <Chat20Regular />,\n  ControlBarPeopleButton: <People20Regular />,\n  MoreDrawerMicrophones: <MicOn20Regular />,\n  MoreDrawerPeople: <People20Regular />,\n  MoreDrawerSpeakers: <Speaker220Regular />,\n  MoreDrawerSelectedMicrophone: <MicOn20Filled />,\n  MoreDrawerSelectedSpeaker: <Speaker220Filled />,\n  Muted: <MicOff20Filled />,\n  NetworkReconnectIcon: <CallMissed20Filled />,\n  NoticePageAccessDeniedTeamsMeeting: <PersonDelete20Filled />,\n  NoticePageJoinCallFailedDueToNoNetwork: <WifiWarning20Filled />,\n  NoticePageLeftCall: <CallEnd20Filled />,\n  NoticePageRemovedFromCall: <Info20Filled />\n};\n/**\n * The default set of icons that are available to used in the Composites.\n *\n * @public\n */\n\nexport const DEFAULT_COMPOSITE_ICONS = { ...DEFAULT_COMPONENT_ICONS,\n  ...COMPOSITE_ONLY_ICONS\n};\n/** @private */\n\nexport type CompositeIconProps<Icons> = IIconProps & {\n  iconName: keyof Icons;\n};\n/**\n * Icons that can be overridden for {@link ChatComposite}.\n *\n * @public\n */\n\nexport type ChatCompositeIcons = {\n  EditBoxCancel?: JSX.Element;\n  EditBoxSubmit?: JSX.Element;\n  MessageDelivered?: JSX.Element;\n  MessageEdit?: JSX.Element;\n  MessageFailed?: JSX.Element;\n  MessageRemove?: JSX.Element;\n  MessageSeen?: JSX.Element;\n  MessageSending?: JSX.Element;\n  ParticipantItemOptions?: JSX.Element;\n  ParticipantItemOptionsHovered?: JSX.Element;\n  SendBoxSend?: JSX.Element;\n  SendBoxSendHovered?: JSX.Element;\n};\n/**\n * Icon wrapper to use when including customizable icons inside the ChatComposite.\n * This wrapper ensures the icon name is being type-checked helping ensure no typos\n * and ensure that icon is customizable through the composite API.\n *\n * @private\n */\n\nexport const ChatCompositeIcon = (props: CompositeIconProps<ChatCompositeIcons>): JSX.Element => <FontIcon {...props} />;\n/**\n * Icons that can be overridden for {@link CallComposite}.\n *\n * @public\n */\n\nexport type CallCompositeIcons = {\n  ControlButtonCameraOff?: JSX.Element;\n  ControlButtonCameraOn?: JSX.Element;\n  ControlButtonEndCall?: JSX.Element;\n  ControlButtonMicOff?: JSX.Element;\n  ControlButtonMicOn?: JSX.Element;\n  ControlButtonOptions?: JSX.Element;\n  ControlButtonParticipants?: JSX.Element;\n  ControlButtonScreenShareStart?: JSX.Element;\n  ControlButtonScreenShareStop?: JSX.Element;\n  ErrorBarCallCameraAccessDenied?: JSX.Element;\n  ErrorBarCallCameraAlreadyInUse?: JSX.Element;\n  ErrorBarCallLocalVideoFreeze?: JSX.Element;\n  ErrorBarCallMacOsCameraAccessDenied?: JSX.Element;\n  ErrorBarCallMacOsMicrophoneAccessDenied?: JSX.Element;\n  ErrorBarCallMicrophoneAccessDenied?: JSX.Element;\n  ErrorBarCallMicrophoneMutedBySystem?: JSX.Element;\n  ErrorBarCallMicrophoneUnmutedBySystem?: JSX.Element;\n  ErrorBarCallNetworkQualityLow?: JSX.Element;\n  ErrorBarCallNoMicrophoneFound?: JSX.Element;\n  ErrorBarCallNoSpeakerFound?: JSX.Element;\n  ErrorBarClear?: JSX.Element;\n  HorizontalGalleryLeftButton?: JSX.Element;\n  HorizontalGalleryRightButton?: JSX.Element;\n  LobbyScreenConnectingToCall?: JSX.Element;\n  LobbyScreenWaitingToBeAdmitted?: JSX.Element;\n  LocalDeviceSettingsCamera?: JSX.Element;\n  LocalDeviceSettingsMic?: JSX.Element;\n  LocalDeviceSettingsSpeaker?: JSX.Element;\n  LocalPreviewPlaceholder?: JSX.Element;\n  Muted?: JSX.Element;\n  NetworkReconnectIcon?: JSX.Element;\n  NoticePageAccessDeniedTeamsMeeting?: JSX.Element;\n  NoticePageJoinCallFailedDueToNoNetwork?: JSX.Element;\n  NoticePageLeftCall?: JSX.Element;\n  NoticePageRemovedFromCall?: JSX.Element;\n  OptionsCamera?: JSX.Element;\n  OptionsMic?: JSX.Element;\n  OptionsSpeaker?: JSX.Element;\n  ParticipantItemMicOff?: JSX.Element;\n  ParticipantItemOptions?: JSX.Element;\n  ParticipantItemOptionsHovered?: JSX.Element;\n  ParticipantItemScreenShareStart?: JSX.Element;\n  VideoTileMicOff?: JSX.Element;\n  LocalCameraSwitch?: JSX.Element;\n};\n/**\n * Icon wrapper to use when including customizable icons inside the CallComposite.\n * This wrapper ensures the icon name is being type-checked helping ensure no typos\n * and ensure that icon is customizable through the composite API.\n *\n * @private\n */\n\nexport const CallCompositeIcon = (props: CompositeIconProps<CallCompositeIcons>): JSX.Element => <FontIcon {...props} />;\n/**\n * Icons that can be overridden for {@link CallWithChatComposite}.\n *\n * @public\n */\n\nexport type CallWithChatCompositeIcons = {\n  // CallWithChat Specific Icons\n  ChevronLeft?: JSX.Element;\n  ControlBarChatButtonActive?: JSX.Element;\n  ControlBarChatButtonInactive?: JSX.Element;\n  ControlBarPeopleButton?: JSX.Element;\n  Link?: JSX.Element;\n  MoreDrawerMicrophones?: JSX.Element;\n  MoreDrawerPeople?: JSX.Element;\n  MoreDrawerSelectedMicrophone?: JSX.Element;\n  MoreDrawerSelectedSpeaker?: JSX.Element;\n  MoreDrawerSpeakers?: JSX.Element; // Call icons\n\n  ControlButtonCameraOff?: JSX.Element;\n  ControlButtonCameraOn?: JSX.Element;\n  ControlButtonEndCall?: JSX.Element;\n  ControlButtonMicOff?: JSX.Element;\n  ControlButtonMicOn?: JSX.Element;\n  ControlButtonOptions?: JSX.Element;\n  ControlButtonScreenShareStart?: JSX.Element;\n  ControlButtonScreenShareStop?: JSX.Element;\n  ErrorBarCallCameraAccessDenied?: JSX.Element;\n  ErrorBarCallCameraAlreadyInUse?: JSX.Element;\n  ErrorBarCallLocalVideoFreeze?: JSX.Element;\n  ErrorBarCallMacOsCameraAccessDenied?: JSX.Element;\n  ErrorBarCallMacOsMicrophoneAccessDenied?: JSX.Element;\n  ErrorBarCallMicrophoneAccessDenied?: JSX.Element;\n  ErrorBarCallMicrophoneMutedBySystem?: JSX.Element;\n  ErrorBarCallMicrophoneUnmutedBySystem?: JSX.Element;\n  ErrorBarCallNetworkQualityLow?: JSX.Element;\n  ErrorBarCallNoMicrophoneFound?: JSX.Element;\n  ErrorBarCallNoSpeakerFound?: JSX.Element;\n  ErrorBarClear?: JSX.Element;\n  HorizontalGalleryLeftButton?: JSX.Element;\n  HorizontalGalleryRightButton?: JSX.Element;\n  LobbyScreenConnectingToCall?: JSX.Element;\n  LobbyScreenWaitingToBeAdmitted?: JSX.Element;\n  LocalDeviceSettingsCamera?: JSX.Element;\n  LocalDeviceSettingsMic?: JSX.Element;\n  LocalDeviceSettingsSpeaker?: JSX.Element;\n  LocalPreviewPlaceholder?: JSX.Element;\n  Muted?: JSX.Element;\n  NetworkReconnectIcon?: JSX.Element;\n  NoticePageAccessDeniedTeamsMeeting?: JSX.Element;\n  NoticePageJoinCallFailedDueToNoNetwork?: JSX.Element;\n  NoticePageLeftCall?: JSX.Element;\n  NoticePageRemovedFromCall?: JSX.Element;\n  OptionsCamera?: JSX.Element;\n  OptionsMic?: JSX.Element;\n  OptionsSpeaker?: JSX.Element;\n  ParticipantItemMicOff?: JSX.Element;\n  ParticipantItemScreenShareStart?: JSX.Element;\n  VideoTileMicOff?: JSX.Element;\n  LocalCameraSwitch?: JSX.Element;\n  // Chat icons\n  EditBoxCancel?: JSX.Element;\n  EditBoxSubmit?: JSX.Element;\n  MessageDelivered?: JSX.Element;\n  MessageEdit?: JSX.Element;\n  MessageFailed?: JSX.Element;\n  MessageRemove?: JSX.Element;\n  MessageSeen?: JSX.Element;\n  MessageSending?: JSX.Element;\n  SendBoxSend?: JSX.Element;\n  SendBoxSendHovered?: JSX.Element;\n  SendBoxAttachFile?: JSX.Element; // Icons common to Call and Chat.\n\n  ParticipantItemOptions?: JSX.Element;\n  ParticipantItemOptionsHovered?: JSX.Element;\n};\n/**\n * Icon wrapper to use when including customizable icons inside the CallWithChatComposite.\n * This wrapper ensures the icon name is being type-checked helping ensure no typos\n * and ensure that icon is customizable through the composite API.\n *\n * @private\n */\n\nexport const CallWithChatCompositeIcon = (props: CompositeIconProps<CallWithChatCompositeIcons>): JSX.Element => <FontIcon {...props} />;\n/**\n * Icons that can be overridden in one of the composites exported by this library.\n *\n * See {@link ChatCompositeIcons}, {@link CallCompositeIcons} and {@link CallWithChatCompositeIcons} for more targeted types.\n *\n * @public\n */\n\nexport type CompositeIcons = ChatCompositeIcons & CallCompositeIcons & CallWithChatCompositeIcons;","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStyle } from '@fluentui/react/lib/Styling';\n/**\n * @private\n */\n\nexport const globalLayerHostStyle: IStyle = {\n  position: 'fixed',\n  zIndex: 1000000,\n  inset: '0px',\n  visibility: 'hidden'\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Customizer, LayerHost, mergeStyles, PartialTheme, registerIcons, Stack, Theme, useTheme } from '@fluentui/react';\nimport { FluentThemeProvider, ParticipantMenuItemsCallback } from '@internal/react-components';\nimport React, { createContext, useContext } from 'react';\nimport { CompositeLocale, LocalizationProvider } from '../localization';\nimport { AvatarPersonaDataCallback } from './AvatarPersona';\nimport { CallCompositeIcons, CallWithChatCompositeIcons, ChatCompositeIcons, DEFAULT_COMPOSITE_ICONS } from './icons';\nimport { globalLayerHostStyle } from './styles/GlobalHostLayer.styles';\nimport { useId } from '@fluentui/react-hooks';\n/**\n * Properties common to all composites exported from this library.\n *\n * @public\n */\n\nexport interface BaseCompositeProps<TIcons extends Record<string, JSX.Element>> {\n  /**\n   * Fluent theme for the composite.\n   *\n   * @defaultValue light theme\n   */\n  fluentTheme?: PartialTheme | Theme;\n  /**\n   * Custom Icon override for the composite.\n   * A JSX element can be provided to override the default icon.\n   */\n\n  icons?: TIcons;\n  /**\n   * Locale for the composite.\n   *\n   * @defaultValue English (US)\n   */\n\n  locale?: CompositeLocale;\n  /**\n   * Whether composite is displayed right-to-left.\n   *\n   * @defaultValue false\n   */\n\n  rtl?: boolean;\n  /**\n   * A callback function that can be used to provide custom data to Avatars rendered\n   * in Composite.\n   *\n   * This will not affect the displayName shown in the composite.\n   * The displayName throughout the composite will be what is provided to the adapter when the adapter is created.\n   * will be what is provided to the adapter when the adapter is created.\n   */\n\n  onFetchAvatarPersonaData?: AvatarPersonaDataCallback;\n  /**\n   * A callback function that can be used to provide custom menu items for a participant in\n   * participant list.\n   */\n\n  onFetchParticipantMenuItems?: ParticipantMenuItemsCallback;\n}\n/**\n * A base provider {@link React.Context} to wrap components with other required providers\n * (e.g. icons, FluentThemeProvider, LocalizationProvider).\n *\n * Required providers are only wrapped once, with all other instances only passing children.\n *\n * @private\n */\n\nexport const BaseProvider = (props: BaseCompositeProps<CallCompositeIcons | ChatCompositeIcons | CallWithChatCompositeIcons> & {\n  children: React.ReactNode;\n}): JSX.Element => {\n  const {\n    fluentTheme,\n    rtl,\n    locale\n  } = props;\n  const globalLayerHostId = useId('composite-global-hostId');\n  /**\n   * Pass only the children if we previously registered icons, and have previously wrapped the children in\n   * FluentThemeProvider and LocalizationProvider\n   */\n\n  const alreadyWrapped = useBase();\n\n  if (alreadyWrapped) {\n    return <>{props.children}</>;\n  }\n  /**\n   * We register the default icon mappings merged with custom icons provided through props\n   * to ensure all icons render correctly.\n   */\n\n\n  registerIcons({\n    icons: { ...DEFAULT_COMPOSITE_ICONS,\n      ...props.icons\n    }\n  }); // we use Customizer to override default LayerHost injected to <body />\n  // which stop polluting global dom tree and increase compatibility with react-full-screen\n\n  const CompositeElement = <FluentThemeProvider fluentTheme={fluentTheme} rtl={rtl}>\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0\" />\n      <Customizer scopedSettings={{\n      Layer: {\n        hostId: globalLayerHostId\n      }\n    }}>\n        <WithBackgroundColor>{props.children}</WithBackgroundColor>\n      </Customizer>\n      <LayerHost id={globalLayerHostId} className={mergeStyles(globalLayerHostStyle)} />\n    </FluentThemeProvider>;\n  const localizedElement = locale ? LocalizationProvider({\n    locale,\n    children: CompositeElement\n  }) : CompositeElement;\n  return <BaseContext.Provider value={true}>{localizedElement}</BaseContext.Provider>;\n};\n/**\n * @private\n */\n\nconst BaseContext = createContext<boolean>(false);\n/**\n * @private\n */\n\nconst useBase = (): boolean => useContext(BaseContext);\n/**\n * @private\n * Provides a wrapper with a background color to ensure that composites always have a background color.\n * This is necessary to ensure that composites are not transparent,\n * and the background color of it's parent elements doesn't show through the composite.\n */\n\n\nconst WithBackgroundColor = (props: {\n  children: React.ReactNode;\n}): JSX.Element => {\n  const {\n    children\n  } = props;\n  const theme = useTheme();\n  const className = mergeStyles({\n    background: theme.semanticColors.bodyBackground,\n    height: '100%',\n    width: '100%',\n    position: 'relative'\n  });\n  return <Stack className={className}>{children}</Stack>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { createContext, useContext } from 'react';\nimport { FileUploadManager } from '../file-sharing';\nimport { FileUploadAdapter } from './AzureCommunicationFileUploadAdapter';\nimport { ChatAdapter } from './ChatAdapter';\n/**\n * @private\n */\n\ntype ChatProviderProps = {\n  children: React.ReactNode;\n  adapter: ChatAdapter;\n};\nconst ChatAdapterContext = createContext<ChatAdapter | undefined>(undefined);\n/**\n * @private\n */\n\nexport const ChatAdapterProvider = (props: ChatProviderProps): JSX.Element => {\n  const {\n    adapter\n  } = props;\n  return <ChatAdapterContext.Provider value={adapter}>{props.children}</ChatAdapterContext.Provider>;\n};\n/**\n * @private\n */\n\nexport const useAdapter = (): ChatAdapter => {\n  const adapter = useContext(ChatAdapterContext);\n\n  if (!adapter) {\n    throw 'Cannot find adapter please initialize before usage.';\n  }\n\n  return adapter;\n};\n/**\n * @private\n */\n\nexport const useFileUploadAdapter = (): FileUploadAdapter => {\n  // A stub that short-circuits all logic because none of the fields are available.\n  return {\n    registerActiveFileUploads() {\n      return ([] as FileUploadManager[]);\n    },\n\n    registerCompletedFileUploads() {\n      return ([] as FileUploadManager[]);\n    },\n\n    cancelFileUpload() {// noop\n    },\n\n    clearFileUploads() {// noop\n    },\n\n    updateFileUploadErrorMessage() {// noop\n    },\n\n    updateFileUploadProgress() {// noop\n    },\n\n    updateFileUploadMetadata() {// noop\n    }\n\n  };\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStyle, memoizeFunction, mergeStyles } from '@fluentui/react';\nimport { MessageThreadStyles } from '@internal/react-components';\nconst MESSAGE_THREAD_WIDTH = '41.25rem';\n/**\n * @private\n * z-index to ensure that chat container has lower z-index than participant pane\n */\n\nexport const CHAT_CONTAINER_ZINDEX = 1;\n/**\n * @private\n */\n\nexport const chatScreenContainerStyle = mergeStyles({\n  height: '100%',\n  width: '100%',\n  minHeight: '13rem',\n  minWidth: '17.5rem'\n});\n/**\n * @private\n */\n\nexport const chatContainer = mergeStyles({\n  height: '100%',\n  width: '100%',\n  overflow: 'hidden',\n  '*::-webkit-scrollbar': {\n    width: '0.3rem',\n    height: '0.3rem'\n  },\n  '.scroll::-webkit-scrollbar-track': {\n    background: 'rgba(150, 150, 150)',\n    borderRadius: '0.3rem'\n  },\n  '*::-webkit-scrollbar-thumb': {\n    borderRadius: '10px',\n    background: 'rgba(150, 150, 150)'\n  }\n});\n/**\n * @private\n */\n\nexport const chatArea = mergeStyles({\n  height: '100%',\n  width: '100%',\n  overflow: 'auto',\n  position: 'relative' // Ensure that the absolute children components are positioned relative to the chat area\n\n});\n/**\n * @private\n */\n\nexport const chatWrapper = mergeStyles({\n  height: '100%',\n  width: '100%',\n  overflow: 'hidden',\n  zIndex: CHAT_CONTAINER_ZINDEX\n});\n/**\n * @private\n */\n\nexport const chatHeaderContainerStyle = mergeStyles({\n  width: '100%',\n  paddingLeft: '1.5rem',\n  paddingRight: '1.5rem',\n  '@media screen and (max-width: 25rem)': {\n    paddingLeft: '5%',\n    paddingRight: '5%'\n  },\n  borderBottom: '0.063rem solid #DDDDDD'\n});\n/**\n * @private\n */\n\nexport const topicNameLabelStyle = mergeStyles({\n  fontSize: '1.1rem',\n  lineHeight: '2.5rem',\n  fontWeight: 600,\n  marginRight: '0.125rem',\n  textOverflow: 'ellipsis',\n  overflowY: 'hidden'\n});\n/**\n * @private\n */\n\nexport const messageThreadChatCompositeStyles = memoizeFunction((background: string): MessageThreadStyles => ({\n  root: {\n    maxWidth: MESSAGE_THREAD_WIDTH\n  },\n  chatContainer: {\n    background: background\n  }\n}));\n/**\n * @private\n */\n\nexport const typingIndicatorContainerStyles: IStyle = {\n  padding: '0rem 0.25rem'\n};\n/**\n * @private\n */\n\nexport const sendboxContainerStyles: IStyle = {\n  maxWidth: MESSAGE_THREAD_WIDTH,\n  width: '100%',\n  alignSelf: 'center'\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IPersonaProps, Persona, PersonaInitialsColor } from '@fluentui/react';\nimport React, { useEffect, useState } from 'react';\n/**\n * Custom data attributes for displaying avatar for a user.\n *\n * @public\n */\n\nexport type AvatarPersonaData = {\n  /**\n   * Primary text to display, usually the name of the person.\n   */\n  text?: string;\n  /**\n   * Image URL to use, should be a square aspect ratio and big enough to fit in the image area.\n   */\n\n  imageUrl?: string;\n  /**\n   * The user's initials to display in the image area when there is no image.\n   * @defaultvalue Derived from `text`\n   */\n\n  imageInitials?: string;\n  /**\n   * The background color when the user's initials are displayed.\n   * @defaultvalue Derived from `text`\n   */\n\n  initialsColor?: PersonaInitialsColor | string;\n  /**\n   * The text color when the user's initials are displayed\n   * @defaultvalue `white`\n   */\n\n  initialsTextColor?: string;\n};\n/**\n * Callback function used to provide custom data to build an avatar for a user.\n *\n * @public\n */\n\nexport type AvatarPersonaDataCallback = (userId: string) => Promise<AvatarPersonaData>;\n/**\n * @private\n */\n\nexport interface AvatarPersonaProps extends IPersonaProps {\n  /**\n   * Azure Communicator user ID.\n   */\n  userId?: string;\n  /**\n   * A function that returns a Promise that resolves to the data to be displayed.\n   */\n\n  dataProvider?: AvatarPersonaDataCallback;\n}\n/**\n * An Avatar component made using the `Persona` component.\n * It allows you to specify a `userId` and a `dataProvider` to retrieve the `AvatarPersonaData`.\n * Read more about `Persona` component at https://developer.microsoft.com/fluentui#/controls/web/persona\n *\n * @private\n */\n\nexport const AvatarPersona = (props: AvatarPersonaProps): JSX.Element => {\n  const {\n    userId,\n    dataProvider,\n    text,\n    imageUrl,\n    imageInitials,\n    initialsColor,\n    initialsTextColor,\n    showOverflowTooltip\n  } = props;\n  const [data, setData] = useState<AvatarPersonaData | undefined>();\n  useEffect(() => {\n    (async () => {\n      if (dataProvider && userId) {\n        const newData = await dataProvider(userId);\n\n        if (avatarDeepDifferenceCheck(data, newData)) {\n          setData(newData);\n        }\n      }\n    })();\n  }, [data, dataProvider, userId]);\n  return <Persona {...props} text={data?.text ?? text} imageUrl={data?.imageUrl ?? imageUrl} imageInitials={data?.imageInitials ?? imageInitials} initialsColor={data?.initialsColor ?? initialsColor} initialsTextColor={data?.initialsTextColor ?? initialsTextColor ?? 'white'} // default disable tooltip unless specified\n  showOverflowTooltip={showOverflowTooltip ?? false} />;\n};\n\nconst avatarDeepDifferenceCheck = (currentData?: AvatarPersonaData, newData?: AvatarPersonaData): boolean => {\n  return currentData?.text !== newData?.text || currentData?.imageUrl !== newData?.imageUrl || currentData?.initialsColor !== newData?.initialsColor || currentData?.imageInitials !== newData?.imageInitials || currentData?.initialsTextColor !== newData?.initialsTextColor;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\nimport * as reselect from 'reselect';\nimport { ChatClientState } from '@internal/chat-stateful-client';\nimport { ChatBaseSelectorProps } from '@internal/chat-component-bindings';\nimport { chatHeaderContainerStyle, topicNameLabelStyle } from './styles/Chat.styles';\n/**\n * @private\n */\n\nexport type HeaderProps = {\n  topic: string;\n};\n/**\n * @private\n */\n\nexport const ChatHeader = (props: HeaderProps): JSX.Element => {\n  return <Stack className={chatHeaderContainerStyle} horizontal>\n      <Stack.Item align=\"center\">\n        <div className={topicNameLabelStyle}>{props.topic}</div>\n      </Stack.Item>\n    </Stack>;\n};\n\nconst getTopicName = (state: ChatClientState, props: ChatBaseSelectorProps): string => {\n  return state.threads[props.threadId]?.properties?.topic || '';\n};\n/**\n * @private\n */\n\n\nexport const getHeaderProps = reselect.createSelector([getTopicName], (topic): HeaderProps => {\n  return {\n    topic: topic\n  };\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IconButton, mergeStyles, Stack, useTheme } from '@fluentui/react';\nimport React from 'react';\nimport { ChatCompositeIcon } from '../../common/icons';\n\n/**\n * Props for {@link FileUploadButton} component.\n * @internal\n */\nexport interface FileUploadButtonProps {\n  /**\n   * A string containing the comma separated list of accepted file types.\n   * Similar to the `accept` attribute of the `<input type=\"file\" />` element.\n   */\n  accept?: string;\n  /**\n   * Allows multiple files to be selected if set to `true`.\n   * Default value is `false`.\n   * Similar to the `multiple` attribute of the `<input type=\"file\" />` element.\n   */\n\n  multiple?: boolean;\n  /**\n   * onChange handler for the file upload button.\n   * Similar to the `onChange` attribute of the `<input type=\"file\" />` element.\n   * Called every time files are selected through the file upload button with a {@link FileList}\n   * of selected files.\n   */\n\n  onChange?: (files: FileList | null) => void;\n}\n/**\n * @internal\n */\n\nexport const FileUploadButton = (props: FileUploadButtonProps): JSX.Element => {\n  const inputRef = React.useRef<HTMLInputElement>(null);\n  const theme = useTheme();\n  const {\n    accept,\n    multiple = false,\n    onChange\n  } = props;\n  const fileUploadButtonClassName = mergeStyles({\n    width: '1.5rem',\n    height: '1.5rem',\n    cursor: 'pointer',\n    padding: '0.15rem',\n    ':hover': {\n      backgroundColor: theme.palette.neutralLighter\n    }\n  });\n  const iconButtonClassName = mergeStyles({\n    color: 'unset',\n    width: '1.5rem',\n    height: '1.5rem',\n    ':hover': {\n      color: 'unset',\n      background: 'transparent'\n    }\n  });\n  return <>\n      <Stack verticalAlign=\"center\" horizontalAlign=\"center\" className={fileUploadButtonClassName} onClick={() => {\n      inputRef.current?.click();\n    }}>\n        <IconButton className={iconButtonClassName} ariaLabel={uploadFileButtonStringTrampoline()}>\n          <SendBoxAttachFileIconTrampoline />\n        </IconButton>\n      </Stack>\n      <input ref={inputRef} hidden multiple={multiple} accept={accept} type=\"file\" onClick={e => {\n      // To ensure that `onChange` is fired even if the same file is picked again.\n      e.currentTarget.value = '';\n    }} onChange={e => {\n      onChange && onChange(e.currentTarget.files);\n    }} />\n    </>;\n};\n\nconst SendBoxAttachFileIconTrampoline = (): JSX.Element => {\n  // Return _some_ available icon, as the real icon is beta-only.\n  return <ChatCompositeIcon iconName=\"EditBoxCancel\" />;\n};\n/**\n * A wrapper to return {@link FileUploadButton} component conditionally.\n * It will return `<></>` for stable builds.\n * @internal\n */\n\n\nexport const FileUploadButtonWrapper = (props: Pick<FileUploadButtonProps, 'accept' | 'multiple' | 'onChange'>): JSX.Element => {\n  return <>\n      {}\n    </>;\n};\n\nconst uploadFileButtonStringTrampoline = (): string => {\n  return '';\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { ChatClientState, ChatErrors, ChatThreadClientState } from '@internal/chat-stateful-client';\nimport { useState, useEffect, useRef, useMemo } from 'react';\nimport { ChatAdapterState } from '../adapter/ChatAdapter';\nimport { useAdapter } from '../adapter/ChatAdapterProvider';\nimport memoizeOne from 'memoize-one';\nimport { CommunicationIdentifierKind } from '@azure/communication-common';\n/**\n * @private\n */\n\nexport const useAdaptedSelector = <SelectorT extends (state: ChatClientState, props: any) => any,>(selector: SelectorT, selectorProps?: Parameters<SelectorT>[1]): ReturnType<SelectorT> => {\n  return useSelectorWithAdaptation(selector, adaptCompositeState, selectorProps);\n};\n/**\n * @private\n */\n\nexport const useSelectorWithAdaptation = <SelectorT extends (state: ReturnType<AdaptFuncT>, props: any) => any, AdaptFuncT extends (state: ChatAdapterState) => any>(selector: SelectorT, adaptState: AdaptFuncT, selectorProps?: Parameters<SelectorT>[1]): ReturnType<SelectorT> => {\n  const adapter = useAdapter(); // Keeps track of whether the current component is mounted or not. If it has unmounted, make sure we do not modify the\n  // state or it will cause React warnings in the console. https://skype.visualstudio.com/SPOOL/_workitems/edit/2453212\n\n  const mounted = useRef(false);\n  useEffect(() => {\n    mounted.current = true;\n    return () => {\n      mounted.current = false;\n    };\n  });\n  const threadId = adapter.getState().thread.threadId;\n  const threadConfigProps = useMemo(() => ({\n    threadId\n  }), [threadId]);\n  const [props, setProps] = useState(selector(adaptState(adapter.getState()), selectorProps ?? threadConfigProps));\n  const propRef = useRef(props);\n  propRef.current = props;\n  useEffect(() => {\n    const onStateChange = (state: ChatAdapterState): void => {\n      if (!mounted.current) {\n        return;\n      }\n\n      const newProps = selector(adaptState(state), selectorProps ?? threadConfigProps);\n\n      if (propRef.current !== newProps) {\n        setProps(newProps);\n      }\n    };\n\n    adapter.onStateChange(onStateChange);\n    return () => {\n      adapter.offStateChange(onStateChange);\n    };\n  }, [adaptState, adapter, selector, selectorProps, threadConfigProps]);\n  return props;\n};\nconst memoizeState = memoizeOne((userId: CommunicationIdentifierKind, displayName: string, threads: {\n  [key: string]: ChatThreadClientState;\n}, latestErrors: ChatErrors) => ({\n  userId,\n  displayName,\n  threads,\n  latestErrors\n}));\nconst memoizeThreads = memoizeOne((thread: ChatThreadClientState) => ({\n  [thread.threadId]: thread\n}));\n\nconst adaptCompositeState = (compositeState: ChatAdapterState): ChatClientState => {\n  return memoizeState(compositeState.userId, compositeState.displayName, memoizeThreads(compositeState.thread), ( // This is an unsafe type expansion.\n  // compositeState.latestErrors can contain properties that are not valid in ChatErrors.\n  //\n  // But there is no way to check for valid property names at runtime:\n  // - The set of valid property names is built from types in the @azure/communication-chat.\n  //   Thus we don't have a literal array of allowed strings at runtime.\n  // - Due to minification / uglification, the property names from the objects at runtime can't be used\n  //   to compare against permissible values inferred from the types.\n  //\n  // This is not a huge problem -- it simply means that our adapted selector will include some extra operations\n  // that are unknown to the UI component and data binding libraries. Generic handling of the errors (e.g.,\n  // just displaying them in some UI surface) will continue to work for these operations. Handling of\n  // specific operations (e.g., acting on errors related to permission issues) will ignore these operations.\n  compositeState.latestErrors as ChatErrors));\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CommonProperties } from '@internal/acs-ui-common';\nimport { ChatHandlers } from '@internal/chat-component-bindings';\nimport { ReactElement } from 'react';\nimport memoizeOne from 'memoize-one';\nimport { ChatAdapter } from '../adapter/ChatAdapter';\nimport { useAdapter } from '../adapter/ChatAdapterProvider';\n/**\n * @private\n */\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/explicit-function-return-type\n\nexport const useHandlers = <PropsT,>(_component: (props: PropsT) => ReactElement | null): Pick<ChatHandlers, CommonProperties<ChatHandlers, PropsT>> => {\n  return createCompositeHandlers(useAdapter());\n};\nconst createCompositeHandlers = memoizeOne((adapter: ChatAdapter): ChatHandlers => ({\n  onSendMessage: adapter.sendMessage,\n  onLoadPreviousChatMessages: adapter.loadPreviousChatMessages,\n  onMessageSeen: adapter.sendReadReceipt,\n  onTyping: adapter.sendTypingIndicator,\n  onRemoveParticipant: adapter.removeParticipant,\n  updateThreadTopicName: adapter.setTopic,\n  onUpdateMessage: adapter.updateMessage,\n  onDeleteMessage: adapter.deleteMessage\n}));","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { getChatSelector, ChatHandlers, GetChatSelector } from '@internal/chat-component-bindings';\nimport { useHandlers } from './useHandlers';\nimport { useAdaptedSelector } from './useAdaptedSelector';\nimport { Common } from '@internal/acs-ui-common';\ntype Selector = (state: any, props: any) => any;\n/**\n * @private\n */\n\nexport const usePropsFor = <Component extends (props: any) => JSX.Element,>(component: Component): GetChatSelector<Component> extends Selector ? ReturnType<GetChatSelector<Component>> & Common<ChatHandlers, Parameters<Component>[0]> : Record<string, never> => {\n  const selector = getChatSelector(component);\n\n  if (!selector) {\n    throw new Error(\"Can't find the selector for component, please check supported component list\");\n  }\n\n  return { ...useAdaptedSelector((selector as Selector)),\n    ...useHandlers(component)\n  };\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStackStyles, IStackItemStyles, IStackTokens, mergeStyles, Theme, ITextStyles } from '@fluentui/react';\nimport { ParticipantListStyles } from '@internal/react-components';\nimport { CHAT_CONTAINER_ZINDEX } from '../../ChatComposite/styles/Chat.styles';\n/**\n * @private\n */\n\nexport const sidePaneContainerStyles: IStackItemStyles = {\n  root: {\n    height: '100%',\n    padding: '0.5rem 0.25rem',\n    width: '21.5rem'\n  }\n};\n/**\n * @private\n */\n\nexport const sidePaneContainerHiddenStyles: IStackItemStyles = {\n  root: { ...sidePaneContainerStyles,\n    display: 'none'\n  }\n};\n/**\n * @private\n */\n\nexport const sidePaneContainerTokens: IStackTokens = {\n  childrenGap: '0.5rem'\n};\n/**\n * @private\n */\n\nexport const sidePaneHeaderStyles: IStackItemStyles = {\n  root: {\n    lineHeight: '1.25rem',\n    padding: '0.25rem',\n    fontWeight: '600'\n  }\n};\n/**\n * @private\n */\n\nexport const sidePaneHeaderContainerStyles: IStackStyles = {\n  root: {\n    margin: '0 0.25rem'\n  }\n};\n/**\n * @private\n */\n\nexport const paneBodyContainer: IStackStyles = {\n  root: {\n    flexDirection: 'column',\n    display: 'flex'\n  }\n};\n/**\n * @private\n */\n\nexport const scrollableContainer: IStackStyles = {\n  root: {\n    flexBasis: '0',\n    flexGrow: '1',\n    overflowY: 'auto'\n  }\n};\n/**\n * @private\n */\n\nexport const scrollableContainerContents: IStackItemStyles = {\n  root: {\n    flexGrow: '1',\n    flexBasis: '0',\n    maxWidth: '100%',\n    // Create a new stacking context so that `pipStyles` can set zIndex above the container.\n    position: 'relative'\n  }\n};\n/**\n * @private\n */\n\nexport const peopleSubheadingStyle: IStackItemStyles = {\n  root: {\n    fontSize: '0.75rem'\n  }\n};\n/**\n * @private\n */\n\nexport const peoplePaneContainerTokens: IStackTokens = {\n  childrenGap: '0.5rem'\n};\n/**\n * @private\n */\n\nexport const participantListWrapper = (theme: Theme): string => mergeStyles({\n  width: '20rem',\n  maxWidth: '50%',\n  height: '100%',\n  position: 'absolute',\n  right: '0',\n  boxShadow: theme.effects.elevation16,\n  background: theme.semanticColors.bodyBackground,\n  // zIndex to set the participant pane above the chat container\n  zIndex: CHAT_CONTAINER_ZINDEX + 1\n});\n/**\n * @private\n */\n\nexport const participantListContainerPadding = {\n  childrenGap: '0.5rem'\n};\n/**\n * @private\n */\n\nexport const participantListStack = mergeStyles({\n  height: '100%'\n});\n/**\n * @private\n */\n\nexport const participantListContainerStyle = mergeStyles({\n  height: '100%',\n  overflowY: 'auto',\n  overflowX: 'hidden'\n});\n/**\n * @private\n */\n\nexport const participantListStyle: ParticipantListStyles = {\n  root: {\n    padding: '0rem'\n  },\n  participantItemStyles: {\n    root: {\n      padding: '0.5rem'\n    }\n  }\n};\n/**\n * @private\n */\n\nexport const participantListMobileStyle: ParticipantListStyles = {\n  root: {\n    padding: '0rem'\n  },\n  participantItemStyles: {\n    root: {\n      padding: '0.5rem 1rem'\n    }\n  }\n};\n/**\n * @private\n */\n\nexport const displayNameStyles: ITextStyles = {\n  root: {\n    padding: '0.5rem',\n    textOverflow: 'ellipsis',\n    overflow: 'hidden'\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles, Stack } from '@fluentui/react';\nimport { CommunicationParticipant, ErrorBar, MessageProps, MessageRenderer, MessageThread, MessageThreadStyles, ParticipantMenuItemsCallback, SendBox, SendBoxStylesProps, TypingIndicator, TypingIndicatorStylesProps, useTheme } from '@internal/react-components';\nimport React, { useCallback, useEffect } from 'react';\nimport { AvatarPersona, AvatarPersonaDataCallback } from '../common/AvatarPersona';\nimport { useAdapter } from './adapter/ChatAdapterProvider';\nimport { ChatCompositeOptions } from './ChatComposite';\nimport { ChatHeader, getHeaderProps } from './ChatHeader';\nimport { FileDownloadHandler } from '@internal/react-components';\nimport { FileUploadButtonWrapper as FileUploadButton, FileUploadHandler } from './file-sharing';\nimport { useAdaptedSelector } from './hooks/useAdaptedSelector';\nimport { usePropsFor } from './hooks/usePropsFor';\nimport { chatArea, chatContainer, chatWrapper, messageThreadChatCompositeStyles, sendboxContainerStyles, typingIndicatorContainerStyles } from './styles/Chat.styles';\nimport { participantListContainerPadding } from '../common/styles/ParticipantContainer.styles';\nimport { toFlatCommunicationIdentifier } from '@internal/acs-ui-common';\n\n/**\n * @private\n */\nexport type ChatScreenProps = {\n  options?: ChatCompositeOptions;\n  onFetchAvatarPersonaData?: AvatarPersonaDataCallback;\n  onRenderMessage?: (messageProps: MessageProps, defaultOnRender?: MessageRenderer) => JSX.Element;\n  onRenderTypingIndicator?: (typingUsers: CommunicationParticipant[]) => JSX.Element;\n  onFetchParticipantMenuItems?: ParticipantMenuItemsCallback;\n  styles?: ChatScreenStyles;\n  hasFocusOnMount?: 'sendBoxTextField';\n  fileSharing?: FileSharingOptions;\n  formFactor?: 'desktop' | 'mobile';\n};\n/**\n * @private\n */\n\nexport type ChatScreenStyles = {\n  messageThread?: MessageThreadStyles;\n  sendBox?: SendBoxStylesProps;\n  typingIndicator?: TypingIndicatorStylesProps;\n};\n/**\n * Properties for configuring the File Sharing feature.\n * @beta\n */\n\nexport interface FileSharingOptions {\n  /**\n   * A string containing the comma separated list of accepted file types.\n   * Similar to the `accept` attribute of the `<input type=\"file\" />` element.\n   * Accepts any type of file if not specified.\n   * @beta\n   */\n  accept?: string;\n  /**\n   * Allows multiple files to be selected if set to `true`.\n   * Similar to the `multiple` attribute of the `<input type=\"file\" />` element.\n   * @defaultValue false\n   * @beta\n   */\n\n  multiple?: boolean;\n  /**\n   * A function of type {@link FileUploadHandler} for handling file uploads.\n   * @beta\n   */\n\n  uploadHandler: FileUploadHandler;\n  /**\n   * A function of type {@link FileDownloadHandler} for handling file downloads.\n   * If the function is not specified, the file's `url` will be opened in a new tab to\n   * initiate the download.\n   */\n\n  downloadHandler?: FileDownloadHandler;\n}\n/**\n * @private\n */\n\nexport const ChatScreen = (props: ChatScreenProps): JSX.Element => {\n  const {\n    onFetchAvatarPersonaData,\n    onRenderMessage,\n    onRenderTypingIndicator,\n    options,\n    styles,\n    fileSharing,\n    formFactor\n  } = props;\n  const defaultNumberOfChatMessagesToReload = 5;\n  const adapter = useAdapter();\n  const theme = useTheme();\n  useEffect(() => {\n    // Initial data should be always fetched by the composite(or external caller) instead of the adapter\n    adapter.fetchInitialData();\n  }, [adapter]);\n  const messageThreadProps = usePropsFor(MessageThread);\n  const sendBoxProps = usePropsFor(SendBox);\n  const typingIndicatorProps = usePropsFor(TypingIndicator);\n  const headerProps = useAdaptedSelector(getHeaderProps);\n  const errorBarProps = usePropsFor(ErrorBar);\n  const onRenderAvatarCallback = useCallback((userId, defaultOptions) => {\n    return <AvatarPersona userId={userId} hidePersonaDetails={true} {...defaultOptions} dataProvider={onFetchAvatarPersonaData} />;\n  }, [onFetchAvatarPersonaData]);\n  const messageThreadStyles = Object.assign({}, messageThreadChatCompositeStyles(theme.semanticColors.bodyBackground), styles?.messageThread);\n  const typingIndicatorStyles = Object.assign({}, styles?.typingIndicator);\n  const sendBoxStyles = Object.assign({}, styles?.sendBox);\n  const userId = toFlatCommunicationIdentifier(adapter.getState().userId);\n  const fileUploadButtonOnChange = useCallback((files: FileList | null): void => {\n    if (!files) {\n      return;\n    }\n  }, [adapter, fileSharing, userId]);\n  const AttachFileButton = useCallback(() => {\n    if (!fileSharing?.uploadHandler) {\n      return null;\n    }\n\n    return <FileUploadButton accept={fileSharing?.accept} multiple={fileSharing?.multiple} onChange={fileUploadButtonOnChange} />;\n  }, [fileSharing?.accept, fileSharing?.multiple, fileSharing?.uploadHandler, fileUploadButtonOnChange]);\n  return <Stack className={chatContainer} grow>\n      {options?.topic !== false && <ChatHeader {...headerProps} />}\n      <Stack className={chatArea} tokens={participantListContainerPadding} horizontal grow>\n        <Stack className={chatWrapper} grow>\n          {options?.errorBar !== false && <ErrorBar {...errorBarProps} />}\n          {}\n          <MessageThread {...messageThreadProps} onRenderAvatar={onRenderAvatarCallback} onRenderMessage={onRenderMessage} numberOfChatMessagesToReload={defaultNumberOfChatMessagesToReload} styles={messageThreadStyles} />\n          <Stack className={mergeStyles(sendboxContainerStyles)}>\n            <div className={mergeStyles(typingIndicatorContainerStyles)}>\n              {onRenderTypingIndicator ? onRenderTypingIndicator(typingIndicatorProps.typingUsers) : <TypingIndicator {...typingIndicatorProps} styles={typingIndicatorStyles} />}\n            </div>\n            <Stack horizontal={formFactor === 'mobile'}>\n              {formFactor === 'mobile' && <Stack verticalAlign=\"center\">\n                  <AttachFileButton />\n                </Stack>}\n              <Stack grow>\n                <SendBox {...sendBoxProps} autoFocus={options?.autoFocus} styles={sendBoxStyles} />\n              </Stack>\n              {formFactor !== 'mobile' && <AttachFileButton />}\n            </Stack>\n          </Stack>\n        </Stack>\n        {}\n      </Stack>\n    </Stack>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CommunicationParticipant, MessageRenderer, MessageProps } from '@internal/react-components';\nimport React from 'react';\nimport { BaseProvider, BaseCompositeProps } from '../common/BaseComposite';\nimport { ChatCompositeIcons } from '../common/icons';\nimport { ChatAdapter } from './adapter/ChatAdapter';\nimport { ChatAdapterProvider } from './adapter/ChatAdapterProvider';\nimport { chatScreenContainerStyle } from './styles/Chat.styles';\nimport { ChatScreen } from './ChatScreen';\n\n/**\n * Props for {@link ChatComposite}.\n *\n * @public\n */\nexport interface ChatCompositeProps extends BaseCompositeProps<ChatCompositeIcons> {\n  /**\n   * An adapter provides logic and data to the composite.\n   * Composite can also be controlled using the adapter.\n   */\n  adapter: ChatAdapter;\n  /**\n   * `(messageProps: MessageProps, defaultOnRender?: MessageRenderer) => JSX.Element`\n   * A callback for customizing the message renderer.\n   */\n\n  onRenderMessage?: (messageProps: MessageProps, defaultOnRender?: MessageRenderer) => JSX.Element;\n  /**\n   * `(typingUsers: CommunicationParticipant[]) => JSX.Element`\n   * A callback for customizing the typing indicator renderer.\n   */\n\n  onRenderTypingIndicator?: (typingUsers: CommunicationParticipant[]) => JSX.Element;\n  /**\n   * Flags to enable/disable visual elements of the {@link ChatComposite}.\n   */\n\n  options?: ChatCompositeOptions;\n}\n/**\n * Optional features of the {@link ChatComposite}.\n *\n * @public\n */\n\nexport type ChatCompositeOptions = {\n  /**\n   * Surface Azure Communication Services backend errors in the UI with {@link @azure/communication-react#ErrorBar}.\n   * Hide or show the error bar.\n   * @defaultValue true\n   */\n  errorBar?: boolean;\n\n  /**\n   * Show or hide the topic at the top of the chat. Hidden if set to `false`\n   * @defaultValue true\n   */\n  topic?: boolean;\n  /**\n   * enumerable to determine if the input box has focus on render or not.\n   * When undefined nothing has focus on render\n   */\n\n  autoFocus?: 'sendBoxTextField';\n};\n/**\n * A customizable UI composite for the chat experience.\n *\n * @remarks Chat composite min width and height are respectively 17.5rem and 20rem (280px and 320px, with default rem at 16px)\n *\n * @public\n */\n\nexport const ChatComposite = (props: ChatCompositeProps): JSX.Element => {\n  const {\n    adapter,\n    options,\n    onFetchAvatarPersonaData,\n    onRenderTypingIndicator,\n    onRenderMessage,\n    onFetchParticipantMenuItems\n  } = props;\n  const formFactor = props['formFactor'] || 'desktop';\n  /**\n   * @TODO Remove this function and pass the props directly when file-sharing is promoted to stable.\n   * @private\n   */\n  // eslint-disable-next-line @typescript-eslint/explicit-function-return-type\n\n  const fileSharingOptions = () => {\n    return {};\n  };\n\n  return <div className={chatScreenContainerStyle}>\n      <BaseProvider {...props}>\n        <ChatAdapterProvider adapter={adapter}>\n          <ChatScreen formFactor={formFactor} options={options} onFetchAvatarPersonaData={onFetchAvatarPersonaData} onRenderTypingIndicator={onRenderTypingIndicator} onRenderMessage={onRenderMessage} onFetchParticipantMenuItems={onFetchParticipantMenuItems} {...fileSharingOptions()} />\n        </ChatAdapterProvider>\n      </BaseProvider>\n    </div>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { createContext, useContext } from 'react';\nimport { CallAdapter } from './CallAdapter';\ntype CallProviderProps = {\n  children: React.ReactNode;\n  adapter: CallAdapter;\n};\nconst CallAdapterContext = createContext<CallAdapter | undefined>(undefined);\n/**\n * @private\n */\n\nexport const CallAdapterProvider = (props: CallProviderProps): JSX.Element => {\n  const {\n    adapter\n  } = props;\n  return <CallAdapterContext.Provider value={adapter}>{props.children}</CallAdapterContext.Provider>;\n};\n/**\n * @private\n */\n\nexport const useAdapter = (): CallAdapter => {\n  const adapter = useContext(CallAdapterContext);\n\n  if (!adapter) {\n    throw 'Cannot find adapter please initialize before usage.';\n  }\n\n  return adapter;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStyle } from '@fluentui/react';\n/** @private */\n\nexport type ContainerRectProps = {\n  containerHeight?: number;\n  containerWidth?: number;\n};\n/** @private */\n\nexport const containerDivStyles: IStyle = {\n  position: 'relative',\n  width: '100%',\n  height: '100%'\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { useState, useEffect, useRef, useMemo } from 'react';\nimport memoizeOne from 'memoize-one';\nimport { useAdapter } from '../adapter/CallAdapterProvider';\nimport { CallAdapterState } from '../adapter/CallAdapter';\nimport { CallErrors, CallState, CallClientState, DeviceManagerState } from '@internal/calling-stateful-client';\nimport { CommunicationIdentifierKind } from '@azure/communication-common';\n/**\n * @private\n */\n\nexport const useAdaptedSelector = <SelectorT extends (state: CallClientState, props: any) => any,>(selector: SelectorT, selectorProps?: Parameters<SelectorT>[1]): ReturnType<SelectorT> => {\n  return useSelectorWithAdaptation(selector, adaptCompositeState, selectorProps);\n};\n/**\n * @private\n */\n\nexport const useSelectorWithAdaptation = <SelectorT extends (state: ReturnType<AdaptFuncT>, props: any) => any, AdaptFuncT extends (state: CallAdapterState) => any>(selector: SelectorT, adaptState: AdaptFuncT, selectorProps?: Parameters<SelectorT>[1]): ReturnType<SelectorT> => {\n  const adapter = useAdapter(); // Keeps track of whether the current component is mounted or not. If it has unmounted, make sure we do not modify the\n  // state or it will cause React warnings in the console. https://skype.visualstudio.com/SPOOL/_workitems/edit/2453212\n\n  const mounted = useRef(false);\n  useEffect(() => {\n    mounted.current = true;\n    return () => {\n      mounted.current = false;\n    };\n  });\n  const callId = adapter.getState().call?.id;\n  const callConfigProps = useMemo(() => ({\n    callId\n  }), [callId]);\n  const [props, setProps] = useState(selector(adaptState(adapter.getState()), selectorProps ?? callConfigProps));\n  const propRef = useRef(props);\n  propRef.current = props;\n  useEffect(() => {\n    const onStateChange = (state: CallAdapterState): void => {\n      if (!mounted.current) {\n        return;\n      }\n\n      const newProps = selector(adaptState(state), selectorProps ?? callConfigProps);\n\n      if (propRef.current !== newProps) {\n        setProps(newProps);\n      }\n    };\n\n    adapter.onStateChange(onStateChange);\n    return () => {\n      adapter.offStateChange(onStateChange);\n    };\n  }, [adaptState, adapter, selector, selectorProps, callConfigProps]);\n  return props;\n};\nconst memoizeState = memoizeOne((userId: CommunicationIdentifierKind, deviceManager: DeviceManagerState, calls: {\n  [key: string]: CallState;\n}, latestErrors: CallErrors, displayName?: string): CallClientState => ({\n  userId,\n  incomingCalls: {},\n  incomingCallsEnded: {},\n  callsEnded: {},\n  deviceManager,\n  callAgent: {\n    displayName\n  },\n  calls,\n  latestErrors\n}));\nconst memoizeCalls = memoizeOne((call?: CallState): {\n  [key: string]: CallState;\n} => call ? {\n  [call.id]: call\n} : {});\n\nconst adaptCompositeState = (compositeState: CallAdapterState): CallClientState => {\n  return memoizeState(compositeState.userId, compositeState.devices, memoizeCalls(compositeState.call), ( // This is an unsafe type expansion.\n  // compositeState.latestErrors can contain properties that are not valid in CallErrors.\n  //\n  // But there is no way to check for valid property names at runtime:\n  // - The set of valid property names is built from types in the @azure/communication-calling.\n  //   Thus we don't have a literal array of allowed strings at runtime.\n  // - Due to minification / uglification, the property names from the objects at runtime can't be used\n  //   to compare against permissible values inferred from the types.\n  //\n  // This is not a huge problem -- it simply means that our adapted selector will include some extra operations\n  // that are unknown to the UI component and data binding libraries. Generic handling of the errors (e.g.,\n  // just displaying them in some UI surface) will continue to work for these operations. Handling of\n  // specific operations (e.g., acting on errors related to permission issues) will ignore these operations.\n  compositeState.latestErrors as CallErrors), compositeState.displayName);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CallState, DeviceManagerState } from '@internal/calling-stateful-client';\nimport type { AudioDeviceInfo, VideoDeviceInfo, Call, PermissionConstraints, RemoteParticipant, StartCallOptions, MediaDiagnosticChangedEventArgs, NetworkDiagnosticChangedEventArgs, PropertyChangedEvent } from '@azure/communication-calling';\nimport { CreateVideoStreamViewResult, VideoStreamOptions } from '@internal/react-components';\nimport type { CommunicationIdentifierKind } from '@azure/communication-common';\nimport type { AdapterState, Disposable, AdapterError, AdapterErrors } from '../../common/adapters';\n/**\n * Major UI screens shown in the {@link CallComposite}.\n *\n * @public\n */\n\nexport type CallCompositePage = 'accessDeniedTeamsMeeting' | 'call' | 'configuration' | 'joinCallFailedDueToNoNetwork' | 'leftCall' | 'lobby' | 'removedFromCall';\n/**\n * Subset of CallCompositePages that represent an end call state.\n * @private\n */\n\nexport const END_CALL_PAGES: CallCompositePage[] = ['accessDeniedTeamsMeeting', 'joinCallFailedDueToNoNetwork', 'leftCall', 'removedFromCall'];\n/**\n * {@link CallAdapter} state for pure UI purposes.\n *\n * @public\n */\n\nexport type CallAdapterUiState = {\n  isLocalPreviewMicrophoneEnabled: boolean;\n  page: CallCompositePage;\n};\n/**\n * {@link CallAdapter} state inferred from Azure Communication Services backend.\n *\n * @public\n */\n\nexport type CallAdapterClientState = {\n  userId: CommunicationIdentifierKind;\n  displayName?: string;\n  call?: CallState;\n  devices: DeviceManagerState;\n  endedCall?: CallState;\n  isTeamsCall: boolean;\n  /**\n   * Latest error encountered for each operation performed via the adapter.\n   */\n\n  latestErrors: AdapterErrors;\n};\n/**\n * {@link CallAdapter} state.\n *\n * @public\n */\n\nexport type CallAdapterState = CallAdapterUiState & CallAdapterClientState;\n/**\n * Callback for {@link CallAdapterSubscribers} 'participantsJoined' event.\n *\n * @public\n */\n\nexport type ParticipantsJoinedListener = (event: {\n  joined: RemoteParticipant[];\n}) => void;\n/**\n * Callback for {@link CallAdapterSubscribers} 'participantsLeft' event.\n *\n * @public\n */\n\nexport type ParticipantsLeftListener = (event: {\n  removed: RemoteParticipant[];\n}) => void;\n/**\n * Callback for {@link CallAdapterSubscribers} 'isMuted' event.\n *\n * @public\n */\n\nexport type IsMutedChangedListener = (event: {\n  identifier: CommunicationIdentifierKind;\n  isMuted: boolean;\n}) => void;\n/**\n * Callback for {@link CallAdapterSubscribers} 'callIdChanged' event.\n *\n * @public\n */\n\nexport type CallIdChangedListener = (event: {\n  callId: string;\n}) => void;\n/**\n * Callback for {@link CallAdapterSubscribers} 'isLocalScreenSharingActiveChanged' event.\n *\n * @public\n */\n\nexport type IsLocalScreenSharingActiveChangedListener = (event: {\n  isScreenSharingOn: boolean;\n}) => void;\n/**\n * Callback for {@link CallAdapterSubscribers} 'isSpeakingChanged' event.\n *\n * @public\n */\n\nexport type IsSpeakingChangedListener = (event: {\n  identifier: CommunicationIdentifierKind;\n  isSpeaking: boolean;\n}) => void;\n/**\n * Callback for {@link CallAdapterSubscribers} 'displayNameChanged' event.\n *\n * @public\n */\n\nexport type DisplayNameChangedListener = (event: {\n  participantId: CommunicationIdentifierKind;\n  displayName: string;\n}) => void;\n/**\n * Payload for {@link CallEndedListener} containing details on the ended call.\n *\n * @public\n */\n\nexport type CallAdapterCallEndedEvent = {\n  callId: string;\n};\n/**\n * Callback for {@link CallAdapterSubscribers} 'callEnded' event.\n *\n * @public\n */\n\nexport type CallEndedListener = (event: CallAdapterCallEndedEvent) => void;\n/**\n * Payload for {@link DiagnosticChangedEventListner} where there is a change in a media diagnostic.\n *\n * @public\n */\n\nexport type MediaDiagnosticChangedEvent = MediaDiagnosticChangedEventArgs & {\n  type: 'media';\n};\n/**\n * Payload for {@link DiagnosticChangedEventListner} where there is a change in a network diagnostic.\n *\n * @public\n */\n\nexport type NetworkDiagnosticChangedEvent = NetworkDiagnosticChangedEventArgs & {\n  type: 'network';\n};\n/**\n * Callback for {@link CallAdapterSubscribers} 'diagnosticChanged' event.\n *\n * @public\n */\n\nexport type DiagnosticChangedEventListner = (event: MediaDiagnosticChangedEvent | NetworkDiagnosticChangedEvent) => void;\n/**\n * Functionality for managing the current call.\n *\n * @public\n */\n\nexport interface CallAdapterCallManagement {\n  /**\n   * Join the call with microphone initially on/off.\n   *\n   * @param microphoneOn - Whether microphone is initially enabled\n   *\n   * @public\n   */\n  joinCall(microphoneOn?: boolean): Call | undefined;\n  /**\n   * Leave the call\n   *\n   * @param forEveryone - Whether to remove all participants when leaving\n   *\n   * @public\n   */\n\n  leaveCall(forEveryone?: boolean): Promise<void>;\n  /**\n   * Start the camera\n   * This method will start rendering a local camera view when the call is not active\n   *\n   * @param options - Options to control how video streams are rendered {@link @azure/communication-calling#VideoStreamOptions }\n   *\n   * @public\n   */\n\n  startCamera(options?: VideoStreamOptions): Promise<void>;\n  /**\n   * Stop the camera\n   * This method will stop rendering a local camera view when the call is not active\n   *\n   * @public\n   */\n\n  stopCamera(): Promise<void>;\n  /**\n   * Mute the current user during the call or disable microphone locally\n   *\n   * @public\n   */\n\n  mute(): Promise<void>;\n  /**\n   * Unmute the current user during the call or enable microphone locally\n   *\n   * @public\n   */\n\n  unmute(): Promise<void>;\n  /**\n   * Start the call.\n   *\n   * @param participants - An array of participant ids to join\n   *\n   * @public\n   */\n\n  startCall(participants: string[], options?: StartCallOptions): Call | undefined;\n\n  /**\n   * Start sharing the screen during a call.\n   *\n   * @public\n   */\n  startScreenShare(): Promise<void>;\n  /**\n   * Stop sharing the screen\n   *\n   * @public\n   */\n\n  stopScreenShare(): Promise<void>;\n  /**\n   * Remove a participant from the call.\n   *\n   * @param userId - Id of the participant to be removed\n   *\n   * @public\n   */\n\n  removeParticipant(userId: string): Promise<void>;\n\n  /**\n   * Create the html view for a stream.\n   *\n   * @remarks\n   * This method is implemented for composite\n   *\n   * @param remoteUserId - Id of the participant to render, leave it undefined to create the local camera view\n   * @param options - Options to control how video streams are rendered {@link @azure/communication-calling#VideoStreamOptions }\n   *\n   * @public\n   */\n  createStreamView(remoteUserId?: string, options?: VideoStreamOptions): Promise<void | CreateVideoStreamViewResult>;\n  /**\n   * Dispose the html view for a stream.\n   *\n   * @remarks\n   * This method is implemented for composite\n   *\n   * @param remoteUserId - Id of the participant to render, leave it undefined to dispose the local camera view\n   * @param options - Options to control how video streams are rendered {@link @azure/communication-calling#VideoStreamOptions }\n   *\n   * @public\n   */\n\n  disposeStreamView(remoteUserId?: string, options?: VideoStreamOptions): Promise<void>;\n}\n/**\n * Functionality for managing devices within a call.\n *\n * @public\n */\n\nexport interface CallAdapterDeviceManagement {\n  /**\n   * Ask for permissions of devices.\n   *\n   * @remarks\n   * Browser permission window will pop up if permissions are not granted yet\n   *\n   * @param constrain - Define constraints for accessing local devices {@link @azure/communication-calling#PermissionConstraints }\n   *\n   * @public\n   */\n  askDevicePermission(constrain: PermissionConstraints): Promise<void>;\n  /**\n   * Query for available camera devices.\n   *\n   * @remarks\n   * This method should be called after askDevicePermission()\n   *\n   * @return An array of video device information entities {@link @azure/communication-calling#VideoDeviceInfo }\n   *\n   * @public\n   */\n\n  queryCameras(): Promise<VideoDeviceInfo[]>;\n  /**\n   * Query for available microphone devices.\n   *\n   * @remarks\n   * This method should be called after askDevicePermission()\n   *\n   * @return An array of audio device information entities {@link @azure/communication-calling#AudioDeviceInfo }\n   *\n   * @public\n   */\n\n  queryMicrophones(): Promise<AudioDeviceInfo[]>;\n  /**\n   * Query for available microphone devices.\n   *\n   * @remarks\n   * This method should be called after askDevicePermission()\n   *\n   * @return An array of audio device information entities {@link @azure/communication-calling#AudioDeviceInfo }\n   *\n   * @public\n   */\n\n  querySpeakers(): Promise<AudioDeviceInfo[]>;\n  /**\n   * Set the camera to use in the call.\n   *\n   * @param sourceInfo - Camera device to choose, pick one returned by  {@link CallAdapterDeviceManagement#queryCameras }\n   * @param options - Options to control how the camera stream is rendered {@link @azure/communication-calling#VideoStreamOptions }\n   *\n   * @public\n   */\n\n  setCamera(sourceInfo: VideoDeviceInfo, options?: VideoStreamOptions): Promise<void>;\n  /**\n   * Set the microphone to use in the call.\n   *\n   * @param sourceInfo - Microphone device to choose, pick one returned by {@link CallAdapterDeviceManagement#queryMicrophones }\n   *\n   * @public\n   */\n\n  setMicrophone(sourceInfo: AudioDeviceInfo): Promise<void>;\n  /**\n   * Set the speaker to use in the call.\n   *\n   * @param sourceInfo - Speaker device to choose, pick one returned by {@link CallAdapterDeviceManagement#querySpeakers }\n   *\n   * @public\n   */\n\n  setSpeaker(sourceInfo: AudioDeviceInfo): Promise<void>;\n}\n/**\n * Call composite events that can be subscribed to.\n *\n * @public\n */\n\nexport interface CallAdapterSubscribers {\n  /**\n   * Subscribe function for 'participantsJoined' event.\n   */\n  on(event: 'participantsJoined', listener: ParticipantsJoinedListener): void;\n  /**\n   * Subscribe function for 'participantsLeft' event.\n   */\n\n  on(event: 'participantsLeft', listener: ParticipantsLeftListener): void;\n  /**\n   * Subscribe function for 'isMutedChanged' event.\n   *\n   * @remarks\n   * The event will be triggered whenever current user or remote user mute state changed\n   *\n   */\n\n  on(event: 'isMutedChanged', listener: IsMutedChangedListener): void;\n  /**\n   * Subscribe function for 'callIdChanged' event.\n   *\n   * @remarks\n   * The event will be triggered when callId of current user changed.\n   *\n   */\n\n  on(event: 'callIdChanged', listener: CallIdChangedListener): void;\n  /**\n   * Subscribe function for 'isLocalScreenSharingActiveChanged' event.\n   */\n\n  on(event: 'isLocalScreenSharingActiveChanged', listener: IsLocalScreenSharingActiveChangedListener): void;\n  /**\n   * Subscribe function for 'displayNameChanged' event.\n   */\n\n  on(event: 'displayNameChanged', listener: DisplayNameChangedListener): void;\n  /**\n   * Subscribe function for 'isSpeakingChanged' event.\n   */\n\n  on(event: 'isSpeakingChanged', listener: IsSpeakingChangedListener): void;\n  /**\n   * Subscribe function for 'callEnded' event.\n   */\n\n  on(event: 'callEnded', listener: CallEndedListener): void;\n  /**\n   * Subscribe function for 'diagnosticChanged' event.\n   *\n   * This event fires whenever there is a change in user facing diagnostics about the ongoing call.\n   */\n\n  on(event: 'diagnosticChanged', listener: DiagnosticChangedEventListner): void;\n  /**\n   * Subscribe function for 'selectedMicrophoneChanged' event.\n   *\n   * This event fires whenever the user selects a new microphone device.\n   */\n\n  on(event: 'selectedMicrophoneChanged', listener: PropertyChangedEvent): void;\n  /**\n   * Subscribe function for 'selectedSpeakerChanged' event.\n   *\n   * This event fires whenever the user selects a new speaker device.\n   */\n\n  on(event: 'selectedSpeakerChanged', listener: PropertyChangedEvent): void;\n  /**\n   * Subscribe function for 'error' event.\n   */\n\n  on(event: 'error', listener: (e: AdapterError) => void): void;\n  /**\n   * Unsubscribe function for 'participantsJoined' event.\n   */\n\n  off(event: 'participantsJoined', listener: ParticipantsJoinedListener): void;\n  /**\n   * Unsubscribe function for 'participantsLeft' event.\n   */\n\n  off(event: 'participantsLeft', listener: ParticipantsLeftListener): void;\n  /**\n   * Unsubscribe function for 'isMutedChanged' event.\n   */\n\n  off(event: 'isMutedChanged', listener: IsMutedChangedListener): void;\n  /**\n   * Unsubscribe function for 'callIdChanged' event.\n   */\n\n  off(event: 'callIdChanged', listener: CallIdChangedListener): void;\n  /**\n   * Unsubscribe function for 'isLocalScreenSharingActiveChanged' event.\n   */\n\n  off(event: 'isLocalScreenSharingActiveChanged', listener: IsLocalScreenSharingActiveChangedListener): void;\n  /**\n   * Unsubscribe function for 'displayNameChanged' event.\n   */\n\n  off(event: 'displayNameChanged', listener: DisplayNameChangedListener): void;\n  /**\n   * Unsubscribe function for 'isSpeakingChanged' event.\n   */\n\n  off(event: 'isSpeakingChanged', listener: IsSpeakingChangedListener): void;\n  /**\n   * Unsubscribe function for 'callEnded' event.\n   */\n\n  off(event: 'callEnded', listener: CallEndedListener): void;\n  /**\n   * Unsubscribe function for 'diagnosticChanged' event.\n   */\n\n  off(event: 'diagnosticChanged', listener: DiagnosticChangedEventListner): void;\n  /**\n   * Unsubscribe function for 'selectedMicrophoneChanged' event.\n   */\n\n  off(event: 'selectedMicrophoneChanged', listener: PropertyChangedEvent): void;\n  /**\n   * Unsubscribe function for 'selectedSpeakerChanged' event.\n   */\n\n  off(event: 'selectedSpeakerChanged', listener: PropertyChangedEvent): void;\n  /**\n   * Unsubscribe function for 'error' event.\n   */\n\n  off(event: 'error', listener: (e: AdapterError) => void): void;\n}\n/**\n * {@link CallComposite} Adapter interface.\n *\n * @public\n */\n\nexport interface CallAdapter extends AdapterState<CallAdapterState>, Disposable, CallAdapterCallManagement, CallAdapterDeviceManagement, CallAdapterSubscribers {}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CallAdapterState, CallCompositePage, END_CALL_PAGES } from '../adapter/CallAdapter';\nimport { _isInCall, _isPreviewOn, _isInLobbyOrConnecting } from '@internal/calling-component-bindings';\nimport { CallControlOptions } from '../types/CallControlOptions';\nimport { CallState } from '@internal/calling-stateful-client';\nimport { isPhoneNumberIdentifier } from '@azure/communication-common';\nconst ACCESS_DENIED_TEAMS_MEETING_SUB_CODE = 5854;\nconst REMOTE_PSTN_USER_HUNG_UP = 560000;\nconst REMOVED_FROM_CALL_SUB_CODES = [5000, 5300, REMOTE_PSTN_USER_HUNG_UP];\n\n/**\n * @private\n */\nexport const isCameraOn = (state: CallAdapterState): boolean => {\n  if (state.call) {\n    const stream = state.call.localVideoStreams.find(stream => stream.mediaStreamType === 'Video');\n    return !!stream;\n  } else {\n    if (state.devices.selectedCamera) {\n      const previewOn = _isPreviewOn(state.devices);\n\n      return previewOn;\n    }\n  }\n\n  return false;\n};\n/**\n * Reduce the set of call controls visible on mobile.\n * For example do not show screenshare button.\n *\n * @private\n */\n\nexport const reduceCallControlsForMobile = (callControlOptions: CallControlOptions | boolean | undefined): CallControlOptions | false => {\n  if (callControlOptions === false) {\n    return false;\n  } // Ensure call controls a valid object.\n\n\n  const reduceCallControlOptions = callControlOptions === true ? {} : callControlOptions || {}; // Set to compressed mode when composite is optimized for mobile\n\n  reduceCallControlOptions.displayType = 'compact'; // Do not show screen share button when composite is optimized for mobile unless the developer\n  // has explicitly opted in.\n\n  if (reduceCallControlOptions.screenShareButton !== true) {\n    reduceCallControlOptions.screenShareButton = false;\n  }\n\n  return reduceCallControlOptions;\n};\nenum CallEndReasons {\n  LEFT_CALL,\n  ACCESS_DENIED,\n  REMOVED_FROM_CALL,\n  ROOM_NOT_FOUND,\n  DENIED_PERMISSION_TO_ROOM,\n}\n\nconst getCallEndReason = (call: CallState): CallEndReasons => {\n  const remoteParticipantsEndedArray = Array.from(Object.values(call.remoteParticipantsEnded));\n  /**\n   * Handle the special case in a PSTN call where removing the last user kicks the caller out of the call.\n   * The code and subcode is the same as when a user is removed from a teams interop call.\n   * Hence, we look at the last remote participant removed to determine if the last participant removed was a phone number.\n   * If yes, the caller was kicked out of the call, but we need to show them that they left the call.\n   * Note: This check will only work for 1:1 PSTN Calls. The subcode is different for 1:N PSTN calls, and we do not need to handle that case.\n   */\n\n  if (remoteParticipantsEndedArray.length === 1 && isPhoneNumberIdentifier(remoteParticipantsEndedArray[0].identifier) && call.callEndReason?.subCode !== REMOTE_PSTN_USER_HUNG_UP) {\n    return CallEndReasons.LEFT_CALL;\n  }\n\n  if (call.callEndReason?.subCode && call.callEndReason.subCode === ACCESS_DENIED_TEAMS_MEETING_SUB_CODE) {\n    return CallEndReasons.ACCESS_DENIED;\n  }\n\n  if (call.callEndReason?.subCode && REMOVED_FROM_CALL_SUB_CODES.includes(call.callEndReason.subCode)) {\n    return CallEndReasons.REMOVED_FROM_CALL;\n  }\n\n  if (call.callEndReason) {\n    // No error codes match, assume the user simply left the call regularly\n    return CallEndReasons.LEFT_CALL;\n  }\n\n  throw new Error('No matching call end reason');\n};\n/**\n * Get the current call composite page based on the current call composite state\n *\n * @param Call - The current call state\n * @param previousCall - The state of the most recent previous call that has ended.\n *\n * @remarks - The previousCall state is needed to determine if the call has ended.\n * When the call ends a new call object is created, and so we must lookback at the\n * previous call state to understand how the call has ended. If there is no previous\n * call we know that this is a fresh call and can display the configuration page.\n *\n * @private\n */\n\n\nexport const getCallCompositePage = (call: CallState | undefined, previousCall: CallState | undefined): CallCompositePage => {\n  // Must check for ongoing call *before* looking at any previous calls.\n  // If the composite completes one call and joins another, the previous calls\n  // will be populated, but not relevant for determining the page.\n  if (call) {\n    // `_isInLobbyOrConnecting` needs to be checked first because `_isInCall` also returns true when call is in lobby.\n    if (_isInLobbyOrConnecting(call?.state)) {\n      return 'lobby'; // `LocalHold` needs to be checked before `isInCall` since it is also a state that's considered in call.\n    } else if (call?.state === 'LocalHold') {\n      return 'call';\n    } else if (_isInCall(call?.state)) {\n      return 'call';\n    } else {\n      // When the call object has been constructed after clicking , but before 'connecting' has been\n      // set on the call object, we continue to show the configuration screen.\n      // The call object does not correctly reflect local device state until `call.state` moves to `connecting`.\n      // Moving to the 'lobby' page too soon leads to components that depend on the `call` object to show incorrect\n      // transitional state.\n      return 'configuration';\n    }\n  }\n\n  if (previousCall) {\n    const reason = getCallEndReason(previousCall);\n\n    switch (reason) {\n      case CallEndReasons.ACCESS_DENIED:\n        return 'accessDeniedTeamsMeeting';\n\n      case CallEndReasons.REMOVED_FROM_CALL:\n        return 'removedFromCall';\n\n      case CallEndReasons.LEFT_CALL:\n        if (previousCall.diagnostics.network.latest.noNetwork) {\n          return 'joinCallFailedDueToNoNetwork';\n        }\n\n        return 'leftCall';\n    }\n  } // No call state - show starting page (configuration)\n\n\n  return 'configuration';\n};\n/** @private */\n\nexport const IsCallEndedPage = (page: 'accessDeniedTeamsMeeting' | 'call' | 'configuration' | 'joinCallFailedDueToNoNetwork' | 'leftCall' | 'lobby' | 'removedFromCall'): boolean => END_CALL_PAGES.includes(page);\n/**\n * Creates a new call control options object and sets the correct values for disabling\n * the buttons provided in the `disabledControls` array.\n * Returns a new object without changing the original object.\n * @param callControlOptions options for the call control component that need to be modified.\n * @param disabledControls An array of controls to disable.\n * @returns a copy of callControlOptions with disabledControls disabled\n * @private\n */\n\nexport const disableCallControls = (callControlOptions: CallControlOptions | boolean | undefined, disabledControls: (keyof CallControlOptions)[]): CallControlOptions | boolean | undefined => {\n  if (callControlOptions === false) {\n    return false;\n  } // Ensure we clone the prop if it is an object to ensure we do not mutate the original prop.\n\n\n  let newOptions = (callControlOptions instanceof Object ? { ...callControlOptions\n  } : callControlOptions) ?? {};\n\n  if (newOptions === true || newOptions === undefined) {\n    newOptions = disabledControls.reduce((acc, key) => {\n      acc[key] = {\n        disabled: true\n      };\n      return acc;\n    }, {});\n  } else {\n    disabledControls.forEach(key => {\n      if (newOptions[key] !== false) {\n        newOptions[key] = {\n          disabled: true\n        };\n      }\n    });\n  }\n\n  return newOptions;\n};\n/**\n * Check if a disabled object is provided for a button and returns if the button is disabled.\n * A button is only disabled if is explicitly set to disabled.\n *\n * @param option\n * @returns whether a button is disabled\n * @private\n */\n\nexport const isDisabled = (option: boolean | {\n  disabled: boolean;\n} | undefined): boolean => {\n  if (option === undefined || typeof option === 'boolean') {\n    return false;\n  }\n\n  return option.disabled;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CallingHandlers } from '@internal/calling-component-bindings';\nimport { CommonProperties, toFlatCommunicationIdentifier } from '@internal/acs-ui-common';\nimport { ReactElement } from 'react';\nimport memoizeOne from 'memoize-one';\nimport { CallAdapter } from '..';\nimport { useAdapter } from '../adapter/CallAdapterProvider';\nimport { isCameraOn } from '../utils';\n\n/**\n * @private\n */\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/explicit-function-return-type\nexport const useHandlers = <PropsT,>(_component: (props: PropsT) => ReactElement | null): Pick<CallingHandlers, CommonProperties<CallingHandlers, PropsT>> => {\n  return createCompositeHandlers(useAdapter());\n};\nconst createCompositeHandlers = memoizeOne((adapter: CallAdapter): CallingHandlers => ({\n  onCreateLocalStreamView: async options => {\n    return await adapter.createStreamView(undefined, options);\n  },\n  onCreateRemoteStreamView: async (userId, options) => {\n    return await adapter.createStreamView(userId, options);\n  },\n  onHangUp: async (forEveryone?: boolean) => {\n    await adapter.leaveCall(forEveryone);\n  },\n  onRemoveParticipant: async userId => {\n    await adapter.removeParticipant(userId);\n  },\n  onSelectCamera: async (deviceInfo, options) => {\n    await adapter.setCamera(deviceInfo, options);\n  },\n  onSelectMicrophone: async deviceInfo => {\n    await adapter.setMicrophone(deviceInfo);\n  },\n  onSelectSpeaker: async deviceInfo => {\n    await adapter.setSpeaker(deviceInfo);\n  },\n  onStartCall: (participants, options?) => {\n    const rawIds = participants.map(participant => toFlatCommunicationIdentifier(participant));\n    return adapter.startCall(rawIds, options);\n  },\n  onStartScreenShare: async () => {\n    await adapter.startScreenShare();\n  },\n  onStopScreenShare: async () => {\n    await adapter.stopScreenShare();\n  },\n  onToggleCamera: async options => {\n    isCameraOn(adapter.getState()) ? await adapter.stopCamera() : await adapter.startCamera(options);\n  },\n  onToggleMicrophone: async () => {\n    return adapter.getState().call?.isMuted ? await adapter.unmute() : await adapter.mute();\n  },\n  onToggleScreenShare: async () => {\n    return adapter.getState().call?.isScreenSharingOn ? await adapter.stopScreenShare() : await adapter.startScreenShare();\n  },\n  onStartLocalVideo: async () => {\n    if (adapter.getState().call) {\n      return adapter.startCamera();\n    }\n  },\n  onDisposeLocalStreamView: async () => {\n    return adapter.disposeStreamView();\n  },\n  onDisposeRemoteStreamView: async userId => {\n    return adapter.disposeStreamView(userId);\n  }\n}));","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { Common } from '@internal/acs-ui-common';\nimport { CallingHandlers, getCallingSelector, GetCallingSelector } from '@internal/calling-component-bindings';\nimport { useAdaptedSelector } from './useAdaptedSelector';\nimport { useHandlers } from './useHandlers';\ntype Selector = (state: any, props: any) => any;\n/**\n * @private\n */\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/explicit-function-return-type\n\nexport const usePropsFor = <Component extends (props: any) => JSX.Element,>(component: Component): GetCallingSelector<Component> extends Selector ? ReturnType<GetCallingSelector<Component>> & Common<CallingHandlers, Parameters<Component>[0]> : Record<string, never> => {\n  const selector = getCallingSelector(component);\n\n  if (!selector) {\n    throw new Error(\"Can't find the selector for component, please check supported component list\");\n  }\n\n  return { ...useAdaptedSelector((selector as Selector)),\n    ...useHandlers(component)\n  };\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { concatStyleSets, IButtonStyles, IContextualMenuItemStyles, IStyle } from '@fluentui/react';\nimport { DevicesButtonStyles, ParticipantsButtonStyles } from '@internal/react-components';\nconst MINIMUM_TOUCH_TARGET_HEIGHT_REM = 3;\n/** @private */\n\nexport const controlBarContainerStyles: IStyle = {\n  paddingTop: '0.25rem',\n  paddingBottom: '0.25rem',\n  // @TODO: this should be exposed through a custom CallComposite Theme API that extends the fluent theme with semantic values\n  boxShadow: `\n    0px 6.400000095367432px 14.399999618530273px 0px #00000021;\n    0px 1.2000000476837158px 3.5999999046325684px 0px #0000001A;\n  `\n};\n/**\n * @private\n */\n\nexport const groupCallLeaveButtonStyle = {\n  root: {\n    border: '0.125rem',\n    borderRadius: 2,\n    height: '2.1875rem',\n    width: '6.5625rem'\n  },\n  flexContainer: {\n    flexFlow: 'row'\n  }\n};\n/**\n * @private\n */\n\nexport const groupCallLeaveButtonCompressedStyle = {\n  root: {\n    border: '0',\n    borderRadius: '0.5rem'\n  },\n  flexContainer: {\n    flexFlow: 'row'\n  }\n};\n/**\n * Styles that can be applied to ensure flyout items have the minimum touch target size.\n *\n * @private\n */\n\nexport const buttonFlyoutIncreasedSizeStyles: IContextualMenuItemStyles = {\n  root: {\n    height: `${MINIMUM_TOUCH_TARGET_HEIGHT_REM}rem`,\n    lineHeight: `${MINIMUM_TOUCH_TARGET_HEIGHT_REM}rem`,\n    maxHeight: 'unset'\n  },\n  linkContent: {\n    height: `${MINIMUM_TOUCH_TARGET_HEIGHT_REM}rem`,\n    lineHeight: `${MINIMUM_TOUCH_TARGET_HEIGHT_REM}rem`,\n    maxHeight: 'unset'\n  },\n  icon: {\n    maxHeight: 'unset',\n    textAlign: 'center'\n  }\n};\n/**\n * @private\n */\n\nexport const participantButtonWithIncreasedTouchTargets: ParticipantsButtonStyles = {\n  menuStyles: {\n    menuItemStyles: buttonFlyoutIncreasedSizeStyles,\n    participantListStyles: {\n      participantItemStyles: {\n        root: {\n          height: `${MINIMUM_TOUCH_TARGET_HEIGHT_REM}rem`\n        },\n        participantSubMenuItemsStyles: buttonFlyoutIncreasedSizeStyles\n      }\n    }\n  }\n};\n/**\n * @private\n */\n\nexport const devicesButtonWithIncreasedTouchTargets: DevicesButtonStyles = {\n  menuStyles: {\n    menuItemStyles: buttonFlyoutIncreasedSizeStyles\n  }\n};\n/**\n * @private\n */\n\nexport const controlButtonBaseStyle: IButtonStyles = {\n  label: {\n    minWidth: '2.25rem'\n  }\n};\n/**\n * @private\n */\n\nexport const concatButtonBaseStyles = (...styles: IButtonStyles[]): IButtonStyles => {\n  let result = controlButtonBaseStyle;\n  styles.forEach(style => {\n    result = concatStyleSets(result, style);\n  });\n  return result;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CameraButton, ControlBarButtonStyles } from '@internal/react-components';\nimport React, { useMemo } from 'react';\nimport { usePropsFor } from '../../hooks/usePropsFor';\nimport { CallControlDisplayType } from '../../types/CallControlOptions';\nimport { concatButtonBaseStyles } from '../../styles/Buttons.styles';\n/**\n * @private\n */\n\nexport const Camera = (props: {\n  displayType?: CallControlDisplayType;\n  styles?: ControlBarButtonStyles;\n  splitButtonsForDeviceSelection?: boolean;\n  disabled?: boolean;\n}): JSX.Element => {\n  const cameraButtonProps = usePropsFor(CameraButton);\n  const styles = useMemo(() => concatButtonBaseStyles(props.styles ?? {}), [props.styles]);\n  return <CameraButton data-ui-id=\"call-composite-camera-button\" {...cameraButtonProps} showLabel={props.displayType !== 'compact'} styles={styles} enableDeviceSelectionMenu={props.splitButtonsForDeviceSelection} disabled={cameraButtonProps.disabled || props.disabled} />;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ControlBarButtonStyles, DevicesButton } from '@internal/react-components';\nimport React, { useMemo } from 'react';\nimport { usePropsFor } from '../../hooks/usePropsFor';\nimport { CallControlDisplayType } from '../../types/CallControlOptions';\nimport { concatButtonBaseStyles, devicesButtonWithIncreasedTouchTargets } from '../../styles/Buttons.styles';\nimport { _HighContrastAwareIcon } from '@internal/react-components';\n/** @private */\n\nexport const Devices = (props: {\n  displayType?: CallControlDisplayType;\n  increaseFlyoutItemSize?: boolean;\n  styles?: ControlBarButtonStyles;\n  disabled?: boolean;\n}): JSX.Element => {\n  const devicesButtonProps = usePropsFor(DevicesButton);\n  const augmentedDeviceButtonProps = useMemo(() => ({ ...devicesButtonProps\n  }), [devicesButtonProps]);\n  const styles = useMemo(() => concatButtonBaseStyles(props.increaseFlyoutItemSize ? devicesButtonWithIncreasedTouchTargets : {}, props.styles ?? {}), [props.increaseFlyoutItemSize, props.styles]);\n  return <DevicesButton\n  /* By setting `persistMenu?` to true, we prevent options menu from getting hidden every time a participant joins or leaves. */\n  persistMenu={true} {...augmentedDeviceButtonProps} showLabel={props.displayType !== 'compact'} styles={styles} data-ui-id=\"calling-composite-devices-button\" disabled={props.disabled} />;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { concatStyleSets } from '@fluentui/react';\nimport { ControlBarButtonStyles, EndCallButton } from '@internal/react-components';\nimport React, { useMemo } from 'react';\nimport { usePropsFor } from '../../hooks/usePropsFor';\nimport { CallControlDisplayType } from '../../types/CallControlOptions';\nimport { groupCallLeaveButtonCompressedStyle, groupCallLeaveButtonStyle } from '../../styles/Buttons.styles';\n/** @private */\n\nexport const EndCall = (props: {\n  displayType?: CallControlDisplayType;\n  styles?: ControlBarButtonStyles;\n}): JSX.Element => {\n  const compactMode = props.displayType === 'compact';\n  const hangUpButtonProps = usePropsFor(EndCallButton);\n  const styles = useMemo(() => concatStyleSets(compactMode ? groupCallLeaveButtonCompressedStyle : groupCallLeaveButtonStyle, props.styles ?? {}), [compactMode, props.styles]);\n  return <EndCallButton data-ui-id=\"call-composite-hangup-button\" {...hangUpButtonProps} styles={styles} showLabel={!compactMode} />;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { CallAdapterState } from '../adapter/CallAdapter';\nimport { useSelectorWithAdaptation } from './useAdaptedSelector';\n/**\n * @private\n */\n\nexport const useSelector = <SelectorT extends (state: CallAdapterState, props: any) => any,>(selector: SelectorT, selectorProps?: Parameters<SelectorT>[1]): ReturnType<SelectorT> => {\n  // use selector with no adaptation\n  return useSelectorWithAdaptation(selector, state => state, selectorProps);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CallState as SDKCallStatus, DominantSpeakersInfo } from '@azure/communication-calling';\nimport { CallState, DeviceManagerState, DiagnosticsCallFeatureState, LocalVideoStreamState, RemoteParticipantState } from '@internal/calling-stateful-client';\nimport { CallAdapterState, CallCompositePage } from '../adapter/CallAdapter';\nimport { _isInCall, _isPreviewOn, _dominantSpeakersWithFlatId } from '@internal/calling-component-bindings';\n/**\n * @private\n */\n\nexport const getDisplayName = (state: CallAdapterState): string | undefined => state.displayName;\n/**\n * @private\n */\n\nexport const getCallId = (state: CallAdapterState): string | undefined => state.call?.id;\n/**\n * @private\n */\n\nexport const getEndedCall = (state: CallAdapterState): CallState | undefined => state.endedCall;\n/**\n * @private\n */\n\nexport const getCallStatus = (state: CallAdapterState): SDKCallStatus => state.call?.state ?? 'None';\n/**\n * @private\n */\n\nexport const getDeviceManager = (state: CallAdapterState): DeviceManagerState => state.devices;\n/**\n * @private\n */\n\nexport const getIsScreenShareOn = (state: CallAdapterState): boolean => state.call?.isScreenSharingOn ?? false;\n/**\n * @private\n */\n\nexport const getIsPreviewCameraOn = (state: CallAdapterState): boolean => _isPreviewOn(state.devices);\n/**\n * @private\n */\n\nexport const getPage = (state: CallAdapterState): CallCompositePage => state.page;\n/**\n * @private\n */\n\nexport const getLocalMicrophoneEnabled = (state: CallAdapterState): boolean => state.isLocalPreviewMicrophoneEnabled;\n/**\n * @private\n */\n\nexport const getLocalVideoStreams = (state: CallAdapterState): LocalVideoStreamState[] | undefined => state.call?.localVideoStreams;\n/**\n * @private\n */\n\nexport const getIsTranscriptionActive = (state: CallAdapterState): boolean => !!state.call?.transcription.isTranscriptionActive;\n/**\n * @private\n */\n\nexport const getIsRecordingActive = (state: CallAdapterState): boolean => !!state.call?.recording.isRecordingActive;\n/**\n * @private\n */\n\nexport const getUserFacingDiagnostics = (state: CallAdapterState): DiagnosticsCallFeatureState | undefined => state.call?.diagnostics;\n/**\n * @private\n */\n\nexport const getDominantSpeakerInfo = (state: CallAdapterState): undefined | DominantSpeakersInfo => state.call?.dominantSpeakers;\n/**\n * @private\n */\n\nexport const getRemoteParticipants = (state: CallAdapterState): undefined | {\n  [keys: string]: RemoteParticipantState;\n} => state.call?.remoteParticipants;","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { _isInLobbyOrConnecting } from '@internal/calling-component-bindings';\nimport { ControlBarButtonStyles, MicrophoneButton } from '@internal/react-components';\nimport React, { useMemo } from 'react';\nimport { useLocale } from '../../../localization';\nimport { usePropsFor } from '../../hooks/usePropsFor';\nimport { useSelector } from '../../hooks/useSelector';\nimport { getCallStatus, getLocalMicrophoneEnabled } from '../../selectors/baseSelectors';\nimport { CallControlDisplayType } from '../../types/CallControlOptions';\nimport { concatButtonBaseStyles } from '../../styles/Buttons.styles';\n/**\n * @private\n */\n\nexport const Microphone = (props: {\n  displayType?: CallControlDisplayType;\n  styles?: ControlBarButtonStyles;\n  splitButtonsForDeviceSelection?: boolean;\n  disabled?: boolean;\n}): JSX.Element => {\n  const microphoneButtonProps = usePropsFor(MicrophoneButton);\n  const callStatus = useSelector(getCallStatus);\n  const isLocalMicrophoneEnabled = useSelector(getLocalMicrophoneEnabled);\n  const strings = useLocale().strings.call;\n  /**\n   * When call is in Lobby, microphone button should be disabled.\n   * This is due to to headless limitation where a call can not be muted/unmuted in lobby.\n   */\n\n  if (_isInLobbyOrConnecting(callStatus)) {\n    microphoneButtonProps.disabled = true; // Lobby page should show the microphone status that was set on the local preview/configuration\n    // page until the user successfully joins the call.\n\n    microphoneButtonProps.checked = isLocalMicrophoneEnabled;\n  }\n\n  const microphoneButtonStrings = _isInLobbyOrConnecting(callStatus) ? {\n    strings: {\n      tooltipOffContent: strings.microphoneToggleInLobbyNotAllowed,\n      tooltipOnContent: strings.microphoneToggleInLobbyNotAllowed\n    }\n  } : {};\n  const styles = useMemo(() => concatButtonBaseStyles(props.styles ?? {}), [props.styles]); // tab focus on MicrophoneButton on page load\n\n  return <MicrophoneButton autoFocus data-ui-id=\"call-composite-microphone-button\" {...microphoneButtonProps} showLabel={props.displayType !== 'compact'} styles={styles} {...microphoneButtonStrings} enableDeviceSelectionMenu={props.splitButtonsForDeviceSelection} disabled={microphoneButtonProps.disabled || props.disabled} />;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ControlBarButtonStyles, ParticipantMenuItemsCallback, ParticipantsButton } from '@internal/react-components';\nimport React, { useMemo } from 'react';\nimport { usePropsFor } from '../../hooks/usePropsFor';\nimport { CallControlDisplayType } from '../../types/CallControlOptions';\nimport { concatButtonBaseStyles, participantButtonWithIncreasedTouchTargets } from '../../styles/Buttons.styles';\n/** @private */\n\nexport const Participants = (props: {\n  // The value of `CallControlOptions.participantsButton`.\n  option?: boolean | {\n    disabled: boolean;\n  };\n  callInvitationURL?: string;\n  onFetchParticipantMenuItems?: ParticipantMenuItemsCallback;\n  displayType?: CallControlDisplayType;\n  increaseFlyoutItemSize?: boolean;\n  styles?: ControlBarButtonStyles;\n  isMobile?: boolean;\n  disabled?: boolean;\n}): JSX.Element => {\n  const participantsButtonProps = usePropsFor(ParticipantsButton);\n  const participantsButtonStyles = useMemo(() => concatButtonBaseStyles(props.increaseFlyoutItemSize ? participantButtonWithIncreasedTouchTargets : {}, props.styles ?? {}), [props.increaseFlyoutItemSize, props.styles]);\n  return <ParticipantsButton data-ui-id=\"call-composite-participants-button\" {...participantsButtonProps} showLabel={props.displayType !== 'compact'} callInvitationURL={props.callInvitationURL} onFetchParticipantMenuItems={props.onFetchParticipantMenuItems} disabled={isDisabled(props.option) || props.disabled} styles={participantsButtonStyles} showParticipantOverflowTooltip={!props.isMobile} />;\n};\n\nconst isDisabled = (option?: boolean | {\n  disabled: boolean;\n}): boolean => {\n  if (option === undefined || option === true || option === false) {\n    return false;\n  }\n\n  return option.disabled;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ControlBarButtonStyles, ScreenShareButton } from '@internal/react-components';\nimport React, { useMemo } from 'react';\nimport { usePropsFor } from '../../hooks/usePropsFor';\nimport { CallControlDisplayType } from '../../types/CallControlOptions';\nimport { concatButtonBaseStyles } from '../../styles/Buttons.styles';\n/** @private */\n\nexport const ScreenShare = (props: {\n  // The value of `CallControlOptions.screenShareButton`.\n  option?: boolean | {\n    disabled: boolean;\n  };\n  displayType?: CallControlDisplayType;\n  styles?: ControlBarButtonStyles;\n  disabled?: boolean;\n}): JSX.Element => {\n  const screenShareButtonProps = usePropsFor(ScreenShareButton);\n  const styles = useMemo(() => concatButtonBaseStyles(props.styles ?? {}), [props.styles]);\n\n  const screenShareButtonDisabled = (): boolean => {\n    return isDisabled(props.option);\n  };\n\n  return <ScreenShareButton data-ui-id=\"call-composite-screenshare-button\" {...screenShareButtonProps} showLabel={props.displayType !== 'compact'} disabled={screenShareButtonDisabled() || props.disabled} styles={styles} />;\n};\n\nconst isDisabled = (option?: boolean | {\n  disabled: boolean;\n}): boolean => {\n  if (option === undefined || option === true || option === false) {\n    return false;\n  }\n\n  return option.disabled;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { memoizeFunction, Stack, useTheme } from '@fluentui/react';\nimport { _isInLobbyOrConnecting } from '@internal/calling-component-bindings';\nimport { ControlBar, ParticipantMenuItemsCallback } from '@internal/react-components';\nimport React, { useMemo } from 'react';\nimport { CallControlOptions } from '../types/CallControlOptions';\nimport { Camera } from './buttons/Camera';\nimport { Devices } from './buttons/Devices';\nimport { EndCall } from './buttons/EndCall';\nimport { Microphone } from './buttons/Microphone';\nimport { Participants } from './buttons/Participants';\nimport { ScreenShare } from './buttons/ScreenShare';\nimport { ContainerRectProps } from '../../common/ContainerRectProps';\nimport { isDisabled } from '../utils';\n/**\n * @private\n */\n\nexport type CallControlsProps = {\n  callInvitationURL?: string;\n  onFetchParticipantMenuItems?: ParticipantMenuItemsCallback;\n  options?: boolean | CallControlOptions;\n  /**\n   * Option to increase the height of the button flyout menu items from 36px to 48px.\n   * Recommended for mobile devices.\n   */\n\n  increaseFlyoutItemSize?: boolean;\n  isMobile?: boolean;\n}; // Enforce a background color on control bar to ensure it matches the composite background color.\n\nconst controlBarStyles = memoizeFunction((background: string) => ({\n  root: {\n    background: background\n  }\n}));\n/**\n * @private\n */\n\nexport const CallControls = (props: CallControlsProps & ContainerRectProps): JSX.Element => {\n  const options = useMemo(() => typeof props.options === 'boolean' ? {} : props.options, [props.options]);\n  const theme = useTheme();\n\n  // when props.options is false then we want to hide the whole control bar.\n  if (props.options === false) {\n    return <></>;\n  }\n\n  let screenShareButtonIsEnabled = isEnabled(options?.screenShareButton);\n  let microphoneButtonIsEnabled = isEnabled(options?.microphoneButton);\n  let cameraButtonIsEnabled = isEnabled(options?.cameraButton);\n  return <Stack horizontalAlign=\"center\">\n      {}\n      <Stack.Item>\n        {\n        /*\n           Note: We use the layout=\"horizontal\" instead of dockedBottom because of how we position the\n           control bar. The control bar exists in a Stack below the MediaGallery. The MediaGallery is\n           set to grow and fill the remaining space not taken up by the ControlBar. If we were to use\n           dockedBottom it has position absolute and would therefore float on top of the media gallery,\n           occluding some of its content.\n        */\n      }\n        <ControlBar layout=\"horizontal\" styles={controlBarStyles(theme.semanticColors.bodyBackground)}>\n          {microphoneButtonIsEnabled && <Microphone displayType={options?.displayType} disabled={isDisabled(options?.microphoneButton)} />}\n          {cameraButtonIsEnabled && <Camera displayType={options?.displayType} disabled={isDisabled(options?.cameraButton)} />}\n          {screenShareButtonIsEnabled && <ScreenShare option={options?.screenShareButton} displayType={options?.displayType} disabled={isDisabled(options?.screenShareButton)} />}\n          {isEnabled(options?.participantsButton) && <Participants option={options?.participantsButton} callInvitationURL={props.callInvitationURL} onFetchParticipantMenuItems={props.onFetchParticipantMenuItems} displayType={options?.displayType} increaseFlyoutItemSize={props.increaseFlyoutItemSize} isMobile={props.isMobile} disabled={isDisabled(options?.participantsButton)} />}\n          {isEnabled(options?.devicesButton) && <Devices displayType={options?.displayType} increaseFlyoutItemSize={props.increaseFlyoutItemSize} disabled={isDisabled(options?.devicesButton)} />}\n          {}\n          {}\n          {isEnabled(options?.endCallButton) && <EndCall displayType={options?.displayType} />}\n        </ControlBar>\n      </Stack.Item>\n    </Stack>;\n};\n\nconst isEnabled = (option: unknown): boolean => option !== false;\n/** @private */\n\n\nexport const isRoomsCallTrampoline = (): boolean => {\n  return false;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStyle } from '@fluentui/react';\n/** @private */\n\nexport const controlBarContainerStyles: IStyle = {\n  paddingTop: '0.25rem',\n  paddingBottom: '0.25rem',\n  // @TODO: this should be exposed through a custom CallComposite Theme API that extends the fluent theme with semantic values\n  boxShadow: `\n    0px 6.400000095367432px 14.399999618530273px 0px #00000021;\n    0px 1.2000000476837158px 3.5999999046325684px 0px #0000001A;\n  `\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStackItemStyles, IStackStyles, IStyle, mergeStyles } from '@fluentui/react';\nimport { controlBarContainerStyles } from './CallControls.styles';\nconst VIDEO_GALLERY_Z_INDEX = 1; // The control bar must be in a higher z-band than the video gallery so the drop shadow appears on top of the video gallery\n\nconst CONTROL_BAR_Z_INDEX = VIDEO_GALLERY_Z_INDEX + 1; // The notification container should be in the highest z-band to ensure it shows on top of all other content.\n\nconst NOTIFICATION_CONTAINER_Z_INDEX = Math.max(CONTROL_BAR_Z_INDEX, VIDEO_GALLERY_Z_INDEX) + 1;\n/**\n * @private\n */\n\nexport const callControlsContainerStyles = mergeStyles(controlBarContainerStyles, {\n  zIndex: CONTROL_BAR_Z_INDEX\n});\nconst containerStyle: IStyle = {\n  width: '100%',\n  position: 'relative',\n  minHeight: '13rem' // linked to minimum space allocated to media gallery\n\n};\n/**\n * @private\n */\n\nexport const containerStyleDesktop = mergeStyles({ ...containerStyle,\n  minWidth: '30rem'\n});\n/**\n * @private\n */\n\nexport const containerStyleMobile = mergeStyles({ ...containerStyle,\n  minWidth: '17.5rem'\n});\n/**\n * @private\n */\n\nexport const galleryParentContainerStyles = (backgroundColor: string): IStackStyles => ({\n  root: {\n    zIndex: VIDEO_GALLERY_Z_INDEX,\n    width: '100%',\n    background: backgroundColor\n  }\n});\n/**\n * @private\n */\n\nexport const mediaGalleryContainerStyles: IStackItemStyles = {\n  root: {\n    height: '100%'\n  }\n};\n/**\n * @private\n */\n\nexport const notificationsContainerStyles: IStackStyles = {\n  root: {\n    width: '100%',\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    padding: '1rem',\n    zIndex: NOTIFICATION_CONTAINER_Z_INDEX,\n    pointerEvents: 'none' // to allow the operation of controls underneath the notification container\n\n  }\n};\n/**\n * @private\n */\n\nexport const bannerNotificationStyles: IStackStyles = {\n  root: {\n    pointerEvents: 'auto' // to allow the dismissal or error and warning bars in the notification container\n\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { AnimationStyles, IStyle, ITheme, mergeStyles, Stack, Text, useTheme } from '@fluentui/react';\nimport React from 'react';\nimport { CallCompositeIcon } from '../../common/icons';\nimport { useLocale } from '../../localization';\n/**\n * @private\n */\n\nexport interface MutedNotificationProps {\n  speakingWhileMuted: boolean;\n}\n/**\n * Notify the user that they're muted.\n */\n\nexport function MutedNotification(props: MutedNotificationProps): JSX.Element {\n  const locale = useLocale();\n  const theme = useTheme();\n  return <Stack horizontal horizontalAlign=\"center\" className={mergeStyles(props.speakingWhileMuted === true ? isSpeakingAndMutedAnimationStyles : isNotSpeakingAndMutedAnimationStyles)}>\n      <Stack horizontal className={mergeStyles(stackStyle(theme))}>\n        <CallCompositeIcon iconName=\"Muted\" className={mergeStyles(iconStyle(theme))} />\n        <Text className={mergeStyles(textStyle(theme))} aria-live={'polite'}>\n          {locale.strings.call.mutedMessage}\n        </Text>\n      </Stack>\n    </Stack>;\n}\n\nconst stackStyle = (theme: ITheme): IStyle => {\n  return {\n    background: theme.palette.black,\n    gap: `1rem`,\n    padding: `1rem`,\n    borderRadius: theme.effects.roundedCorner4,\n    width: 'fit-content',\n    opacity: 0.8\n  };\n};\n\nconst iconStyle = (theme: ITheme): IStyle => {\n  return {\n    color: theme.palette.white,\n    maxHeight: '1.25rem'\n  };\n};\n\nconst textStyle = (theme: ITheme): IStyle => {\n  return {\n    color: theme.palette.white,\n    fontSize: `1rem`\n  };\n};\n\nconst isSpeakingAndMutedAnimationStyles: IStyle = { ...AnimationStyles.fadeIn100\n};\nconst isNotSpeakingAndMutedAnimationStyles: IStyle = { ...AnimationStyles.fadeOut200,\n  display: 'none'\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles, Stack } from '@fluentui/react';\nimport { _isInCall } from '@internal/calling-component-bindings';\nimport { _ComplianceBanner, _ComplianceBannerProps, _useContainerHeight, _useContainerWidth, ErrorBar, ErrorBarProps, useTheme } from '@internal/react-components';\nimport React, { useMemo, useRef } from 'react';\nimport { containerDivStyles } from '../../common/ContainerRectProps';\nimport { CallControls, CallControlsProps } from '../components/CallControls';\nimport { callControlsContainerStyles, notificationsContainerStyles, containerStyleDesktop, containerStyleMobile, mediaGalleryContainerStyles, galleryParentContainerStyles, bannerNotificationStyles } from '../styles/CallPage.styles';\nimport { MutedNotification, MutedNotificationProps } from './MutedNotification';\n/**\n * @private\n */\n\nexport interface CallArrangementProps {\n  complianceBannerProps: _ComplianceBannerProps;\n  errorBarProps: ErrorBarProps | false;\n  mutedNotificationProps?: MutedNotificationProps;\n  callControlProps: CallControlsProps;\n  onRenderGalleryContent: () => JSX.Element;\n  dataUiId: string;\n  mobileView: boolean;\n}\n/**\n * @private\n */\n\nexport const CallArrangement = (props: CallArrangementProps): JSX.Element => {\n  const containerClassName = useMemo(() => {\n    return props.mobileView ? containerStyleMobile : containerStyleDesktop;\n  }, [props.mobileView]);\n  const theme = useTheme();\n  const callGalleryStyles = useMemo(() => galleryParentContainerStyles(theme.palette.neutralLighterAlt), [theme.palette.neutralLighterAlt]);\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const containerWidth = _useContainerWidth(containerRef);\n\n  const containerHeight = _useContainerHeight(containerRef);\n\n  // To be removed once feature is out of beta, replace with callCompositeContainerCSS\n  // eslint-disable-next-line @typescript-eslint/explicit-function-return-type\n  const callCompositeContainerFlex = () => {\n    return {\n      display: 'flex'\n    };\n  };\n\n  let canUnmute = true;\n  let errorBarProps = props.errorBarProps;\n  return <div ref={containerRef} className={mergeStyles(containerDivStyles)}>\n      <Stack verticalFill horizontalAlign=\"stretch\" className={containerClassName} data-ui-id={props.dataUiId}>\n        <Stack horizontal grow>\n          <Stack.Item styles={notificationsContainerStyles}>\n            <Stack styles={bannerNotificationStyles}>\n              <_ComplianceBanner {...props.complianceBannerProps} />\n            </Stack>\n            {errorBarProps !== false && <Stack styles={bannerNotificationStyles}>\n                <ErrorBar {...errorBarProps} />\n              </Stack>}\n            {canUnmute && !!props.mutedNotificationProps && <MutedNotification {...props.mutedNotificationProps} />}\n          </Stack.Item>\n          <Stack.Item grow style={callCompositeContainerFlex()}>\n            <Stack.Item styles={callGalleryStyles} grow>\n              {props.onRenderGalleryContent && <Stack verticalFill styles={mediaGalleryContainerStyles}>\n                  {props.onRenderGalleryContent()}\n                </Stack>}\n            </Stack.Item>\n          </Stack.Item>\n          {}\n        </Stack>\n        {props.callControlProps?.options !== false && <Stack.Item className={callControlsContainerStyles}>\n              <CallControls {...props.callControlProps} containerWidth={containerWidth} containerHeight={containerHeight} isMobile={props.mobileView} />\n            </Stack.Item>}\n      </Stack>\n    </div>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { createSelector } from 'reselect';\nimport { getDeviceManager } from './baseSelectors';\n/**\n * Provides data attributes to {@link LocalVideoCameraCycleButton} component.\n * @public\n */\n\nexport const localVideoCameraCycleButtonSelector = createSelector([getDeviceManager], deviceManager => {\n  return {\n    cameras: deviceManager.cameras,\n    selectedCamera: deviceManager.selectedCamera\n  };\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { VideoGallery, VideoStreamOptions, OnRenderAvatarCallback, CustomAvatarOptions } from '@internal/react-components';\nimport { usePropsFor } from '../hooks/usePropsFor';\nimport { AvatarPersona, AvatarPersonaDataCallback } from '../../common/AvatarPersona';\nimport { mergeStyles, Stack } from '@fluentui/react';\nimport { getIsPreviewCameraOn } from '../selectors/baseSelectors';\nimport { useHandlers } from '../hooks/useHandlers';\nimport { useSelector } from '../hooks/useSelector';\nimport { localVideoCameraCycleButtonSelector } from '../selectors/LocalVideoTileSelector';\nimport { LocalVideoCameraCycleButton } from '@internal/react-components';\nconst VideoGalleryStyles = {\n  root: {\n    height: '100%',\n    minHeight: '10rem',\n    // space affordance to ensure media gallery is never collapsed\n    minWidth: '6rem'\n  }\n};\nconst localVideoViewOptions = ({\n  scalingMode: 'Crop',\n  isMirrored: true\n} as VideoStreamOptions);\nconst remoteVideoViewOptions = ({\n  scalingMode: 'Crop'\n} as VideoStreamOptions);\n/**\n * @private\n */\n\nexport interface MediaGalleryProps {\n  isVideoStreamOn?: boolean;\n  isMicrophoneChecked?: boolean;\n  onStartLocalVideo: () => Promise<void>;\n  onRenderAvatar?: OnRenderAvatarCallback;\n  onFetchAvatarPersonaData?: AvatarPersonaDataCallback;\n  isMobile?: boolean;\n}\n/**\n * @private\n */\n\nexport const MediaGallery = (props: MediaGalleryProps): JSX.Element => {\n  const videoGalleryProps = usePropsFor(VideoGallery);\n  const cameraSwitcherCameras = useSelector(localVideoCameraCycleButtonSelector);\n  const cameraSwitcherCallback = useHandlers(LocalVideoCameraCycleButton);\n  const cameraSwitcherProps = useMemo(() => {\n    return { ...cameraSwitcherCallback,\n      ...cameraSwitcherCameras\n    };\n  }, [cameraSwitcherCallback, cameraSwitcherCameras]);\n  const onRenderAvatar = useCallback((userId?: string, options?: CustomAvatarOptions) => {\n    return <Stack className={mergeStyles({\n      position: 'absolute',\n      height: '100%',\n      width: '100%'\n    })}>\n          <Stack styles={{\n        root: {\n          margin: 'auto',\n          maxHeight: '100%'\n        }\n      }}>\n            <AvatarPersona userId={userId} {...options} dataProvider={props.onFetchAvatarPersonaData} />\n          </Stack>\n        </Stack>;\n  }, [props.onFetchAvatarPersonaData]);\n  useLocalVideoStartTrigger(!!props.isVideoStreamOn);\n  const VideoGalleryMemoized = useMemo(() => {\n    return <VideoGallery {...videoGalleryProps} localVideoViewOptions={localVideoViewOptions} remoteVideoViewOptions={remoteVideoViewOptions} styles={VideoGalleryStyles} layout=\"floatingLocalVideo\" showCameraSwitcherInLocalPreview={props.isMobile} localVideoCameraCycleButtonProps={cameraSwitcherProps} onRenderAvatar={onRenderAvatar} />;\n  }, [videoGalleryProps, props.isMobile, onRenderAvatar, cameraSwitcherProps]);\n  return VideoGalleryMemoized;\n};\n/**\n * @private\n *\n * `shouldTransition` is an extra predicate that controls whether this hooks actually transitions the call.\n * The rule of hooks disallows calling the hook conditionally, so this predicate can be used to make the decision.\n */\n\nexport const useLocalVideoStartTrigger = (isLocalVideoAvailable: boolean, shouldTransition?: boolean): void => {\n  // Once a call is joined, we need to transition the local preview camera setting into the call.\n  // This logic is needed on any screen that we might join a call from:\n  // - The Media gallery\n  // - The lobby page\n  // - The networkReconnect interstitial that may show at the start of a call.\n  //\n  // @TODO: Can we simply have the callHandlers handle this transition logic.\n  const [isButtonStatusSynced, setIsButtonStatusSynced] = useState(false);\n  const isPreviewCameraOn = useSelector(getIsPreviewCameraOn);\n  const mediaGalleryHandlers = useHandlers(MediaGallery);\n  useEffect(() => {\n    if (shouldTransition !== false) {\n      if (isPreviewCameraOn && !isLocalVideoAvailable && !isButtonStatusSynced) {\n        mediaGalleryHandlers.onStartLocalVideo();\n      }\n\n      setIsButtonStatusSynced(true);\n    }\n  }, [shouldTransition, isButtonStatusSynced, isPreviewCameraOn, isLocalVideoAvailable, mediaGalleryHandlers]);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStackStyles } from '@fluentui/react';\nimport { IPalette, IStyle } from '@fluentui/react'; // By default, absolute positioned elements are overlayed over static ones.\n// So we need to explicitly layer the background and contents.\n\nconst OVERLAY_BACKGROUND_ZINDEX = 0;\nconst OVERLAY_CONTENT_ZINDEX = OVERLAY_BACKGROUND_ZINDEX + 1;\n/**\n * @private\n */\n\nexport const containerStyles: IStackStyles = {\n  root: {\n    height: '100%',\n    width: '100%',\n    position: 'relative'\n  }\n};\n/**\n * @private\n */\n\nexport const overlayBackgroundStyles: (palette: IPalette, isVideoReady: boolean) => IStyle = (palette, isVideoReady) => {\n  return {\n    position: 'absolute',\n    height: '100%',\n    width: '100%',\n    background: isVideoReady ? 'black' : palette.neutralLighterAlt,\n    opacity: isVideoReady ? 0.6 : 1,\n    zIndex: OVERLAY_BACKGROUND_ZINDEX\n  };\n};\n/**\n * @private\n */\n\nexport const overlayContentStyles: IStyle = {\n  height: '100%',\n  width: '100%',\n  zIndex: OVERLAY_CONTENT_ZINDEX\n};\n/**\n * @private\n */\n\nexport const videoTileStyles = {\n  root: {\n    height: '100%',\n    width: '100%'\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { useEffect } from 'react';\nimport { mergeStyles, Stack } from '@fluentui/react';\nimport { StreamMedia, VideoGalleryStream, VideoTile, useTheme, VideoStreamOptions, CreateVideoStreamViewResult } from '@internal/react-components';\nimport { containerStyles, overlayBackgroundStyles, overlayContentStyles, videoTileStyles } from '../styles/ExpandedLocalVideoTile.styles';\n\nconst onRenderEmptyPlaceholder = (): JSX.Element => <></>;\n\nconst localVideoViewOptions = ({\n  scalingMode: 'Crop',\n  isMirrored: true\n} as VideoStreamOptions);\n/**\n * @private\n */\n\nexport interface ExpandedLocalVideoTileProps {\n  localParticipantVideoStream: VideoGalleryStream;\n  onCreateLocalStreamView?: (options?: VideoStreamOptions) => Promise<void | CreateVideoStreamViewResult>;\n  overlayContent?: JSX.Element;\n}\n/**\n * @private\n */\n\nexport const ExpandedLocalVideoTile = (props: ExpandedLocalVideoTileProps): JSX.Element => {\n  const videoStream = props.localParticipantVideoStream;\n  const isVideoReady = videoStream?.isAvailable ?? false;\n  const renderElement = videoStream?.renderElement;\n  const palette = useTheme().palette;\n  useEffect(() => {\n    if (videoStream && isVideoReady) {\n      props.onCreateLocalStreamView && props.onCreateLocalStreamView(localVideoViewOptions).catch(err => console.log('Can not render video', err));\n    }\n  }, [isVideoReady, videoStream, props, renderElement]);\n  return <Stack horizontalAlign=\"center\" verticalAlign=\"center\" styles={containerStyles} grow>\n      <VideoTile styles={videoTileStyles} renderElement={renderElement ? <StreamMedia videoStreamElement={renderElement} /> : undefined} onRenderPlaceholder={onRenderEmptyPlaceholder}>\n        {props.overlayContent && <>\n            <Stack className={mergeStyles(overlayBackgroundStyles(palette, isVideoReady))} />\n            <Stack horizontalAlign=\"center\" verticalAlign=\"center\" className={mergeStyles(overlayContentStyles)}>\n              {props.overlayContent}\n            </Stack>\n          </>}\n      </VideoTile>\n    </Stack>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { FontWeights, IPalette, IStyle } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const containerStyle: IStyle = {\n  // Ensure some space around the text on a narrow viewport.\n  margin: '1rem',\n  gap: `1.5rem`\n};\n/**\n * @private\n */\n\nexport const titleContainerStyle: IStyle = {\n  gap: `1rem`\n};\n/**\n * @private\n */\n\nexport const titleStyle = (palette: IPalette, isVideoReady: boolean): IStyle => ({\n  fontSize: '1.25rem',\n  fontWeight: FontWeights.semibold,\n  color: isVideoReady ? 'white' : palette.neutralPrimary,\n  textAlign: 'center'\n});\n/**\n * @private\n */\n\nexport const moreDetailsStyle = (palette: IPalette, isVideoReady: boolean): IStyle => ({\n  fontSize: '1rem',\n  color: isVideoReady ? 'white' : palette.neutralPrimary,\n  textAlign: 'center'\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React from 'react';\nimport { VideoGalleryStream, useTheme } from '@internal/react-components';\nimport { ExpandedLocalVideoTile } from './ExpandedLocalVideoTile';\nimport { mergeStyles, Stack, Text } from '@fluentui/react';\nimport { useLocale } from '../../localization';\nimport { containerStyle, moreDetailsStyle, titleContainerStyle, titleStyle } from '../styles/NetworkReconnectTile.styles';\nimport { useHandlers } from '../hooks/useHandlers';\nimport { useLocalVideoStartTrigger } from './MediaGallery';\nimport { CallCompositeIcon } from '../../common/icons';\n/**\n * @private\n */\n\nexport interface NetworkReconnectTileProps {\n  localParticipantVideoStream: VideoGalleryStream;\n}\n/**\n * @private\n */\n\nexport const NetworkReconnectTile = (props: NetworkReconnectTileProps): JSX.Element => {\n  const videoStream = props.localParticipantVideoStream;\n  const isVideoReady = videoStream?.isAvailable ?? false;\n  const palette = useTheme().palette;\n  const strings = useLocale().strings.call;\n  const handlers = useHandlers(ExpandedLocalVideoTile); // This tile may be shown at the beginning of a call.\n  // So we need to transition local video to the call.\n\n  useLocalVideoStartTrigger(!!props.localParticipantVideoStream.isAvailable);\n  return <ExpandedLocalVideoTile localParticipantVideoStream={props.localParticipantVideoStream} overlayContent={<Stack verticalFill horizontalAlign=\"center\" verticalAlign=\"center\" className={mergeStyles(containerStyle)} aria-atomic>\n          <Stack horizontal className={mergeStyles(titleContainerStyle)}>\n            <CallCompositeIcon iconName=\"NetworkReconnectIcon\" className={mergeStyles(titleStyle)} />\n            <Text className={mergeStyles(titleStyle(palette, isVideoReady))} aria-live={'assertive'}>\n              {strings.networkReconnectTitle}\n            </Text>\n          </Stack>\n          <Text className={mergeStyles(moreDetailsStyle(palette, isVideoReady))} aria-live={'assertive'}>\n            {strings.networkReconnectMoreDetails}\n          </Text>\n        </Stack>} {...handlers} />;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { getCallStatus, getIsScreenShareOn } from './baseSelectors';\nimport { createSelector } from 'reselect';\nimport { CallState as SDKCallStatus } from '@azure/communication-calling';\n/**\n * @private\n */\n\nexport const callStatusSelector = createSelector([getCallStatus, getIsScreenShareOn], (callStatus: SDKCallStatus, isScreenShareOn) => {\n  return {\n    callStatus,\n    isScreenShareOn\n  };\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport * as reselect from 'reselect';\nimport { getIsRecordingActive, getIsTranscriptionActive } from './baseSelectors';\n/**\n * @private\n */\n\nexport const complianceBannerSelector = reselect.createSelector([getIsTranscriptionActive, getIsRecordingActive], (isTranscriptionActive, isRecordingActive) => {\n  return {\n    callTranscribeState: isTranscriptionActive,\n    callRecordState: isRecordingActive\n  };\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport * as reselect from 'reselect';\nimport { getLocalVideoStreams } from './baseSelectors';\n/**\n * @private\n */\n\nexport const mediaGallerySelector = reselect.createSelector([getLocalVideoStreams], localVideoStreams => {\n  return {\n    isVideoStreamOn: !!localVideoStreams?.find(stream => stream.mediaStreamType === 'Video')?.view?.target\n  };\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport * as reselect from 'reselect';\nimport { getUserFacingDiagnostics } from './baseSelectors';\n/**\n * @private\n */\n\nexport const mutedNotificationSelector = reselect.createSelector([getUserFacingDiagnostics], diagnostics => {\n  return {\n    speakingWhileMuted: !!diagnostics?.media.latest.speakingWhileMicrophoneIsMuted?.value\n  };\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { _isInCall, _isPreviewOn } from '@internal/calling-component-bindings';\nimport { LocalVideoStreamState } from '@internal/calling-stateful-client';\nimport * as reselect from 'reselect';\nimport { getDeviceManager, getLocalVideoStreams } from './baseSelectors';\nimport { callStatusSelector } from './callStatusSelector';\n/**\n * @private\n */\n\nexport const localVideoSelector = reselect.createSelector([callStatusSelector, getDeviceManager, getLocalVideoStreams], (callStatus, deviceManager, localVideoStreams) => {\n  let localVideoStream: LocalVideoStreamState | undefined;\n\n  if (_isInCall(callStatus.callStatus)) {\n    localVideoStream = localVideoStreams?.find(i => i.mediaStreamType === 'Video');\n  } else if (_isPreviewOn(deviceManager)) {\n    // TODO: we should take in a LocalVideoStream that developer wants to use as their 'Preview' view. We should also\n    // handle cases where 'Preview' view is in progress and not necessary completed.\n    localVideoStream = deviceManager.unparentedViews[0];\n  }\n\n  return {\n    isAvailable: !!localVideoStream,\n    isMirrored: localVideoStream?.view?.isMirrored,\n    renderElement: localVideoStream?.view?.target\n  };\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { _isInCall, _isPreviewOn } from '@internal/calling-component-bindings';\nimport * as reselect from 'reselect';\nimport { localVideoSelector } from './localVideoStreamSelector';\n/**\n * @private\n */\n\nexport const lobbySelector = reselect.createSelector([localVideoSelector], localVideoStreamInfo => {\n  return {\n    localParticipantVideoStream: localVideoStreamInfo\n  };\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport * as reselect from 'reselect';\nimport { getUserFacingDiagnostics } from './baseSelectors';\nimport { lobbySelector } from './lobbySelector';\n/**\n * @private\n */\n\nexport const networkReconnectTileSelector = reselect.createSelector([getUserFacingDiagnostics, lobbySelector], (diagnostics, lobbyProps) => {\n  return {\n    networkReconnectValue: diagnostics?.network.latest.networkReconnect?.value,\n    localParticipantVideoStream: lobbyProps.localParticipantVideoStream\n  };\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { DiagnosticQuality } from '@azure/communication-calling';\nimport { _isInCall } from '@internal/calling-component-bindings';\nimport { ErrorBar, OnRenderAvatarCallback, ParticipantMenuItemsCallback } from '@internal/react-components';\nimport React from 'react';\nimport { AvatarPersonaDataCallback } from '../../common/AvatarPersona';\nimport { useLocale } from '../../localization';\nimport { CallCompositeOptions } from '../CallComposite';\nimport { CallArrangement } from '../components/CallArrangement';\nimport { MediaGallery } from '../components/MediaGallery';\nimport { NetworkReconnectTile } from '../components/NetworkReconnectTile';\nimport { useHandlers } from '../hooks/useHandlers';\nimport { usePropsFor } from '../hooks/usePropsFor';\nimport { useSelector } from '../hooks/useSelector';\nimport { callStatusSelector } from '../selectors/callStatusSelector';\nimport { complianceBannerSelector } from '../selectors/complianceBannerSelector';\nimport { mediaGallerySelector } from '../selectors/mediaGallerySelector';\nimport { mutedNotificationSelector } from '../selectors/mutedNotificationSelector';\nimport { networkReconnectTileSelector } from '../selectors/networkReconnectTileSelector';\nimport { reduceCallControlsForMobile } from '../utils';\n/**\n * @private\n */\n\nexport interface CallPageProps {\n  mobileView: boolean;\n  callInvitationURL?: string;\n  onRenderAvatar?: OnRenderAvatarCallback;\n  onFetchAvatarPersonaData?: AvatarPersonaDataCallback;\n  onFetchParticipantMenuItems?: ParticipantMenuItemsCallback;\n  options?: CallCompositeOptions;\n}\n/**\n * @private\n */\n\nexport const CallPage = (props: CallPageProps): JSX.Element => {\n  const {\n    callInvitationURL,\n    onRenderAvatar,\n    onFetchAvatarPersonaData,\n    onFetchParticipantMenuItems,\n    options,\n    mobileView\n  } = props; // To use useProps to get these states, we need to create another file wrapping Call,\n  // It seems unnecessary in this case, so we get the updated states using this approach.\n\n  const {\n    callStatus\n  } = useSelector(callStatusSelector);\n  const mediaGalleryProps = useSelector(mediaGallerySelector);\n  const mediaGalleryHandlers = useHandlers(MediaGallery);\n  const complianceBannerProps = useSelector(complianceBannerSelector);\n  const errorBarProps = usePropsFor(ErrorBar);\n  const mutedNotificationProps = useSelector(mutedNotificationSelector);\n  const networkReconnectTileProps = useSelector(networkReconnectTileSelector);\n  const strings = useLocale().strings.call; // Reduce the controls shown when mobile view is enabled.\n\n  const callControlOptions = mobileView ? reduceCallControlsForMobile(options?.callControls) : options?.callControls;\n  return <CallArrangement complianceBannerProps={{ ...complianceBannerProps,\n    strings\n  }} errorBarProps={options?.errorBar !== false && { ...errorBarProps\n  }} mutedNotificationProps={mutedNotificationProps} callControlProps={{\n    callInvitationURL: callInvitationURL,\n    onFetchParticipantMenuItems: onFetchParticipantMenuItems,\n    options: callControlOptions,\n    increaseFlyoutItemSize: mobileView\n  }} mobileView={mobileView} onRenderGalleryContent={() => _isInCall(callStatus) ? isNetworkHealthy(networkReconnectTileProps.networkReconnectValue) ? <MediaGallery isMobile={mobileView} {...mediaGalleryProps} {...mediaGalleryHandlers} onRenderAvatar={onRenderAvatar} onFetchAvatarPersonaData={onFetchAvatarPersonaData} /> : <NetworkReconnectTile {...networkReconnectTileProps} /> : <></>} dataUiId={'call-page'} />;\n};\n/**\n * @private\n */\n\nexport const isNetworkHealthy = (value: DiagnosticQuality | boolean | undefined): boolean => {\n  // We know that the value is actually of type DiagnosticQuality for this diagnostic.\n  // We ignore any boolen values, considering the network to still be healthy.\n  // Thus, only DiagnosticQuality.Poor or .Bad indicate network problems.\n  return value === true || value === false || value === undefined || value === DiagnosticQuality.Good;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IDropdownStyles, IStackTokens, Theme, mergeStyles } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const mainStackTokens: IStackTokens = {\n  childrenGap: '1rem'\n};\n/**\n * @private\n */\n\nexport const micStackTokens: IStackTokens = {\n  childrenGap: '1rem'\n};\n/**\n * @private\n */\n\nexport const dropDownStyles = (theme: Theme): Partial<IDropdownStyles> => ({\n  caretDownWrapper: {\n    height: '2.5rem',\n    lineHeight: '2.5rem'\n  },\n  dropdownItem: {\n    fontSize: '0.875rem',\n    height: '2.5rem',\n    background: theme.palette.neutralQuaternaryAlt\n  },\n  dropdown: {\n    height: '2.5rem',\n    width: '100%',\n    svg: {\n      verticalAlign: 'top'\n    }\n  },\n  title: {\n    fontSize: '0.875rem',\n    height: '2.5rem',\n    lineHeight: '2.3125rem'\n  },\n  label: {\n    fontWeight: 600,\n    fontSize: '0.875rem'\n  },\n  errorMessage: {\n    fontSize: '0.875rem'\n  }\n});\n/**\n * @private\n */\n\nexport const dropDownTitleIconStyles = mergeStyles({\n  overflow: 'hidden',\n  textOverflow: 'ellipsis',\n  minWidth: '0',\n  maxWidth: '100%',\n  overflowWrap: 'break-word',\n  margin: '.063rem'\n});\n/**\n * @private\n */\n\nexport const optionIconStyles = mergeStyles({\n  marginRight: '8px',\n  verticalAlign: 'text-top'\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CallingHandlers } from '@internal/calling-component-bindings';\n/**\n * @private\n */\n\nexport interface ConfigurationpageCameraDropdownProps {\n  cameraGrantedDropdown: JSX.Element;\n  cameraPermissionGranted: boolean;\n  dropdownProps?: Record<string, never> & Partial<CallingHandlers>;\n}\n/**\n * @private\n */\n\nexport const ConfigurationpageCameraDropdown = (props: ConfigurationpageCameraDropdownProps): JSX.Element => {\n  return props.cameraGrantedDropdown;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CallingHandlers } from '@internal/calling-component-bindings';\n/**\n * @private\n */\n\nexport interface ConfigurationpageMicDropdownProps {\n  micGrantedDropdown: JSX.Element;\n  micPermissionGranted: boolean;\n  dropdownProps?: Record<string, never> & Partial<CallingHandlers>;\n}\n/**\n * @private\n */\n\nexport const ConfigurationpageMicDropdown = (props: ConfigurationpageMicDropdownProps): JSX.Element => {\n  return props.micGrantedDropdown;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { AudioDeviceInfo, VideoDeviceInfo } from '@azure/communication-calling';\nimport { Dropdown, IDropdownOption, Label, mergeStyles, Stack } from '@fluentui/react';\nimport { useTheme, VideoStreamOptions, _DevicePermissionDropdown } from '@internal/react-components';\nimport React from 'react';\nimport { CallCompositeIcon } from '../../common/icons';\nimport { useLocale } from '../../localization';\nimport { dropDownStyles, dropDownTitleIconStyles, mainStackTokens, optionIconStyles } from '../styles/LocalDeviceSettings.styles';\nimport { ConfigurationpageCameraDropdown } from './ConfigurationpageCameraDropdown';\nimport { ConfigurationpageMicDropdown } from './ConfigurationpageMicDropdown';\ntype iconType = 'Camera' | 'Microphone' | 'Speaker';\n\nconst getDropDownList = (list: Array<VideoDeviceInfo | AudioDeviceInfo>): IDropdownOption[] => {\n  // Remove duplicates\n  const noDuplicates = new Map<string, VideoDeviceInfo | AudioDeviceInfo>();\n\n  for (const item of list) {\n    noDuplicates.set(item.id, item);\n  }\n\n  const dropdownList: IDropdownOption[] = [];\n\n  for (const item of noDuplicates.values()) {\n    dropdownList.push({\n      key: item.id,\n      text: item.name === '' ? item.deviceType : item.name\n    });\n  }\n\n  return dropdownList;\n};\n\nconst getOptionIcon = (type: iconType): JSX.Element | undefined => {\n  if (type === 'Camera') {\n    return <CallCompositeIcon iconName=\"LocalDeviceSettingsCamera\" className={optionIconStyles} />;\n  } else if (type === 'Microphone') {\n    return <CallCompositeIcon iconName=\"LocalDeviceSettingsMic\" className={optionIconStyles} />;\n  } else if (type === 'Speaker') {\n    return <CallCompositeIcon iconName=\"LocalDeviceSettingsSpeaker\" className={optionIconStyles} />;\n  } else {\n    return undefined;\n  }\n};\n\nconst onRenderTitle = (iconType: iconType, props?: IDropdownOption[]): JSX.Element => {\n  const icon = props && getOptionIcon(iconType);\n  return props ? <div className={dropDownTitleIconStyles}>\n      {icon}\n      <span>{props[0].text}</span>\n    </div> : <></>;\n};\n\nconst localVideoViewOptions = ({\n  scalingMode: 'Crop',\n  isMirrored: true\n} as VideoStreamOptions);\n/**\n * @private\n */\n\nexport interface LocalDeviceSettingsType {\n  cameras: VideoDeviceInfo[];\n  microphones: AudioDeviceInfo[];\n  speakers: AudioDeviceInfo[];\n  selectedCamera?: VideoDeviceInfo;\n  selectedMicrophone?: AudioDeviceInfo;\n  selectedSpeaker?: AudioDeviceInfo;\n  microphonePermissionGranted: boolean | undefined;\n  cameraPermissionGranted: boolean | undefined;\n  onSelectCamera: (device: VideoDeviceInfo, options?: VideoStreamOptions) => Promise<void>;\n  onSelectMicrophone: (device: AudioDeviceInfo) => Promise<void>;\n  onSelectSpeaker: (device: AudioDeviceInfo) => Promise<void>;\n}\n/**\n * @private\n */\n\nexport const LocalDeviceSettings = (props: LocalDeviceSettingsType): JSX.Element => {\n  const theme = useTheme();\n  const locale = useLocale();\n  const defaultPlaceHolder = locale.strings.call.defaultPlaceHolder;\n  const cameraLabel = locale.strings.call.cameraLabel;\n  const soundLabel = locale.strings.call.soundLabel;\n  const cameraPermissionGranted = props.cameraPermissionGranted;\n  const micPermissionGranted = props.microphonePermissionGranted;\n  let roleCanUseCamera = true;\n  let roleCanUseMic = true;\n  const cameraGrantedDropdown = <Dropdown data-ui-id=\"call-composite-local-camera-settings\" aria-labelledby={'call-composite-local-camera-settings-label'} placeholder={defaultPlaceHolder} options={cameraPermissionGranted ? getDropDownList(props.cameras) : [{\n    key: 'deniedOrUnknown',\n    text: ''\n  }]} styles={dropDownStyles(theme)} disabled={!cameraPermissionGranted} errorMessage={props.cameraPermissionGranted === undefined || props.cameraPermissionGranted ? undefined : locale.strings.call.cameraPermissionDenied} defaultSelectedKey={micPermissionGranted ? props.selectedCamera ? props.selectedCamera.id : props.cameras ? props.cameras[0]?.id : '' : 'deniedOrUnknown'} onChange={(event, option, index) => {\n    props.onSelectCamera(props.cameras[index ?? 0], localVideoViewOptions);\n  }} onRenderTitle={(props?: IDropdownOption[]) => onRenderTitle('Camera', props)} />;\n  const micGrantedDropdown = <>\n      {roleCanUseMic && <Dropdown aria-labelledby={'call-composite-local-sound-settings-label'} placeholder={defaultPlaceHolder} styles={dropDownStyles(theme)} disabled={!micPermissionGranted} errorMessage={props.microphonePermissionGranted === undefined || props.microphonePermissionGranted ? undefined : locale.strings.call.microphonePermissionDenied} options={micPermissionGranted ? getDropDownList(props.microphones) : [{\n      key: 'deniedOrUnknown',\n      text: ''\n    }]} defaultSelectedKey={micPermissionGranted ? props.selectedMicrophone ? props.selectedMicrophone.id : defaultDeviceId(props.microphones) : 'deniedOrUnknown'} onChange={(event: React.FormEvent<HTMLDivElement>, option?: IDropdownOption | undefined, index?: number | undefined) => {\n      props.onSelectMicrophone(props.microphones[index ?? 0]);\n    }} onRenderTitle={(props?: IDropdownOption[]) => onRenderTitle('Microphone', props)} />}\n    </>;\n  return <Stack data-ui-id=\"call-composite-device-settings\" tokens={mainStackTokens}>\n      {roleCanUseCamera && <Stack>\n          <Label id={'call-composite-local-camera-settings-label'} className={mergeStyles(dropDownStyles(theme).label)} disabled={!cameraPermissionGranted} // follows dropdown disabled state\n      >\n            {cameraLabel}\n          </Label>\n          <ConfigurationpageCameraDropdown cameraGrantedDropdown={cameraGrantedDropdown} cameraPermissionGranted={cameraPermissionGranted ?? false} />\n        </Stack>}\n      <Stack>\n        <Label id={'call-composite-local-sound-settings-label'} className={mergeStyles(dropDownStyles(theme).label)} disabled={!micPermissionGranted} // follows Start button disabled state in ConfigurationPage\n      >\n          {soundLabel}\n        </Label>\n        <Stack data-ui-id=\"call-composite-sound-settings\" tokens={mainStackTokens}>\n          <ConfigurationpageMicDropdown micGrantedDropdown={micGrantedDropdown} micPermissionGranted={micPermissionGranted ?? false} />\n          <Dropdown aria-labelledby={'call-composite-local-sound-settings-label'} placeholder={defaultPlaceHolder} styles={dropDownStyles(theme)} disabled={props.speakers.length === 0} options={getDropDownList(props.speakers)} defaultSelectedKey={props.selectedSpeaker ? props.selectedSpeaker.id : defaultDeviceId(props.speakers)} onChange={(event: React.FormEvent<HTMLDivElement>, option?: IDropdownOption | undefined, index?: number | undefined) => {\n          props.onSelectSpeaker(props.speakers[index ?? 0]);\n        }} onRenderTitle={(props?: IDropdownOption[]) => onRenderTitle('Speaker', props)} />\n        </Stack>\n      </Stack>\n    </Stack>;\n};\n\nconst defaultDeviceId = (devices: AudioDeviceInfo[]): string => {\n  if (devices.length === 0) {\n    return '';\n  }\n\n  const defaultDevice = devices.find(device => device.isSystemDefault);\n\n  if (defaultDevice) {\n    return defaultDevice.id;\n  }\n\n  return devices[0].id;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IButtonStyles, mergeStyles } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const videoCameraIconStyle = mergeStyles({\n  marginRight: '0.375rem',\n  fontSize: '1.375rem'\n});\n/**\n * @private\n */\n\nexport const buttonStyle = mergeStyles({\n  fontWeight: 600,\n  fontSize: '0.875rem',\n  // 14px\n  height: '2.75rem',\n  width: '100%'\n});\n/**\n * @private\n */\n\nexport const buttonWithIconStyles: IButtonStyles = {\n  textContainer: {\n    display: 'contents'\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { PrimaryButton, mergeStyles, IButtonProps } from '@fluentui/react';\nimport React from 'react';\nimport { buttonStyle, buttonWithIconStyles, videoCameraIconStyle } from '../styles/StartCallButton.styles';\nimport { Video20Filled } from '@fluentui/react-icons';\nimport { useLocale } from '../../localization';\n/**\n * @private\n */\n\nexport interface StartCallButtonProps extends IButtonProps {\n  className?: string;\n  /** If set, the button is intended to rejoin an existing call. */\n\n  rejoinCall?: boolean;\n}\n/**\n * @private\n */\n\nexport const StartCallButton = (props: StartCallButtonProps): JSX.Element => {\n  const {\n    rejoinCall\n  } = props;\n  const locale = useLocale();\n  return <PrimaryButton {...props} data-ui-id=\"call-composite-start-call-button\" className={mergeStyles(buttonStyle, props.className)} styles={buttonWithIconStyles} text={rejoinCall ? locale.strings.call.rejoinCallButtonLabel : locale.strings.call.startCallButtonLabel} onRenderIcon={() => <Video20Filled className={videoCameraIconStyle} />} />;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport * as reselect from 'reselect';\nimport { getDeviceManager } from './baseSelectors';\n/**\n * @private\n */\n\nexport const devicePermissionSelector = reselect.createSelector([getDeviceManager], deviceManager => {\n  return {\n    video: deviceManager.deviceAccess ? deviceManager.deviceAccess.video : undefined,\n    audio: deviceManager.deviceAccess ? deviceManager.deviceAccess.audio : undefined\n  };\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport * as reselect from 'reselect';\nimport { getDeviceManager } from './baseSelectors';\n/**\r\n * @private\r\n */\n\nexport const localPreviewSelector = reselect.createSelector([getDeviceManager], deviceManager => {\n  // TODO: we should take in a LocalVideoStream that developer wants to use as their 'Preview' view. We should also\n  // handle cases where 'Preview' view is in progress and not necessary completed.\n  const view = deviceManager.unparentedViews.length > 0 && deviceManager.unparentedViews[0].view;\n  return {\n    videoStreamElement: view ? view.target : null\n  };\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStyle, mergeStyles } from '@fluentui/react';\nconst localPreviewContainerStyle: IStyle = {\n  borderRadius: '.25rem'\n};\n/**\n * @private\n */\n\nexport const localPreviewContainerStyleDesktop = mergeStyles({ ...localPreviewContainerStyle,\n  width: '50%',\n  minWidth: '11rem',\n  maxWidth: '25rem',\n  height: '18.75rem',\n  padding: '0.5rem'\n});\n/**\n * @private\n */\n\nexport const localPreviewContainerStyleMobile = mergeStyles({ ...localPreviewContainerStyle,\n  width: '100%',\n  height: '100%'\n});\n/**\n * @private\n */\n\nexport const cameraOffLabelStyle = mergeStyles({\n  fontSize: '0.75rem' // 12px\n\n});\n/**\n * @private\n */\n\nexport const localPreviewTileStyle = {\n  root: {\n    borderRadius: '.25rem'\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { mergeStyles, Stack, Text } from '@fluentui/react';\nimport { CameraButton, ControlBar, MicrophoneButton, DevicesButton, StreamMedia, useTheme, VideoTile } from '@internal/react-components';\nimport React, { useCallback } from 'react';\nimport { CallCompositeIcon } from '../../common/icons';\nimport { useLocale } from '../../localization';\nimport { useAdapter } from '../adapter/CallAdapterProvider';\nimport { usePropsFor } from '../hooks/usePropsFor';\nimport { useSelector } from '../hooks/useSelector';\nimport { getLocalMicrophoneEnabled } from '../selectors/baseSelectors';\nimport { devicePermissionSelector } from '../selectors/devicePermissionSelector';\nimport { localPreviewSelector } from '../selectors/localPreviewSelector';\nimport { buttonFlyoutIncreasedSizeStyles } from '../styles/Buttons.styles';\nimport { cameraOffLabelStyle, localPreviewContainerStyleDesktop, localPreviewContainerStyleMobile, localPreviewTileStyle } from '../styles/LocalPreview.styles';\n/**\n * @private\n */\n\nexport interface LocalPreviewProps {\n  mobileView: boolean;\n  showDevicesButton: boolean;\n}\n/**\n * @private\n */\n\nexport const LocalPreview = (props: LocalPreviewProps): JSX.Element => {\n  const locale = useLocale();\n  const cameraButtonProps = usePropsFor(CameraButton);\n  const localPreviewProps = useSelector(localPreviewSelector);\n  const devicesButtonProps = usePropsFor(DevicesButton);\n  const {\n    audio: microphonePermissionGranted,\n    video: cameraPermissionGranted\n  } = useSelector(devicePermissionSelector);\n  const isLocalMicrophoneEnabled = useSelector(getLocalMicrophoneEnabled);\n  const adapter = useAdapter();\n  const onToggleMic = useCallback(async () => {\n    isLocalMicrophoneEnabled ? adapter.mute() : adapter.unmute();\n  }, [adapter, isLocalMicrophoneEnabled]);\n  const theme = useTheme();\n  const onRenderPlaceholder = useCallback((): JSX.Element => {\n    return <Stack className={mergeStyles({\n      width: '100%',\n      height: '100%'\n    })} verticalAlign=\"center\" tokens={{\n      childrenGap: '0.25rem'\n    }}>\n        <Stack.Item align=\"center\">\n          <CallCompositeIcon iconName=\"LocalPreviewPlaceholder\" className={mergeStyles(cameraOffLabelStyle, {\n          color: theme.palette.neutralTertiary\n        })} />\n        </Stack.Item>\n        <Stack.Item align=\"center\">\n          <Text className={mergeStyles(cameraOffLabelStyle, {\n          color: theme.palette.neutralSecondary\n        })}>\n            {locale.strings.call.cameraTurnedOff}\n          </Text>\n        </Stack.Item>\n      </Stack>;\n  }, [theme, locale.strings.call.cameraTurnedOff]);\n  const devicesButtonStyles = props.mobileView ? {\n    menuStyles: {\n      menuItemStyles: buttonFlyoutIncreasedSizeStyles\n    }\n  } : undefined;\n  return <Stack data-ui-id=\"call-composite-local-preview\" className={props.mobileView ? localPreviewContainerStyleMobile : localPreviewContainerStyleDesktop}>\n      <VideoTile styles={localPreviewTileStyle} renderElement={localPreviewProps?.videoStreamElement ? <StreamMedia videoStreamElement={localPreviewProps.videoStreamElement} /> : undefined} onRenderPlaceholder={onRenderPlaceholder}>\n        <ControlBar layout=\"floatingBottom\">\n          <MicrophoneButton data-ui-id=\"call-composite-local-device-settings-microphone-button\" checked={isLocalMicrophoneEnabled} onToggleMicrophone={onToggleMic} disabled={!microphonePermissionGranted} showLabel={true} />\n          <CameraButton data-ui-id=\"call-composite-local-device-settings-camera-button\" {...cameraButtonProps} showLabel={true} disabled={!cameraPermissionGranted} />\n          {props.showDevicesButton && <DevicesButton data-ui-id=\"call-composite-local-device-settings-options-button\" {...devicesButtonProps} // disable button whilst all other buttons are disabled\n        disabled={!microphonePermissionGranted || !cameraPermissionGranted} showLabel={true} styles={devicesButtonStyles} />}\n        </ControlBar>\n      </VideoTile>\n    </Stack>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStackItemStyles, IStackStyles, IStackTokens, IStyle, mergeStyles } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const configurationStackTokensDesktop: IStackTokens = {\n  childrenGap: '2rem'\n};\n/**\n * @private\n */\n\nexport const configurationStackTokensMobile: IStackTokens = {\n  childrenGap: '1rem'\n};\nconst configurationContainerStyle: IStyle = {\n  height: '100%',\n  width: '100%',\n  padding: '0.5rem'\n};\n/**\n * @private\n */\n\nexport const configurationContainerStyleDesktop = mergeStyles({ ...configurationContainerStyle,\n  minWidth: '25rem',\n  // sum of min-width from children + ChildrenGap * (nb of children - 1) + padding * 2 = (11 + 11) + (2 * 1) + 0.5 * 2\n  minHeight: '22rem' // max height of SelectionContainer + padding * 2 = 21 + 0.5 * 2\n\n});\n/**\n * @private\n */\n\nexport const configurationContainerStyleMobile = mergeStyles({ ...configurationContainerStyle,\n  minWidth: '16rem',\n  // from LocalPreview: ControlBar width + 0.5 * 2 for spacing + padding * 2 = 14 + 0.5 * 2 + 0.5 * 2\n  minHeight: '13rem'\n});\n/**\n * @private\n */\n\nexport const selectionContainerStyle = mergeStyles({\n  width: '50%',\n  minWidth: '11rem',\n  maxWidth: '18.75rem',\n  padding: '0.5rem'\n});\n/**\n * @private\n */\n\nexport const titleContainerStyleDesktop = mergeStyles({\n  fontSize: '1.25rem',\n  lineHeight: '1.75rem',\n  fontWeight: 600\n});\n/**\n * @private\n */\n\nexport const titleContainerStyleMobile = mergeStyles({\n  fontSize: '1.0625rem',\n  lineHeight: '1.375rem',\n  fontWeight: 600,\n  textAlign: 'center'\n});\n/**\n * @private\n */\n\nexport const callDetailsContainerStylesDesktop: IStackItemStyles = {\n  root: {\n    marginBottom: '1.563rem'\n  }\n};\nconst callDetailsStyle: IStyle = {\n  fontSize: '0.9375',\n  lineHeight: '1.25rem',\n  marginTop: '0.25rem'\n};\n/**\n * @private\n */\n\nexport const callDetailsStyleDesktop = mergeStyles({ ...callDetailsStyle\n});\n/**\n * @private\n */\n\nexport const callDetailsStyleMobile = mergeStyles({ ...callDetailsStyle,\n  textAlign: 'center'\n});\n/**\n * @private\n */\n\nexport const startCallButtonContainerStyleDesktop: IStackStyles = {\n  root: {\n    paddingTop: '1.125rem'\n  }\n};\n/**\n * @private\n */\n\nexport const startCallButtonContainerStyleMobile: IStackStyles = {\n  root: {\n    textAlign: 'center'\n  }\n};\n/**\n * @private\n */\n\nexport const startCallButtonStyleMobile = mergeStyles({\n  width: '100%',\n  maxWidth: 'unset'\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React from 'react';\nimport { useAdaptedSelector } from '../hooks/useAdaptedSelector';\nimport { useHandlers } from '../hooks/useHandlers';\nimport { LocalDeviceSettings } from '../components/LocalDeviceSettings';\nimport { StartCallButton } from '../components/StartCallButton';\nimport { devicePermissionSelector } from '../selectors/devicePermissionSelector';\nimport { useSelector } from '../hooks/useSelector';\nimport { DevicesButton, ErrorBar } from '@internal/react-components';\nimport { getCallingSelector } from '@internal/calling-component-bindings';\nimport { Stack } from '@fluentui/react';\nimport { LocalPreview } from '../components/LocalPreview';\nimport { callDetailsStyleDesktop, callDetailsStyleMobile, configurationStackTokensDesktop, configurationStackTokensMobile, configurationContainerStyleDesktop, configurationContainerStyleMobile, selectionContainerStyle, startCallButtonContainerStyleDesktop, startCallButtonContainerStyleMobile, startCallButtonStyleMobile, titleContainerStyleDesktop, titleContainerStyleMobile, callDetailsContainerStylesDesktop } from '../styles/CallConfiguration.styles';\nimport { useLocale } from '../../localization';\nimport { bannerNotificationStyles } from '../styles/CallPage.styles';\nimport { usePropsFor } from '../hooks/usePropsFor';\nimport { useAdapter } from '../adapter/CallAdapterProvider';\n\n/**\n * @private\n */\nexport interface ConfigurationPageProps {\n  mobileView: boolean;\n  startCallHandler(): void;\n}\n/**\n * @private\n */\n\nexport const ConfigurationPage = (props: ConfigurationPageProps): JSX.Element => {\n  const {\n    startCallHandler,\n    mobileView\n  } = props;\n  const options = useAdaptedSelector(getCallingSelector(DevicesButton));\n  const localDeviceSettingsHandlers = useHandlers(LocalDeviceSettings);\n  const {\n    video: cameraPermissionGranted,\n    audio: microphonePermissionGranted\n  } = useSelector(devicePermissionSelector);\n  let errorBarProps = usePropsFor(ErrorBar);\n  const adapter = useAdapter();\n  const deviceState = adapter.getState().devices;\n  let disableStartCallButton = !microphonePermissionGranted || deviceState.microphones?.length === 0;\n  const locale = useLocale();\n  const title = <Stack.Item className={mobileView ? titleContainerStyleMobile : titleContainerStyleDesktop}>\n      {locale.strings.call.configurationPageTitle}\n    </Stack.Item>;\n  const callDescription = locale.strings.call.configurationPageCallDetails && <Stack.Item className={mobileView ? callDetailsStyleMobile : callDetailsStyleDesktop}>\n      {locale.strings.call.configurationPageCallDetails}\n    </Stack.Item>;\n  let mobileWithPreview = mobileView;\n  return <Stack className={mobileView ? configurationContainerStyleMobile : configurationContainerStyleDesktop}>\n      <Stack styles={bannerNotificationStyles}>\n        <ErrorBar {...errorBarProps} />\n      </Stack>\n      <Stack grow horizontal={!mobileWithPreview} horizontalAlign={mobileWithPreview ? 'stretch' : 'center'} verticalAlign=\"center\" tokens={mobileWithPreview ? configurationStackTokensMobile : configurationStackTokensDesktop}>\n        {mobileWithPreview && <Stack.Item>\n            {title}\n            {callDescription}\n          </Stack.Item>}\n        {localPreviewTrampoline(mobileWithPreview)}\n        <Stack className={mobileView ? undefined : selectionContainerStyle}>\n          {!mobileWithPreview && <>\n              <Stack.Item styles={callDetailsContainerStylesDesktop}>\n                {title}\n                {callDescription}\n              </Stack.Item>\n              <LocalDeviceSettings {...options} {...localDeviceSettingsHandlers} cameraPermissionGranted={cameraPermissionGranted} microphonePermissionGranted={microphonePermissionGranted} />\n            </>}\n          <Stack styles={mobileWithPreview ? startCallButtonContainerStyleMobile : startCallButtonContainerStyleDesktop}>\n            <StartCallButton className={mobileWithPreview ? startCallButtonStyleMobile : undefined} onClick={startCallHandler} disabled={disableStartCallButton} />\n          </Stack>\n        </Stack>\n      </Stack>\n    </Stack>;\n};\n\nconst localPreviewTrampoline = (mobileView: boolean, doNotShow?: boolean): JSX.Element | undefined => {\n  return <LocalPreview mobileView={mobileView} showDevicesButton={mobileView} />;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStyle, IStackTokens, IStackStyles } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const containerStyle: IStyle = {\n  maxWidth: '22.5rem',\n  // Ensure some space around the text on a narrow viewport.\n  margin: '1rem'\n};\n/**\n * @private\n */\n\nexport const containerItemGap: IStackTokens = {\n  childrenGap: '0.5rem'\n};\n/**\n * @private\n */\n\nexport const rejoinCallButtonContainerStyles: IStackStyles = {\n  root: {\n    paddingTop: '1.125rem'\n  }\n};\n/**\n * @private\n */\n\nexport const titleStyles: IStyle = {\n  fontSize: '1.25rem',\n  fontWeight: 600\n};\n/**\n * @private\n */\n\nexport const moreDetailsStyles: IStyle = {\n  fontSize: '1rem'\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React from 'react';\nimport { mergeStyles, Stack, Text } from '@fluentui/react';\nimport { containerStyle, moreDetailsStyles, containerItemGap, titleStyles, rejoinCallButtonContainerStyles } from '../styles/NoticePage.styles';\nimport { useAdapter } from '../adapter/CallAdapterProvider';\nimport { StartCallButton } from '../components/StartCallButton';\nimport { CallCompositeIcon, CallCompositeIcons } from '../../common/icons';\n/**\n * @private\n */\n\nexport interface NoticePageProps {\n  iconName: keyof CallCompositeIcons;\n  title: string;\n  moreDetails?: string;\n  dataUiId: string;\n}\n/**\n * Generic page with a title and more details text for serving up a notice to the user.\n *\n * @private\n */\n\nexport function NoticePage(props: NoticePageProps): JSX.Element {\n  const adapter = useAdapter();\n  return <Stack verticalFill verticalAlign=\"center\" horizontalAlign=\"center\" data-ui-id={props.dataUiId} aria-atomic>\n      <Stack className={mergeStyles(containerStyle)} tokens={containerItemGap}>\n        {props.iconName && <CallCompositeIcon iconName={props.iconName} />}\n        <Text className={mergeStyles(titleStyles)} aria-live=\"assertive\">\n          {props.title}\n        </Text>\n        <Text className={mergeStyles(moreDetailsStyles)} aria-live=\"assertive\">\n          {props.moreDetails}\n        </Text>\n        <Stack styles={rejoinCallButtonContainerStyles}>\n          <StartCallButton onClick={() => adapter.joinCall()} disabled={false} rejoinCall={true} autoFocus />\n        </Stack>\n      </Stack>\n    </Stack>;\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IPalette, IStyle } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const overlayContainerStyle: IStyle = {\n  // Ensure some space around the text on a narrow viewport.\n  margin: '1rem'\n};\n/**\n * @private\n */\n\nexport const titleStyle: (palette: IPalette, isVideoReady: boolean) => IStyle = (palette, isVideoReady) => {\n  return {\n    fontSize: '1.75rem',\n    color: isVideoReady ? 'white' : palette.neutralPrimary,\n    textAlign: 'center'\n  };\n};\n/**\n * @private\n */\n\nexport const videoTileStyles = {\n  root: {\n    height: '100%',\n    width: '100%'\n  }\n};\n/**\n * @private\n */\n\nexport const moreDetailsStyle = (palette: IPalette, isVideoReady: boolean): IStyle => ({\n  fontSize: '1rem',\n  color: isVideoReady ? 'white' : palette.neutralPrimary,\n  textAlign: 'center'\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React from 'react';\nimport { mergeStyles, Stack, Text } from '@fluentui/react';\nimport { VideoGalleryStream, useTheme } from '@internal/react-components';\nimport { moreDetailsStyle, overlayContainerStyle, titleStyle } from '../styles/LobbyTile.styles';\nimport { ExpandedLocalVideoTile } from './ExpandedLocalVideoTile';\nimport { useHandlers } from '../hooks/useHandlers';\n/**\n * @private\n */\n\nexport interface LobbyOverlayProps {\n  overlayIcon?: JSX.Element;\n  title: string;\n  moreDetails?: string;\n}\n/**\n * @private\n */\n\nexport interface LobbyTileProps {\n  localParticipantVideoStream: VideoGalleryStream;\n  overlayProps: LobbyOverlayProps;\n}\n/**\n * @private\n */\n\nexport const LobbyTile = (props: LobbyTileProps): JSX.Element => {\n  const videoStream = props.localParticipantVideoStream;\n  const isVideoReady = videoStream?.isAvailable ?? false;\n  const palette = useTheme().palette;\n  const handlers = useHandlers(ExpandedLocalVideoTile);\n  return <ExpandedLocalVideoTile localParticipantVideoStream={props.localParticipantVideoStream} overlayContent={props.overlayProps ? <Stack verticalFill horizontalAlign=\"center\" verticalAlign=\"center\" className={mergeStyles(overlayContainerStyle)} aria-atomic>\n            <Stack.Item className={mergeStyles(titleStyle(palette, isVideoReady))}>\n              {props.overlayProps.overlayIcon}\n            </Stack.Item>\n            <Text className={mergeStyles(titleStyle(palette, isVideoReady))} aria-live=\"assertive\">\n              {props.overlayProps.title}\n            </Text>\n            {props.overlayProps.moreDetails && <Text className={mergeStyles(moreDetailsStyle(palette, isVideoReady))} aria-live=\"assertive\">\n                {props.overlayProps.moreDetails}\n              </Text>}\n          </Stack> : undefined} {...handlers} />;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React from 'react';\nimport { ErrorBar } from '@internal/react-components';\nimport { useSelector } from '../hooks/useSelector';\nimport { lobbySelector } from '../selectors/lobbySelector';\nimport { CallCompositeOptions } from '../CallComposite';\nimport { CallArrangement } from '../components/CallArrangement';\nimport { usePropsFor } from '../hooks/usePropsFor';\nimport { LobbyOverlayProps, LobbyTile } from '../components/LobbyTile';\nimport { getCallStatus, getRemoteParticipants } from '../selectors/baseSelectors';\nimport { disableCallControls, reduceCallControlsForMobile } from '../utils';\nimport { CallCompositeStrings } from '../Strings';\nimport { useLocale } from '../../localization';\nimport { useLocalVideoStartTrigger } from '../components/MediaGallery';\nimport { CallCompositeIcon } from '../../common/icons';\nimport { isPhoneNumberIdentifier, PhoneNumberIdentifier } from '@azure/communication-common';\nimport { RemoteParticipantState } from '@internal/calling-stateful-client';\n/**\n * @private\n */\n\nexport interface LobbyPageProps {\n  mobileView: boolean;\n  options?: CallCompositeOptions;\n}\n/**\n * @private\n */\n\nexport const LobbyPage = (props: LobbyPageProps): JSX.Element => {\n  const errorBarProps = usePropsFor(ErrorBar);\n  const lobbyProps = useSelector(lobbySelector);\n  const strings = useLocale().strings.call;\n  const callState = useSelector(getCallStatus);\n  const inLobby = callState === 'InLobby';\n  const participants = useSelector(getRemoteParticipants) ?? {};\n  useLocalVideoStartTrigger(lobbyProps.localParticipantVideoStream.isAvailable, inLobby); // Reduce the controls shown when mobile view is enabled.\n\n  let callControlOptions = props.mobileView ? reduceCallControlsForMobile(props.options?.callControls) : props.options?.callControls;\n  callControlOptions = disableCallControls(callControlOptions, ['screenShareButton', 'participantsButton']);\n  return <CallArrangement complianceBannerProps={{\n    strings\n  }} errorBarProps={props.options?.errorBar !== false && { ...errorBarProps\n  }} callControlProps={{\n    options: callControlOptions,\n    increaseFlyoutItemSize: props.mobileView\n  }} mobileView={props.mobileView} onRenderGalleryContent={() => <LobbyTile {...lobbyProps} overlayProps={overlayProps(strings, inLobby, Object.values(participants))} />} dataUiId={'lobby-page'} />;\n};\n\nconst overlayProps = (strings: CallCompositeStrings, inLobby: boolean, remoteParticipants: RemoteParticipantState[]): LobbyOverlayProps => {\n  /**\n   * Only grab the first participant because there will only be one in this situation.\n   * when starting a call with multiple people the call goes to the connected state and composite goes directly to\n   * videoGallery.\n   *\n   * We also need to check the participant state since in a group call the remote participants array will populate just before\n   * the user joins. In this situation we also check the participant states. in a groupCall the state of the participants\n   * will be 'Idle'.\n   */\n  const outboundCallParticipant: RemoteParticipantState | undefined = remoteParticipants[0] && ['Ringing', 'Connecting'].includes(remoteParticipants[0].state) && remoteParticipants.length === 1 ? remoteParticipants[0] : undefined;\n  return inLobby ? overlayPropsWaitingToBeAdmitted(strings) : outboundCallParticipant ? overlayPropsOutboundCall(strings, outboundCallParticipant) : overlayPropsConnectingToCall(strings);\n};\n\nconst overlayPropsConnectingToCall = (strings: CallCompositeStrings): LobbyOverlayProps => ({\n  title: strings.lobbyScreenConnectingToCallTitle,\n  moreDetails: strings.lobbyScreenConnectingToCallMoreDetails,\n  overlayIcon: <CallCompositeIcon iconName=\"LobbyScreenConnectingToCall\" />\n});\n\nconst overlayPropsWaitingToBeAdmitted = (strings: CallCompositeStrings): LobbyOverlayProps => ({\n  title: strings.lobbyScreenWaitingToBeAdmittedTitle,\n  moreDetails: strings.lobbyScreenWaitingToBeAdmittedMoreDetails,\n  overlayIcon: <CallCompositeIcon iconName=\"LobbyScreenWaitingToBeAdmitted\" />\n});\n\nconst overlayPropsOutboundCall = (strings: CallCompositeStrings, participant: RemoteParticipantState): LobbyOverlayProps => {\n  if (isPhoneNumberIdentifier(participant.identifier)) {\n    return {\n      title: (participant.identifier as PhoneNumberIdentifier).phoneNumber,\n      moreDetails: outboundCallStringsTrampoline(strings)\n    };\n  } else {\n    return {\n      title: outboundCallStringsTrampoline(strings)\n    };\n  }\n};\n\nconst outboundCallStringsTrampoline = (strings: CallCompositeStrings): string => {\n  return '';\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStackStyles, IStyle, mergeStyles } from '@fluentui/react';\nconst mainScreenContainerStyle: IStyle = {\n  height: '100%',\n  width: '100%'\n};\n/**\n * @private\n */\n\nexport const mainScreenContainerStyleDesktop = mergeStyles({ ...mainScreenContainerStyle,\n  minWidth: '30rem',\n  // max of min-width of composite pages (Call page)\n  minHeight: '22rem' // max height of min-height of composite pages (Configuration page)\n\n});\n/**\n * @private\n */\n\nexport const mainScreenContainerStyleMobile = mergeStyles({ ...mainScreenContainerStyle,\n  minWidth: '17.5rem',\n  // max of min-width of composite pages (Call page)\n  minHeight: '13rem' // max height of min-height of composite pages (Configuration page & Call page)\n\n});\n/** @private */\n\nexport const drawerContainerStyles: IStackStyles = {\n  root: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n    // Any zIndex > 0 will work because this is the only absolutely\n    // positioned element in the container.\n    zIndex: 1\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { _isInCall } from '@internal/calling-component-bindings';\nimport { OnRenderAvatarCallback, ParticipantMenuItemsCallback } from '@internal/react-components';\nimport React, { useEffect, useMemo } from 'react';\nimport { AvatarPersonaDataCallback } from '../common/AvatarPersona';\nimport { BaseProvider, BaseCompositeProps } from '../common/BaseComposite';\nimport { CallCompositeIcons } from '../common/icons';\nimport { useLocale } from '../localization';\nimport { CallAdapter } from './adapter/CallAdapter';\nimport { CallAdapterProvider, useAdapter } from './adapter/CallAdapterProvider';\nimport { CallPage } from './pages/CallPage';\nimport { ConfigurationPage } from './pages/ConfigurationPage';\nimport { NoticePage } from './pages/NoticePage';\nimport { useSelector } from './hooks/useSelector';\nimport { getPage } from './selectors/baseSelectors';\nimport { LobbyPage } from './pages/LobbyPage';\nimport { mainScreenContainerStyleDesktop, mainScreenContainerStyleMobile } from './styles/CallComposite.styles';\nimport { CallControlOptions } from './types/CallControlOptions';\n\n/**\n * Props for {@link CallComposite}.\n *\n * @public\n */\nexport interface CallCompositeProps extends BaseCompositeProps<CallCompositeIcons> {\n  /**\n   * An adapter provides logic and data to the composite.\n   * Composite can also be controlled using the adapter.\n   */\n  adapter: CallAdapter;\n  /**\n   * Optimizes the composite form factor for either desktop or mobile.\n   * @remarks `mobile` is currently only optimized for Portrait mode on mobile devices and does not support landscape.\n   * @defaultValue 'desktop'\n   */\n\n  formFactor?: 'desktop' | 'mobile';\n  /**\n   * URL to invite new participants to the current call. If this is supplied, a button appears in the Participants\n   * Button flyout menu.\n   */\n\n  callInvitationUrl?: string;\n  /**\n   * Flags to enable/disable or customize UI elements of the {@link CallComposite}.\n   */\n\n  options?: CallCompositeOptions;\n}\n\n/**\n * Optional features of the {@link CallComposite}.\n *\n * @public\n */\nexport type CallCompositeOptions = {\n  /**\n   * Surface Azure Communication Services backend errors in the UI with {@link @azure/communication-react#ErrorBar}.\n   * Hide or show the error bar.\n   * @defaultValue true\n   */\n  errorBar?: boolean;\n  /**\n   * Hide or Customize the control bar element.\n   * Can be customized by providing an object of type {@link @azure/communication-react#CallControlOptions}.\n   * @defaultValue true\n   */\n\n  callControls?: boolean | CallControlOptions;\n};\ntype MainScreenProps = {\n  mobileView: boolean;\n  onRenderAvatar?: OnRenderAvatarCallback;\n  callInvitationUrl?: string;\n  onFetchAvatarPersonaData?: AvatarPersonaDataCallback;\n  onFetchParticipantMenuItems?: ParticipantMenuItemsCallback;\n  options?: CallCompositeOptions;\n};\n\nconst MainScreen = (props: MainScreenProps): JSX.Element => {\n  const {\n    callInvitationUrl,\n    onRenderAvatar,\n    onFetchAvatarPersonaData,\n    onFetchParticipantMenuItems\n  } = props;\n  const page = useSelector(getPage);\n  const adapter = useAdapter();\n  const locale = useLocale();\n  let pageElement: JSX.Element | undefined;\n\n  switch (page) {\n    case 'configuration':\n      pageElement = <ConfigurationPage mobileView={props.mobileView} startCallHandler={(): void => {\n        adapter.joinCall();\n      }} />;\n      break;\n\n    case 'accessDeniedTeamsMeeting':\n      pageElement = <NoticePage iconName=\"NoticePageAccessDeniedTeamsMeeting\" title={locale.strings.call.failedToJoinTeamsMeetingReasonAccessDeniedTitle} moreDetails={locale.strings.call.failedToJoinTeamsMeetingReasonAccessDeniedMoreDetails} dataUiId={'access-denied-teams-meeting-page'} />;\n      break;\n\n    case 'removedFromCall':\n      pageElement = <NoticePage iconName=\"NoticePageRemovedFromCall\" title={locale.strings.call.removedFromCallTitle} moreDetails={locale.strings.call.removedFromCallMoreDetails} dataUiId={'removed-from-call-page'} />;\n      break;\n\n    case 'joinCallFailedDueToNoNetwork':\n      pageElement = <NoticePage iconName=\"NoticePageJoinCallFailedDueToNoNetwork\" title={locale.strings.call.failedToJoinCallDueToNoNetworkTitle} moreDetails={locale.strings.call.failedToJoinCallDueToNoNetworkMoreDetails} dataUiId={'join-call-failed-due-to-no-network-page'} />;\n      break;\n\n    case 'leftCall':\n      pageElement = <NoticePage iconName=\"NoticePageLeftCall\" title={locale.strings.call.leftCallTitle} moreDetails={locale.strings.call.leftCallMoreDetails} dataUiId={'left-call-page'} />;\n      break;\n\n    case 'lobby':\n      pageElement = <LobbyPage mobileView={props.mobileView} options={props.options} />;\n      break;\n\n    case 'call':\n      pageElement = <CallPage onRenderAvatar={onRenderAvatar} callInvitationURL={callInvitationUrl} onFetchAvatarPersonaData={onFetchAvatarPersonaData} onFetchParticipantMenuItems={onFetchParticipantMenuItems} mobileView={props.mobileView} options={props.options} />;\n      break;\n\n    /* @conditional-compile-remove(PSTN-calls) */\n\n    /* @conditional-compile-remove(one-to-n-calling) */\n\n    case holdPageTrampoline():\n      pageElement = <>\n          {}\n        </>;\n      break;\n\n    case unsupportedEnvironmentPageTrampoline():\n      pageElement = <>\n          {}\n        </>;\n  }\n\n  if (!pageElement) {\n    throw new Error('Invalid call composite page');\n  }\n\n  // default retElement for stable version\n  let retElement = pageElement;\n  return retElement;\n};\n/**\n * A customizable UI composite for calling experience.\n *\n * @remarks Call composite min width/height are as follow:\n * - mobile: 17.5rem x 21rem (280px x 336px, with default rem at 16px)\n * - desktop: 30rem x 22rem (480px x 352px, with default rem at 16px)\n *\n * @public\n */\n\n\nexport const CallComposite = (props: CallCompositeProps): JSX.Element => {\n  const {\n    adapter,\n    callInvitationUrl,\n    onFetchAvatarPersonaData,\n    onFetchParticipantMenuItems,\n    options,\n    formFactor = 'desktop'\n  } = props;\n  useEffect(() => {\n    (async () => {\n      await adapter.askDevicePermission({\n        video: true,\n        audio: true\n      });\n      adapter.queryCameras();\n      adapter.queryMicrophones();\n      adapter.querySpeakers();\n    })();\n  }, [adapter]);\n  const mobileView = formFactor === 'mobile';\n  const mainScreenContainerClassName = useMemo(() => {\n    return mobileView ? mainScreenContainerStyleMobile : mainScreenContainerStyleDesktop;\n  }, [mobileView]);\n  return <div className={mainScreenContainerClassName}>\n      <BaseProvider {...props}>\n        <CallAdapterProvider adapter={adapter}>\n          <MainScreen callInvitationUrl={callInvitationUrl} onFetchAvatarPersonaData={onFetchAvatarPersonaData} onFetchParticipantMenuItems={onFetchParticipantMenuItems} mobileView={mobileView} options={options} />\n          {// This layer host is for ModalLocalAndRemotePIP in CallPane. This LayerHost cannot be inside the CallPane\n        // because when the CallPane is hidden, ie. style property display is 'none', it takes up no space. This causes problems when dragging\n        // the Modal because the draggable bounds thinks it has no space and will always return to its initial position after dragging.\n        // Additionally, this layer host cannot be in the Call Arrangement as it needs to be rendered before useMinMaxDragPosition() in\n        // common/utils useRef is called.\n        // Warning: this is fragile and works because the call arrangement page is only rendered after the call has connected and thus this\n        // LayerHost will be guaranteed to have rendered (and subsequently mounted in the DOM). This ensures the DOM element will be available\n        // before the call to `document.getElementById(modalLayerHostId)` is made.\n        }\n        </CallAdapterProvider>\n      </BaseProvider>\n    </div>;\n};\n\nconst holdPageTrampoline = (): string => {\n  return 'call';\n};\n\nconst unsupportedEnvironmentPageTrampoline = (): string => {\n  return 'call';\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { RemoteParticipant, RemoteVideoStream } from '@azure/communication-calling';\nimport EventEmitter from 'events';\n/**\n * @private\n */\n\nexport class ParticipantSubscriber {\n  private participant: RemoteParticipant;\n  private emitter: EventEmitter;\n\n  constructor(participant: RemoteParticipant, emitter: EventEmitter) {\n    this.participant = participant;\n    this.emitter = emitter;\n    this.subscribeParticipantEvents();\n  }\n\n  private isMutedChangedHandler = (): void => {\n    this.emitter.emit('isMutedChanged', {\n      participantId: this.participant.identifier,\n      isMuted: this.participant.isMuted\n    });\n  };\n  private displayNameChangedHandler = (): void => {\n    this.emitter.emit('displayNameChanged', {\n      participantId: this.participant.identifier,\n      displayName: this.participant.displayName\n    });\n  };\n  private isSpeakingChangedHandler = (): void => {\n    this.emitter.emit('isSpeakingChanged', {\n      participantId: this.participant.identifier,\n      isSpeaking: this.participant.isSpeaking\n    });\n  };\n  private videoStreamsUpdatedHandler = (event: {\n    added: RemoteVideoStream[];\n    removed: RemoteVideoStream[];\n  }): void => {\n    this.emitter.emit('videoStreamsUpdated', event);\n  };\n\n  private subscribeParticipantEvents(): void {\n    this.participant.on('isMutedChanged', this.isMutedChangedHandler);\n    this.participant.on('displayNameChanged', this.displayNameChangedHandler);\n    this.participant.on('isSpeakingChanged', this.isSpeakingChangedHandler);\n    this.participant.on('videoStreamsUpdated', this.videoStreamsUpdatedHandler);\n  }\n\n  public unsubscribeAll(): void {\n    this.participant.off('isMutedChanged', this.isMutedChangedHandler);\n    this.participant.off('displayNameChanged', this.displayNameChangedHandler);\n    this.participant.off('isSpeakingChanged', this.isSpeakingChangedHandler);\n    this.participant.off('videoStreamsUpdated', this.videoStreamsUpdatedHandler);\n  }\n\n}\n/**\n * @private\n */\n\nexport type ParticipantEvent = 'isMutedChanged' | 'displayNameChanged' | 'isSpeakingChanged' | 'videoStreamsUpdated';","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Call, UserFacingDiagnosticsFeature, Features, MediaDiagnosticChangedEventArgs, NetworkDiagnosticChangedEventArgs } from '@azure/communication-calling';\nimport { EventEmitter } from 'events';\nimport { MediaDiagnosticChangedEvent, NetworkDiagnosticChangedEvent } from './CallAdapter';\n/**\n * @private\n */\n\nexport class DiagnosticsForwarder {\n  private _diagnostics: UserFacingDiagnosticsFeature;\n  private _emitter: EventEmitter;\n\n  constructor(emitter: EventEmitter, call: Call) {\n    this._diagnostics = call.feature(Features.UserFacingDiagnostics);\n    this._emitter = emitter;\n    this.subscribe();\n  }\n\n  public unsubscribe = (): void => {\n    this._diagnostics.network.off('diagnosticChanged', this.networkDiagnosticsChanged.bind(this));\n\n    this._diagnostics.media.off('diagnosticChanged', this.mediaDiagnosticsChanged.bind(this));\n  };\n\n  private subscribe(): void {\n    this._diagnostics.network.on('diagnosticChanged', this.networkDiagnosticsChanged.bind(this));\n\n    this._diagnostics.media.on('diagnosticChanged', this.mediaDiagnosticsChanged.bind(this));\n  }\n\n  private networkDiagnosticsChanged(args: NetworkDiagnosticChangedEventArgs): void {\n    const event: NetworkDiagnosticChangedEvent = {\n      type: 'network',\n      ...args\n    };\n\n    this._emitter.emit('diagnosticChanged', event);\n  }\n\n  private mediaDiagnosticsChanged(args: MediaDiagnosticChangedEventArgs): void {\n    const event: MediaDiagnosticChangedEvent = {\n      type: 'media',\n      ...args\n    };\n\n    this._emitter.emit('diagnosticChanged', event);\n  }\n\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CallingHandlers, createDefaultCallingHandlers, _isInCall, _isInLobbyOrConnecting } from '@internal/calling-component-bindings';\nimport { CallClientState, CallError, CallState, createStatefulCallClient, StatefulCallClient, StatefulDeviceManager } from '@internal/calling-stateful-client';\nimport { AudioOptions, CallAgent, Call, GroupCallLocator, TeamsMeetingLinkLocator, LocalVideoStream as SDKLocalVideoStream, AudioDeviceInfo, VideoDeviceInfo, RemoteParticipant, PermissionConstraints, PropertyChangedEvent, StartCallOptions, VideoOptions } from '@azure/communication-calling';\nimport { EventEmitter } from 'events';\nimport { CallAdapter, CallEndedListener, CallIdChangedListener, CallAdapterState, DisplayNameChangedListener, IsMutedChangedListener, IsLocalScreenSharingActiveChangedListener, IsSpeakingChangedListener, ParticipantsJoinedListener, ParticipantsLeftListener, DiagnosticChangedEventListner, CallAdapterCallEndedEvent } from './CallAdapter';\nimport { getCallCompositePage, IsCallEndedPage, isCameraOn } from '../utils';\nimport { CreateVideoStreamViewResult, VideoStreamOptions } from '@internal/react-components';\nimport { toFlatCommunicationIdentifier, _toCommunicationIdentifier } from '@internal/acs-ui-common';\nimport { CommunicationTokenCredential, CommunicationUserIdentifier, isCommunicationUserIdentifier, isPhoneNumberIdentifier, UnknownIdentifier, PhoneNumberIdentifier, CommunicationIdentifier } from '@azure/communication-common';\nimport { ParticipantSubscriber } from './ParticipantSubcriber';\nimport { AdapterError } from '../../common/adapters';\nimport { DiagnosticsForwarder } from './DiagnosticsForwarder';\nimport { useEffect, useRef, useState } from 'react';\n/** Context of call, which is a centralized context for all state updates */\n\nclass CallContext {\n  private emitter: EventEmitter = new EventEmitter();\n  private state: CallAdapterState;\n  private callId: string | undefined;\n\n  constructor(clientState: CallClientState, isTeamsCall: boolean) {\n    this.state = {\n      isLocalPreviewMicrophoneEnabled: false,\n      userId: clientState.userId,\n      displayName: clientState.callAgent?.displayName,\n      devices: clientState.deviceManager,\n      call: undefined,\n      page: 'configuration',\n      latestErrors: clientState.latestErrors,\n      isTeamsCall\n    };\n  }\n\n  public onStateChange(handler: (_uiState: CallAdapterState) => void): void {\n    this.emitter.on('stateChanged', handler);\n  }\n\n  public offStateChange(handler: (_uiState: CallAdapterState) => void): void {\n    this.emitter.off('stateChanged', handler);\n  }\n\n  public setState(state: CallAdapterState): void {\n    this.state = state;\n    this.emitter.emit('stateChanged', this.state);\n  }\n\n  public getState(): CallAdapterState {\n    return this.state;\n  }\n\n  public setIsLocalMicrophoneEnabled(isLocalPreviewMicrophoneEnabled: boolean): void {\n    this.setState({ ...this.state,\n      isLocalPreviewMicrophoneEnabled\n    });\n  } // This is the key to find current call object in client state\n\n\n  public setCurrentCallId(callId: string | undefined): void {\n    this.callId = callId;\n  }\n\n  public onCallEnded(handler: (callEndedData: CallAdapterCallEndedEvent) => void): void {\n    this.emitter.on('callEnded', handler);\n  }\n\n  public offCallEnded(handler: (callEndedData: CallAdapterCallEndedEvent) => void): void {\n    this.emitter.off('callEnded', handler);\n  }\n\n  public updateClientState(clientState: CallClientState): void {\n    let call = this.callId ? clientState.calls[this.callId] : undefined;\n    const latestEndedCall = findLatestEndedCall(clientState.callsEnded); // As the state is transitioning to a new state, trigger appropriate callback events.\n\n    const oldPage = this.state.page;\n    const newPage = getCallCompositePage(call, latestEndedCall);\n\n    if (!IsCallEndedPage(oldPage) && IsCallEndedPage(newPage)) {\n      this.emitter.emit('callEnded', {\n        callId: this.callId\n      }); // Reset the callId to undefined as the call has ended.\n\n      this.setCurrentCallId(undefined); // Make sure that the call is set to undefined in the state.\n\n      call = undefined;\n    }\n\n    if (this.state.page) {\n      this.setState({ ...this.state,\n        userId: clientState.userId,\n        displayName: clientState.callAgent?.displayName,\n        call,\n        page: newPage,\n        endedCall: latestEndedCall,\n        devices: clientState.deviceManager,\n        latestErrors: clientState.latestErrors\n      });\n    }\n  }\n\n}\n\nconst findLatestEndedCall = (calls: {\n  [key: string]: CallState;\n}): CallState | undefined => {\n  const callStates = Object.values(calls);\n\n  if (callStates.length === 0) {\n    return undefined;\n  }\n\n  let latestCall = callStates[0];\n\n  for (const call of callStates.slice(1)) {\n    if ((call.endTime?.getTime() ?? 0) > (latestCall.endTime?.getTime() ?? 0)) {\n      latestCall = call;\n    }\n  }\n\n  return latestCall;\n};\n/**\n * @private\n */\n\n\nexport class AzureCommunicationCallAdapter implements CallAdapter {\n  private callClient: StatefulCallClient;\n  private callAgent: CallAgent;\n  private deviceManager: StatefulDeviceManager;\n  private localStream: SDKLocalVideoStream | undefined;\n  private locator: CallAdapterLocator; // Never use directly, even internally. Use `call` property instead.\n\n  private _call?: Call;\n  private context: CallContext;\n  private diagnosticsForwarder?: DiagnosticsForwarder;\n  private handlers: CallingHandlers;\n  private participantSubscribers = new Map<string, ParticipantSubscriber>();\n  private emitter: EventEmitter = new EventEmitter();\n  private onClientStateChange: (clientState: CallClientState) => void;\n\n  private get call(): Call | undefined {\n    return this._call;\n  }\n\n  private set call(newCall: Call | undefined) {\n    this.resetDiagnosticsForwarder(newCall);\n    this._call = newCall;\n  }\n\n  constructor(callClient: StatefulCallClient, locator: CallAdapterLocator, callAgent: CallAgent, deviceManager: StatefulDeviceManager) {\n    this.bindPublicMethods();\n    this.callClient = callClient;\n    this.callAgent = callAgent;\n    this.locator = locator;\n    this.deviceManager = deviceManager;\n    const isTeamsMeeting = ('meetingLink' in this.locator);\n    this.context = new CallContext(callClient.getState(), isTeamsMeeting);\n    this.context.onCallEnded(endCallData => this.emitter.emit('callEnded', endCallData));\n\n    const onStateChange = (clientState: CallClientState): void => {\n      // unsubscribe when the instance gets disposed\n      if (!this) {\n        callClient.offStateChange(onStateChange);\n        return;\n      } // `updateClientState` searches for the current call from all the calls in the state using a cached `call.id`\n      // from the call object. `call.id` can change during a call. We must update the cached `call.id` before\n      // calling `updateClientState` so that we find the correct state object for the call even when `call.id`\n      // has changed.\n      // https://github.com/Azure/communication-ui-library/pull/1820\n\n\n      if (this.call?.id) {\n        this.context.setCurrentCallId(this.call.id);\n      }\n\n      this.context.updateClientState(clientState);\n    };\n\n    this.handlers = createDefaultCallingHandlers(callClient, callAgent, deviceManager, undefined);\n    this.onClientStateChange = onStateChange;\n    this.subscribeDeviceManagerEvents();\n    this.callClient.onStateChange(onStateChange);\n  } // TODO: update this to include the 'selectedCameraChanged' when calling adds it to the device manager\n\n\n  private subscribeDeviceManagerEvents(): void {\n    this.deviceManager.on('selectedMicrophoneChanged', () => {\n      this.emitter.emit('selectedMicrophoneChanged');\n    });\n    this.deviceManager.on('selectedSpeakerChanged', () => {\n      this.emitter.emit('selectedSpeakerChanged');\n    });\n  }\n\n  private bindPublicMethods(): void {\n    this.onStateChange.bind(this);\n    this.offStateChange.bind(this);\n    this.getState.bind(this);\n    this.dispose.bind(this);\n    this.joinCall.bind(this);\n    this.leaveCall.bind(this);\n    this.setCamera.bind(this);\n    this.setMicrophone.bind(this);\n    this.setSpeaker.bind(this);\n    this.askDevicePermission.bind(this);\n    this.queryCameras.bind(this);\n    this.queryMicrophones.bind(this);\n    this.querySpeakers.bind(this);\n    this.startCamera.bind(this);\n    this.stopCamera.bind(this);\n    this.mute.bind(this);\n    this.unmute.bind(this);\n    this.startCall.bind(this);\n    this.startScreenShare.bind(this);\n    this.stopScreenShare.bind(this);\n    this.removeParticipant.bind(this);\n    this.createStreamView.bind(this);\n    this.disposeStreamView.bind(this);\n    this.on.bind(this);\n    this.off.bind(this);\n    this.processNewCall.bind(this);\n  }\n\n  public dispose(): void {\n    this.resetDiagnosticsForwarder();\n    this.callClient.offStateChange(this.onClientStateChange);\n    this.callAgent.dispose();\n  }\n\n  public async queryCameras(): Promise<VideoDeviceInfo[]> {\n    return await this.asyncTeeErrorToEventEmitter(async () => {\n      return this.deviceManager.getCameras();\n    });\n  }\n\n  public async queryMicrophones(): Promise<AudioDeviceInfo[]> {\n    return await this.asyncTeeErrorToEventEmitter(async () => {\n      return this.deviceManager.getMicrophones();\n    });\n  }\n\n  public async querySpeakers(): Promise<AudioDeviceInfo[]> {\n    return await this.asyncTeeErrorToEventEmitter(async () => {\n      return this.deviceManager.isSpeakerSelectionAvailable ? this.deviceManager.getSpeakers() : [];\n    });\n  }\n\n  public async askDevicePermission(constrain: PermissionConstraints): Promise<void> {\n    return await this.asyncTeeErrorToEventEmitter(async () => {\n      await this.deviceManager.askDevicePermission(constrain);\n    });\n  }\n\n  public joinCall(microphoneOn?: boolean): Call | undefined {\n    if (_isInCall(this.getState().call?.state ?? 'None')) {\n      throw new Error('You are already in the call!');\n    }\n\n    return this.teeErrorToEventEmitter(() => {\n      const audioOptions: AudioOptions = {\n        muted: !(microphoneOn ?? this.getState().isLocalPreviewMicrophoneEnabled)\n      }; // TODO: find a way to expose stream to here\n\n      const videoOptions = {\n        localVideoStreams: this.localStream ? [this.localStream] : undefined\n      };\n\n      const call = this._joinCall(audioOptions, videoOptions);\n\n      this.processNewCall(call);\n      return call;\n    });\n  }\n\n  private _joinCall(audioOptions: AudioOptions, videoOptions: VideoOptions): Call {\n    const isTeamsMeeting = ('meetingLink' in this.locator);\n\n    if (isTeamsMeeting) {\n      return this.callAgent.join((this.locator as TeamsMeetingLinkLocator), {\n        audioOptions,\n        videoOptions\n      });\n    }\n\n    return this.callAgent.join((this.locator as GroupCallLocator), {\n      audioOptions,\n      videoOptions\n    });\n  }\n\n  public async createStreamView(remoteUserId?: string, options?: VideoStreamOptions): Promise<void | CreateVideoStreamViewResult> {\n    if (remoteUserId === undefined) {\n      return await this.handlers.onCreateLocalStreamView(options);\n    } else {\n      return await this.handlers.onCreateRemoteStreamView(remoteUserId, options);\n    }\n  }\n\n  public async disposeStreamView(remoteUserId?: string): Promise<void> {\n    if (remoteUserId === undefined) {\n      await this.handlers.onDisposeLocalStreamView();\n    } else {\n      await this.handlers.onDisposeRemoteStreamView(remoteUserId);\n    }\n  }\n\n  public async leaveCall(forEveryone?: boolean): Promise<void> {\n    await this.handlers.onHangUp(forEveryone);\n    this.unsubscribeCallEvents();\n    this.handlers = createDefaultCallingHandlers(this.callClient, this.callAgent, this.deviceManager, undefined); // We set the adapter.call object to undefined immediately when a call is ended.\n    // We do not set the context.callId to undefined because it is a part of the immutable data flow loop.\n\n    this.call = undefined;\n    this.stopCamera();\n    this.mute();\n  }\n\n  public async setCamera(device: VideoDeviceInfo, options?: VideoStreamOptions): Promise<void> {\n    return await this.asyncTeeErrorToEventEmitter(async () => {\n      await this.handlers.onSelectCamera(device, options);\n    });\n  }\n\n  public async setMicrophone(device: AudioDeviceInfo): Promise<void> {\n    return await this.asyncTeeErrorToEventEmitter(async () => {\n      await this.handlers.onSelectMicrophone(device);\n    });\n  }\n\n  public async setSpeaker(device: AudioDeviceInfo): Promise<void> {\n    return await this.asyncTeeErrorToEventEmitter(async () => {\n      await this.handlers.onSelectSpeaker(device);\n    });\n  }\n\n  public async startCamera(options?: VideoStreamOptions): Promise<void> {\n    return await this.asyncTeeErrorToEventEmitter(async () => {\n      if (!isCameraOn(this.getState())) {\n        await this.handlers.onToggleCamera(options);\n      }\n    });\n  }\n\n  public async stopCamera(): Promise<void> {\n    return await this.asyncTeeErrorToEventEmitter(async () => {\n      if (isCameraOn(this.getState())) {\n        await this.handlers.onToggleCamera();\n      }\n    });\n  }\n\n  public async mute(): Promise<void> {\n    return await this.asyncTeeErrorToEventEmitter(async () => {\n      this.context.setIsLocalMicrophoneEnabled(false);\n\n      if (_isInCall(this.call?.state) && !this.call?.isMuted) {\n        await this.handlers.onToggleMicrophone();\n      }\n    });\n  }\n\n  public async unmute(): Promise<void> {\n    return await this.asyncTeeErrorToEventEmitter(async () => {\n      this.context.setIsLocalMicrophoneEnabled(true);\n\n      if (_isInCall(this.call?.state) && this.call?.isMuted) {\n        await this.handlers.onToggleMicrophone();\n      }\n    });\n  }\n\n  public async startScreenShare(): Promise<void> {\n    return await this.asyncTeeErrorToEventEmitter(async () => {\n      if (!this.call?.isScreenSharingOn) {\n        await this.handlers.onToggleScreenShare();\n      }\n    });\n  }\n\n  public async stopScreenShare(): Promise<void> {\n    return await this.asyncTeeErrorToEventEmitter(async () => {\n      if (this.call?.isScreenSharingOn) {\n        await this.handlers.onToggleScreenShare();\n      }\n    });\n  }\n\n  public startCall(participants: string[]\n  /* @conditional-compile-remove(PSTN-calls) */\n  | CommunicationIdentifier[], options?: StartCallOptions): Call | undefined {\n    if (_isInCall(this.getState().call?.state ?? 'None')) {\n      throw new Error('You are already in the call.');\n    }\n\n    const idsToAdd = participants.map(participant => {\n      // FIXME: `onStartCall` does not allow a Teams user.\n      // Need some way to return an error if a Teams user is provided.\n      const backendId: CommunicationIdentifier = _toCommunicationIdentifier(participant);\n\n      if (isPhoneNumberIdentifier(backendId)) {\n        if (options?.alternateCallerId === undefined) {\n          throw new Error('Unable to start call, PSTN user present with no alternateCallerId.');\n        }\n\n        return (backendId as PhoneNumberIdentifier);\n      } else if (isCommunicationUserIdentifier(backendId)) {\n        return (backendId as CommunicationUserIdentifier);\n      }\n\n      return (backendId as UnknownIdentifier);\n    });\n    const call = this.handlers.onStartCall(idsToAdd, options);\n\n    if (!call) {\n      throw new Error('Unable to start call.');\n    }\n\n    this.processNewCall(call);\n    return this.call;\n  }\n\n  private processNewCall(call: Call): void {\n    this.call = call;\n    this.context.setCurrentCallId(call.id); // Resync state after callId is set\n\n    this.context.updateClientState(this.callClient.getState());\n    this.handlers = createDefaultCallingHandlers(this.callClient, this.callAgent, this.deviceManager, this.call);\n    this.subscribeCallEvents();\n  }\n\n  public async removeParticipant(userId: string): Promise<void> {\n    let participant = userId;\n    this.handlers.onRemoveParticipant(participant);\n  }\n\n  public getState(): CallAdapterState {\n    return this.context.getState();\n  }\n\n  public onStateChange(handler: (state: CallAdapterState) => void): void {\n    this.context.onStateChange(handler);\n  }\n\n  public offStateChange(handler: (state: CallAdapterState) => void): void {\n    this.context.offStateChange(handler);\n  }\n\n  on(event: 'participantsJoined', listener: ParticipantsJoinedListener): void;\n  on(event: 'participantsLeft', listener: ParticipantsLeftListener): void;\n  on(event: 'isMutedChanged', listener: IsMutedChangedListener): void;\n  on(event: 'callIdChanged', listener: CallIdChangedListener): void;\n  on(event: 'isLocalScreenSharingActiveChanged', listener: IsLocalScreenSharingActiveChangedListener): void;\n  on(event: 'displayNameChanged', listener: DisplayNameChangedListener): void;\n  on(event: 'isSpeakingChanged', listener: IsSpeakingChangedListener): void;\n  on(event: 'callEnded', listener: CallEndedListener): void;\n  on(event: 'diagnosticChanged', listener: DiagnosticChangedEventListner): void;\n  on(event: 'selectedMicrophoneChanged', listener: PropertyChangedEvent): void;\n  on(event: 'selectedSpeakerChanged', listener: PropertyChangedEvent): void;\n  on(event: 'error', errorHandler: (e: AdapterError) => void): void; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n  public on(event: string, listener: (e: any) => void): void {\n    this.emitter.on(event, listener);\n  }\n\n  private subscribeCallEvents(): void {\n    this.call?.on('remoteParticipantsUpdated', this.onRemoteParticipantsUpdated.bind(this));\n    this.call?.on('isMutedChanged', this.isMyMutedChanged.bind(this));\n    this.call?.on('isScreenSharingOnChanged', this.isScreenSharingOnChanged.bind(this));\n    this.call?.on('idChanged', this.callIdChanged.bind(this));\n  }\n\n  private unsubscribeCallEvents(): void {\n    for (const subscriber of this.participantSubscribers.values()) {\n      subscriber.unsubscribeAll();\n    }\n\n    this.participantSubscribers.clear();\n    this.call?.off('remoteParticipantsUpdated', this.onRemoteParticipantsUpdated.bind(this));\n    this.call?.off('isMutedChanged', this.isMyMutedChanged.bind(this));\n    this.call?.off('isScreenSharingOnChanged', this.isScreenSharingOnChanged.bind(this));\n    this.call?.off('idChanged', this.callIdChanged.bind(this));\n  }\n\n  private isMyMutedChanged = (): void => {\n    this.emitter.emit('isMutedChanged', {\n      participantId: this.getState().userId,\n      isMuted: this.call?.isMuted\n    });\n  };\n\n  private onRemoteParticipantsUpdated({\n    added,\n    removed\n  }: {\n    added: RemoteParticipant[];\n    removed: RemoteParticipant[];\n  }): void {\n    if (added && added.length > 0) {\n      this.emitter.emit('participantsJoined', added);\n    }\n\n    if (removed && removed.length > 0) {\n      this.emitter.emit('participantsLeft', removed);\n    }\n\n    added.forEach(participant => {\n      this.participantSubscribers.set(toFlatCommunicationIdentifier(participant.identifier), new ParticipantSubscriber(participant, this.emitter));\n    });\n    removed.forEach(participant => {\n      const subscriber = this.participantSubscribers.get(toFlatCommunicationIdentifier(participant.identifier));\n      subscriber && subscriber.unsubscribeAll();\n      this.participantSubscribers.delete(toFlatCommunicationIdentifier(participant.identifier));\n    });\n  }\n\n  private isScreenSharingOnChanged(): void {\n    this.emitter.emit('isLocalScreenSharingActiveChanged', {\n      isScreenSharingOn: this.call?.isScreenSharingOn\n    });\n  }\n\n  private callIdChanged(): void {\n    this.call?.id && this.emitter.emit('callIdChanged', {\n      callId: this.call.id\n    });\n  }\n\n  private resetDiagnosticsForwarder(newCall?: Call): void {\n    if (this.diagnosticsForwarder) {\n      this.diagnosticsForwarder.unsubscribe();\n    }\n\n    if (newCall) {\n      this.diagnosticsForwarder = new DiagnosticsForwarder(this.emitter, newCall);\n    }\n  }\n\n  off(event: 'participantsJoined', listener: ParticipantsJoinedListener): void;\n  off(event: 'participantsLeft', listener: ParticipantsLeftListener): void;\n  off(event: 'isMutedChanged', listener: IsMutedChangedListener): void;\n  off(event: 'callIdChanged', listener: CallIdChangedListener): void;\n  off(event: 'isLocalScreenSharingActiveChanged', listener: IsLocalScreenSharingActiveChangedListener): void;\n  off(event: 'displayNameChanged', listener: DisplayNameChangedListener): void;\n  off(event: 'isSpeakingChanged', listener: IsSpeakingChangedListener): void;\n  off(event: 'callEnded', listener: CallEndedListener): void;\n  off(event: 'diagnosticChanged', listener: DiagnosticChangedEventListner): void;\n  off(event: 'selectedMicrophoneChanged', listener: PropertyChangedEvent): void;\n  off(event: 'selectedSpeakerChanged', listener: PropertyChangedEvent): void;\n  off(event: 'error', errorHandler: (e: AdapterError) => void): void; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n  public off(event: string, listener: (e: any) => void): void {\n    this.emitter.off(event, listener);\n  }\n\n  private async asyncTeeErrorToEventEmitter<T>(f: () => Promise<T>): Promise<T> {\n    try {\n      return await f();\n    } catch (error) {\n      if (isCallError((error as Error))) {\n        this.emitter.emit('error', (error as AdapterError));\n      }\n\n      throw error;\n    }\n  }\n\n  private teeErrorToEventEmitter<T>(f: () => T): T {\n    try {\n      return f();\n    } catch (error) {\n      if (isCallError((error as Error))) {\n        this.emitter.emit('error', (error as AdapterError));\n      }\n\n      throw error;\n    }\n  }\n\n}\n\n/**\n * Locator used by {@link createAzureCommunicationCallAdapter} to locate the call to join\n *\n * @public\n */\nexport type CallAdapterLocator = TeamsMeetingLinkLocator | GroupCallLocator;\n/**\n * Arguments for creating the Azure Communication Services implementation of {@link CallAdapter}.\n *\n * Note: `displayName` can be a maximum of 256 characters.\n *\n * @public\n */\n\nexport type AzureCommunicationCallAdapterArgs = {\n  userId: CommunicationUserIdentifier;\n  displayName: string;\n  credential: CommunicationTokenCredential;\n  locator: CallAdapterLocator;\n};\n/**\n * Create a {@link CallAdapter} backed by Azure Communication Services.\n *\n * This is the default implementation of {@link CallAdapter} provided by this library.\n *\n * Note: `displayName` can be a maximum of 256 characters.\n *\n * @public\n */\n\nexport const createAzureCommunicationCallAdapter = async ({\n  userId,\n  displayName,\n  credential,\n  locator\n}: AzureCommunicationCallAdapterArgs): Promise<CallAdapter> => {\n  const callClient = createStatefulCallClient({\n    userId\n  });\n  const callAgent = await callClient.createCallAgent(credential, {\n    displayName\n  });\n  const adapter = createAzureCommunicationCallAdapterFromClient(callClient, callAgent, locator);\n  return adapter;\n};\n/**\n * A custom React hook to simplify the creation of {@link CallAdapter}.\n *\n * Similar to {@link createAzureCommunicationCallAdapter}, but takes care of asynchronous\n * creation of the adapter internally.\n *\n * Allows arguments to be undefined so that you can respect the rule-of-hooks and pass in arguments\n * as they are created. The adapter is only created when all arguments are defined.\n *\n * Note that you must memoize the arguments to avoid recreating adapter on each render.\n * See storybook for typical usage examples.\n *\n * @public\n */\n\nexport const useAzureCommunicationCallAdapter = (args: Partial<AzureCommunicationCallAdapterArgs>, afterCreate?: (adapter: CallAdapter) => Promise<CallAdapter>, beforeDispose?: (adapter: CallAdapter) => Promise<void>): CallAdapter | undefined => {\n  const {\n    credential,\n    displayName,\n    locator,\n    userId\n  } = args; // State update needed to rerender the parent component when a new adapter is created.\n\n  const [adapter, setAdapter] = useState<CallAdapter | undefined>(undefined); // Ref needed for cleanup to access the old adapter created asynchronously.\n\n  const adapterRef = useRef<CallAdapter | undefined>(undefined);\n  const afterCreateRef = useRef<((adapter: CallAdapter) => Promise<CallAdapter>) | undefined>(undefined);\n  const beforeDisposeRef = useRef<((adapter: CallAdapter) => Promise<void>) | undefined>(undefined); // These refs are updated on *each* render, so that the latest values\n  // are used in the `useEffect` closures below.\n  // Using a Ref ensures that new values for the callbacks do not trigger the\n  // useEffect blocks, and a new adapter creation / distruction is not triggered.\n\n  afterCreateRef.current = afterCreate;\n  beforeDisposeRef.current = beforeDispose;\n  useEffect(() => {\n    if (!credential || !displayName || !locator || !userId) {\n      return;\n    }\n\n    (async () => {\n      if (adapterRef.current) {\n        // Dispose the old adapter when a new one is created.\n        //\n        // This clean up function uses `adapterRef` because `adapter` can not be added to the dependency array of\n        // this `useEffect` -- we do not want to trigger a new adapter creation because of the first adapter\n        // creation.\n        if (beforeDisposeRef.current) {\n          await beforeDisposeRef.current(adapterRef.current);\n        }\n\n        adapterRef.current.dispose();\n        adapterRef.current = undefined;\n      }\n\n      let newAdapter = await createAzureCommunicationCallAdapter({\n        credential,\n        displayName,\n        locator,\n        userId\n      });\n\n      if (afterCreateRef.current) {\n        newAdapter = await afterCreateRef.current(newAdapter);\n      }\n\n      adapterRef.current = newAdapter;\n      setAdapter(newAdapter);\n    })();\n  }, // Explicitly list all arguments so that caller doesn't have to memoize the `args` object.\n  [adapterRef, afterCreateRef, beforeDisposeRef, credential, displayName, locator, userId]); // Dispose any existing adapter when the component unmounts.\n\n  useEffect(() => {\n    return () => {\n      (async () => {\n        if (adapterRef.current) {\n          if (beforeDisposeRef.current) {\n            await beforeDisposeRef.current(adapterRef.current);\n          }\n\n          adapterRef.current.dispose();\n          adapterRef.current = undefined;\n        }\n      })();\n    };\n  }, []);\n  return adapter;\n};\n/**\n * Create a {@link CallAdapter} using the provided {@link StatefulCallClient}.\n *\n * Useful if you want to keep a reference to {@link StatefulCallClient}.\n * Consider using {@link createAzureCommunicationCallAdapter} for a simpler API.\n *\n * @public\n */\n\nexport const createAzureCommunicationCallAdapterFromClient = async (callClient: StatefulCallClient, callAgent: CallAgent, locator: CallAdapterLocator): Promise<CallAdapter> => {\n  const deviceManager = (await callClient.getDeviceManager() as StatefulDeviceManager);\n  return new AzureCommunicationCallAdapter(callClient, locator, callAgent, deviceManager);\n};\n\nconst isCallError = (e: Error): e is CallError => {\n  return e['target'] !== undefined && e['innerError'] !== undefined;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { useMemo } from 'react';\nimport { ControlBarButton, ControlBarButtonProps, ControlBarButtonStyles, useTheme } from '@internal/react-components';\nimport { concatStyleSets } from '@fluentui/react';\nimport { CallWithChatCompositeIcon } from '../common/icons';\n\nconst icon = (): JSX.Element => <CallWithChatCompositeIcon iconName={'ControlBarPeopleButton'} />;\n/**\n * @private\n */\n\n\nexport const PeopleButton = (props: ControlBarButtonProps): JSX.Element => {\n  const {\n    strings,\n    onRenderOnIcon,\n    onRenderOffIcon,\n    onClick\n  } = props;\n  const theme = useTheme();\n  const styles: ControlBarButtonStyles = useMemo(() => concatStyleSets({\n    rootChecked: {\n      background: theme.palette.neutralLight\n    }\n  }, props.styles ?? {}), [props.styles, theme.palette.neutralLight]);\n  return <ControlBarButton {...props} strings={strings} labelKey={'peopleButtonLabelKey'} onRenderOnIcon={onRenderOnIcon ?? icon} onRenderOffIcon={onRenderOffIcon ?? icon} onClick={onClick} styles={styles} />;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { useLocale } from '../../localization/LocalizationProvider';\nimport { CallWithChatCompositeStrings } from '../Strings';\n/**\n * The hook to bypass limitation of conditional build for CallWithChatComposite\n * Remove this and use useLocale() instead when merge CallWithChatComposite from beta\n *\n * @private\n */\n\nexport const useCallWithChatCompositeStrings = (): CallWithChatCompositeStrings => {\n  const locale = useLocale(); // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n  return ((locale.strings as any).callWithChat as CallWithChatCompositeStrings);\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { useMemo } from 'react';\nimport { ControlBarButton, ControlBarButtonProps, ControlBarButtonStyles, useTheme } from '@internal/react-components';\nimport { concatStyleSets } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const ChatButton = (props: ControlBarButtonProps): JSX.Element => {\n  const strings = {\n    label: props.label,\n    ...props.strings\n  };\n  const theme = useTheme();\n  const styles: ControlBarButtonStyles = useMemo(() => concatStyleSets({\n    rootChecked: {\n      background: theme.palette.neutralLight\n    }\n  }, props.styles ?? {}), [props.styles, theme.palette.neutralLight]);\n  return <ControlBarButton {...props} labelKey={'chatButtonLabelKey'} strings={strings} onClick={props.onClick} styles={styles} />;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React from 'react';\nimport { IIconStyles, IStackStyles, ITheme, memoizeFunction, Stack, useTheme, Text } from '@fluentui/react';\n/**\n * @private\n */\n\nexport type NotificationIconProps = {\n  chatMessagesCount: number;\n  label?: string;\n};\n/**\n * @private\n */\n\nexport const NotificationIcon = (props: NotificationIconProps): JSX.Element => {\n  const {\n    chatMessagesCount,\n    label\n  } = props;\n  const theme = useTheme();\n\n  const renderNumber = (numberOfMessages): JSX.Element => {\n    if (numberOfMessages < 1) {\n      return <></>;\n    } else {\n      const textNumberOfMessages = numberOfMessages < 9 ? numberOfMessages : '9+';\n      return <Text role={'status'} aria-label={textNumberOfMessages + label} styles={notificationTextStyles(theme)}>\n          {textNumberOfMessages}\n        </Text>;\n    }\n  };\n\n  return <Stack data-ui-id=\"call-with-chat-composite-chat-button-unread-icon\" horizontalAlign=\"center\" verticalAlign=\"center\" styles={notificationIconContainerStyles(theme)}>\n      <Stack>{renderNumber(chatMessagesCount)}</Stack>\n    </Stack>;\n};\nconst notificationIconPaddingREM = 0.225;\nconst notificationSizeREM = 1;\nconst notificationIconContainerStyles = memoizeFunction((theme: ITheme): IIconStyles => ({\n  root: {\n    borderRadius: `${notificationSizeREM}rem`,\n    // Create a css circle. This should match the height.\n    height: `${notificationSizeREM}rem`,\n    minWidth: `${notificationSizeREM}rem`,\n    // use min-width over width as we want to extend the width of the notification icon when contents is more than one character (e.g. 9+)\n    background: theme.palette.themePrimary,\n    border: `0.0625rem solid white`,\n    // border should always be white\n    padding: `${notificationIconPaddingREM}rem`,\n    // positioning to place the badge within the button appropriately.\n    position: 'absolute',\n    top: `-${0.5 - notificationIconPaddingREM / 2}rem`,\n    left: `${0.5 + notificationIconPaddingREM / 2}rem`\n  }\n}));\nconst notificationTextStyles = memoizeFunction((theme: ITheme): IStackStyles => ({\n  root: {\n    color: 'white',\n    fontSize: theme.fonts.xSmall.fontSize\n  }\n}));","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { ChatMessage } from '@azure/communication-chat';\nimport { IStackStyles, Stack } from '@fluentui/react';\nimport { _formatString } from '@internal/acs-ui-common';\nimport { ControlBarButtonProps } from '@internal/react-components';\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { useEffect } from 'react';\nimport { ChatAdapter } from '../ChatComposite';\nimport { CallWithChatCompositeIcon } from '../common/icons';\nimport { ChatButton } from './ChatButton';\nimport { useCallWithChatCompositeStrings } from './hooks/useCallWithChatCompositeStrings';\nimport { NotificationIcon } from './NotificationIcon';\n/**\n * @private\n */\n\nexport interface ChatButtonWithUnreadMessagesBadgeProps extends ControlBarButtonProps {\n  chatAdapter: ChatAdapter;\n  isChatPaneVisible: boolean;\n  newMessageLabel?: string;\n}\n/**\n * Helper function to determine if the message in the event is a valid one from a user.\n * Display name is used since system messages will not have one.\n */\n\nconst validNewChatMessage = (message): boolean => !!message.senderDisplayName && (message.type === 'text' || message.type === 'html');\n\nconst filledIcon = <CallWithChatCompositeIcon iconName={'ControlBarChatButtonActive'} />;\nconst regularIcon = <CallWithChatCompositeIcon iconName={'ControlBarChatButtonInactive'} />;\n/**\n * @private\n */\n\nexport const ChatButtonWithUnreadMessagesBadge = (props: ChatButtonWithUnreadMessagesBadgeProps): JSX.Element => {\n  const {\n    chatAdapter,\n    isChatPaneVisible,\n    newMessageLabel\n  } = props;\n  const [unreadChatMessagesCount, setUnreadChatMessagesCount] = useState<number>(0);\n  const baseIcon = props.showLabel ? regularIcon : filledIcon;\n  const callWithChatStrings = useCallWithChatCompositeStrings();\n  const numberOfMsgToolTip = props.strings?.tooltipOffContent && unreadChatMessagesCount > 0 ? _formatString(callWithChatStrings.chatButtonTooltipClosedWithMessageCount, {\n    unreadMessagesCount: `${unreadChatMessagesCount}`\n  }) : undefined;\n  const chatStrings = useMemo(() => ({\n    label: props.strings?.label,\n    tooltipOffContent: numberOfMsgToolTip ? numberOfMsgToolTip : props.strings?.tooltipOffContent,\n    tooltipOnContent: props.strings?.tooltipOnContent\n  }), [numberOfMsgToolTip, props.strings?.label, props.strings?.tooltipOffContent, props.strings?.tooltipOnContent]);\n  const onRenderOnIcon = useCallback(() => baseIcon, [baseIcon]);\n  const notificationOnIcon = useCallback((): JSX.Element => {\n    return <Stack styles={chatNotificationContainerStyles}>\n        {unreadChatMessagesCount > 0 && <NotificationIcon chatMessagesCount={unreadChatMessagesCount} label={newMessageLabel} />}\n        {baseIcon}\n      </Stack>;\n  }, [unreadChatMessagesCount, newMessageLabel, baseIcon]);\n  useEffect(() => {\n    if (isChatPaneVisible) {\n      setUnreadChatMessagesCount(0);\n      return;\n    }\n\n    const incrementUnreadChatMessagesCount = (event: {\n      message: ChatMessage;\n    }): void => {\n      if (!isChatPaneVisible && validNewChatMessage(event.message)) {\n        setUnreadChatMessagesCount(unreadChatMessagesCount + 1);\n      }\n    };\n\n    chatAdapter.on('messageReceived', incrementUnreadChatMessagesCount);\n    return () => {\n      chatAdapter.off('messageReceived', incrementUnreadChatMessagesCount);\n    };\n  }, [chatAdapter, setUnreadChatMessagesCount, isChatPaneVisible, unreadChatMessagesCount]);\n  return <ChatButton {...props} data-ui-id=\"call-with-chat-composite-chat-button\" onRenderOffIcon={notificationOnIcon} onRenderOnIcon={onRenderOnIcon} strings={chatStrings} />;\n};\nconst chatNotificationContainerStyles: IStackStyles = {\n  root: {\n    display: 'inline',\n    position: 'relative'\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React from 'react';\nimport { ControlBarButton, ControlBarButtonProps } from '@internal/react-components';\nimport { MoreHorizontal20Filled } from '@fluentui/react-icons';\n\nconst icon = (): JSX.Element => <MoreHorizontal20Filled key={'chatOnIconKey'} primaryFill=\"currentColor\" />;\n/**\n * @private\n */\n\n\nexport const MoreButton = (props: ControlBarButtonProps): JSX.Element => {\n  return <ControlBarButton {...props} labelKey={'optionsButtonLabelKey'} showLabel={props.showLabel} onRenderOnIcon={icon} onRenderOffIcon={icon} onClick={props.onClick} data-ui-id={'call-with-chat-composite-more-button'} />;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { useMemo } from 'react';\nimport { CallAdapterProvider } from '../CallComposite/adapter/CallAdapterProvider';\nimport { CallAdapter } from '../CallComposite';\nimport { PeopleButton } from './PeopleButton';\nimport { concatStyleSets, IStyle, ITheme, mergeStyles, mergeStyleSets, Stack, useTheme } from '@fluentui/react';\nimport { controlBarContainerStyles } from '../CallComposite/styles/CallControls.styles';\nimport { callControlsContainerStyles } from '../CallComposite/styles/CallPage.styles';\nimport { useCallWithChatCompositeStrings } from './hooks/useCallWithChatCompositeStrings';\nimport { ChatAdapter } from '../ChatComposite';\nimport { ChatButtonWithUnreadMessagesBadge } from './ChatButtonWithUnreadMessagesBadge';\nimport { BaseCustomStyles, ControlBarButtonStyles } from '@internal/react-components';\nimport { ControlBar } from '@internal/react-components';\nimport { Microphone } from '../CallComposite/components/buttons/Microphone';\nimport { Camera } from '../CallComposite/components/buttons/Camera';\nimport { ScreenShare } from '../CallComposite/components/buttons/ScreenShare';\nimport { EndCall } from '../CallComposite/components/buttons/EndCall';\nimport { MoreButton } from '../common/MoreButton';\nimport { CallWithChatControlOptions } from './CallWithChatComposite';\nimport { ContainerRectProps } from '../common/ContainerRectProps';\nimport { isDisabled } from '../CallComposite/utils';\n/**\n * @private\n */\n\nexport interface CallWithChatControlBarProps {\n  callAdapter: CallAdapter;\n  chatButtonChecked: boolean;\n  peopleButtonChecked: boolean;\n  onChatButtonClicked: () => void;\n  onPeopleButtonClicked: () => void;\n  onMoreButtonClicked: () => void;\n  mobileView: boolean;\n  disableButtonsForLobbyPage: boolean;\n  callControls?: boolean | CallWithChatControlOptions;\n  chatAdapter: ChatAdapter;\n  disableButtonsForHoldScreen?: boolean;\n}\n\nconst inferCallWithChatControlOptions = (mobileView: boolean, callWithChatControls?: boolean | CallWithChatControlOptions): CallWithChatControlOptions | false => {\n  if (callWithChatControls === false) {\n    return false;\n  }\n\n  const options = callWithChatControls === true || callWithChatControls === undefined ? {} : callWithChatControls;\n\n  if (mobileView) {\n    // Set to compressed mode when composite is optimized for mobile\n    options.displayType = 'compact'; // Do not show screen share button when composite is optimized for mobile unless the developer\n    // has explicitly opted in.\n\n    if (options.screenShareButton !== true) {\n      options.screenShareButton = false;\n    }\n  }\n\n  return options;\n};\n/**\n * @private\n */\n\n\nexport const CallWithChatControlBar = (props: CallWithChatControlBarProps & ContainerRectProps): JSX.Element => {\n  const theme = useTheme();\n  const callWithChatStrings = useCallWithChatCompositeStrings();\n  const options = inferCallWithChatControlOptions(props.mobileView, props.callControls);\n  const chatButtonStrings = useMemo(() => ({\n    label: callWithChatStrings.chatButtonLabel,\n    tooltipOffContent: callWithChatStrings.chatButtonTooltipOpen,\n    tooltipOnContent: callWithChatStrings.chatButtonTooltipClose\n  }), [callWithChatStrings]);\n  const peopleButtonStrings = useMemo(() => ({\n    label: callWithChatStrings.peopleButtonLabel,\n    tooltipOffContent: callWithChatStrings.peopleButtonTooltipOpen,\n    tooltipOnContent: callWithChatStrings.peopleButtonTooltipClose\n  }), [callWithChatStrings]);\n  const moreButtonStrings = useMemo(() => ({\n    label: callWithChatStrings.moreDrawerButtonLabel,\n    tooltipContent: callWithChatStrings.moreDrawerButtonTooltip\n  }), [callWithChatStrings]);\n  const centerContainerStyles = useMemo(() => {\n    const styles: BaseCustomStyles = !props.mobileView ? desktopControlBarStyles : {};\n    return mergeStyleSets(styles, {\n      root: {\n        // Enforce a background color on control bar to ensure it matches the composite background color.\n        background: theme.semanticColors.bodyBackground\n      }\n    });\n  }, [props.mobileView, theme.semanticColors.bodyBackground]);\n  const screenShareButtonStyles = useMemo(() => !props.mobileView ? getDesktopScreenShareButtonStyles(theme) : undefined, [props.mobileView, theme]);\n  const commonButtonStyles = useMemo(() => !props.mobileView ? getDesktopCommonButtonStyles(theme) : undefined, [props.mobileView, theme]);\n  const endCallButtonStyles = useMemo(() => !props.mobileView ? getDesktopEndCallButtonStyles(theme) : undefined, [props.mobileView, theme]);\n\n  // when options is false then we want to hide the whole control bar.\n  if (options === false) {\n    return <></>;\n  }\n\n  const chatButton = <ChatButtonWithUnreadMessagesBadge chatAdapter={props.chatAdapter} checked={props.chatButtonChecked} showLabel={options.displayType !== 'compact'} isChatPaneVisible={props.chatButtonChecked} onClick={props.onChatButtonClicked} disabled={props.disableButtonsForLobbyPage || isDisabled(options.chatButton)} strings={chatButtonStrings} styles={commonButtonStyles} newMessageLabel={callWithChatStrings.chatButtonNewMessageNotificationLabel} />;\n  return <Stack horizontal className={mergeStyles(callControlsContainerStyles, controlBarContainerStyles)}>\n      <Stack.Item grow>\n        <CallAdapterProvider adapter={props.callAdapter}>\n          <Stack horizontalAlign=\"center\">\n            <Stack.Item>\n              {\n              /*\n                 Note: We use the layout=\"horizontal\" instead of dockedBottom because of how we position the\n                 control bar. The control bar exists in a Stack below the MediaGallery. The MediaGallery is\n                 set to grow and fill the remaining space not taken up by the ControlBar. If we were to use\n                 dockedBottom it has position absolute and would therefore float on top of the media gallery,\n                 occluding some of its content.\n               */\n            }\n              <ControlBar layout=\"horizontal\" styles={centerContainerStyles}>\n                {isEnabled(options.microphoneButton) && <Microphone displayType={options.displayType} styles={commonButtonStyles} splitButtonsForDeviceSelection={!props.mobileView} />}\n                {isEnabled(options.cameraButton) && <Camera displayType={options.displayType} styles={commonButtonStyles} splitButtonsForDeviceSelection={!props.mobileView} />}\n                {props.mobileView && isEnabled(options?.chatButton) && chatButton}\n                {isEnabled(options.screenShareButton) && <ScreenShare option={options.screenShareButton} displayType={options.displayType} styles={screenShareButtonStyles} />}\n                {}\n                {props.mobileView && <MoreButton data-ui-id=\"call-with-chat-composite-more-button\" strings={moreButtonStrings} onClick={props.onMoreButtonClicked} disabled={props.disableButtonsForLobbyPage} />}\n                {}\n                <EndCall displayType=\"compact\" styles={endCallButtonStyles} />\n              </ControlBar>\n            </Stack.Item>\n          </Stack>\n        </CallAdapterProvider>\n      </Stack.Item>\n      {!props.mobileView && <Stack horizontal className={!props.mobileView ? mergeStyles(desktopButtonContainerStyle) : undefined}>\n          {}\n          {isEnabled(options?.peopleButton) && <PeopleButton checked={props.peopleButtonChecked} showLabel={options.displayType !== 'compact'} onClick={props.onPeopleButtonClicked} data-ui-id=\"call-with-chat-composite-people-button\" disabled={props.disableButtonsForLobbyPage || isDisabled(options.peopleButton)} strings={peopleButtonStrings} styles={commonButtonStyles} />}\n          {isEnabled(options?.chatButton) && chatButton}\n        </Stack>}\n    </Stack>;\n};\nconst desktopButtonContainerStyle: IStyle = {\n  padding: '0.75rem',\n  columnGap: '0.5rem'\n};\nconst desktopControlBarStyles: BaseCustomStyles = {\n  root: desktopButtonContainerStyle\n};\n\nconst getDesktopCommonButtonStyles = (theme: ITheme): ControlBarButtonStyles => ({\n  root: {\n    border: `solid 1px ${theme.palette.neutralQuaternaryAlt}`,\n    borderRadius: theme.effects.roundedCorner4,\n    minHeight: '2.5rem',\n    maxWidth: '12rem' // allot extra space than the regular ControlBarButton. This is to give extra room to have the icon beside the text.\n\n  },\n  flexContainer: {\n    display: 'flex',\n    flexFlow: 'row nowrap'\n  },\n  textContainer: {\n    // Override the default so that label doesn't introduce a new block.\n    display: 'inline',\n    // Ensure width is set to permit child to show ellipsis when there is a label that is too long\n    maxWidth: '100%'\n  },\n  label: {\n    fontSize: theme.fonts.medium.fontSize,\n    // Ensure there is enough space between the icon and text to allow for the unread messages badge in the chat button\n    marginLeft: '0.625rem',\n    // Ensure letters that go above and below the standard text line like 'g', 'y', 'j' are not clipped\n    lineHeight: '1.5rem',\n    // Do not allow very long button texts to ruin the control bar experience, instead ensure long text is truncated and shows ellipsis\n    display: 'block',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden'\n  },\n  splitButtonMenuButton: {\n    border: `solid 1px ${theme.palette.neutralQuaternaryAlt}`,\n    borderTopRightRadius: theme.effects.roundedCorner4,\n    borderBottomRightRadius: theme.effects.roundedCorner4,\n    borderTopLeftRadius: '0',\n    borderBottomLeftRadius: '0'\n  },\n  splitButtonMenuButtonChecked: {\n    // Default colors the menu half similarly for :hover and when button is checked.\n    // To align with how the left-half is styled, override the checked style.\n    background: 'none'\n  }\n});\n\nconst getDesktopScreenShareButtonStyles = (theme: ITheme): ControlBarButtonStyles => {\n  const overrideStyles = {\n    border: 'none',\n    background: theme.palette.themePrimary,\n    color: theme.palette.white,\n    '* > svg': {\n      fill: theme.palette.white\n    }\n  };\n  const overrides: ControlBarButtonStyles = {\n    rootChecked: overrideStyles,\n    rootCheckedHovered: overrideStyles\n  };\n  return concatStyleSets(getDesktopCommonButtonStyles(theme), overrides);\n};\n\nconst getDesktopEndCallButtonStyles = (theme: ITheme): ControlBarButtonStyles => {\n  const overrides: ControlBarButtonStyles = {\n    root: {\n      // Suppress border around the dark-red button.\n      border: 'none'\n    }\n  };\n  return concatStyleSets(getDesktopCommonButtonStyles(theme), overrides);\n};\n\nconst isEnabled = (option: unknown): boolean => option !== false;","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IStackStyles } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const compositeOuterContainerStyles: IStackStyles = {\n  root: {\n    width: '100%',\n    // Create a new stacking context so that DrawerMenu can be positioned absolutely.\n    position: 'relative'\n  }\n};\n/** @private */\n\nexport const callCompositeContainerStyles: IStackStyles = {\n  root: {\n    // Start a new stacking context so that any `position:absolute` elements\n    // inside the call composite do not compete with its siblings.\n    position: 'relative'\n  }\n};\n/** @private */\n\nexport const controlBarContainerStyles: IStackStyles = {\n  root: {\n    // Start a new stacking context so that any `position:absolute` elements\n    // inside the control bar do not compete with its siblings.\n    position: 'relative'\n  }\n};\n/** @private */\n\nexport const drawerContainerStyles: IStackStyles = {\n  root: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n    // Any zIndex > 0 will work because this is the only absolutely\n    // positioned element in the container.\n    zIndex: 1\n  }\n};\n/**\n * Chat button might have a optional notification icon attached that must be positioned absolute inside the chat button.\n * this requires the parent to have `position relative`\n * @private\n */\n\nexport const ChatButtonContainerStyles: IStackStyles = {\n  root: {\n    position: 'relative'\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CallWithChatAdapter } from './CallWithChatAdapter';\nimport { CallAdapter, CallAdapterState } from '../../CallComposite';\nimport { CreateVideoStreamViewResult, VideoStreamOptions } from '@internal/react-components';\nimport { AudioDeviceInfo, VideoDeviceInfo, Call, PermissionConstraints, StartCallOptions } from '@azure/communication-calling';\nimport { CallWithChatAdapterState } from '../state/CallWithChatAdapterState';\nimport { _toCommunicationIdentifier } from '@internal/acs-ui-common';\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\n\n/**\n * Facade around the CallWithChatAdapter to satisfy the call adapter interface.\n *\n * @private\n */\n\nexport class CallWithChatBackedCallAdapter implements CallAdapter {\n  private callWithChatAdapter: CallWithChatAdapter; // For onStateChange we must convert CallWithChat state to chat state. This involves creating a new handler to be passed into the onStateChange.\n  // In order to unsubscribe the handler when offStateChange is called we must have a mapping of the original handler to the newly created handler.\n\n  private eventStore: Map<(state: CallAdapterState) => void, (state: CallWithChatAdapterState) => void> = new Map();\n\n  constructor(callWithChatAdapter: CallWithChatAdapter) {\n    this.callWithChatAdapter = callWithChatAdapter;\n  }\n\n  public on = (event: any, listener: any): void => {\n    switch (event) {\n      case 'error':\n        return this.callWithChatAdapter.on('callError', listener);\n\n      case 'participantsJoined':\n        return this.callWithChatAdapter.on('callParticipantsJoined', listener);\n\n      case 'participantsLeft':\n        return this.callWithChatAdapter.on('callParticipantsLeft', listener);\n\n      default:\n        return this.callWithChatAdapter.on(event, listener);\n    }\n  };\n  public off = (event: any, listener: any): void => {\n    switch (event) {\n      case 'error':\n        return this.callWithChatAdapter.off('callError', listener);\n\n      case 'participantsJoined':\n        return this.callWithChatAdapter.off('callParticipantsJoined', listener);\n\n      case 'participantsLeft':\n        return this.callWithChatAdapter.off('callParticipantsLeft', listener);\n\n      default:\n        return this.callWithChatAdapter.off(event, listener);\n    }\n  };\n  public onStateChange = (handler: (state: CallAdapterState) => void): void => {\n    const convertedHandler = (state: CallWithChatAdapterState): void => {\n      handler(callAdapterStateFromCallWithChatAdapterState(state));\n    };\n\n    this.callWithChatAdapter.onStateChange(convertedHandler);\n    this.eventStore.set(handler, convertedHandler);\n  };\n  public offStateChange = (handler: (state: CallAdapterState) => void): void => {\n    const convertedHandler = this.eventStore.get(handler);\n    convertedHandler && this.callWithChatAdapter.offStateChange(convertedHandler);\n  };\n  public getState = (): CallAdapterState => callAdapterStateFromCallWithChatAdapterState(this.callWithChatAdapter.getState());\n  public dispose = (): void => this.callWithChatAdapter.dispose();\n  public joinCall = (microphoneOn?: boolean): Call | undefined => {\n    return this.callWithChatAdapter.joinCall(microphoneOn);\n  };\n  public leaveCall = async (forEveryone?: boolean): Promise<void> => await this.callWithChatAdapter.leaveCall(forEveryone);\n  public startCall = (participants: string[], options: StartCallOptions): Call | undefined => {\n    let communicationParticipants = participants;\n    return this.callWithChatAdapter.startCall(communicationParticipants, options);\n  };\n  public setCamera = async (sourceId: VideoDeviceInfo, options?: VideoStreamOptions): Promise<void> => await this.callWithChatAdapter.setCamera(sourceId, options);\n  public setMicrophone = async (sourceId: AudioDeviceInfo): Promise<void> => await this.callWithChatAdapter.setMicrophone(sourceId);\n  public setSpeaker = async (sourceId: AudioDeviceInfo): Promise<void> => await this.callWithChatAdapter.setSpeaker(sourceId);\n  public askDevicePermission = async (constraints: PermissionConstraints): Promise<void> => await this.callWithChatAdapter.askDevicePermission(constraints);\n  public queryCameras = async (): Promise<VideoDeviceInfo[]> => await this.callWithChatAdapter.queryCameras();\n  public queryMicrophones = async (): Promise<AudioDeviceInfo[]> => await this.callWithChatAdapter.queryMicrophones();\n  public querySpeakers = async (): Promise<AudioDeviceInfo[]> => await this.callWithChatAdapter.querySpeakers();\n  public startCamera = async (options?: VideoStreamOptions): Promise<void> => await this.callWithChatAdapter.startCamera(options);\n  public stopCamera = async (): Promise<void> => await this.callWithChatAdapter.stopCamera();\n  public mute = async (): Promise<void> => await this.callWithChatAdapter.mute();\n  public unmute = async (): Promise<void> => await this.callWithChatAdapter.unmute();\n  public startScreenShare = async (): Promise<void> => await this.callWithChatAdapter.startScreenShare();\n  public stopScreenShare = async (): Promise<void> => await this.callWithChatAdapter.stopScreenShare();\n  public removeParticipant = async (userId: string): Promise<void> => {\n    let participant = userId;\n    await this.callWithChatAdapter.removeParticipant(participant);\n  };\n  public createStreamView = async (remoteUserId?: string, options?: VideoStreamOptions): Promise<void | CreateVideoStreamViewResult> => await this.callWithChatAdapter.createStreamView(remoteUserId, options);\n  public disposeStreamView = async (remoteUserId?: string, options?: VideoStreamOptions): Promise<void> => await this.callWithChatAdapter.disposeStreamView(remoteUserId, options);\n}\n\nfunction callAdapterStateFromCallWithChatAdapterState(callWithChatAdapterState: CallWithChatAdapterState): CallAdapterState {\n  return {\n    isLocalPreviewMicrophoneEnabled: callWithChatAdapterState.isLocalPreviewMicrophoneEnabled,\n    page: callWithChatAdapterState.page,\n    userId: callWithChatAdapterState.userId,\n    displayName: callWithChatAdapterState.displayName,\n    call: callWithChatAdapterState.call,\n    devices: callWithChatAdapterState.devices,\n    isTeamsCall: callWithChatAdapterState.isTeamsCall,\n    latestErrors: callWithChatAdapterState.latestCallErrors\n  };\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CallWithChatAdapter } from './CallWithChatAdapter';\nimport { ChatAdapter, ChatAdapterState } from '../../ChatComposite';\nimport { ErrorBarStrings } from '@internal/react-components';\nimport { CallWithChatAdapterState } from '../state/CallWithChatAdapterState';\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\n\n/**\n * Facade around the CallWithChatAdapter to satisfy the chat adapter interface.\n *\n * @private\n */\n\nexport class CallWithChatBackedChatAdapter implements ChatAdapter {\n  private callWithChatAdapter: CallWithChatAdapter; // For onStateChange we must convert CallWithChat state to chat state. This involves creating a new handler to be passed into the onStateChange.\n  // In order to unsubscribe the handler when offStateChange is called we must have a mapping of the original handler to the newly created handler.\n\n  private eventStore: Map<(state: ChatAdapterState) => void, (state: CallWithChatAdapterState) => void> = new Map();\n\n  constructor(callWithChatAdapter: CallWithChatAdapter) {\n    this.callWithChatAdapter = callWithChatAdapter;\n  }\n\n  public fetchInitialData = async (): Promise<void> => await this.callWithChatAdapter.fetchInitialData();\n  public sendMessage = async (content: string): Promise<void> => await this.callWithChatAdapter.sendMessage(content);\n  public sendReadReceipt = async (chatMessageId: string): Promise<void> => await this.callWithChatAdapter.sendReadReceipt(chatMessageId);\n  public sendTypingIndicator = async (): Promise<void> => await this.callWithChatAdapter.sendTypingIndicator();\n  public removeParticipant = async (userId: string): Promise<void> => await this.callWithChatAdapter.removeParticipant(userId);\n  public loadPreviousChatMessages = async (messagesToLoad: number): Promise<boolean> => await this.callWithChatAdapter.loadPreviousChatMessages(messagesToLoad);\n  public dispose = (): void => this.callWithChatAdapter.dispose();\n  public onStateChange = (handler: (state: ChatAdapterState) => void): void => {\n    const convertedHandler = (state: CallWithChatAdapterState): void => {\n      handler(chatAdapterStateFromCallWithChatAdapterState(state));\n    };\n\n    this.callWithChatAdapter.onStateChange(convertedHandler);\n    this.eventStore.set(handler, convertedHandler);\n  };\n  public offStateChange = (handler: (state: ChatAdapterState) => void): void => {\n    const convertedHandler = this.eventStore.get(handler);\n    convertedHandler && this.callWithChatAdapter.offStateChange(convertedHandler);\n  };\n  public getState = (): ChatAdapterState => chatAdapterStateFromCallWithChatAdapterState(this.callWithChatAdapter.getState());\n  /* eslint-disable @typescript-eslint/explicit-module-boundary-types */\n\n  public on = (event: any, listener: any): void => {\n    switch (event) {\n      case 'error':\n        return this.callWithChatAdapter.on('chatError', listener);\n\n      case 'participantsAdded':\n        return this.callWithChatAdapter.on('chatParticipantsAdded', listener);\n\n      case 'participantsRemoved':\n        return this.callWithChatAdapter.on('chatParticipantsRemoved', listener);\n\n      default:\n        return this.callWithChatAdapter.on(event, listener);\n    }\n  };\n  public off = (event: any, listener: any): void => {\n    switch (event) {\n      case 'error':\n        return this.callWithChatAdapter.off('chatError', listener);\n\n      case 'participantsAdded':\n        return this.callWithChatAdapter.off('chatParticipantsAdded', listener);\n\n      case 'participantsRemoved':\n        return this.callWithChatAdapter.off('chatParticipantsRemoved', listener);\n\n      default:\n        return this.callWithChatAdapter.off(event, listener);\n    }\n  };\n  public updateMessage = async (messageId: string, content: string, metadata?: Record<string, string>): Promise<void> => await this.callWithChatAdapter.updateMessage(messageId, content, metadata);\n  public deleteMessage = async (messageId: string): Promise<void> => await this.callWithChatAdapter.deleteMessage(messageId);\n  public clearErrors = (errorTypes: (keyof ErrorBarStrings)[]): void => {\n    throw new Error(`Method not supported in CallWithChatComposite.`);\n  };\n  public setTopic = async (topicName: string): Promise<void> => {\n    throw new Error(`Chat Topics are not supported in CallWithChatComposite.`);\n  };\n}\n\nfunction chatAdapterStateFromCallWithChatAdapterState(callWithChatAdapterState: CallWithChatAdapterState): ChatAdapterState {\n  if (!callWithChatAdapterState.chat) {\n    throw new Error('Chat thread state id undefined.');\n  }\n\n  return {\n    userId: callWithChatAdapterState.userId,\n    displayName: callWithChatAdapterState.displayName || '',\n    thread: callWithChatAdapterState.chat,\n    latestErrors: callWithChatAdapterState.latestChatErrors\n  };\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { useCallback } from 'react';\nimport { OptionsDevice, _DrawerMenu as DrawerMenu, _DrawerMenuItemProps as DrawerMenuItemProps, _DrawerMenuItemProps } from '@internal/react-components';\nimport { AudioDeviceInfo } from '@azure/communication-calling';\nimport { CallWithChatControlOptions } from '../CallWithChatComposite';\nimport { isDisabled } from '../../CallComposite/utils';\n/** @private */\n\nexport interface MoreDrawerStrings {\n  /**\n   * Label for people drawerMenuItem.\n   */\n  peopleButtonLabel: string;\n  /**\n   * Label for audio device drawerMenuItem.\n   *\n   * @remarks This replaces the microphoneMenuTitle speakers can not be enumerated\n   *\n   */\n\n  audioDeviceMenuTitle?: string;\n  /**\n   * Label for microphone drawerMenuItem.\n   *\n   * @remarks Only displayed when speakers can be enumerated otherwise audioDeviceMenuTitle is used\n   *\n   */\n\n  microphoneMenuTitle: string;\n  /**\n   * Label for speaker drawerMenuItem.\n   *\n   * @remarks Only displayed when speakers can be enumerated\n   *\n   */\n\n  speakerMenuTitle: string;\n}\n/** @private */\n\nexport interface MoreDrawerDevicesMenuProps {\n  /**\n   * Available microphones for selection\n   */\n  microphones?: OptionsDevice[];\n  /**\n   * Available speakers for selection\n   */\n\n  speakers?: OptionsDevice[];\n  /**\n   * Microphone that is shown as currently selected\n   */\n\n  selectedMicrophone?: OptionsDevice;\n  /**\n   * Speaker that is shown as currently selected\n   */\n\n  selectedSpeaker?: OptionsDevice;\n  /**\n   * Speaker when a speaker is selected\n   */\n\n  onSelectSpeaker: (device: AudioDeviceInfo) => Promise<void>;\n  /**\n   * Callback when a microphone is selected\n   */\n\n  onSelectMicrophone: (device: AudioDeviceInfo) => Promise<void>;\n}\n/** @private */\n\nexport interface MoreDrawerProps extends MoreDrawerDevicesMenuProps {\n  onLightDismiss: () => void;\n  onPeopleButtonClicked: () => void;\n  callControls?: boolean | CallWithChatControlOptions;\n  onClickShowDialpad?: () => void;\n  strings: MoreDrawerStrings;\n  disableButtonsForHoldScreen?: boolean;\n}\n\nconst inferCallWithChatControlOptions = (callWithChatControls?: boolean | CallWithChatControlOptions): CallWithChatControlOptions | false => {\n  if (callWithChatControls === false) {\n    return false;\n  }\n\n  const options = callWithChatControls === true || callWithChatControls === undefined ? {} : callWithChatControls;\n  return options;\n};\n/** @private */\n\n\nexport const MoreDrawer = (props: MoreDrawerProps): JSX.Element => {\n  const drawerMenuItems: DrawerMenuItemProps[] = [];\n  const {\n    speakers,\n    onSelectSpeaker,\n    onLightDismiss\n  } = props;\n  const onSpeakerItemClick = useCallback((_ev, itemKey) => {\n    const selected = speakers?.find(speaker => speaker.id === itemKey);\n\n    if (selected) {\n      // This is unsafe - we're only passing in part of the argument to the handler.\n      // But this is a known issue in our state.\n      onSelectSpeaker((selected as AudioDeviceInfo));\n    }\n\n    onLightDismiss();\n  }, [speakers, onSelectSpeaker, onLightDismiss]);\n  const drawerSelectionOptions = inferCallWithChatControlOptions(props.callControls);\n\n  if (props.speakers && props.speakers.length > 0) {\n    drawerMenuItems.push({\n      itemKey: 'speakers',\n      disabled: props.disableButtonsForHoldScreen,\n      text: props.strings.speakerMenuTitle,\n      iconProps: {\n        iconName: 'MoreDrawerSpeakers'\n      },\n      subMenuProps: props.speakers.map(speaker => ({\n        itemKey: speaker.id,\n        iconProps: {\n          iconName: isDeviceSelected(speaker, props.selectedSpeaker) ? 'MoreDrawerSelectedSpeaker' : 'MoreDrawerSpeakers'\n        },\n        text: speaker.name,\n        onItemClick: onSpeakerItemClick,\n        secondaryIconProps: isDeviceSelected(speaker, props.selectedSpeaker) ? {\n          iconName: 'Accept'\n        } : undefined\n      })),\n      secondaryText: props.selectedSpeaker?.name\n    });\n  }\n\n  const {\n    microphones,\n    onSelectMicrophone\n  } = props;\n  const onMicrophoneItemClick = useCallback((_ev, itemKey) => {\n    const selected = microphones?.find(mic => mic.id === itemKey);\n\n    if (selected) {\n      // This is unsafe - we're only passing in part of the argument to the handler.\n      // But this is a known issue in our state.\n      onSelectMicrophone((selected as AudioDeviceInfo));\n    }\n\n    onLightDismiss();\n  }, [microphones, onSelectMicrophone, onLightDismiss]);\n\n  if (props.microphones && props.microphones.length > 0) {\n    // Set props as Microphone if speakers can be enumerated else set as Audio Device\n    const speakersAvailable = props.speakers && props.speakers.length > 0;\n    const itemKey = speakersAvailable ? 'microphones' : 'audioDevices';\n    const text = speakersAvailable ? props.strings.microphoneMenuTitle : props.strings.audioDeviceMenuTitle;\n    const iconName = speakersAvailable ? 'MoreDrawerMicrophones' : 'MoreDrawerSpeakers';\n    const selectedIconName = speakersAvailable ? 'MoreDrawerSelectedMicrophone' : 'MoreDrawerSelectedSpeaker';\n    drawerMenuItems.push({\n      itemKey: itemKey,\n      disabled: props.disableButtonsForHoldScreen,\n      text: text,\n      iconProps: {\n        iconName: iconName\n      },\n      subMenuProps: props.microphones.map(mic => ({\n        itemKey: mic.id,\n        iconProps: {\n          iconName: isDeviceSelected(mic, props.selectedMicrophone) ? selectedIconName : iconName\n        },\n        text: mic.name,\n        onItemClick: onMicrophoneItemClick,\n        secondaryIconProps: isDeviceSelected(mic, props.selectedMicrophone) ? {\n          iconName: 'Accept'\n        } : undefined,\n        disabled: drawerSelectionOptions !== false ? isDisabled(drawerSelectionOptions.microphoneButton) : undefined\n      })),\n      secondaryText: props.selectedMicrophone?.name\n    });\n  }\n\n  if (drawerSelectionOptions !== false && isEnabled(drawerSelectionOptions?.peopleButton)) {\n    drawerMenuItems.push({\n      itemKey: 'people',\n      text: props.strings.peopleButtonLabel,\n      iconProps: {\n        iconName: 'MoreDrawerPeople'\n      },\n      onItemClick: props.onPeopleButtonClicked,\n      disabled: drawerSelectionOptions !== false ? isDisabled(drawerSelectionOptions.peopleButton) : undefined\n    });\n  }\n\n  return <DrawerMenu items={drawerMenuItems} onLightDismiss={props.onLightDismiss} />;\n};\n\nconst isDeviceSelected = (speaker: OptionsDevice, selectedSpeaker?: OptionsDevice): boolean => !!selectedSpeaker && speaker.id === selectedSpeaker.id;\n\nconst isEnabled = (option: unknown): boolean => option !== false;","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CallingBaseSelectorProps } from '@internal/calling-component-bindings';\nimport { OptionsDevice } from '@internal/react-components';\nimport * as reselect from 'reselect';\nimport { CallAdapterState } from '../../CallComposite/adapter/CallAdapter';\nimport { getDeviceManager } from '../../CallComposite/selectors/baseSelectors';\n/** @private */\n\nexport type MoreDrawerSelector = (state: CallAdapterState, props: CallingBaseSelectorProps) => {\n  microphones?: OptionsDevice[];\n  speakers?: OptionsDevice[];\n  selectedMicrophone?: OptionsDevice;\n  selectedSpeaker?: OptionsDevice;\n};\n/**\n * @private\n */\n\nexport const moreDrawerSelector: MoreDrawerSelector = reselect.createSelector([getDeviceManager], deviceManager => {\n  return {\n    microphones: deviceManager.microphones,\n    speakers: deviceManager.speakers,\n    selectedMicrophone: deviceManager.selectedMicrophone,\n    selectedSpeaker: deviceManager.selectedSpeaker\n  };\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { useMemo } from 'react';\nimport { useCallWithChatCompositeStrings } from './hooks/useCallWithChatCompositeStrings';\nimport { MoreDrawer, MoreDrawerStrings } from './components/MoreDrawer';\nimport { moreDrawerSelector } from './selectors/moreDrawerSelector';\nimport { useSelector } from '../CallComposite/hooks/useSelector';\nimport { useHandlers } from '../CallComposite/hooks/useHandlers';\nimport { CallWithChatControlOptions } from './CallWithChatComposite';\n/** @private */\n\nexport interface PreparedMoreDrawerProps {\n  onLightDismiss: () => void;\n  onPeopleButtonClicked: () => void;\n  callControls?: boolean | CallWithChatControlOptions;\n  disableButtonsForHoldScreen?: boolean;\n}\n/** @private */\n\nexport const PreparedMoreDrawer = (props: PreparedMoreDrawerProps): JSX.Element => {\n  const strings = useCallWithChatCompositeStrings();\n  const moreDrawerStrings: MoreDrawerStrings = useMemo(() => ({\n    peopleButtonLabel: strings.peopleButtonLabel,\n    audioDeviceMenuTitle: strings.moreDrawerAudioDeviceMenuTitle,\n    microphoneMenuTitle: strings.moreDrawerMicrophoneMenuTitle,\n    speakerMenuTitle: strings.moreDrawerSpeakerMenuTitle\n  }), [strings]);\n  const deviceProps = useSelector(moreDrawerSelector);\n  const callHandlers = useHandlers(MoreDrawer);\n  return <MoreDrawer {...props} {...deviceProps} {...callHandlers} strings={moreDrawerStrings} />;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CommandBarButton, Stack } from '@fluentui/react';\nimport { useTheme } from '@internal/react-components';\nimport React, { useMemo } from 'react';\nimport { CallWithChatCompositeStrings } from '../CallWithChatComposite';\nimport { sidePaneHeaderContainerStyles, sidePaneHeaderStyles } from '../common/styles/ParticipantContainer.styles';\n/**\n * @private\n */\n\nexport const SidePaneHeader = (props: {\n  headingText: string;\n  onClose: () => void;\n  strings: CallWithChatCompositeStrings;\n}): JSX.Element => {\n  const theme = useTheme();\n  const sidePaneCloseButtonStyles = useMemo(() => ({\n    root: {\n      minWidth: '1.5rem',\n      padding: 0,\n      backgroundColor: theme.semanticColors.bodyBackground\n    },\n    icon: {\n      color: theme.palette.neutralSecondary\n    },\n    iconHovered: {\n      color: theme.palette.neutralSecondary\n    },\n    iconPressed: {\n      color: theme.palette.neutralSecondary\n    }\n  }), [theme.palette.neutralSecondary, theme.semanticColors.bodyBackground]);\n  return <Stack horizontal horizontalAlign=\"space-between\" styles={sidePaneHeaderContainerStyles}>\n      <Stack.Item styles={sidePaneHeaderStyles}>{props.headingText}</Stack.Item>\n      <CommandBarButton ariaLabel={props.strings.dismissSidePaneButtonLabel} styles={sidePaneCloseButtonStyles} iconProps={{\n      iconName: 'cancel'\n    }} onClick={props.onClose} />\n    </Stack>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { useMemo } from 'react';\nimport { CreateVideoStreamViewResult, VideoGalleryStream, VideoStreamOptions, _LocalVideoTile, _RemoteVideoTile, _PictureInPictureInPicture, _PictureInPictureInPictureTileProps } from '@internal/react-components';\nimport { useLocale } from '../../localization';\n/**\n * @private\n */\n\nexport interface LocalAndRemotePIPProps {\n  localParticipant: {\n    displayName?: string;\n    videoStream?: VideoGalleryStream;\n  };\n  dominantRemoteParticipant?: {\n    userId: string;\n    displayName?: string;\n    videoStream?: VideoGalleryStream;\n  };\n  /** Callback to create the local video stream view */\n\n  onCreateLocalStreamView?: (options?: VideoStreamOptions) => Promise<void | CreateVideoStreamViewResult>;\n  /** Callback to dispose of the local video stream view */\n\n  onDisposeLocalStreamView?: () => void;\n  /** Callback to create a remote video stream view */\n\n  onCreateRemoteStreamView?: (userId: string, options?: VideoStreamOptions) => Promise<void | CreateVideoStreamViewResult>;\n  /** Callback to dispose a remote video stream view */\n\n  onDisposeRemoteStreamView?: (userId: string) => Promise<void>;\n  onClick?: () => void;\n}\n/**\n * @private\n */\n\nexport const LocalAndRemotePIP = (props: LocalAndRemotePIPProps): JSX.Element => {\n  const {\n    localParticipant,\n    dominantRemoteParticipant,\n    onCreateLocalStreamView,\n    onDisposeLocalStreamView,\n    onCreateRemoteStreamView,\n    onDisposeRemoteStreamView\n  } = props;\n  const localVideoTileProps = useMemo(() => ({\n    onCreateLocalStreamView,\n    onDisposeLocalStreamView,\n    localVideoViewOptions,\n    displayName: localParticipant.displayName,\n    showLabel: false,\n    showMuteIndicator: false,\n    showCameraSwitcherInLocalPreview: false,\n    isAvailable: localParticipant.videoStream?.isAvailable,\n    renderElement: localParticipant.videoStream?.renderElement\n  }), [localParticipant.displayName, localParticipant.videoStream?.isAvailable, localParticipant.videoStream?.renderElement, onCreateLocalStreamView, onDisposeLocalStreamView]);\n  const remoteVideoTileProps = useMemo(() => !dominantRemoteParticipant ? undefined : {\n    onCreateRemoteStreamView,\n    onDisposeRemoteStreamView,\n    remoteVideoViewOptions,\n    displayName: dominantRemoteParticipant?.displayName,\n    showLabel: false,\n    showMuteIndicator: false,\n    isAvailable: dominantRemoteParticipant.videoStream?.isAvailable,\n    isReceiving: dominantRemoteParticipant.videoStream?.isReceiving,\n    renderElement: dominantRemoteParticipant.videoStream?.renderElement,\n    userId: dominantRemoteParticipant.userId,\n    key: dominantRemoteParticipant.userId\n  }, [dominantRemoteParticipant, onCreateRemoteStreamView, onDisposeRemoteStreamView]);\n  const locale = useLocale();\n  const ariaLabel = locale.strings.callWithChat.pictureInPictureTileAriaLabel;\n  const strings = useMemo(() => ({\n    rootAriaLabel: ariaLabel\n  }), [ariaLabel]); // If there are no remote participants, show the local participant as the primary tile\n\n  const primaryTileProps: _PictureInPictureInPictureTileProps = useMemo(() => ({\n    children: remoteVideoTileProps ? <_RemoteVideoTile {...remoteVideoTileProps} /> : <_LocalVideoTile {...localVideoTileProps} />,\n    // TODO: when the calling SDK provides height/width stream information - update this to reflect the stream orientation.\n    orientation: 'portrait'\n  }), [localVideoTileProps, remoteVideoTileProps]); // If we are showing the local participant as the primary tile, show nothing for the secondary tile\n\n  const secondaryTileProps: _PictureInPictureInPictureTileProps | undefined = useMemo(() => remoteVideoTileProps ? {\n    children: <_LocalVideoTile {...localVideoTileProps} personaMinSize={20} />,\n    // TODO: when the calling SDK provides height/width stream information - update this to reflect the stream orientation.\n    orientation: 'portrait'\n  } : undefined, [localVideoTileProps, remoteVideoTileProps]);\n  return <_PictureInPictureInPicture onClick={props.onClick} strings={strings} primaryTile={primaryTileProps} secondaryTile={secondaryTileProps} />;\n};\nconst localVideoViewOptions: VideoStreamOptions = {\n  scalingMode: 'Crop',\n  isMirrored: true\n};\nconst remoteVideoViewOptions: VideoStreamOptions = {\n  scalingMode: 'Crop',\n  isMirrored: false\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { _dominantSpeakersWithFlatId, _isInCall, _isPreviewOn, _videoGalleryRemoteParticipantsMemo } from '@internal/calling-component-bindings';\nimport { RemoteParticipantState } from '@internal/calling-stateful-client';\nimport * as reselect from 'reselect';\nimport { getDominantSpeakerInfo, getRemoteParticipants } from './baseSelectors';\n/**\n * Get the most dominant remote participant, if no dominant speaker IDs exist, this uses\n * one of the remote participants with no bias towards which one.\n *\n * @private\n */\n\nexport const dominantRemoteParticipantSelector = reselect.createSelector([getRemoteParticipants, getDominantSpeakerInfo], (remoteParticipants, dominantSpeakerInfo) => {\n  const dominantSpeakers = _dominantSpeakersWithFlatId(dominantSpeakerInfo);\n\n  const dominantRemoteParticipant = remoteParticipants && Object.keys(remoteParticipants).length > 0 ? findDominantRemoteParticipant(remoteParticipants, dominantSpeakers ?? []) : undefined;\n  return dominantRemoteParticipant ? _videoGalleryRemoteParticipantsMemo(updateUserDisplayNamesTrampoline(Object.values(dominantRemoteParticipant)))[0] : undefined;\n});\n\nconst findDominantRemoteParticipant = (remoteParticipants: {\n  [keys: string]: RemoteParticipantState;\n}, dominantSpeakerIds: string[]): {\n  dominantRemoteParticipantId: RemoteParticipantState;\n} => {\n  let dominantRemoteParticipantId = dominantSpeakerIds[0]; // Fallback to using the first remote participant if there are no dominant speaker IDs\n  // or if the dominant speaker is no longer available in the list of remoteParticipantIds\n\n  const remoteParticipantIds = Object.keys(remoteParticipants);\n\n  if (!dominantRemoteParticipantId || !remoteParticipantIds.includes(dominantRemoteParticipantId)) {\n    dominantRemoteParticipantId = remoteParticipantIds[0];\n  }\n\n  return {\n    dominantRemoteParticipantId: remoteParticipants[dominantRemoteParticipantId]\n  };\n};\n\nconst updateUserDisplayNamesTrampoline = (remoteParticipants: RemoteParticipantState[]): RemoteParticipantState[] => {\n  return remoteParticipants;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { _isInCall, _isPreviewOn, _videoGalleryRemoteParticipantsMemo } from '@internal/calling-component-bindings';\nimport * as reselect from 'reselect';\nimport { localVideoSelector } from './localVideoStreamSelector';\nimport { dominantRemoteParticipantSelector } from './dominantRemoteParticipantSelector';\nimport { getDisplayName } from './baseSelectors';\n/**\n * Picture in picture in picture needs to display the most-dominant remote speaker, as well as the local participant video.\n * @private\n */\n\nexport const localAndRemotePIPSelector = reselect.createSelector([getDisplayName, dominantRemoteParticipantSelector, localVideoSelector], (displayName, dominantRemoteParticipant, localVideoStreamInfo) => {\n  return {\n    localParticipant: {\n      displayName,\n      videoStream: localVideoStreamInfo\n    },\n    dominantRemoteParticipant\n  };\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { concatStyleSets, IModalStyleProps, IModalStyles, IStackStyles, IStyle, IStyleFunctionOrObject, ITheme } from '@fluentui/react';\nimport { _pxToRem } from '@internal/acs-ui-common';\n/**\n * Styles for {@link ModalLocalAndRemotePIP} component\n */\n\nexport type ModalLocalAndRemotePIPStyles = {\n  modal?: Partial<IModalStyles>;\n};\n/**\n * Default Modal PIP related pixel measurements used for ModalLocalAndremotePIP and common/utils.\n *\n * @private\n */\n\nexport const MODAL_PIP_DEFAULT_PX = {\n  rightPositionPx: 16,\n  topPositionPx: 52,\n  widthPx: 88,\n  heightPx: 128\n};\n/**\n * @private\n */\n\nexport const getPipStyles = (theme: ITheme): ModalLocalAndRemotePIPStyles => ({\n  modal: {\n    main: {\n      borderRadius: theme.effects.roundedCorner4,\n      boxShadow: theme.effects.elevation8,\n      // Above the message thread / people pane.\n      zIndex: 2,\n      ...(theme.rtl ? {\n        left: _pxToRem(MODAL_PIP_DEFAULT_PX.rightPositionPx)\n      } : {\n        right: _pxToRem(MODAL_PIP_DEFAULT_PX.rightPositionPx)\n      }),\n      top: _pxToRem(MODAL_PIP_DEFAULT_PX.topPositionPx)\n    }\n  }\n});\n/**\n * @private\n */\n\nexport const PIPContainerStyle: IStackStyles = {\n  root: {\n    position: 'absolute',\n    width: '100%',\n    height: '100%',\n    pointerEvents: 'none'\n  }\n};\n/**\n * @private\n */\n\nexport const hiddenStyle: IStackStyles = concatStyleSets(PIPContainerStyle, {\n  root: {\n    display: 'none'\n  }\n});\n/**\n * @private\n */\n\nexport const modalStyle: IStyleFunctionOrObject<IModalStyleProps, IModalStyles> = {\n  main: {\n    minWidth: 'min-content',\n    minHeight: 'min-content',\n    position: 'absolute',\n    overflow: 'hidden',\n    // pointer events for root Modal div set to auto to make LocalAndRemotePIP interactive\n    pointerEvents: 'auto',\n    touchAction: 'none'\n  },\n  root: {\n    width: '100%',\n    height: '100%',\n    // pointer events for root Modal div set to none to make descendants interactive\n    pointerEvents: 'none'\n  }\n};\n/**\n * Styles for layer host to bound the modal wrapping PiPiP in the mobile pane.\n * @private\n */\n\nexport const modalLayerHostStyle: IStyle = {\n  display: 'flex',\n  position: 'absolute',\n  left: 0,\n  top: 0,\n  width: '100%',\n  height: '100%',\n  overflow: 'hidden',\n  // pointer events for layerHost set to none to make descendants interactive\n  pointerEvents: 'none'\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { concatStyleSets, ContextualMenu, IDragOptions, Stack } from '@fluentui/react';\nimport React, { useMemo } from 'react';\nimport { LocalAndRemotePIP } from '../CallComposite/components/LocalAndRemotePIP';\nimport { useHandlers } from '../CallComposite/hooks/useHandlers';\nimport { useSelector } from '../CallComposite/hooks/useSelector';\nimport { localAndRemotePIPSelector } from '../CallComposite/selectors/localAndRemotePIPSelector';\nimport { _ModalClone, _ICoordinates } from '@internal/react-components';\nimport { hiddenStyle, ModalLocalAndRemotePIPStyles, modalStyle, PIPContainerStyle } from './styles/ModalLocalAndRemotePIP.styles';\n/**\n * Drag options for Modal in {@link ModalLocalAndRemotePIP} component\n */\n\nconst DRAG_OPTIONS: IDragOptions = {\n  moveMenuItemText: 'Move',\n  closeMenuItemText: 'Close',\n  menu: ContextualMenu,\n  keepInBounds: true\n};\n/**\n * A wrapping component with a draggable {@link LocalAndRemotePIP} component that is bound to a LayerHost component with id\n * specified by `modalLayerHostId` prop\n * @private\n */\n\nexport const ModalLocalAndRemotePIP = (props: {\n  hidden: boolean;\n  modalLayerHostId: string;\n  styles?: ModalLocalAndRemotePIPStyles;\n  minDragPosition?: _ICoordinates;\n  maxDragPosition?: _ICoordinates;\n}): JSX.Element | null => {\n  const rootStyles = props.hidden ? hiddenStyle : PIPContainerStyle;\n  const pictureInPictureProps = useSelector(localAndRemotePIPSelector);\n  const pictureInPictureHandlers = useHandlers(LocalAndRemotePIP);\n  const localAndRemotePIP = useMemo(() => {\n    return <LocalAndRemotePIP {...pictureInPictureProps} {...pictureInPictureHandlers} />;\n  }, [pictureInPictureProps, pictureInPictureHandlers]);\n  const modalStylesThemed = concatStyleSets(modalStyle, props.styles?.modal);\n  return <Stack styles={rootStyles}>\n      <_ModalClone isOpen={true} isModeless={true} dragOptions={DRAG_OPTIONS} styles={modalStylesThemed} layerProps={{\n      hostId: props.modalLayerHostId\n    }} minDragPosition={props.minDragPosition} maxDragPosition={props.maxDragPosition}>\n        {// Only render LocalAndRemotePIP when this component is NOT hidden because VideoGallery needs to have\n      // possession of the dominant remote participant video stream\n      !props.hidden && localAndRemotePIP}\n      </_ModalClone>\n    </Stack>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { useMemo } from 'react';\nimport { participantListContainerStyle, participantListMobileStyle, participantListStack, participantListStyle, participantListWrapper, displayNameStyles } from './styles/ParticipantContainer.styles';\nimport { OnRenderAvatarCallback, ParticipantList, ParticipantListProps, ParticipantMenuItemsCallback } from '@internal/react-components';\nimport { FocusZone, Stack, Text, useTheme } from '@fluentui/react';\nimport { AvatarPersona, AvatarPersonaDataCallback } from './AvatarPersona';\ntype ParticipantContainerProps = {\n  onRenderAvatar?: OnRenderAvatarCallback;\n  onFetchParticipantMenuItems?: ParticipantMenuItemsCallback;\n  onFetchAvatarPersonaData?: AvatarPersonaDataCallback;\n  participantListProps: ParticipantListProps;\n  title?: string;\n  isMobile?: boolean;\n};\n/**\n * @private\n */\n\nexport const ParticipantContainer = (props: ParticipantContainerProps): JSX.Element => {\n  const theme = useTheme();\n  const participantListWrapperClassName = useMemo(() => participantListWrapper(theme), [theme]);\n  return <Stack className={participantListWrapperClassName}>\n      <ParticipantListWithHeading {...props} />\n    </Stack>;\n};\n/**\n * @private\n */\n\nexport const ParticipantListWithHeading = (props: {\n  participantListProps: ParticipantListProps;\n  title?: string;\n  isMobile?: boolean;\n  onFetchAvatarPersonaData?: AvatarPersonaDataCallback;\n  onFetchParticipantMenuItems?: ParticipantMenuItemsCallback;\n}): JSX.Element => {\n  const {\n    onFetchAvatarPersonaData,\n    onFetchParticipantMenuItems,\n    title,\n    participantListProps\n  } = props;\n  const theme = useTheme();\n  const subheadingStyleThemed = useMemo(() => ({\n    root: {\n      color: theme.palette.neutralSecondary,\n      margin: props.isMobile ? '0.5rem 1rem' : '0.5rem',\n      fontSize: theme.fonts.smallPlus.fontSize\n    }\n  }), [theme.palette.neutralSecondary, theme.fonts.smallPlus.fontSize, props.isMobile]);\n  return <Stack className={participantListStack}>\n      <Stack.Item styles={subheadingStyleThemed}>{title}</Stack.Item>\n      <FocusZone className={participantListContainerStyle}>\n        <ParticipantList {...participantListProps} styles={props.isMobile ? participantListMobileStyle : participantListStyle} onRenderAvatar={(userId, options) => <>\n              <AvatarPersona data-ui-id=\"chat-composite-participant-custom-avatar\" userId={userId} {...options} {...{\n          hidePersonaDetails: !!options?.text\n        }} dataProvider={onFetchAvatarPersonaData} />\n              {options?.text && <Text nowrap={true} styles={displayNameStyles}>\n                  {options?.text}\n                </Text>}\n            </>} onFetchParticipantMenuItems={onFetchParticipantMenuItems} showParticipantOverflowTooltip={!props.isMobile} />\n      </FocusZone>\n    </Stack>;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IButtonStyles, IStackItemStyles, IStackStyles, IStackTokens, Theme } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const peoplePaneContainerTokens: IStackTokens = {\n  childrenGap: '0.5rem'\n};\n/**\n * @private\n */\n\nexport const peoplePaneContainerStyle: IStackItemStyles = {\n  root: {\n    position: 'relative',\n    maxHeight: '100%',\n    overflow: 'hidden'\n  }\n};\n/**\n * @private\n */\n\nexport const participantListContainerStyles: IStackItemStyles = {\n  root: {\n    overflowY: 'scroll'\n  }\n};\n/**\n * @private\n */\n\nexport const copyLinkButtonContainerStyles: IStackStyles = {\n  root: {\n    width: '100%',\n    padding: '0.5rem 1rem'\n  }\n};\n/**\n * @private\n */\n\nexport const copyLinkButtonStackStyles: IStackStyles = {\n  root: {\n    marginLeft: '0.5rem',\n    marginRight: '0.5rem'\n  }\n};\n/**\n * @private\n */\n\nexport const copyLinkButtonStyles: IButtonStyles = {\n  root: {\n    height: '2.5rem',\n    width: '100%'\n  },\n  textContainer: {\n    display: 'contents'\n  }\n};\n/**\n * @private\n */\n\nexport const linkIconStyles = {\n  marginRight: '0.5rem'\n};\n/**\n * @private\n */\n\nexport const localAndRemotePIPStyles: IStackStyles = {\n  root: {\n    marginRight: '1rem'\n  }\n};\n/**\n * @private\n */\n\nexport const themedCopyLinkButtonStyles = (mobileView: boolean | undefined, theme: Theme): Partial<IButtonStyles> => ({\n  root: {\n    minHeight: mobileView ? '3rem' : '2.5rem',\n    borderRadius: mobileView ? theme.effects.roundedCorner6 : theme.effects.roundedCorner4\n  }\n});","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IContextualMenuItem } from '@fluentui/react';\nimport { _DrawerMenuItemProps } from '@internal/react-components';\n/**\n * Convert IContextualMenuItem to _DrawerMenuItemProps\n * @param contextualMenu - IContextualMenuItem to convert\n * @param onDrawerMenuItemClick - callback to call when converted DrawerMenuItem is clicked\n * @returns DrawerMenuItem\n * @private\n */\n\nexport const convertContextualMenuItemToDrawerMenuItem = (contextualMenu: IContextualMenuItem, onDrawerMenuItemClick: () => void): _DrawerMenuItemProps => {\n  return {\n    itemKey: contextualMenu.key,\n    onItemClick: () => {\n      contextualMenu.onClick?.();\n      onDrawerMenuItemClick();\n    },\n    iconProps: contextualMenu.iconProps,\n    text: contextualMenu.text,\n    disabled: contextualMenu.disabled\n  };\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { concatStyleSets, DefaultButton, IButtonStyles, PrimaryButton, Stack, useTheme } from '@fluentui/react';\nimport copy from 'copy-to-clipboard';\nimport React, { useMemo } from 'react';\nimport { CallWithChatCompositeStrings } from '../../index-public';\nimport { CallWithChatCompositeIcon } from './icons';\nimport { peoplePaneContainerTokens } from './styles/ParticipantContainer.styles';\nimport { copyLinkButtonContainerStyles, copyLinkButtonStackStyles, copyLinkButtonStyles, linkIconStyles, themedCopyLinkButtonStyles } from './styles/PeoplePaneContent.styles';\n\n/** @private */\nexport interface AddPeopleButtonProps {\n  inviteLink?: string;\n  mobileView?: boolean;\n  participantList?: JSX.Element;\n  strings: CallWithChatCompositeStrings;\n  alternateCallerId?: string;\n}\n/** @private */\n\nexport const AddPeopleButton = (props: AddPeopleButtonProps): JSX.Element => {\n  const {\n    inviteLink,\n    mobileView,\n    strings,\n    participantList\n  } = props;\n  const theme = useTheme();\n  const copyLinkButtonStylesThemed = useMemo((): IButtonStyles => concatStyleSets(copyLinkButtonStyles, themedCopyLinkButtonStyles(mobileView, theme)), [mobileView, theme]);\n\n  if (mobileView) {\n    return <Stack>\n        {inviteLink && <Stack.Item styles={copyLinkButtonContainerStyles}>\n            <PrimaryButton onClick={() => copy(inviteLink ?? '')} styles={copyLinkButtonStylesThemed} onRenderIcon={() => <CallWithChatCompositeIcon iconName=\"Link\" style={linkIconStyles} />} text={strings.copyInviteLinkButtonLabel} />\n          </Stack.Item>}\n      </Stack>;\n  } else {\n    return <Stack tokens={peoplePaneContainerTokens}>\n        {inviteLink && <Stack styles={copyLinkButtonStackStyles}>\n            <DefaultButton text={strings.copyInviteLinkButtonLabel} onRenderIcon={() => <CallWithChatCompositeIcon iconName=\"Link\" style={linkIconStyles} />} onClick={() => copy(inviteLink ?? '')} styles={copyLinkButtonStylesThemed} />\n          </Stack>}\n        {participantList}\n      </Stack>;\n  }\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { IContextualMenuItem, Stack } from '@fluentui/react';\nimport { ParticipantList, ParticipantListParticipant, ParticipantListProps, ParticipantMenuItemsCallback, _DrawerMenuItemProps } from '@internal/react-components';\nimport React, { useMemo } from 'react';\nimport { CallWithChatCompositeStrings } from '../CallWithChatComposite';\nimport { usePropsFor } from '../CallComposite/hooks/usePropsFor';\nimport { AvatarPersonaDataCallback } from '../common/AvatarPersona';\nimport { ParticipantListWithHeading } from '../common/ParticipantContainer';\nimport { peoplePaneContainerTokens } from '../common/styles/ParticipantContainer.styles';\nimport { participantListContainerStyles, peoplePaneContainerStyle } from './styles/PeoplePaneContent.styles';\nimport { convertContextualMenuItemToDrawerMenuItem } from '../CallWithChatComposite/ConvertContextualMenuItemToDrawerMenuItem';\nimport { AddPeopleButton } from './AddPeopleButton';\n\n/**\n * @private\n */\nexport const PeoplePaneContent = (props: {\n  inviteLink?: string;\n  onRemoveParticipant: (participantId: string) => void;\n  onFetchAvatarPersonaData?: AvatarPersonaDataCallback;\n  onFetchParticipantMenuItems?: ParticipantMenuItemsCallback;\n  strings: CallWithChatCompositeStrings;\n  setDrawerMenuItems: (_DrawerMenuItemProps) => void;\n  mobileView?: boolean;\n}): JSX.Element => {\n  const {\n    inviteLink,\n    onFetchParticipantMenuItems,\n    setDrawerMenuItems,\n    strings,\n    onRemoveParticipant\n  } = props;\n  const participantListDefaultProps = usePropsFor(ParticipantList);\n  const removeButtonAllowed = hasRemoveParticipantsPermissionTrampoline();\n  const setDrawerMenuItemsForParticipant: (participant?: ParticipantListParticipant) => void = useMemo(() => {\n    return (participant?: ParticipantListParticipant) => {\n      if (participant) {\n        let contextualMenuItems: IContextualMenuItem[] = createDefaultContextualMenuItems(participant, strings, removeButtonAllowed && participant.isRemovable ? participantListDefaultProps.onRemoveParticipant : undefined, participantListDefaultProps.myUserId);\n\n        if (onFetchParticipantMenuItems) {\n          contextualMenuItems = onFetchParticipantMenuItems(participant.userId, participantListDefaultProps.myUserId, contextualMenuItems);\n        }\n\n        const drawerMenuItems = contextualMenuItems.map((contextualMenu: IContextualMenuItem) => convertContextualMenuItemToDrawerMenuItem(contextualMenu, () => setDrawerMenuItems([])));\n        setDrawerMenuItems(drawerMenuItems);\n      }\n    };\n  }, [strings, participantListDefaultProps.onRemoveParticipant, participantListDefaultProps.myUserId, removeButtonAllowed, onFetchParticipantMenuItems, setDrawerMenuItems]);\n  const participantListProps: ParticipantListProps = useMemo(() => {\n    const onRemoveAParticipant = async (participantId: string): Promise<void> => onRemoveParticipant(participantId);\n\n    return { ...participantListDefaultProps,\n      // Passing undefined callback for mobile to avoid context menus for participants in ParticipantList are clicked\n      onRemoveParticipant: props.mobileView ? undefined : onRemoveAParticipant,\n      // We want the drawer menu items to appear when participants in ParticipantList are clicked\n      onParticipantClick: props.mobileView ? setDrawerMenuItemsForParticipant : undefined\n    };\n  }, [participantListDefaultProps, props.mobileView, setDrawerMenuItemsForParticipant, onRemoveParticipant]);\n  const participantList = <ParticipantListWithHeading isMobile={props.mobileView} participantListProps={participantListProps} onFetchAvatarPersonaData={props.onFetchAvatarPersonaData} onFetchParticipantMenuItems={props.mobileView ? undefined : props.onFetchParticipantMenuItems} title={props.strings.peoplePaneSubTitle} />;\n\n  if (props.mobileView) {\n    return <Stack verticalFill styles={peoplePaneContainerStyle} tokens={peoplePaneContainerTokens}>\n        <Stack.Item grow styles={participantListContainerStyles}>\n          {participantList}\n        </Stack.Item>\n\n        <AddPeopleButton inviteLink={inviteLink} mobileView={props.mobileView} participantList={participantList} strings={strings} />\n      </Stack>;\n  }\n\n  return <AddPeopleButton inviteLink={inviteLink} mobileView={props.mobileView} participantList={participantList} strings={strings} />;\n};\n/**\n * Create default contextual menu items for particant\n * @param participant - participant to create contextual menu items for\n * @param strings - localized strings for menu item text\n * @param onRemoveParticipant - callback to remove participant\n * @param localParticipantUserId - Local participant user id\n * @returns - IContextualMenuItem[]\n */\n\nconst createDefaultContextualMenuItems = (participant: ParticipantListParticipant, strings: CallWithChatCompositeStrings, onRemoveParticipant?: (userId: string) => Promise<void>, localParticipantUserId?: string): IContextualMenuItem[] => {\n  const menuItems: IContextualMenuItem[] = [];\n\n  if (onRemoveParticipant && participant?.userId !== localParticipantUserId) {\n    menuItems.push({\n      key: 'remove',\n      text: strings.removeMenuLabel,\n      onClick: () => {\n        if (participant?.userId) {\n          onRemoveParticipant?.(participant?.userId);\n        }\n      },\n      iconProps: {\n        iconName: 'UserRemove'\n      }\n    });\n  }\n\n  return menuItems;\n};\n/**\n * @private\n */\n\n\nconst hasRemoveParticipantsPermissionTrampoline = (): boolean => {\n  // Return true if stable.\n  return true;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { concatStyleSets, IButtonStyles, IStackStyles, IStackTokens } from '@fluentui/react';\n/**\n * @private\n */\n\nexport const mobilePaneStyle = {\n  root: {\n    width: '100%',\n    height: '100%'\n  }\n};\n/**\n * @private\n */\n\nexport const hiddenMobilePaneStyle: IStackStyles = concatStyleSets(mobilePaneStyle, {\n  root: {\n    display: 'none'\n  }\n});\n/**\n * @private\n */\n\nexport const mobilePaneControlBarStyle: IStackStyles = {\n  root: {\n    height: '3rem'\n  }\n};\n/**\n * @private\n */\n\nexport const mobilePaneBackButtonStyles: IButtonStyles = {\n  root: {\n    border: 'none',\n    minWidth: '2.5rem',\n    height: '100%',\n    background: 'none',\n    padding: '0 1rem'\n  },\n  rootChecked: {\n    background: 'none'\n  },\n  rootCheckedHovered: {\n    background: 'none'\n  }\n};\n/**\n * @private\n */\n\nexport const mobilePaneHiddenIconStyles: IButtonStyles = concatStyleSets(mobilePaneBackButtonStyles, {\n  root: {\n    visibility: 'hidden'\n  }\n});\n/**\n * @private\n */\n\nexport const mobilePaneButtonStyles: IButtonStyles = {\n  root: {\n    border: 'none',\n    borderBottom: '0.125rem solid transparent',\n    width: '8rem',\n    height: '100%',\n    background: 'none',\n    padding: '0'\n  },\n  rootChecked: {\n    background: 'none'\n  },\n  rootCheckedHovered: {\n    background: 'none'\n  },\n  flexContainer: {\n    flexFlow: 'column',\n    display: 'contents'\n  },\n  label: {\n    fontSize: '1rem',\n    fontWeight: 100,\n    lineHeight: '2rem',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap'\n  },\n  labelChecked: {\n    fontWeight: 600\n  }\n};\n/**\n * @private\n */\n\nexport const hiddenStyles: IStackStyles = {\n  root: {\n    display: 'none'\n  }\n};\n/**\n * @private\n */\n\nexport const sidePaneStyles: IStackStyles = {\n  root: {\n    height: '100%',\n    padding: '0.5rem 0.25rem',\n    maxWidth: '21.5rem'\n  }\n};\n/**\n * @private\n */\n\nexport const availableSpaceStyles: IStackStyles = {\n  root: {\n    width: '100%',\n    height: '100%'\n  }\n};\n/**\n * @private\n */\n\nexport const sidePaneTokens: IStackTokens = {\n  childrenGap: '0.5rem'\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { concatStyleSets, DefaultButton, Stack } from '@fluentui/react';\nimport { useTheme } from '@internal/react-components';\nimport React, { useMemo } from 'react';\nimport { CallWithChatCompositeStrings } from '../CallWithChatComposite';\nimport { CallWithChatCompositeIcon } from '../common/icons';\nimport { mobilePaneBackButtonStyles, mobilePaneButtonStyles, mobilePaneControlBarStyle, mobilePaneHiddenIconStyles } from './styles/Pane.styles';\n/**\n * Props for {@link TabHeader} component\n */\n\ntype TabHeaderProps = {\n  onClose: () => void; // If set, show a button to open chat tab.\n\n  onChatButtonClicked?: () => void; // If set, show a button to open people tab.\n\n  onPeopleButtonClicked?: () => void;\n  activeTab: TabHeaderTab;\n  strings: CallWithChatCompositeStrings;\n  disableChatButton?: boolean;\n  disablePeopleButton?: boolean;\n};\n/**\n * @private\n */\n\nexport const TabHeader = (props: TabHeaderProps): JSX.Element => {\n  const {\n    onClose,\n    onChatButtonClicked,\n    onPeopleButtonClicked,\n    activeTab,\n    strings\n  } = props;\n  const theme = useTheme();\n  const haveMultipleTabs = onChatButtonClicked && onPeopleButtonClicked;\n  const mobilePaneButtonStylesThemed = useMemo(() => {\n    return concatStyleSets(mobilePaneButtonStyles, {\n      root: {\n        width: '100%'\n      },\n      label: {\n        fontSize: theme.fonts.medium.fontSize,\n        fontWeight: theme.fonts.medium.fontWeight\n      }\n    }, haveMultipleTabs ? {\n      rootChecked: {\n        borderBottom: `0.125rem solid ${theme.palette.themePrimary}`\n      }\n    } : {});\n  }, [theme, haveMultipleTabs]);\n  return <Stack horizontal grow styles={mobilePaneControlBarStyle}>\n      <DefaultButton ariaLabel={strings.returnToCallButtonAriaLabel} ariaDescription={strings.returnToCallButtonAriaDescription} onClick={onClose} styles={mobilePaneBackButtonStyles} onRenderIcon={() => <CallWithChatCompositeIcon iconName=\"ChevronLeft\" />} autoFocus></DefaultButton>\n      <Stack.Item grow>\n        {onChatButtonClicked && <DefaultButton onClick={onChatButtonClicked} styles={mobilePaneButtonStylesThemed} checked={activeTab === 'chat'} role={'tab'} disabled={props.disableChatButton}>\n            {strings.chatButtonLabel}\n          </DefaultButton>}\n      </Stack.Item>\n      <Stack.Item grow>\n        {onPeopleButtonClicked && <DefaultButton onClick={onPeopleButtonClicked} styles={mobilePaneButtonStylesThemed} checked={activeTab === 'people'} role={'tab'} disabled={props.disablePeopleButton}>\n            {strings.peopleButtonLabel}\n          </DefaultButton>}\n      </Stack.Item>\n      {\n      /* Hidden icon to take the same space as the actual back button on the left. */\n    }\n      <DefaultButton styles={mobilePaneHiddenIconStyles} onRenderIcon={() => <CallWithChatCompositeIcon iconName=\"ChevronLeft\" />}></DefaultButton>\n    </Stack>;\n};\n/**\n * Type used to define which tab is active in {@link TabHeader}\n */\n\nexport type TabHeaderTab = 'chat' | 'people';","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { _ICoordinates, _useContainerHeight, _useContainerWidth } from '@internal/react-components';\nimport { useMemo, useRef } from 'react';\nimport { MODAL_PIP_DEFAULT_PX } from './styles/ModalLocalAndRemotePIP.styles';\n/**\n * Interface for ModalLocalAndRemotePIP drag positions\n */\n\ninterface MinMaxDragPosition {\n  minDragPosition: _ICoordinates | undefined;\n  maxDragPosition: _ICoordinates | undefined;\n}\n/**\n * @private\n */\n// Use document.getElementById until Fluent's Stack supports componentRef property: https://github.com/microsoft/fluentui/issues/20410\n\nexport const useMinMaxDragPosition = (modalLayerHostId: string, rtl?: boolean): MinMaxDragPosition => {\n  const modalHostRef = useRef<HTMLElement>(document.getElementById(modalLayerHostId));\n\n  const modalHostWidth = _useContainerWidth(modalHostRef);\n\n  const modalHostHeight = _useContainerHeight(modalHostRef);\n\n  const minDragPosition: _ICoordinates | undefined = useMemo(() => modalHostWidth === undefined ? undefined : {\n    x: rtl ? -1 * MODAL_PIP_DEFAULT_PX.rightPositionPx : MODAL_PIP_DEFAULT_PX.rightPositionPx - modalHostWidth + MODAL_PIP_DEFAULT_PX.widthPx,\n    y: -1 * MODAL_PIP_DEFAULT_PX.topPositionPx\n  }, [modalHostWidth, rtl]);\n  const maxDragPosition: _ICoordinates | undefined = useMemo(() => modalHostWidth === undefined || modalHostHeight === undefined ? undefined : {\n    x: rtl ? modalHostWidth - MODAL_PIP_DEFAULT_PX.rightPositionPx - MODAL_PIP_DEFAULT_PX.widthPx : MODAL_PIP_DEFAULT_PX.rightPositionPx,\n    y: modalHostHeight - MODAL_PIP_DEFAULT_PX.topPositionPx - MODAL_PIP_DEFAULT_PX.heightPx\n  }, [modalHostHeight, modalHostWidth, rtl]);\n  return {\n    minDragPosition: minDragPosition,\n    maxDragPosition: maxDragPosition\n  };\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Stack } from '@fluentui/react';\nimport { _DrawerMenu, _DrawerMenuItemProps, _useContainerHeight, _useContainerWidth, ParticipantMenuItemsCallback, useTheme } from '@internal/react-components';\nimport React, { useMemo, useState } from 'react';\nimport { CallAdapter } from '../CallComposite';\nimport { CallAdapterProvider } from '../CallComposite/adapter/CallAdapterProvider';\nimport { ChatAdapter, ChatComposite, ChatCompositeProps } from '../ChatComposite';\nimport { AvatarPersonaDataCallback } from '../common/AvatarPersona';\nimport { paneBodyContainer, scrollableContainer, scrollableContainerContents } from '../common/styles/ParticipantContainer.styles';\nimport { SidePaneHeader } from '../common/SidePaneHeader';\nimport { useCallWithChatCompositeStrings } from './hooks/useCallWithChatCompositeStrings';\nimport { ModalLocalAndRemotePIP } from '../common/ModalLocalAndRemotePIP';\nimport { PeoplePaneContent } from '../common/PeoplePaneContent';\nimport { drawerContainerStyles } from './styles/CallWithChatCompositeStyles';\nimport { TabHeader } from '../common/TabHeader';\nimport { _ICoordinates } from '@internal/react-components';\nimport { _pxToRem } from '@internal/acs-ui-common';\nimport { getPipStyles } from '../common/styles/ModalLocalAndRemotePIP.styles';\nimport { useMinMaxDragPosition } from '../common/utils';\nimport { availableSpaceStyles, hiddenStyles, sidePaneStyles, sidePaneTokens } from '../common/styles/Pane.styles';\nimport { CallWithChatControlOptions } from './CallWithChatComposite';\nimport { isDisabled } from '../CallComposite/utils';\n/**\n * Pane that is used to store chat and people for CallWithChat composite\n * @private\n */\n\nexport const CallWithChatPane = (props: {\n  chatCompositeProps: Partial<ChatCompositeProps>;\n  callAdapter: CallAdapter;\n  chatAdapter: ChatAdapter;\n  onClose: () => void;\n  onFetchAvatarPersonaData?: AvatarPersonaDataCallback;\n  onFetchParticipantMenuItems?: ParticipantMenuItemsCallback;\n  onChatButtonClicked?: () => void;\n  onPeopleButtonClicked?: () => void;\n  modalLayerHostId: string;\n  activePane: CallWithChatPaneOption;\n  mobileView?: boolean;\n  inviteLink?: string;\n  rtl?: boolean;\n  callControls?: CallWithChatControlOptions;\n}): JSX.Element => {\n  const [drawerMenuItems, setDrawerMenuItems] = useState<_DrawerMenuItemProps[]>([]);\n  const hidden = props.activePane === 'none';\n  const paneStyles = hidden ? hiddenStyles : props.mobileView ? availableSpaceStyles : sidePaneStyles;\n  const callWithChatStrings = useCallWithChatCompositeStrings();\n  const theme = useTheme();\n  const header = props.activePane === 'none' ? null : props.mobileView ? <TabHeader {...props} strings={callWithChatStrings} activeTab={props.activePane} disableChatButton={isDisabled(props.callControls?.chatButton)} disablePeopleButton={isDisabled(props.callControls?.peopleButton)} /> : <SidePaneHeader {...props} strings={callWithChatStrings} headingText={props.activePane === 'chat' ? callWithChatStrings.chatPaneTitle : props.activePane === 'people' ? callWithChatStrings.peoplePaneTitle : ''} />;\n  const chatContent = <ChatComposite {...props.chatCompositeProps} adapter={props.chatAdapter} fluentTheme={theme} options={{\n    topic: false\n  }} onFetchAvatarPersonaData={props.onFetchAvatarPersonaData} />;\n  /**\n   * In a CallWithChat when a participant is removed, we must remove them from both\n   * the call and the chat thread.\n   */\n\n  const removeParticipantFromCallWithChat = async (participantId: string): Promise<void> => {\n    await props.callAdapter.removeParticipant(participantId);\n    await props.chatAdapter.removeParticipant(participantId);\n  };\n\n  const peopleContent = <CallAdapterProvider adapter={props.callAdapter}>\n      <PeoplePaneContent {...props} onRemoveParticipant={removeParticipantFromCallWithChat} setDrawerMenuItems={setDrawerMenuItems} strings={callWithChatStrings} />\n    </CallAdapterProvider>;\n  const minMaxDragPosition = useMinMaxDragPosition(props.modalLayerHostId, props.rtl);\n  const pipStyles = useMemo(() => getPipStyles(theme), [theme]);\n  const dataUiId = props.activePane === 'chat' ? 'call-with-chat-composite-chat-pane' : props.activePane === 'people' ? 'call-with-chat-composite-people-pane' : '';\n  return <Stack verticalFill grow styles={paneStyles} data-ui-id={dataUiId} tokens={props.mobileView ? {} : sidePaneTokens}>\n      {header}\n      <Stack.Item verticalFill grow styles={paneBodyContainer}>\n        <Stack horizontal styles={scrollableContainer}>\n          <Stack.Item verticalFill styles={scrollableContainerContents}>\n            <Stack styles={props.activePane === 'chat' ? availableSpaceStyles : hiddenStyles}>{chatContent}</Stack>\n            <Stack styles={props.activePane === 'people' ? availableSpaceStyles : hiddenStyles}>{peopleContent}</Stack>\n          </Stack.Item>\n        </Stack>\n      </Stack.Item>\n      {props.mobileView && <CallAdapterProvider adapter={props.callAdapter}>\n          <ModalLocalAndRemotePIP modalLayerHostId={props.modalLayerHostId} hidden={hidden} styles={pipStyles} minDragPosition={minMaxDragPosition.minDragPosition} maxDragPosition={minMaxDragPosition.maxDragPosition} />\n        </CallAdapterProvider>}\n      {drawerMenuItems.length > 0 && <Stack styles={drawerContainerStyles}>\n          <_DrawerMenu onLightDismiss={() => setDrawerMenuItems([])} items={drawerMenuItems} />\n        </Stack>}\n    </Stack>;\n};\n/**\n * Active tab option type for {@link CallWithChatPane} component\n * @private\n */\n\nexport type CallWithChatPaneOption = 'none' | 'chat' | 'people';","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport React, { useCallback, useState, useMemo, useEffect, useRef } from 'react';\nimport { LayerHost, mergeStyles, PartialTheme, Stack, Theme } from '@fluentui/react';\nimport { CallComposite, CallCompositePage, CallControlDisplayType } from '../CallComposite';\nimport { CallAdapterProvider } from '../CallComposite/adapter/CallAdapterProvider';\nimport { CallWithChatControlBar } from './CallWithChatControlBar';\nimport { CallState } from '@azure/communication-calling';\nimport { callCompositeContainerStyles, compositeOuterContainerStyles, controlBarContainerStyles, drawerContainerStyles } from './styles/CallWithChatCompositeStyles';\nimport { CallWithChatAdapter } from './adapter/CallWithChatAdapter';\nimport { CallWithChatBackedCallAdapter } from './adapter/CallWithChatBackedCallAdapter';\nimport { CallWithChatBackedChatAdapter } from './adapter/CallWithChatBackedChatAdapter';\nimport { CallAdapter } from '../CallComposite';\nimport { ChatCompositeProps } from '../ChatComposite';\nimport { BaseProvider, BaseCompositeProps } from '../common/BaseComposite';\nimport { CallWithChatCompositeIcons } from '../common/icons';\nimport { AvatarPersonaDataCallback } from '../common/AvatarPersona';\nimport { ChatAdapterProvider } from '../ChatComposite/adapter/ChatAdapterProvider';\nimport { CallWithChatAdapterState } from './state/CallWithChatAdapterState';\nimport { PreparedMoreDrawer } from './PreparedMoreDrawer';\nimport { ParticipantMenuItemsCallback, _useContainerHeight, _useContainerWidth } from '@internal/react-components';\nimport { useId } from '@fluentui/react-hooks';\nimport { CallWithChatPane, CallWithChatPaneOption } from './CallWithChatPane';\nimport { containerDivStyles } from '../common/ContainerRectProps';\nimport { modalLayerHostStyle } from '../common/styles/ModalLocalAndRemotePIP.styles';\n\n/**\n * Props required for the {@link CallWithChatComposite}\n *\n * @public\n */\nexport interface CallWithChatCompositeProps extends BaseCompositeProps<CallWithChatCompositeIcons> {\n  adapter: CallWithChatAdapter;\n  /**\n   * Fluent theme for the composite.\n   *\n   * Defaults to a light theme if undefined.\n   */\n\n  fluentTheme?: PartialTheme | Theme;\n  /**\n   * Optimizes the composite form factor for either desktop or mobile.\n   * @remarks `mobile` is currently only optimized for Portrait mode on mobile devices and does not support landscape.\n   * @defaultValue 'desktop'\n   */\n\n  formFactor?: 'desktop' | 'mobile';\n  /**\n   * URL that can be used to copy a call-with-chat invite to the Users clipboard.\n   */\n\n  joinInvitationURL?: string;\n  /**\n   * Flags to enable/disable or customize UI elements of the {@link CallWithChatComposite}\n   */\n\n  options?: CallWithChatCompositeOptions;\n}\n/**\n * Optional features of the {@link CallWithChatComposite}.\n *\n * @public\n */\n\nexport type CallWithChatCompositeOptions = {\n  /**\n   * Call control options to change what buttons show on the call-with-chat composite control bar.\n   * If using the boolean values, true will cause default behavior across the whole control bar. False hides the whole control bar.\n   */\n  callControls?: boolean | CallWithChatControlOptions;\n};\n/**\n * {@link CallWithChatComposite} Call controls to show or hide buttons on the calling control bar.\n *\n * @public\n */\n\nexport interface CallWithChatControlOptions {\n  /**\n   * {@link CallControlDisplayType} to change how the call controls are displayed.\n   * `'compact'` display type will decreases the size of buttons and hide the labels.\n   *\n   * @remarks\n   * If the composite `formFactor` is set to `'mobile'`, the control bar will always use compact view.\n   *\n   * @defaultValue 'default'\n   */\n  displayType?: CallControlDisplayType;\n  /**\n   * Show or Hide Microphone button during a call.\n   * @defaultValue true\n   */\n\n  microphoneButton?: boolean;\n  /**\n   * Show or Hide Camera Button during a call\n   * @defaultValue true\n   */\n\n  cameraButton?: boolean;\n  /**\n   * Show, Hide or Disable the screen share button during a call.\n   * @defaultValue true\n   */\n\n  screenShareButton?: boolean | {\n    disabled: boolean;\n  };\n  /**\n   * Show or Hide EndCall button during a call.\n   * @defaultValue true\n   */\n\n  endCallButton?: boolean;\n  /**\n   * Show or hide the chat button in the call-with-chat composite control bar.\n   * @defaultValue true\n   */\n\n  chatButton?: boolean;\n  /**\n   * Show or hide the people button in the call-with-chat composite control bar.\n   * @defaultValue true\n   */\n\n  peopleButton?: boolean;\n}\ntype CallWithChatScreenProps = {\n  callWithChatAdapter: CallWithChatAdapter;\n  fluentTheme?: PartialTheme | Theme;\n  formFactor?: 'desktop' | 'mobile';\n  joinInvitationURL?: string;\n  callControls?: boolean | CallWithChatControlOptions;\n  onFetchAvatarPersonaData?: AvatarPersonaDataCallback;\n  onFetchParticipantMenuItems?: ParticipantMenuItemsCallback;\n  rtl?: boolean;\n};\n\nconst CallWithChatScreen = (props: CallWithChatScreenProps): JSX.Element => {\n  const {\n    callWithChatAdapter,\n    fluentTheme,\n    formFactor = 'desktop'\n  } = props;\n  const mobileView = formFactor === 'mobile';\n\n  if (!callWithChatAdapter) {\n    throw new Error('CallWithChatAdapter is undefined');\n  }\n\n  const callAdapter: CallAdapter = useMemo(() => new CallWithChatBackedCallAdapter(callWithChatAdapter), [callWithChatAdapter]);\n  const [currentCallState, setCurrentCallState] = useState<CallState>();\n  const [currentPage, setCurrentPage] = useState<CallCompositePage>();\n  const [activePane, setActivePane] = useState<CallWithChatPaneOption>('none');\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const containerWidth = _useContainerWidth(containerRef);\n\n  const containerHeight = _useContainerHeight(containerRef);\n\n  useEffect(() => {\n    const updateCallWithChatPage = (newState: CallWithChatAdapterState): void => {\n      setCurrentPage(newState.page);\n      setCurrentCallState(newState.call?.state);\n    };\n\n    updateCallWithChatPage(callWithChatAdapter.getState());\n    callWithChatAdapter.onStateChange(updateCallWithChatPage);\n    return () => {\n      callWithChatAdapter.offStateChange(updateCallWithChatPage);\n    };\n  }, [callWithChatAdapter]);\n  const closePane = useCallback(() => {\n    setActivePane('none');\n  }, [setActivePane]);\n  const chatProps: ChatCompositeProps = useMemo(() => {\n    return {\n      adapter: new CallWithChatBackedChatAdapter(callWithChatAdapter)\n    };\n  }, [callWithChatAdapter]);\n  const modalLayerHostId = useId('modalLayerhost');\n  const isInLobbyOrConnecting = currentPage === 'lobby';\n  const hasJoinedCall = !!(currentPage && hasJoinedCallFn(currentPage, currentCallState ?? 'None'));\n  const showControlBar = isInLobbyOrConnecting || hasJoinedCall;\n  const isMobileWithActivePane = mobileView && hasJoinedCall && activePane !== 'none';\n  /** Constant setting of id for the parent stack of the composite */\n\n  const compositeParentDivId = useId('callWithChatCompositeParentDiv-internal');\n  const toggleChat = useCallback(() => {\n    if (activePane === 'chat' || !hasJoinedCall) {\n      setActivePane('none');\n    } else {\n      setActivePane('chat'); // timeout is required to give the window time to render the sendbox so we have something to send focus to.\n      // TODO: Selecting elements in the DOM via attributes is not stable. We should expose an API from ChatComposite to be able to focus on the sendbox.\n\n      const chatFocusTimeout = setInterval(() => {\n        const callWithChatCompositeRootDiv = document.querySelector(`[id=\"${compositeParentDivId}\"]`);\n        const sendbox = (callWithChatCompositeRootDiv?.querySelector(`[id=\"sendbox\"]`) as HTMLTextAreaElement);\n\n        if (sendbox !== null) {\n          sendbox.focus();\n          clearInterval(chatFocusTimeout);\n        }\n      }, 3);\n      setTimeout(() => {\n        clearInterval(chatFocusTimeout);\n      }, 300);\n    }\n  }, [activePane, setActivePane, compositeParentDivId, hasJoinedCall]);\n  const togglePeople = useCallback(() => {\n    if (activePane === 'people' || !hasJoinedCall) {\n      setActivePane('none');\n    } else {\n      setActivePane('people');\n    }\n  }, [activePane, setActivePane, hasJoinedCall]);\n  const selectChat = useCallback(() => {\n    if (hasJoinedCall) {\n      setActivePane('chat');\n    }\n  }, [setActivePane, hasJoinedCall]);\n  const selectPeople = useCallback(() => {\n    if (hasJoinedCall) {\n      setActivePane('people');\n    }\n  }, [setActivePane, hasJoinedCall]);\n  const [showDrawer, setShowDrawer] = useState(false);\n  const onMoreButtonClicked = useCallback(() => {\n    closePane();\n    setShowDrawer(true);\n  }, [closePane]);\n  const closeDrawer = useCallback(() => {\n    setShowDrawer(false);\n  }, []);\n  const onMoreDrawerPeopleClicked = useCallback(() => {\n    setShowDrawer(false);\n    togglePeople();\n  }, [togglePeople]); // On mobile, when there is an active call and some side pane is active,\n  // we hide the call composite via CSS to show only the pane.\n  // We only set `display` to `none` instead of unmounting the call composite component tree\n  // to avoid the performance cost of rerendering video streams when we later show the composite again.\n\n  const callCompositeContainerCSS = useMemo(() => {\n    return {\n      display: isMobileWithActivePane ? 'none' : 'flex'\n    };\n  }, [isMobileWithActivePane]);\n  return <div ref={containerRef} className={mergeStyles(containerDivStyles)}>\n      <Stack verticalFill grow styles={compositeOuterContainerStyles} id={compositeParentDivId}>\n        <Stack horizontal grow>\n          <Stack.Item grow styles={callCompositeContainerStyles} // Perf: Instead of removing the video gallery from DOM, we hide it to prevent re-renders.\n        style={callCompositeContainerCSS}>\n            <CallComposite {...props} formFactor={formFactor} options={{\n            callControls: false\n          }} adapter={callAdapter} fluentTheme={fluentTheme} />\n          </Stack.Item>\n\n          {chatProps.adapter && callAdapter && hasJoinedCall && <CallWithChatPane chatCompositeProps={chatProps} inviteLink={props.joinInvitationURL} onClose={closePane} chatAdapter={chatProps.adapter} callAdapter={callAdapter} onFetchAvatarPersonaData={props.onFetchAvatarPersonaData} onFetchParticipantMenuItems={props.onFetchParticipantMenuItems} onChatButtonClicked={showShowChatTabHeaderButton(props.callControls) ? selectChat : undefined} onPeopleButtonClicked={showShowPeopleTabHeaderButton(props.callControls) ? selectPeople : undefined} modalLayerHostId={modalLayerHostId} mobileView={mobileView} activePane={activePane} rtl={props.rtl} callControls={typeof props.callControls !== 'boolean' ? props.callControls : undefined} />}\n        </Stack>\n        {showControlBar && !isMobileWithActivePane && <ChatAdapterProvider adapter={chatProps.adapter}>\n            <Stack.Item styles={controlBarContainerStyles}>\n              <CallWithChatControlBar callAdapter={callAdapter} chatAdapter={chatProps.adapter} chatButtonChecked={activePane === 'chat'} onChatButtonClicked={toggleChat} peopleButtonChecked={activePane === 'people'} onPeopleButtonClicked={togglePeople} onMoreButtonClicked={onMoreButtonClicked} mobileView={mobileView} disableButtonsForLobbyPage={isInLobbyOrConnecting} callControls={props.callControls} containerHeight={containerHeight} containerWidth={containerWidth} />\n            </Stack.Item>\n          </ChatAdapterProvider>}\n        {showControlBar && showDrawer && <ChatAdapterProvider adapter={chatProps.adapter}>\n            <CallAdapterProvider adapter={callAdapter}>\n              <Stack styles={drawerContainerStyles}>\n                <PreparedMoreDrawer callControls={props.callControls} onLightDismiss={closeDrawer} onPeopleButtonClicked={onMoreDrawerPeopleClicked} />\n              </Stack>\n            </CallAdapterProvider>\n          </ChatAdapterProvider>}\n\n        {}\n        {// This layer host is for ModalLocalAndRemotePIP in CallWithChatPane. This LayerHost cannot be inside the CallWithChatPane\n      // because when the CallWithChatPane is hidden, ie. style property display is 'none', it takes up no space. This causes problems when dragging\n      // the Modal because the draggable bounds thinks it has no space and will always return to its initial position after dragging.\n      mobileView && <LayerHost id={modalLayerHostId} className={mergeStyles(modalLayerHostStyle)} />}\n      </Stack>\n    </div>;\n};\n/**\n * CallWithChatComposite brings together key components to provide a full call with chat experience out of the box.\n *\n * @public\n */\n\n\nexport const CallWithChatComposite = (props: CallWithChatCompositeProps): JSX.Element => {\n  const {\n    adapter,\n    fluentTheme,\n    rtl,\n    formFactor,\n    joinInvitationURL,\n    options\n  } = props;\n  return <BaseProvider fluentTheme={fluentTheme} rtl={rtl} locale={props.locale} icons={props.icons}>\n      <CallWithChatScreen {...props} callWithChatAdapter={adapter} formFactor={formFactor} callControls={options?.callControls} joinInvitationURL={joinInvitationURL} fluentTheme={fluentTheme} />\n    </BaseProvider>;\n};\n\nconst hasJoinedCallFn = (page: CallCompositePage, callStatus: CallState): boolean => {\n  return page === 'call' && (callStatus === 'Connected' || callStatus === 'Disconnecting');\n};\n\nconst showShowChatTabHeaderButton = (callControls?: boolean | CallWithChatControlOptions): boolean => {\n  if (callControls === undefined || callControls === true) {\n    return true;\n  }\n\n  if (callControls === false) {\n    return false;\n  }\n\n  return callControls.chatButton !== false;\n};\n\nconst showShowPeopleTabHeaderButton = (callControls?: boolean | CallWithChatControlOptions): boolean => {\n  if (callControls === undefined || callControls === true) {\n    return true;\n  }\n\n  if (callControls === false) {\n    return false;\n  }\n\n  return callControls.peopleButton !== false;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CommunicationIdentifierKind } from '@azure/communication-common';\nimport { CallState, DeviceManagerState } from '@internal/calling-stateful-client';\nimport { ChatThreadClientState } from '@internal/chat-stateful-client';\nimport { CallAdapter, CallAdapterState, CallCompositePage } from '../../CallComposite';\nimport { ChatAdapter, ChatAdapterState } from '../../ChatComposite';\nimport { AdapterErrors } from '../../common/adapters';\n/**\n * UI state pertaining to the {@link CallWithChatComposite}.\n *\n * @public\n */\n\nexport interface CallWithChatAdapterUiState {\n  /**\n   * Microphone state before a call has joined.\n   *\n   * @public\n   */\n  isLocalPreviewMicrophoneEnabled: boolean;\n  /**\n   * Current page of the Composite.\n   *\n   * @public\n   */\n\n  page: CallCompositePage;\n}\n/**\n * State from the backend services that drives {@link CallWithChatComposite}.\n *\n * @public\n */\n\nexport interface CallWithChatClientState {\n  /** ID of the call participant using this CallWithChatAdapter. */\n  userId: CommunicationIdentifierKind;\n  /** Display name of the participant using this CallWithChatAdapter. */\n\n  displayName: string | undefined;\n  /** State of the current call. */\n\n  call?: CallState;\n  /** State of the current chat. */\n\n  chat?: ChatThreadClientState;\n  /** Latest call error encountered for each operation performed via the adapter. */\n\n  latestCallErrors: AdapterErrors;\n  /** Latest chat error encountered for each operation performed via the adapter. */\n\n  latestChatErrors: AdapterErrors;\n  /** State of available and currently selected devices */\n\n  devices: DeviceManagerState;\n  /** State of whether the active call is a Teams interop call */\n\n  isTeamsCall: boolean;\n}\n/**\n * CallWithChat State is a combination of Stateful Chat and Stateful Calling clients with some\n * state specific to the CallWithChat Composite only.\n *\n * @public\n */\n\nexport interface CallWithChatAdapterState extends CallWithChatAdapterUiState, CallWithChatClientState {}\n/**\n * @private\n */\n\nexport function callWithChatAdapterStateFromBackingStates(callAdapter: CallAdapter, chatAdapter: ChatAdapter): CallWithChatAdapterState {\n  const callAdapterState = callAdapter.getState();\n  const chatAdapterState = chatAdapter.getState();\n  return {\n    call: callAdapterState.call,\n    chat: chatAdapterState.thread,\n    userId: callAdapterState.userId,\n    page: callAdapterState.page,\n    displayName: callAdapterState.displayName,\n    devices: callAdapterState.devices,\n    isLocalPreviewMicrophoneEnabled: callAdapterState.isLocalPreviewMicrophoneEnabled,\n    isTeamsCall: callAdapterState.isTeamsCall,\n    latestCallErrors: callAdapterState.latestErrors,\n    latestChatErrors: chatAdapterState.latestErrors\n  };\n}\n/**\n * @private\n */\n\nexport function mergeChatAdapterStateIntoCallWithChatAdapterState(existingCallWithChatAdapterState: CallWithChatAdapterState, chatAdapterState: ChatAdapterState): CallWithChatAdapterState {\n  return { ...existingCallWithChatAdapterState,\n    chat: chatAdapterState.thread,\n    latestChatErrors: chatAdapterState.latestErrors\n  };\n}\n/**\n * @private\n */\n\nexport function mergeCallAdapterStateIntoCallWithChatAdapterState(existingCallWithChatAdapterState: CallWithChatAdapterState, callAdapterState: CallAdapterState): CallWithChatAdapterState {\n  return { ...existingCallWithChatAdapterState,\n    userId: callAdapterState.userId,\n    page: callAdapterState.page,\n    displayName: callAdapterState.displayName,\n    devices: callAdapterState.devices,\n    call: callAdapterState.call,\n    isLocalPreviewMicrophoneEnabled: callAdapterState.isLocalPreviewMicrophoneEnabled,\n    isTeamsCall: callAdapterState.isTeamsCall,\n    latestCallErrors: callAdapterState.latestErrors\n  };\n}","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/**\n * Get chat thread from a teams url.\n * As per documented on the Chat SDK: https://docs.microsoft.com/en-us/azure/communication-services/quickstarts/chat/meeting-interop?pivots=platform-web#get-a-teams-meeting-chat-thread-for-a-communication-services-user\n *\n * @private\n */\nexport const getChatThreadFromTeamsLink = (teamsMeetingLink: string): string => {\n  // Get the threadId from the url - this also contains the call locator ID that will be removed in the threadId.split\n  let threadId = teamsMeetingLink.replace('https://teams.microsoft.com/l/meetup-join/', ''); // Unescape characters that applications like Outlook encode when creating joinable links\n\n  threadId = decodeURIComponent(threadId); // Extract just the chat guid from the link, stripping away the call locator ID\n\n  threadId = threadId.split(/^(.*?@thread\\.v2)/gm)[1];\n\n  if (!threadId || threadId.length === 0) {\n    throw new Error('Could not get chat thread from teams link');\n  }\n\n  return threadId;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\n// REMOVE ONCE THIS FILE IS IMPLEMENTED\n\n/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\n// REMOVE ONCE THIS FILE IS IMPLEMENTED\nimport { AudioDeviceInfo, Call, CallAgent, GroupCallLocator, PermissionConstraints, PropertyChangedEvent, TeamsMeetingLinkLocator, StartCallOptions, VideoDeviceInfo } from '@azure/communication-calling';\nimport { CreateVideoStreamViewResult, VideoStreamOptions } from '@internal/react-components';\nimport { ParticipantsJoinedListener, ParticipantsLeftListener, IsMutedChangedListener, CallIdChangedListener, IsLocalScreenSharingActiveChangedListener, DisplayNameChangedListener, IsSpeakingChangedListener, CallAdapter, CallAdapterState, createAzureCommunicationCallAdapter, CallEndedListener } from '../../CallComposite';\nimport { MessageReceivedListener, MessageReadListener, ChatAdapter, ChatAdapterState, ParticipantsRemovedListener, ParticipantsAddedListener } from '../../ChatComposite';\nimport { CallWithChatAdapter, CallWithChatEvent } from './CallWithChatAdapter';\nimport { callWithChatAdapterStateFromBackingStates, CallWithChatAdapterState, mergeCallAdapterStateIntoCallWithChatAdapterState, mergeChatAdapterStateIntoCallWithChatAdapterState } from '../state/CallWithChatAdapterState';\nimport { createAzureCommunicationChatAdapter, createAzureCommunicationChatAdapterFromClient } from '../../ChatComposite/adapter/AzureCommunicationChatAdapter';\nimport { EventEmitter } from 'events';\nimport { CommunicationTokenCredential, CommunicationUserIdentifier } from '@azure/communication-common';\nimport { getChatThreadFromTeamsLink } from './parseTeamsUrl';\nimport { AdapterError } from '../../common/adapters';\nimport { CallAdapterLocator, createAzureCommunicationCallAdapterFromClient } from '../../CallComposite/adapter/AzureCommunicationCallAdapter';\nimport { StatefulCallClient } from '@internal/calling-stateful-client';\nimport { StatefulChatClient } from '@internal/chat-stateful-client';\nimport { ChatThreadClient } from '@azure/communication-chat';\nimport { useEffect, useRef, useState } from 'react';\nimport { _toCommunicationIdentifier } from '@internal/acs-ui-common';\ntype CallWithChatAdapterStateChangedHandler = (newState: CallWithChatAdapterState) => void;\n/** Context of Call with Chat, which is a centralized context for all state updates */\n\nclass CallWithChatContext {\n  private emitter = new EventEmitter();\n  private state: CallWithChatAdapterState;\n\n  constructor(clientState: CallWithChatAdapterState) {\n    this.state = clientState;\n  }\n\n  public onStateChange(handler: CallWithChatAdapterStateChangedHandler): void {\n    this.emitter.on('stateChanged', handler);\n  }\n\n  public offStateChange(handler: CallWithChatAdapterStateChangedHandler): void {\n    this.emitter.off('stateChanged', handler);\n  }\n\n  public setState(state: CallWithChatAdapterState): void {\n    this.state = state;\n    this.emitter.emit('stateChanged', this.state);\n  }\n\n  public getState(): CallWithChatAdapterState {\n    return this.state;\n  }\n\n  public updateClientState(clientState: CallWithChatAdapterState): void {\n    this.setState(clientState);\n  }\n\n  public updateClientStateWithChatState(chatAdapterState: ChatAdapterState): void {\n    this.updateClientState(mergeChatAdapterStateIntoCallWithChatAdapterState(this.state, chatAdapterState));\n  }\n\n  public updateClientStateWithCallState(callAdapterState: CallAdapterState): void {\n    this.updateClientState(mergeCallAdapterStateIntoCallWithChatAdapterState(this.state, callAdapterState));\n  }\n\n}\n/**\n * CallWithChat adapter backed by Azure Communication Services.\n * Created for easy use with the {@link CallWithChatComposite}.\n */\n\n\nexport class AzureCommunicationCallWithChatAdapter implements CallWithChatAdapter {\n  private callAdapter: CallAdapter;\n  private chatAdapter: ChatAdapter;\n  private context: CallWithChatContext;\n  private onChatStateChange: (newChatAdapterState: ChatAdapterState) => void;\n  private onCallStateChange: (newChatAdapterState: CallAdapterState) => void;\n\n  constructor(callAdapter: CallAdapter, chatAdapter: ChatAdapter) {\n    this.bindPublicMethods();\n    this.callAdapter = callAdapter;\n    this.chatAdapter = chatAdapter;\n    this.context = new CallWithChatContext(callWithChatAdapterStateFromBackingStates(callAdapter, chatAdapter));\n\n    const onChatStateChange = (newChatAdapterState: ChatAdapterState): void => {\n      this.context.updateClientStateWithChatState(newChatAdapterState);\n    };\n\n    this.chatAdapter.onStateChange(onChatStateChange);\n    this.onChatStateChange = onChatStateChange;\n\n    const onCallStateChange = (newCallAdapterState: CallAdapterState): void => {\n      this.context.updateClientStateWithCallState(newCallAdapterState);\n    };\n\n    this.callAdapter.onStateChange(onCallStateChange);\n    this.onCallStateChange = onCallStateChange;\n  }\n\n  private bindPublicMethods(): void {\n    this.joinCall.bind(this);\n    this.leaveCall.bind(this);\n    this.startCall.bind(this);\n    this.onStateChange.bind(this);\n    this.offStateChange.bind(this);\n    this.getState.bind(this);\n    this.dispose.bind(this);\n    this.setCamera.bind(this);\n    this.setMicrophone.bind(this);\n    this.setSpeaker.bind(this);\n    this.askDevicePermission.bind(this);\n    this.queryCameras.bind(this);\n    this.queryMicrophones.bind(this);\n    this.querySpeakers.bind(this);\n    this.startCamera.bind(this);\n    this.stopCamera.bind(this);\n    this.mute.bind(this);\n    this.unmute.bind(this);\n    this.startScreenShare.bind(this);\n    this.stopScreenShare.bind(this);\n    this.removeParticipant.bind(this);\n    this.createStreamView.bind(this);\n    this.disposeStreamView.bind(this);\n    this.fetchInitialData.bind(this);\n    this.sendMessage.bind(this);\n    this.sendReadReceipt.bind(this);\n    this.sendTypingIndicator.bind(this);\n    this.loadPreviousChatMessages.bind(this);\n    this.updateMessage.bind(this);\n    this.deleteMessage.bind(this);\n    this.on.bind(this);\n    this.off.bind(this);\n  }\n  /** Join existing Call. */\n\n\n  public joinCall(microphoneOn?: boolean): Call | undefined {\n    return this.callAdapter.joinCall(microphoneOn);\n  }\n  /** Leave current Call. */\n\n\n  public async leaveCall(forEveryone?: boolean): Promise<void> {\n    // Only remove self from the GroupCall. Contoso must manage access to Chat.\n    await this.callAdapter.leaveCall(forEveryone);\n  }\n  /** Start a new Call. */\n\n\n  public startCall(participants: string[], options?: StartCallOptions): Call | undefined {\n    let communicationParticipants = participants;\n    return this.callAdapter.startCall(communicationParticipants, options);\n  }\n  /**\n   * Subscribe to state change events.\n   * @param handler - handler to be called when the state changes. This is passed the new state.\n   */\n\n\n  public onStateChange(handler: (state: CallWithChatAdapterState) => void): void {\n    this.context.onStateChange(handler);\n  }\n  /**\n   * Unsubscribe to state change events.\n   * @param handler - handler to be no longer called when state changes.\n   */\n\n\n  public offStateChange(handler: (state: CallWithChatAdapterState) => void): void {\n    this.context.offStateChange(handler);\n  }\n  /** Get current Call and Chat state. */\n\n\n  public getState(): CallWithChatAdapterState {\n    return this.context.getState();\n  }\n  /** Dispose of the current CallWithChatAdapter. */\n\n\n  public dispose(): void {\n    this.chatAdapter.offStateChange(this.onChatStateChange);\n    this.callAdapter.offStateChange(this.onCallStateChange);\n    this.chatAdapter.dispose();\n    this.callAdapter.dispose();\n  }\n  /** Remove a participant from the Call only. */\n\n\n  public async removeParticipant(userId: string): Promise<void> {\n    let participant = userId;\n    await this.callAdapter.removeParticipant(participant);\n  }\n\n  public async setCamera(device: VideoDeviceInfo, options?: VideoStreamOptions): Promise<void> {\n    await this.callAdapter.setCamera(device, options);\n  }\n  /** Set the microphone to be used in the Call. */\n\n\n  public async setMicrophone(device: AudioDeviceInfo): Promise<void> {\n    await this.callAdapter.setMicrophone(device);\n  }\n  /** Set the speaker to be used in the Call. */\n\n\n  public async setSpeaker(device: AudioDeviceInfo): Promise<void> {\n    await this.callAdapter.setSpeaker(device);\n  }\n\n  public async askDevicePermission(constraints: PermissionConstraints): Promise<void> {\n    await this.callAdapter.askDevicePermission(constraints);\n  }\n  /** Query for available cameras. */\n\n\n  public async queryCameras(): Promise<VideoDeviceInfo[]> {\n    return await this.callAdapter.queryCameras();\n  }\n  /** Query for available microphones. */\n\n\n  public async queryMicrophones(): Promise<AudioDeviceInfo[]> {\n    return await this.callAdapter.queryMicrophones();\n  }\n  /** Query for available speakers. */\n\n\n  public async querySpeakers(): Promise<AudioDeviceInfo[]> {\n    return await this.callAdapter.querySpeakers();\n  }\n  /** Start the camera for the user in the Call. */\n\n\n  public async startCamera(options?: VideoStreamOptions): Promise<void> {\n    await this.callAdapter.startCamera(options);\n  }\n  /** Stop the camera for the user in the Call. */\n\n\n  public async stopCamera(): Promise<void> {\n    await this.callAdapter.stopCamera();\n  }\n  /** Mute the user in the Call. */\n\n\n  public async mute(): Promise<void> {\n    await this.callAdapter.mute();\n  }\n  /** Unmute the user in the Call. */\n\n\n  public async unmute(): Promise<void> {\n    await this.callAdapter.unmute();\n  }\n  /** Trigger the user to start screen share. */\n\n\n  public async startScreenShare(): Promise<void> {\n    await this.callAdapter.startScreenShare();\n  }\n  /** Stop the current active screen share. */\n\n\n  public async stopScreenShare(): Promise<void> {\n    await this.callAdapter.stopScreenShare();\n  }\n  /** Create a stream view for a remote participants video feed. */\n\n\n  public async createStreamView(remoteUserId?: string, options?: VideoStreamOptions): Promise<void | CreateVideoStreamViewResult> {\n    return await this.callAdapter.createStreamView(remoteUserId, options);\n  }\n  /** Dispose of a created stream view of a remote participants video feed. */\n\n\n  public async disposeStreamView(remoteUserId?: string, options?: VideoStreamOptions): Promise<void> {\n    await this.callAdapter.disposeStreamView(remoteUserId, options);\n  }\n  /** Fetch initial Call and Chat data such as chat messages. */\n\n\n  public async fetchInitialData(): Promise<void> {\n    await this.chatAdapter.fetchInitialData();\n  }\n  /** Send a chat message. */\n\n\n  public async sendMessage(content: string): Promise<void> {\n    await this.chatAdapter.sendMessage(content);\n  }\n  /** Send a chat read receipt. */\n\n\n  public async sendReadReceipt(chatMessageId: string): Promise<void> {\n    await this.chatAdapter.sendReadReceipt(chatMessageId);\n  }\n  /** Send an isTyping indicator. */\n\n\n  public async sendTypingIndicator(): Promise<void> {\n    await this.chatAdapter.sendTypingIndicator();\n  }\n  /** Load previous Chat messages. */\n\n\n  public async loadPreviousChatMessages(messagesToLoad: number): Promise<boolean> {\n    return await this.chatAdapter.loadPreviousChatMessages(messagesToLoad);\n  }\n  /** Update an existing message. */\n\n\n  public async updateMessage(messageId: string, content: string, metadata?: Record<string, string>): Promise<void> {\n    return await this.chatAdapter.updateMessage(messageId, content, metadata);\n  }\n  /** Delete an existing message. */\n\n\n  public async deleteMessage(messageId: string): Promise<void> {\n    return await this.chatAdapter.deleteMessage(messageId);\n  }\n\n  on(event: 'callParticipantsJoined', listener: ParticipantsJoinedListener): void;\n  on(event: 'callParticipantsLeft', listener: ParticipantsLeftListener): void;\n  on(event: 'callEnded', listener: CallEndedListener): void;\n  on(event: 'callError', listener: (e: AdapterError) => void): void;\n  on(event: 'isMutedChanged', listener: IsMutedChangedListener): void;\n  on(event: 'callIdChanged', listener: CallIdChangedListener): void;\n  on(event: 'isLocalScreenSharingActiveChanged', listener: IsLocalScreenSharingActiveChangedListener): void;\n  on(event: 'displayNameChanged', listener: DisplayNameChangedListener): void;\n  on(event: 'isSpeakingChanged', listener: IsSpeakingChangedListener): void;\n  on(event: 'messageReceived', listener: MessageReceivedListener): void;\n  on(event: 'messageSent', listener: MessageReceivedListener): void;\n  on(event: 'messageRead', listener: MessageReadListener): void;\n  on(event: 'chatParticipantsAdded', listener: ParticipantsAddedListener): void;\n  on(event: 'chatParticipantsRemoved', listener: ParticipantsRemovedListener): void;\n  on(event: 'selectedMicrophoneChanged', listener: PropertyChangedEvent): void;\n  on(event: 'selectedSpeakerChanged', listener: PropertyChangedEvent): void;\n  on(event: 'chatError', listener: (e: AdapterError) => void): void; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n  on(event: CallWithChatEvent, listener: any): void {\n    switch (event) {\n      case 'callParticipantsJoined':\n        this.callAdapter.on('participantsJoined', listener);\n        break;\n\n      case 'callParticipantsLeft':\n        this.callAdapter.on('participantsLeft', listener);\n        break;\n\n      case 'callEnded':\n        this.callAdapter.on('callEnded', listener);\n        break;\n\n      case 'isMutedChanged':\n        this.callAdapter.on('isMutedChanged', listener);\n        break;\n\n      case 'callIdChanged':\n        this.callAdapter.on('callIdChanged', listener);\n        break;\n\n      case 'isLocalScreenSharingActiveChanged':\n        this.callAdapter.on('isLocalScreenSharingActiveChanged', listener);\n        break;\n\n      case 'displayNameChanged':\n        this.callAdapter.on('displayNameChanged', listener);\n        break;\n\n      case 'isSpeakingChanged':\n        this.callAdapter.on('isSpeakingChanged', listener);\n        break;\n\n      case 'selectedMicrophoneChanged':\n        this.callAdapter.on('selectedMicrophoneChanged', listener);\n        break;\n\n      case 'selectedSpeakerChanged':\n        this.callAdapter.on('selectedSpeakerChanged', listener);\n        break;\n\n      case 'messageReceived':\n        this.chatAdapter.on('messageReceived', listener);\n        break;\n\n      case 'messageSent':\n        this.chatAdapter.on('messageSent', listener);\n        break;\n\n      case 'messageRead':\n        this.chatAdapter.on('messageRead', listener);\n        break;\n\n      case 'chatParticipantsAdded':\n        this.chatAdapter.on('participantsAdded', listener);\n        break;\n\n      case 'chatParticipantsRemoved':\n        this.chatAdapter.on('participantsRemoved', listener);\n        break;\n\n      case 'callError':\n        this.callAdapter.on('error', listener);\n        break;\n\n      case 'chatError':\n        this.chatAdapter.on('error', listener);\n        break;\n\n      default:\n        throw `Unknown AzureCommunicationCallWithChatAdapter Event: ${event}`;\n    }\n  }\n\n  off(event: 'callParticipantsJoined', listener: ParticipantsJoinedListener): void;\n  off(event: 'callParticipantsLeft', listener: ParticipantsLeftListener): void;\n  off(event: 'callEnded', listener: CallEndedListener): void;\n  off(event: 'callError', listener: (e: AdapterError) => void): void;\n  off(event: 'isMutedChanged', listener: IsMutedChangedListener): void;\n  off(event: 'callIdChanged', listener: CallIdChangedListener): void;\n  off(event: 'isLocalScreenSharingActiveChanged', listener: IsLocalScreenSharingActiveChangedListener): void;\n  off(event: 'displayNameChanged', listener: DisplayNameChangedListener): void;\n  off(event: 'isSpeakingChanged', listener: IsSpeakingChangedListener): void;\n  off(event: 'selectedMicrophoneChanged', listener: PropertyChangedEvent): void;\n  off(event: 'selectedSpeakerChanged', listener: PropertyChangedEvent): void;\n  off(event: 'messageReceived', listener: MessageReceivedListener): void;\n  off(event: 'messageSent', listener: MessageReceivedListener): void;\n  off(event: 'messageRead', listener: MessageReadListener): void;\n  off(event: 'chatParticipantsAdded', listener: ParticipantsAddedListener): void;\n  off(event: 'chatParticipantsRemoved', listener: ParticipantsRemovedListener): void;\n  off(event: 'chatError', listener: (e: AdapterError) => void): void; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n  off(event: CallWithChatEvent, listener: any): void {\n    switch (event) {\n      case 'callParticipantsJoined':\n        this.callAdapter.off('participantsJoined', listener);\n        break;\n\n      case 'callParticipantsLeft':\n        this.callAdapter.off('participantsLeft', listener);\n        break;\n\n      case 'callEnded':\n        this.callAdapter.off('callEnded', listener);\n        break;\n\n      case 'isMutedChanged':\n        this.callAdapter.off('isMutedChanged', listener);\n        break;\n\n      case 'callIdChanged':\n        this.callAdapter.off('callIdChanged', listener);\n        break;\n\n      case 'isLocalScreenSharingActiveChanged':\n        this.callAdapter.off('isLocalScreenSharingActiveChanged', listener);\n        break;\n\n      case 'displayNameChanged':\n        this.callAdapter.off('displayNameChanged', listener);\n        break;\n\n      case 'isSpeakingChanged':\n        this.callAdapter.off('isSpeakingChanged', listener);\n        break;\n\n      case 'selectedMicrophoneChanged':\n        this.callAdapter.off('selectedMicrophoneChanged', listener);\n        break;\n\n      case 'selectedSpeakerChanged':\n        this.callAdapter.off('selectedSpeakerChanged', listener);\n        break;\n\n      case 'messageReceived':\n        this.chatAdapter.off('messageReceived', listener);\n        break;\n\n      case 'messageSent':\n        this.chatAdapter.off('messageSent', listener);\n        break;\n\n      case 'messageRead':\n        this.chatAdapter.off('messageRead', listener);\n        break;\n\n      case 'chatParticipantsAdded':\n        this.chatAdapter.off('participantsAdded', listener);\n        break;\n\n      case 'chatParticipantsRemoved':\n        this.chatAdapter.off('participantsRemoved', listener);\n        break;\n\n      case 'callError':\n        this.callAdapter.off('error', listener);\n        break;\n\n      case 'chatError':\n        this.chatAdapter.off('error', listener);\n        break;\n\n      default:\n        throw `Unknown AzureCommunicationCallWithChatAdapter Event: ${event}`;\n    }\n  }\n\n}\n/**\n * Arguments for use in {@link createAzureCommunicationCallWithChatAdapter} to join a Call with an associated Chat thread.\n *\n * @public\n */\n\nexport interface CallAndChatLocator {\n  /** Locator used by {@link createAzureCommunicationCallWithChatAdapter} to locate the call to join */\n  callLocator: GroupCallLocator;\n  /** Chat thread ID used by {@link createAzureCommunicationCallWithChatAdapter} to locate the chat thread to join */\n\n  chatThreadId: string;\n}\n/**\n * Arguments for {@link createAzureCommunicationCallWithChatAdapter}\n *\n * @public\n */\n\nexport type AzureCommunicationCallWithChatAdapterArgs = {\n  endpoint: string;\n  userId: CommunicationUserIdentifier;\n  displayName: string;\n  credential: CommunicationTokenCredential;\n  locator: CallAndChatLocator | TeamsMeetingLinkLocator;\n};\n/**\n * Create a CallWithChatAdapter backed by Azure Communication services\n * to plug into the {@link CallWithChatComposite}.\n *\n * @public\n */\n\nexport const createAzureCommunicationCallWithChatAdapter = async ({\n  userId,\n  displayName,\n  credential,\n  endpoint,\n  locator\n}: AzureCommunicationCallWithChatAdapterArgs): Promise<CallWithChatAdapter> => {\n  const callAdapterLocator = isTeamsMeetingLinkLocator(locator) ? locator : locator.callLocator;\n  const createCallAdapterPromise = createAzureCommunicationCallAdapter({\n    userId,\n    displayName,\n    credential,\n    locator: callAdapterLocator\n  });\n  const threadId = isTeamsMeetingLinkLocator(locator) ? getChatThreadFromTeamsLink(locator.meetingLink) : locator.chatThreadId;\n  const createChatAdapterPromise = createAzureCommunicationChatAdapter({\n    endpoint,\n    userId,\n    displayName,\n    credential,\n    threadId\n  });\n  const [callAdapter, chatAdapter] = await Promise.all([createCallAdapterPromise, createChatAdapterPromise]);\n  return new AzureCommunicationCallWithChatAdapter(callAdapter, chatAdapter);\n};\n/**\n * A custom React hook to simplify the creation of {@link CallWithChatAdapter}.\n *\n * Similar to {@link createAzureCommunicationCallWithChatAdapter}, but takes care of asynchronous\n * creation of the adapter internally.\n *\n * Allows arguments to be undefined so that you can respect the rule-of-hooks and pass in arguments\n * as they are created. The adapter is only created when all arguments are defined.\n *\n * Note that you must memoize the arguments to avoid recreating adapter on each render.\n * See storybook for typical usage examples.\n *\n * @public\n */\n\nexport const useAzureCommunicationCallWithChatAdapter = (args: Partial<AzureCommunicationCallWithChatAdapterArgs>, afterCreate?: (adapter: CallWithChatAdapter) => Promise<CallWithChatAdapter>, beforeDispose?: (adapter: CallWithChatAdapter) => Promise<void>): CallWithChatAdapter | undefined => {\n  const {\n    credential,\n    displayName,\n    endpoint,\n    locator,\n    userId\n  } = args; // State update needed to rerender the parent component when a new adapter is created.\n\n  const [adapter, setAdapter] = useState<CallWithChatAdapter | undefined>(undefined); // Ref needed for cleanup to access the old adapter created asynchronously.\n\n  const adapterRef = useRef<CallWithChatAdapter | undefined>(undefined);\n  const afterCreateRef = useRef<((adapter: CallWithChatAdapter) => Promise<CallWithChatAdapter>) | undefined>(undefined);\n  const beforeDisposeRef = useRef<((adapter: CallWithChatAdapter) => Promise<void>) | undefined>(undefined); // These refs are updated on *each* render, so that the latest values\n  // are used in the `useEffect` closures below.\n  // Using a Ref ensures that new values for the callbacks do not trigger the\n  // useEffect blocks, and a new adapter creation / distruction is not triggered.\n\n  afterCreateRef.current = afterCreate;\n  beforeDisposeRef.current = beforeDispose;\n  useEffect(() => {\n    if (!credential || !displayName || !endpoint || !locator || !userId) {\n      return;\n    }\n\n    (async () => {\n      if (adapterRef.current) {\n        // Dispose the old adapter when a new one is created.\n        //\n        // This clean up function uses `adapterRef` because `adapter` can not be added to the dependency array of\n        // this `useEffect` -- we do not want to trigger a new adapter creation because of the first adapter\n        // creation.\n        if (beforeDisposeRef.current) {\n          await beforeDisposeRef.current(adapterRef.current);\n        }\n\n        adapterRef.current.dispose();\n        adapterRef.current = undefined;\n      }\n\n      let newAdapter = await createAzureCommunicationCallWithChatAdapter({\n        credential,\n        displayName,\n        endpoint,\n        locator,\n        userId\n      });\n\n      if (afterCreateRef.current) {\n        newAdapter = await afterCreateRef.current(newAdapter);\n      }\n\n      adapterRef.current = newAdapter;\n      setAdapter(newAdapter);\n    })();\n  }, // Explicitly list all arguments so that caller doesn't have to memoize the `args` object.\n  [adapterRef, afterCreateRef, beforeDisposeRef, credential, displayName, endpoint, locator, userId]); // Dispose any existing adapter when the component unmounts.\n\n  useEffect(() => {\n    return () => {\n      (async () => {\n        if (adapterRef.current) {\n          if (beforeDisposeRef.current) {\n            await beforeDisposeRef.current(adapterRef.current);\n          }\n\n          adapterRef.current.dispose();\n          adapterRef.current = undefined;\n        }\n      })();\n    };\n  }, []);\n  return adapter;\n};\n/**\n * Arguments for {@link createAzureCommunicationCallWithChatAdapterFromClient}\n *\n * @public\n */\n\nexport type AzureCommunicationCallWithChatAdapterFromClientArgs = {\n  callLocator: CallAdapterLocator | TeamsMeetingLinkLocator;\n  callAgent: CallAgent;\n  callClient: StatefulCallClient;\n  chatClient: StatefulChatClient;\n  chatThreadClient: ChatThreadClient;\n};\n/**\n * Create a {@link CallWithChatAdapter} using the provided {@link StatefulChatClient} and {@link StatefulCallClient}.\n *\n * Useful if you want to keep a reference to {@link StatefulChatClient} and {@link StatefulCallClient}.\n * Consider using {@link createAzureCommunicationCallWithChatAdapter} for a simpler API.\n *\n * @public\n */\n\nexport const createAzureCommunicationCallWithChatAdapterFromClients = async ({\n  callClient,\n  callAgent,\n  callLocator,\n  chatClient,\n  chatThreadClient\n}: AzureCommunicationCallWithChatAdapterFromClientArgs): Promise<CallWithChatAdapter> => {\n  const createCallAdapterPromise = createAzureCommunicationCallAdapterFromClient(callClient, callAgent, callLocator);\n  const createChatAdapterPromise = createAzureCommunicationChatAdapterFromClient(chatClient, chatThreadClient);\n  const [callAdapter, chatAdapter] = await Promise.all([createCallAdapterPromise, createChatAdapterPromise]);\n  return new AzureCommunicationCallWithChatAdapter(callAdapter, chatAdapter);\n};\n/**\n * Create a {@link CallWithChatAdapter} from the underlying adapters.\n *\n * This is an internal factory function used by browser tests to inject fake adapters for call and chat.\n *\n * @internal\n */\n\nexport const _createAzureCommunicationCallWithChatAdapterFromAdapters = (callAdapter: CallAdapter, chatAdapter: ChatAdapter): CallWithChatAdapter => new AzureCommunicationCallWithChatAdapter(callAdapter, chatAdapter);\n\nconst isTeamsMeetingLinkLocator = (locator: CallAndChatLocator | TeamsMeetingLinkLocator): locator is TeamsMeetingLinkLocator => {\n  return 'meetingLink' in locator;\n};","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { CallingHandlers, getCallingSelector, GetCallingSelector, useCallingHandlers, useCallingSelector } from '@internal/calling-component-bindings';\nimport { ChatHandlers, getChatSelector, GetChatSelector, useChatHandlers, useChatSelector } from '@internal/chat-component-bindings';\nimport { ChatClientState } from '@internal/chat-stateful-client';\nimport { CallClientState } from '@internal/calling-stateful-client';\nimport { Common } from '@internal/acs-ui-common';\n/**\n * Centralized state for {@link @azure/communication-calling#CallClient} or {@link @azure/communication-chat#ChatClient}.\n *\n * See also: {@link CallClientState}, {@link ChatClientState}.\n * @public\n */\n\nexport type ClientState = CallClientState & ChatClientState;\n/**\n * An optimized selector that refines {@link ClientState} updates into props for React Components in this library.\n *\n * @public\n */\n\nexport type Selector = (state: ClientState, props: any) => any;\n/**\n * Hook to obtain a selector for a specified component.\n *\n * Useful when implementing a custom component that utilizes the providers\n * exported from this library.\n *\n * @public\n */\n\nexport const useSelector = <ParamT extends Selector | undefined,>(selector: ParamT, selectorProps?: ParamT extends Selector ? Parameters<ParamT>[1] : undefined, type?: 'calling' | 'chat'): ParamT extends Selector ? ReturnType<ParamT> : undefined => {\n  // Because of react hooks rules, hooks can't be conditionally called\n  // We call both call and chat hooks and detect current context\n  // Return undefined and skip execution when not in that context\n  const callingMode = !type || type === 'calling';\n  const chatMode = !type || type === 'chat';\n  const callProps = useCallingSelector(callingMode ? (selector as any) : undefined, selectorProps);\n  const chatProps = useChatSelector(chatMode ? (selector as any) : undefined, selectorProps);\n  return callProps ?? chatProps;\n};\n/**\n * Helper type for {@link usePropsFor}.\n *\n * @public\n */\n\nexport type ChatReturnProps<Component extends (props: any) => JSX.Element> = GetChatSelector<Component> extends (state: ChatClientState, props: any) => any ? ReturnType<GetChatSelector<Component>> & Common<ChatHandlers, Parameters<Component>[0]> : never;\n/**\n * Helper type for {@link usePropsFor}.\n *\n * @public\n */\n\nexport type CallingReturnProps<Component extends (props: any) => JSX.Element> = GetCallingSelector<Component> extends (state: CallClientState, props: any) => any ? ReturnType<GetCallingSelector<Component>> & Common<CallingHandlers, Parameters<Component>[0]> : never;\n/**\n * Helper type for {@link usePropsFor}.\n *\n * @public\n */\n\nexport type ComponentProps<Component extends (props: any) => JSX.Element> = ChatReturnProps<Component> extends never ? CallingReturnProps<Component> extends never ? undefined : CallingReturnProps<Component> : ChatReturnProps<Component>;\n/**\n * Primary hook to get all hooks necessary for a React Component from this library.\n *\n * To call this hook, the component requires to be wrapped under these providers:\n *\n * 1. For chat components: {@link ChatClientProvider} and {@link ChatThreadClientProvider}.\n *\n * 2. For calling components: {@link CallClientProvider}, {@link CallAgentProvider} and {@link CallAgentProvider}.\n *\n * Most straightforward usage of a components looks like:\n *\n * @example\n * ```\n *     import { ParticipantList, usePropsFor } from '@azure/communication-react';\n *\n *     const App = (): JSX.Element => {\n *         // ... code to setup Providers ...\n *\n *         return <ParticipantList {...usePropsFor(ParticipantList)}/>\n *     }\n * ```\n *\n * @public\n */\n\nexport const usePropsFor = <Component extends (props: any) => JSX.Element,>(component: Component, type?: 'calling' | 'chat'): ComponentProps<Component> => {\n  const callingSelector = type === 'calling' || !type ? getCallingSelector(component) : undefined;\n  const chatSelector = type === 'chat' || !type ? getChatSelector(component) : undefined;\n  const callProps = useCallingSelector(callingSelector);\n  const chatProps = useChatSelector(chatSelector);\n  const callingHandlers = useCallingHandlers<Parameters<Component>[0]>(component);\n  const chatHandlers = useChatHandlers<Parameters<Component>[0]>(component);\n\n  if (chatProps) {\n    if (!chatHandlers) {\n      throw 'Please initialize chatClient and chatThreadClient first!';\n    }\n\n    return ({ ...chatProps,\n      ...chatHandlers\n    } as any);\n  }\n\n  if (callProps) {\n    if (!callingHandlers) {\n      throw 'Please initialize callClient first!';\n    }\n\n    return ({ ...callProps,\n      ...callingHandlers\n    } as any);\n  }\n\n  if (!chatSelector && !callingSelector) {\n    throw \"Can't find corresponding selector for this component. Please check the supported components from Azure Communication UI Feature Component List.\";\n  } else {\n    throw 'Could not find props for this component, ensure the component is wrapped by appropriate providers.';\n  }\n};"],"names":["isCommunicationUserIdentifier","isMicrosoftTeamsUserIdentifier","isPhoneNumberIdentifier","telemetryVersion['default']","getDeviceManager","getRemoteParticipants","getLocalVideoStreams","getDisplayName","getLatestErrors","reselect","memoizeOne","LocalVideoStream","createContext","React","useContext","useState","useEffect","CallContext","mergeStyles","en_US","en_GB","de_DE","es_ES","fr_FR","it_IT","ja_JP","ko_KR","nl_NL","pt_BR","ru_RU","tr_TR","zh_CN","zh_TW","LocaleContext","LocalizationProvider","useLocale","Text","Stack","MessageBarType","MessageBar","useRef","useMemo","mergeThemes","getTheme","mergeNorthstarThemes","teamsTheme","ThemeProvider","Provider","WifiWarning20Filled","MoreHorizontal20Regular","VideoOff20Filled","Video20Filled","CallEnd20Filled","MicOff20Filled","MicOn20Filled","Settings20Filled","People20Filled","ShareScreenStart20Filled","ShareScreenStop20Filled","Dismiss20Regular","Checkmark20Regular","VideoProhibited16Filled","MicProhibited16Filled","MicOff16Filled","MicOn16Filled","SpeakerMute16Filled","Dismiss16Regular","Video16Filled","ChevronLeft20Regular","ChevronRight20Regular","CheckmarkCircle16Regular","Edit20Regular","ErrorCircle16Regular","Delete20Regular","ArrowClockwise16Regular","EyeShow16Regular","Circle16Regular","Video20Regular","MicOn20Regular","Speaker220Regular","MicOff16Regular","MoreHorizontal20Filled","Send20Regular","Send20Filled","FontWeights","concatStyleSets","useCallback","TextField","TooltipHost","IconButton","buttonStyle","iconWrapperStyle","DefaultButton","MAXIMUM_LENGTH_OF_MESSAGE","Icon","hostStyles","LiveMessage","buttonWithIconStyles","FontIcon","useTheme","getFileTypeIconProps","ProgressIndicator","actionIconStyle","MINIMUM_TOUCH_TARGET_HEIGHT_REM","PersonaSize","Persona","ContextualMenu","DirectionalHint","Parser","Linkify","Link","Ref","Spinner","SpinnerSize","Chat","convertRemToPx","PrimaryButton","SystemMessageComponent","Flex","LiveAnnouncer","iconContainerStyle","iconStyles","participantStateStringTrampoline","preventDismissOnEvent","participantListStyle","PersonaPresence","merge","palette","useLayoutEffect","AnimationVariables","classNamesFunction","getPropsWithDefaults","useMergedRefs","useResponsiveMode","useId","useWindow","useSetTimeout","useBoolean","useConst","EventGroup","allowOverscrollOnElement","allowScrollOnElement","KeyCodes","elementContains","useUnmount","FocusTrapZone","ResponsiveMode","Layer","Popup","Overlay","memoizeFunction","on","getGlobalClassNames","ZIndexes","styled","DRAG_OPTIONS","LayerHost","controlBarStyles","mergeStyleSets","ContextualMenuItemType","copy","DefaultPalette","containerStyles","AnimationStyles","createSelector","updateUserDisplayNamesTrampoline","getIdentifierKind","useHandlers","useSelector","errorBarSelector","DiagnosticQuality","maxErrorCount","getSelector","findSelector","createClientLogger","enableMapSet","enablePatches","EventEmitter","produce","getLogLevel","VideoStreamRenderer","ParticipantSubscriber","Features","CallClient","ChatContext","__asyncValues","nanoid","ChatClient","ComponentLocalizationProvider","Speaker220Filled","CameraSwitch24Regular","Chat20Filled","Chat20Regular","People20Regular","CallMissed20Filled","PersonDelete20Filled","Info20Filled","registerIcons","Customizer","useAdapter","useAdaptedSelector","useSelectorWithAdaptation","adaptCompositeState","memoizeState","createCompositeHandlers","usePropsFor","getChatSelector","FileUploadButton","isDisabled","getCallingSelector","isEnabled","controlBarContainerStyles","containerStyle","localVideoViewOptions","remoteVideoViewOptions","titleStyle","moreDetailsStyle","Dropdown","Label","icon","inferCallWithChatControlOptions","DrawerMenu","CommandBarButton","FocusZone","useCallingSelector","useChatSelector","useCallingHandlers","useChatHandlers"],"mappings":"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"}